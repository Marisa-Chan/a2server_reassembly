                .686p
                .mmx
                .model flat
                assume fs:nothing
                option casemap :none

include kernel32.inc

include a2server.exe.inc
include crt.inc ; to not define it as public

.data

__xi_a          dd 0                    ; DATA XREF: __cinit+22↑o
                dd offset sub_5F4A3F
                dd offset sub_5F4CFA
                dd offset sub_5F54CC
                dd offset sub_5F642B
                dd offset sub_5F6451
                dd offset sub_5D9D9B
                dd offset unknown_libname_409 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_453 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_499 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_526 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_540 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_541 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_542 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_543 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_544 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_545 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_546 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_547 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_548 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_549 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_550 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_551 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_552 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_553 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_554 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_555 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_556 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_557 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_558 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_559 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_560 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_561 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_562 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_563 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_564 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_565 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_566 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_567 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_568 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_571 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_572 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_573 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_574 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_575 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_576 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_577 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_589 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_590 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_591 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_652 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_653 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_654 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_655 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_656 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_670 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_671 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_682 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_683 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_684 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_685 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_686 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_690 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_691 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_692 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_693 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_694 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_695 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_696 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_697 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_698 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_699 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_700 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_701 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_702 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_703 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_704 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_705 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_706 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_707 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_708 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_709 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_710 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_711 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_712 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_713 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_714 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_715 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_716 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_717 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_718 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_719 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_720 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_725 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_730 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_731 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_732 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_733 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_734 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_735 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_736 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_738 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_741 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_742 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_743 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_744 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_746 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_747 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_748 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_749 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_750 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_751 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_752 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_753 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_754 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_755 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_756 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_762 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_763 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_764 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_765 ; MFC 3.1-14.0 32bit
                dd offset unknown_libname_766 ; MFC 3.1-14.0 32bit
                dd offset sub_5F4548
                dd offset sub_5F4685
                dd offset sub_5F46F3
                dd offset sub_5EFCB8
                dd offset sub_5F4741
                dd offset sub_5F4779
                dd offset sub_5F47B1
                dd offset sub_5F47E9
                dd offset sub_5F48E9
                dd offset sub_5F4953
                dd offset sub_5E06F0
                dd offset sub_5E0706
                dd offset sub_5E0744
                dd offset sub_5E0782
                dd offset sub_5E07C0
                dd offset j_unknown_libname_941
                dd offset j_unknown_libname_942
                dd offset sub_5F5AB8
                dd offset sub_5F6477
                dd offset sub_5F2BD3
__xi_z          dd 0

__xc_a          dd 0
                dd offset ___onexitinit
                dd offset ___initstdio
                dd offset ?__CxxSetUnhandledExceptionFilter@@YAXXZ
__xc_z          dd 0

__xp_a    dd 0
          dd offset ___endstdio
__xp_z    dd 0

__xt_a    dd 0
          dd offset ?__CxxRestoreUnhandledExceptionFilter@@YAXXZ ; __CxxRestoreUnhandledExceptionFilter(void)
__xt_z    dd 0




_aexit_rtn      dd offset __exit        ; DATA XREF: __amsg_exit+20↑r

_exitflag     db ?                    ; DATA XREF: _doexit+38↑w
_C_Termination_Done    dd ?                    ; DATA XREF: _doexit+2E↑w
_C_Exit_Done    dd ?                    ; DATA XREF: _doexit+8↑r
__onexitend    dd ?                    ; DATA XREF: __onexit+11↑r
__onexitbegin    dd ?                    ; DATA XREF: __onexit+6↑r


_adbgmsg    dd ?                    ; DATA XREF: __FF_MSGBANNER+21↑r

aProgramNameUnk db '<program name unknown>',0
aMicrosoftVisua db 'Microsoft Visual C++ Runtime Library',0
aRuntimeErrorPr db 'Runtime Error!',0Ah
                db 0Ah
                db 'Program: ',0
asc_614A8C      db 0Ah                  ; DATA XREF: __NMSG_WRITE+11A↑o
                db 0Ah,0
asc_614AAC      db '...',0              ; DATA XREF: __NMSG_WRITE+C4↑o

; int dword_70D4E0
dword_70D4E0    dd ?

__sbh_threshold    dd 1E0h                 ; DATA XREF: __heap_alloc+9↑r

_crtheap           dd ?                    ; DATA XREF: __heap_alloc:loc_5BF062↑r



sigcritsect     db 18h dup(?)
ltlcritsect     db 18h dup(?)
hlcritsect      db 18h dup(?)
xlcritsect      db 18h dup(?)

_locktable      dd 0                    ; 0
                dd offset sigcritsect   ; 1
                dd 0                    ; 2
                dd 0                    ; 3
                dd 0                    ; 4
                dd 0                    ; 5
                dd 0                    ; 6
                dd 0                    ; 7
                dd 0                    ; 8
                dd offset hlcritsect    ; 9
                dd 0                    ; 10
                dd 0                    ; 11
                dd 0                    ; 12
                dd offset xlcritsect    ; 13
                dd 0                    ; 14
                dd 0                    ; 15
                dd 0                    ; 16
                dd offset ltlcritsect   ; 17
                dd 0                    ; 18
                dd 0                    ; 19
                dd 0                    ; 20
                dd 0                    ; 21
                dd 0                    ; 22
                dd 0                    ; 23
                dd 0                    ; 24
                dd 0                    ; 25
                dd 0                    ; 26
                dd 0                    ; 27
                dd 0                    ; 28
                dd 0                    ; 29
                dd 0                    ; 30
                dd 0                    ; 31
                dd 0                    ; 32
                dd 0                    ; 33
                dd 0                    ; 34
                dd 0                    ; 35
                dd 0                    ; 36
                dd 0                    ; 37
                dd 0                    ; 38
                dd 0                    ; 39
                dd 0                    ; 40
                dd 0                    ; 41
                dd 0                    ; 42
                dd 0                    ; 43
                dd 0                    ; 44
                dd 0                    ; 45
                dd 0                    ; 46
                dd 0                    ; 47


__small_block_heap      dd offset __small_block_heap    ; p_next_region
                        dd offset __small_block_heap    ; p_prev_region +4
                        dd offset __small_block_heap+18h            ; p_starting_region_map +8
                        dd offset __small_block_heap+18h            ; p_first_uncommitted +C
                        dd 0FFFFFFFFh           ; p_pages_begin  +10
                        dd 0FFFFFFFFh           ; p_pages_end  +14
                        dd 0F0h                 ; region_map[0]  +18
                        dd 0F1h                 ; region_map[1]  +1C
                        db 2000h dup(0)         ; region_map[...]

__sbh_p_starting_region      dd offset __small_block_heap



aRuntimeError   db 'runtime error ',0
asc_6147E8      db 0Dh,0Ah,0            ; DATA XREF: .data:006416D4\u2193o
aTlossError     db 'TLOSS error',0Dh,0Ah,0
aSingError      db 'SING error',0Dh,0Ah,0
aDomainError    db 'DOMAIN error',0Dh,0Ah,0
aR6028UnableToI db 'R6028',0Dh,0Ah
                db '- unable to initialize heap',0Dh,0Ah,0
aR6027NotEnough db 'R6027',0Dh,0Ah
                db '- not enough space for lowio initialization',0Dh,0Ah,0
aR6026NotEnough db 'R6026',0Dh,0Ah
                db '- not enough space for stdio initialization',0Dh,0Ah,0
aR6025PureVirtu db 'R6025',0Dh,0Ah
                db '- pure virtual function call',0Dh,0Ah,0
aR6024NotEnough db 'R6024',0Dh,0Ah
                db '- not enough space for _onexit/atexit table',0Dh,0Ah,0
aR6019UnableToO db 'R6019',0Dh,0Ah
                db '- unable to open console device',0Dh,0Ah,0
aR6018Unexpecte db 'R6018',0Dh,0Ah
                db '- unexpected heap error',0Dh,0Ah,0
aR6017Unexpecte db 'R6017',0Dh,0Ah
                db '- unexpected multithread lock error',0Dh,0Ah,0
aR6016NotEnough db 'R6016',0Dh,0Ah
                db '- not enough space for thread data',0Dh,0Ah,0
aAbnormalProgra db 0Dh,0Ah
                db 'abnormal program termination',0Dh,0Ah,0
aR6009NotEnough db 'R6009',0Dh,0Ah
                db '- not enough space for environment',0Dh,0Ah,0
aR6008NotEnough db 'R6008',0Dh,0Ah
                db '- not enough space for arguments',0Dh,0Ah,0
aR6002FloatingP db 'R6002',0Dh,0Ah      ; DATA XREF: .data:lpBuffer↓o
                db '- floating point not loaded',0Dh,0Ah,0


rterrs          dd 2                      ; DATA XREF: __NMSG_WRITE+A↑o
                dd offset aR6002FloatingP ; "R6002\r\n- floating point not loaded\r"...
                dd 8
                dd offset aR6008NotEnough ; "R6008\r\n- not enough space for argumen"...
                dd 9
                dd offset aR6009NotEnough ; "R6009\r\n- not enough space for environ"...
                dd 0Ah
                dd offset aAbnormalProgra ; "\r\nabnormal program termination\r\n"
                dd 10h
                dd offset aR6016NotEnough ; "R6016\r\n- not enough space for thread "...
                dd 11h
                dd offset aR6017Unexpecte ; "R6017\r\n- unexpected multithread lock "...
                dd 12h
                dd offset aR6018Unexpecte ; "R6018\r\n- unexpected heap error\r\n"
                dd 13h
                dd offset aR6019UnableToO ; "R6019\r\n- unable to open console devic"...
                dd 18h
                dd offset aR6024NotEnough ; "R6024\r\n- not enough space for _onexit"...
                dd 19h
                dd offset aR6025PureVirtu ; "R6025\r\n- pure virtual function call\r"...
                dd 1Ah
                dd offset aR6026NotEnough ; "R6026\r\n- not enough space for stdio i"...
                dd 1Bh
                dd offset aR6027NotEnough ; "R6027\r\n- not enough space for lowio i"...
                dd 1Ch
                dd offset aR6028UnableToI ; "R6028\r\n- unable to initialize heap\r"...
                dd 78h
                dd offset aDomainError  ; "DOMAIN error\r\n"
                dd 79h
                dd offset aSingError    ; "SING error\r\n"
                dd 7Ah
                dd offset aTlossError   ; "TLOSS error\r\n"
                dd 0FCh
                dd offset asc_6147E8    ; "\r\n"
                dd 0FFh
                dd offset aRuntimeError ; "runtime error "


aGetlastactivep db 'GetLastActivePopup',0
aGetactivewindo db 'GetActiveWindow',0  ; DATA XREF: ___crtMessageBoxA+36↑o
aMessageboxa    db 'MessageBoxA',0      ; DATA XREF: ___crtMessageBoxA+25↑o
LibFileName     db 'user32.dll',0       ; DATA XREF: ___crtMessageBoxA+E↑o



__sbh_decommitable_pages    dd ?                    ; DATA XREF: ___sbh_decommit_pages

_pnhHeap    dd ?                    ; DATA XREF: _set_new_handler

__error_mode    dd ?                    ; DATA XREF: __amsg_exit

__app_type    dd 2                   

pfnMessageBoxA    dd ?                    ; DATA XREF: ___crtMessageBoxA↑r
pfnGetActiveWindow    dd ?                    ; DATA XREF: ___crtMessageBoxA+44↑w
pfnGetLastActivePopup    dd ?                    ; DATA XREF: ___crtMessageBoxA+4B↑w


_XcptActTabSize     dd 78h   
_XcptActTabCount    dd 0Ah 

_XcptActTab     dd 0C0000005h
                dd 0Bh
                dd 0
                dd 0C000001Dh
                dd 4
                dd 0
                dd 0C0000096h
                dd 4
                dd 0
                dd 0C000008Dh
                dd 8
                dd 0
                dd 0C000008Eh
                dd 8
                dd 0
                dd 0C000008Fh
                dd 8
                dd 0
                dd 0C0000090h
                dd 8
                dd 0
                dd 0C0000091h
                dd 8
                dd 0
                dd 0C0000092h
                dd 8
                dd 0
                dd 0C0000093h
                dd 8
                dd 0

__tlsindex      dd 0FFFFFFFFh 

dword_70D584    dd ?                    ; DATA XREF: _signal:loc_5CC20C↑r
dword_70D588    dd ?                    ; DATA XREF: _signal:loc_5CC229↑r
dword_70D58C    dd ?                    ; DATA XREF: _signal:loc_5CC246↑r
dword_70D590    dd ?                    ; DATA XREF: _signal:loc_5CC263↑r

ConsoleCtrlHandler_Installed    dd ?                    ; DATA XREF: _signal:loc_5CC1CD↑r

.code


; =============== S U B R O U T I N E =======================================

_malloc         proc near               ; CODE XREF: sub_402FB8+11C↑p

varSize            = dword ptr  4
                mov     eax, dword_70D4E0
                mov     ecx, dword ptr [esp+varSize]
                push    eax             ; int
                push    ecx             ; varSize
                call    __nh_malloc
                add     esp, 8
                retn
_malloc         endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void *__cdecl realloc(void *Block, size_t varSize)
_realloc        proc near               ; CODE XREF: sub_4E819C+F2↑p

var_8           = dword ptr -8
var_4           = dword ptr -4
lpMem           = dword ptr  4
dwBytes         = dword ptr  8

                sub     esp, 8
                push    ebx
                push    ebp
                push    esi
                mov     esi, [esp+14h+lpMem]
                test    esi, esi
                push    edi
                jnz     short loc_5C1E54
                mov     eax, dword ptr [esp+18h+dwBytes]
                push    eax             ; varSize
                call    _malloc
                add     esp, 4
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C1E54:                             ; CODE XREF: _realloc+D↑j
                mov     edi, [esp+18h+dwBytes]
                test    edi, edi
                jnz     short loc_5C1E6F
                push    esi             ; Block
                call    _free
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C1E6F:                             ; CODE XREF: _realloc+2A↑j
                cmp     edi, 0FFFFFFE0h
                ja      short loc_5C1E90
                test    edi, edi
                jbe     short loc_5C1E84
                add     edi, 0Fh
                and     edi, 0FFFFFFF0h
                mov     [esp+18h+dwBytes], edi
                jmp     short loc_5C1E8C
; ---------------------------------------------------------------------------

loc_5C1E84:                             ; CODE XREF: _realloc+46↑j
                mov     [esp+18h+dwBytes], 10h

loc_5C1E8C:                             ; CODE XREF: _realloc+52↑j
                mov     edi, [esp+18h+dwBytes]

loc_5C1E90:                             ; CODE XREF: _realloc+42↑j
                xor     ebx, ebx
                cmp     edi, 0FFFFFFE0h
                ja      loc_5C1FB0
                push    9
                call    __lock
                add     esp, 4
                lea     ecx, [esp+18h+var_8]
                lea     edx, [esp+18h+var_4]
                push    ecx
                push    edx
                push    esi
                call    ___sbh_find_block
                mov     ebp, eax
                add     esp, 0Ch
                test    ebp, ebp
                jz      loc_5C1F94
                cmp     edi, __sbh_threshold
                jnb     short loc_5C1F35
                mov     eax, dword ptr [esp+18h+var_8]
                mov     ecx, dword ptr [esp+18h+var_4]
                mov     ebx, edi
                shr     ebx, 4
                push    ebx
                push    ebp
                push    eax
                push    ecx
                call    ___sbh_resize_block
                add     esp, 10h
                test    eax, eax
                jz      short loc_5C1EEB
                mov     ebx, esi
                jmp     short loc_5C1F35
; ---------------------------------------------------------------------------

loc_5C1EEB:                             ; CODE XREF: _realloc+B5↑j
                push    ebx
                call    ___sbh_alloc_block
                mov     ebx, eax
                add     esp, 4
                test    ebx, ebx
                jz      short loc_5C1F39
                xor     eax, eax
                mov     al, [ebp+0]
                shl     eax, 4
                cmp     eax, edi
                jb      short loc_5C1F08
                mov     eax, edi

loc_5C1F08:                             ; CODE XREF: _realloc+D4↑j
                mov     ecx, eax
                mov     edi, ebx
                mov     edx, ecx
                push    ebp
                shr     ecx, 2
                rep movsd
                mov     ecx, edx
                and     ecx, 3
                rep movsb
                mov     eax, dword ptr [esp+1Ch+var_8]
                mov     ecx, dword ptr [esp+1Ch+var_4]
                push    eax
                push    ecx
                call    ___sbh_free_block
                mov     edi, [esp+24h+dwBytes]
                mov     esi, [esp+24h+lpMem]
                add     esp, 0Ch

loc_5C1F35:                             ; CODE XREF: _realloc+98↑j
                test    ebx, ebx
                jnz     short loc_5C1F88

loc_5C1F39:                             ; CODE XREF: _realloc+C8↑j
                mov     edx, _crtheap
                push    edi             ; dwBytes
                push    0               ; dwFlags
                push    edx             ; _crtheap
                call    HeapAlloc
                mov     ebx, eax
                test    ebx, ebx
                jz      short loc_5C1F88
                xor     eax, eax
                mov     al, [ebp+0]
                shl     eax, 4
                cmp     eax, edi
                jb      short loc_5C1F5D
                mov     eax, edi

loc_5C1F5D:                             ; CODE XREF: _realloc+129↑j
                mov     ecx, eax
                mov     edi, ebx
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                push    ebp
                and     ecx, 3
                rep movsb
                mov     ecx, dword ptr [esp+1Ch+var_8]
                mov     edx, dword ptr [esp+1Ch+var_4]
                push    ecx
                push    edx
                call    ___sbh_free_block
                mov     edi, [esp+24h+dwBytes]
                mov     esi, [esp+24h+lpMem]
                add     esp, 0Ch

loc_5C1F88:                             ; CODE XREF: _realloc+107↑j
                push    9
                call    __unlock
                add     esp, 4
                jmp     short loc_5C1FB0
; ---------------------------------------------------------------------------

loc_5C1F94:                             ; CODE XREF: _realloc+8C↑j
                push    9
                call    __unlock
                mov     eax, _crtheap
                add     esp, 4
                push    edi             ; dwBytes
                push    esi             ; lpMem
                push    0               ; dwFlags
                push    eax             ; _crtheap
                call    HeapReAlloc
                mov     ebx, eax

loc_5C1FB0:                             ; CODE XREF: _realloc+65↑j
                test    ebx, ebx
                jnz     short loc_5C1FD6
                mov     eax, dword_70D4E0
                test    eax, eax
                jz      short loc_5C1FD6
                push    edi             ; varSize
                call    __callnewh
                add     esp, 4
                test    eax, eax
                jnz     loc_5C1E90
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C1FD6:                             ; CODE XREF: _realloc+182↑j
                pop     edi
                pop     esi
                mov     eax, ebx
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
_realloc        endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void *__cdecl calloc(size_t Count, size_t varSize)
_calloc         proc near               ; CODE XREF: __beginthread+8↑p

Count           = dword ptr  4
varSize            = dword ptr  8

                push    ebx
                mov     ebx, dword ptr [esp+4+varSize]
                imul    ebx, [esp+4+Count]
                push    ebp
                push    esi
                cmp     ebx, 0FFFFFFE0h
                push    edi
                ja      short loc_5C61E3
                test    ebx, ebx
                jbe     short loc_5C61DE
                add     ebx, 0Fh
                and     ebx, 0FFFFFFF0h
                jmp     short loc_5C61E3
; ---------------------------------------------------------------------------

loc_5C61DE:                             ; CODE XREF: _calloc+14↑j
                mov     ebx, 10h

loc_5C61E3:                             ; CODE XREF: _calloc+10↑j
                mov     ebp, ds:HeapAlloc

loc_5C61E9:                             ; CODE XREF: _calloc+9D↓j
                xor     esi, esi
                cmp     ebx, 0FFFFFFE0h
                ja      short loc_5C6245
                cmp     ebx, __sbh_threshold
                ja      short loc_5C6234
                push    9
                call    __lock
                mov     eax, ebx
                add     esp, 4
                shr     eax, 4
                push    eax
                call    ___sbh_alloc_block
                add     esp, 4
                mov     esi, eax
                push    9
                call    __unlock
                add     esp, 4
                test    esi, esi
                jz      short loc_5C6238
                mov     ecx, ebx
                xor     eax, eax
                mov     edx, ecx
                mov     edi, esi
                shr     ecx, 2
                rep stosd
                mov     ecx, edx
                and     ecx, 3
                rep stosb

loc_5C6234:                             ; CODE XREF: _calloc+36↑j
                test    esi, esi
                jnz     short loc_5C6264

loc_5C6238:                             ; CODE XREF: _calloc+5E↑j
                mov     eax, _crtheap
                push    ebx             ; dwBytes
                push    8               ; dwFlags
                push    eax             ; _crtheap
                call    ebp ; HeapAlloc
                mov     esi, eax

loc_5C6245:                             ; CODE XREF: _calloc+2E↑j
                test    esi, esi
                jnz     short loc_5C6264
                mov     eax, dword_70D4E0
                test    eax, eax
                jz      short loc_5C6264
                push    ebx             ; varSize
                call    __callnewh
                add     esp, 4
                test    eax, eax
                jnz     short loc_5C61E9
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C6264:                             ; CODE XREF: _calloc+76↑j
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
_calloc         endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void __cdecl free(void *Block)
_free           proc near               ; CODE XREF: sub_40328E+11↑p

var_4           = dword ptr -4
lpMem           = dword ptr  4

                push    ecx
                push    esi
                mov     esi, [esp+8+lpMem]
                test    esi, esi
                jz      short loc_5BF0E5
                push    9
                call    __lock
                add     esp, 4
                lea     eax, [esp+8+lpMem]
                lea     ecx, [esp+8+var_4]
                push    eax
                push    ecx
                push    esi
                call    ___sbh_find_block
                add     esp, 0Ch
                test    eax, eax
                jz      short loc_5BF0CB
                mov     edx, dword ptr [esp+8+lpMem]
                push    eax
                mov     eax, dword ptr [esp+0Ch+var_4]
                push    edx
                push    eax
                call    ___sbh_free_block
                add     esp, 0Ch
                push    9
                call    __unlock
                add     esp, 4
                pop     esi
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5BF0CB:                             ; CODE XREF: _free+29↑j
                push    9
                call    __unlock
                mov     ecx, _crtheap
                add     esp, 4
                push    esi             ; lpMem
                push    0               ; dwFlags
                push    ecx             ; _crtheap
                call    HeapFree

loc_5BF0E5:                             ; CODE XREF: _free+8↑j
                pop     esi
                pop     ecx
                retn
_free           endp

; ---------------------------------------------------------------------------


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _nh_malloc(size_t varSize, int)
__nh_malloc     proc near               ; CODE XREF: _malloc+B↑p

varSize            = dword ptr  4
arg_4           = dword ptr  8

                push    esi
                mov     esi, [esp+4+varSize]
                cmp     esi, 0FFFFFFE0h
                push    edi
                ja      short loc_5BF00F
                test    esi, esi
                jnz     short loc_5BEFE4
                mov     esi, 1

loc_5BEFE4:                             ; CODE XREF: __nh_malloc+D↑j
                mov     edi, [esp+8+arg_4]

loc_5BEFE8:                             ; CODE XREF: __nh_malloc+3D↓j
                cmp     esi, 0FFFFFFE0h
                ja      short loc_5BEFF8
                push    esi
                call    __heap_alloc
                add     esp, 4
                jmp     short loc_5BEFFA
; ---------------------------------------------------------------------------

loc_5BEFF8:                             ; CODE XREF: __nh_malloc+1B↑j
                xor     eax, eax

loc_5BEFFA:                             ; CODE XREF: __nh_malloc+26↑j
                test    eax, eax
                jnz     short loc_5BF011
                test    edi, edi
                jz      short loc_5BF011
                push    esi             ; varSize
                call    __callnewh
                add     esp, 4
                test    eax, eax
                jnz     short loc_5BEFE8

loc_5BF00F:                             ; CODE XREF: __nh_malloc+9↑j
                xor     eax, eax

loc_5BF011:                             ; CODE XREF: __nh_malloc+2C↑j
                pop     edi
                pop     esi
                retn
__nh_malloc     endp




__lock          proc near               ; CODE XREF: __heap_alloc+17↑p

arg_0           = dword ptr  8

                push    ebp
                mov     ebp, esp
                push    edi
                mov     edi, [ebp+arg_0]
                mov     eax, _locktable[edi*4]
                test    eax, eax
                jnz     short loc_5C7815
                push    esi
                push    18h             ; varSize
                call    _malloc
                mov     esi, eax
                add     esp, 4
                test    esi, esi
                jnz     short loc_5C77DD
                push    11h
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5C77DD:                             ; CODE XREF: __lock+21↑j
                push    11h
                call    __lock
                mov     eax, _locktable[edi*4]
                add     esp, 4
                test    eax, eax
                push    esi             ; Block
                jnz     short loc_5C7802
                call    InitializeCriticalSection
                mov     _locktable[edi*4], esi
                jmp     short loc_5C780A
; ---------------------------------------------------------------------------

loc_5C7802:                             ; CODE XREF: __lock+41↑j
                call    _free
                add     esp, 4

loc_5C780A:                             ; CODE XREF: __lock+50↑j
                push    11h
                call    __unlock
                add     esp, 4
                pop     esi

loc_5C7815:                             ; CODE XREF: __lock+10↑j
                mov     eax, _locktable[edi*4]
                push    eax             ; lpCriticalSection
                call    EnterCriticalSection
                pop     edi
                pop     ebp
                retn
__lock          endp

; ---------------------------------------------------------------------------


; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

__unlock        proc near               ; CODE XREF: __heap_alloc+31↑p

arg_0           = dword ptr  8

                push    ebp
                mov     ebp, esp
                mov     eax, dword ptr [ebp+arg_0]
                mov     ecx, _locktable[eax*4]
                push    ecx             ; lpCriticalSection
                call    LeaveCriticalSection
                pop     ebp
                retn
__unlock        endp

; ---------------------------------------------------------------------------



; =============== S U B R O U T I N E =======================================

; Attributes: library function

___sbh_find_block proc near             ; CODE XREF: _free+1F↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                mov     ecx, dword ptr [esp+arg_0]
                mov     eax, offset __small_block_heap

loc_5C7C29:                             ; CODE XREF: ___sbh_find_block+1C↓j
                cmp     ecx, [eax+10h]
                jbe     short loc_5C7C33
                cmp     ecx, [eax+14h]
                jb      short loc_5C7C3E

loc_5C7C33:                             ; CODE XREF: ___sbh_find_block+C↑j
                mov     eax, dword ptr [eax]
                cmp     eax, offset __small_block_heap
                jz      short loc_5C7C76
                jmp     short loc_5C7C29
; ---------------------------------------------------------------------------

loc_5C7C3E:                             ; CODE XREF: ___sbh_find_block+11↑j
                test    cl, 0Fh
                jnz     short loc_5C7C76
                mov     edx, ecx
                and     edx, 0FFFh
                cmp     edx, 100h
                jb      short loc_5C7C76
                mov     edx, dword ptr [esp+arg_4]
                mov     [edx], eax
                mov     edx, dword ptr [esp+arg_8]
                mov     eax, ecx
                and     eax, 0FFFFF000h
                sub     ecx, eax
                mov     [edx], eax
                sub     ecx, 100h
                sar     ecx, 4
                lea     eax, [ecx+eax+8]
                retn
; ---------------------------------------------------------------------------

loc_5C7C76:                             ; CODE XREF: ___sbh_find_block+1A↑j
                xor     eax, eax
                retn
___sbh_find_block endp

; ---------------------------------------------------------------------------

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___sbh_free_block proc near             ; CODE XREF: _free+36↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                mov     eax, dword ptr [esp+arg_0]
                mov     ecx, dword ptr [esp+arg_4]
                push    esi
                xor     edx, edx
                sub     ecx, [eax+10h]
                sar     ecx, 0Ch
                mov     esi, [eax+ecx*8+18h]
                lea     eax, [eax+ecx*8+18h]
                mov     ecx, dword ptr [esp+4+arg_8]
                mov     dl, [ecx]
                add     esi, edx
                mov     [eax], esi
                mov     byte ptr [ecx], 0
                mov     ecx, dword ptr [eax]
                mov     dword ptr [eax+4], 0F1h
                cmp     ecx, 0F0h
                jnz     short loc_5C7CD1
                mov     eax, __sbh_decommitable_pages
                inc     eax
                cmp     eax, 20h ; ' '
                mov     __sbh_decommitable_pages, eax
                jnz     short loc_5C7CD1
                push    10h
                call    ___sbh_decommit_pages
                add     esp, 4

loc_5C7CD1:                             ; CODE XREF: ___sbh_free_block+35↑j
                pop     esi
                retn
___sbh_free_block endp

; ---------------------------------------------------------------------------



; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _set_sbh_threshold(size_t NewValue)
__set_sbh_threshold proc near

NewValue        = dword ptr  4

                mov     eax, dword ptr [esp+NewValue]
                add     eax, 0Fh
                and     al, 0F0h
                cmp     eax, 780h
                ja      short loc_5C797B
                mov     __sbh_threshold, eax
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5C797B:                             ; CODE XREF: __set_sbh_threshold+E↑j
                xor     eax, eax
                retn
__set_sbh_threshold endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___sbh_new_region proc near             ; CODE XREF: __heap_init:loc_5C7699↑p
                mov     eax, __small_block_heap+10h
                push    ebp
                push    esi
                cmp     eax, 0FFFFFFFFh
                push    edi
                jnz     short loc_5C7994
                mov     ebp, offset __small_block_heap
                jmp     short loc_5C79B1
; ---------------------------------------------------------------------------

loc_5C7994:                             ; CODE XREF: ___sbh_new_region+B↑j
                mov     eax, _crtheap
                push    2020h           ; dwBytes
                push    0               ; dwFlags
                push    eax             ; _crtheap
                call    HeapAlloc
                mov     ebp, eax
                test    ebp, ebp
                jz      loc_5C7ADC

loc_5C79B1:                             ; CODE XREF: ___sbh_new_region+12↑j
                mov     edi, ds:VirtualAlloc
                push    4               ; flProtect
                push    2000h           ; flAllocationType
                push    400000h         ; dwSize
                push    0               ; lpAddress
                call    edi ; VirtualAlloc
                mov     esi, eax
                test    esi, esi
                jz      loc_5C7AC5
                push    4               ; flProtect
                push    1000h           ; flAllocationType
                push    10000h          ; dwSize
                push    esi             ; lpAddress
                call    edi ; VirtualAlloc
                test    eax, eax
                jz      loc_5C7AB7
                cmp     ebp, offset __small_block_heap
                jnz     short loc_5C7A18
                mov     eax, __small_block_heap
                test    eax, eax
                jnz     short loc_5C7A03
                mov     __small_block_heap, offset __small_block_heap

loc_5C7A03:                             ; CODE XREF: ___sbh_new_region+77↑j
                mov     eax, [__small_block_heap+4h]
                test    eax, eax
                jnz     short loc_5C7A33
                mov     [__small_block_heap+4h], offset __small_block_heap
                jmp     short loc_5C7A33
; ---------------------------------------------------------------------------

loc_5C7A18:                             ; CODE XREF: ___sbh_new_region+6E↑j
                mov     dword ptr [ebp+0], offset __small_block_heap
                mov     ecx, [__small_block_heap+4h]
                mov     [ebp+4], ecx
                mov     [__small_block_heap+4h], ebp
                mov     edx, dword ptr [ebp+4]
                mov     [edx], ebp

loc_5C7A33:                             ; CODE XREF: ___sbh_new_region+8A↑j
                lea     eax, [esi+400000h]
                lea     ecx, [ebp+18h]
                lea     edx, [ebp+98h]
                mov     [ebp+14h], eax
                mov     [ebp+10h], esi
                mov     [ebp+8], ecx
                mov     [ebp+0Ch], edx
                xor     eax, eax
                mov     edi, 0F1h

loc_5C7A55:                             ; CODE XREF: ___sbh_new_region+F0↓j
                xor     edx, edx
                cmp     eax, 10h
                setnl   dl
                dec     edx
                add     ecx, 8
                and     edx, edi
                dec     edx
                inc     eax
                mov     [ecx-8], edx
                mov     [ecx-4], edi
                cmp     eax, 400h
                jl      short loc_5C7A55
                mov     ecx, 4000h
                xor     eax, eax
                mov     edi, esi
                rep stosd
                mov     eax, dword ptr [ebp+10h]
                add     eax, 10000h
                cmp     esi, eax
                jnb     short loc_5C7AB1
                mov     ecx, 0F0h
                mov     al, 0FFh

loc_5C7A90:                             ; CODE XREF: ___sbh_new_region+12F↓j
                lea     edx, [esi+8]
                mov     [esi+4], ecx
                mov     [esi], edx
                mov     [esi+0F8h], al
                mov     edx, dword ptr [ebp+10h]
                add     esi, 1000h
                add     edx, 10000h
                cmp     esi, edx
                jb      short loc_5C7A90

loc_5C7AB1:                             ; CODE XREF: ___sbh_new_region+107↑j
                mov     eax, ebp
                pop     edi
                pop     esi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_5C7AB7:                             ; CODE XREF: ___sbh_new_region+62↑j
                push    8000h           ; dwFreeType
                push    0               ; dwSize
                push    esi             ; lpAddress
                call    VirtualFree

loc_5C7AC5:                             ; CODE XREF: ___sbh_new_region+4B↑j
                cmp     ebp, offset __small_block_heap
                jz      short loc_5C7ADC
                mov     eax, _crtheap
                push    ebp             ; lpMem
                push    0               ; dwFlags
                push    eax             ; _crtheap
                call    HeapFree

loc_5C7ADC:                             ; CODE XREF: ___sbh_new_region+2B↑j
                pop     edi
                pop     esi
                xor     eax, eax
                pop     ebp
                retn
___sbh_new_region endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __sbh_release_region(LPVOID lpMem)
___sbh_release_region proc near         ; CODE XREF: ___sbh_decommit_pages+AC↓p

lpMem           = dword ptr  4

                push    esi
                mov     esi, [esp+4+lpMem]
                push    8000h           ; dwFreeType
                push    0               ; dwSize
                mov     eax, dword ptr [esi+10h]
                push    eax             ; lpAddress
                call    VirtualFree
                cmp     __sbh_p_starting_region, esi
                jnz     short loc_5C7B17
                mov     ecx, dword ptr [esi+4]
                mov     __sbh_p_starting_region, ecx

loc_5C7B17:                             ; CODE XREF: ___sbh_release_region+1C↑j
                cmp     esi, offset __small_block_heap
                jz      short loc_5C7B3F
                mov     edx, dword ptr [esi+4]
                mov     eax, dword ptr [esi]
                push    esi             ; lpMem
                push    0               ; dwFlags
                mov     [edx], eax
                mov     ecx, dword ptr [esi]
                mov     edx, dword ptr [esi+4]
                mov     [ecx+4], edx
                mov     eax, _crtheap
                push    eax             ; _crtheap
                call    HeapFree
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C7B3F:                             ; CODE XREF: ___sbh_release_region+2D↑j
                mov     __small_block_heap+10h, 0FFFFFFFFh
                pop     esi
                retn
___sbh_release_region endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___sbh_decommit_pages proc near         ; CODE XREF: ___sbh_free_block+49↓p

arg_0           = dword ptr  4

                push    ebx
                push    ebp
                push    esi
                push    edi
                mov     edi, [__small_block_heap+4h]

loc_5C7B5A:                             ; CODE XREF: ___sbh_decommit_pages+C2↓j
                cmp     dword ptr [edi+10h], 0FFFFFFFFh
                jz      loc_5C7C04
                xor     ebp, ebp
                lea     esi, [edi+2010h]
                mov     ebx, 3FF000h

loc_5C7B71:                             ; CODE XREF: ___sbh_decommit_pages+7B↓j
                cmp     dword ptr [esi], 0F0h
                jnz     short loc_5C7BC0
                mov     eax, dword ptr [edi+10h]
                push    4000h           ; dwFreeType
                add     eax, ebx
                push    1000h           ; dwSize
                push    eax             ; lpAddress
                call    VirtualFree
                test    eax, eax
                jz      short loc_5C7BC0
                mov     dword ptr [esi], 0FFFFFFFFh
                mov     edx, __sbh_decommitable_pages
                dec     edx
                mov     __sbh_decommitable_pages, edx
                mov     eax, dword ptr [edi+0Ch]
                test    eax, eax
                jz      short loc_5C7BB1
                cmp     eax, esi
                jbe     short loc_5C7BB4

loc_5C7BB1:                             ; CODE XREF: ___sbh_decommit_pages+5B↑j
                mov     [edi+0Ch], esi

loc_5C7BB4:                             ; CODE XREF: ___sbh_decommit_pages+5F↑j
                mov     eax, dword ptr [esp+10h+arg_0]
                inc     ebp
                dec     eax
                mov     [esp+10h+arg_0], eax
                jz      short loc_5C7BCD

loc_5C7BC0:                             ; CODE XREF: ___sbh_decommit_pages+27↑j
                sub     ebx, 1000h
                sub     esi, 8
                test    ebx, ebx
                jge     short loc_5C7B71

loc_5C7BCD:                             ; CODE XREF: ___sbh_decommit_pages+6E↑j
                mov     edx, edi
                mov     edi, [edi+4]
                test    ebp, ebp
                jz      short loc_5C7C04
                cmp     dword ptr [edx+18h], 0FFFFFFFFh
                jnz     short loc_5C7C04
                mov     eax, 1
                lea     ecx, [edx+20h]

loc_5C7BE4:                             ; CODE XREF: ___sbh_decommit_pages+A2↓j
                cmp     dword ptr [ecx], 0FFFFFFFFh
                jnz     short loc_5C7BF4
                inc     eax
                add     ecx, 8
                cmp     eax, 400h
                jl      short loc_5C7BE4

loc_5C7BF4:                             ; CODE XREF: ___sbh_decommit_pages+97↑j
                cmp     eax, 400h
                jnz     short loc_5C7C04
                push    edx             ; lpMem
                call    ___sbh_release_region
                add     esp, 4

loc_5C7C04:                             ; CODE XREF: ___sbh_decommit_pages+E↑j
                cmp     edi, [__small_block_heap+4h]
                jz      short loc_5C7C18
                mov     eax, dword ptr [esp+10h+arg_0]
                test    eax, eax
                jg      loc_5C7B5A

loc_5C7C18:                             ; CODE XREF: ___sbh_decommit_pages+BA↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
___sbh_decommit_pages endp

; ---------------------------------------------------------------------------
                align 10h



; =============== S U B R O U T I N E =======================================

; Attributes: library function

___sbh_alloc_block proc near            ; CODE XREF: __heap_alloc+25↑p

var_4           = dword ptr -4
arg_0           = dword ptr  4

                push    ecx
                mov     ecx, __sbh_p_starting_region
                push    ebx
                mov     ebx, dword ptr [esp+8+arg_0]
                push    ebp
                push    esi
                push    edi
                mov     [esp+14h+var_4], ecx

loc_5C7CF3:                             ; CODE XREF: ___sbh_alloc_block+B3↓j
                mov     eax, dword ptr [ecx+10h]
                cmp     eax, 0FFFFFFFFh
                jz      loc_5C7D84
                mov     edi, [ecx+8]
                lea     ebp, [ecx+2018h]
                mov     esi, edi
                sub     esi, ecx
                sub     esi, 18h
                sar     esi, 3
                shl     esi, 0Ch
                add     esi, eax
                cmp     edi, ebp
                jnb     short loc_5C7D49

loc_5C7D1B:                             ; CODE XREF: ___sbh_alloc_block+67↓j
                mov     eax, dword ptr [edi]
                cmp     eax, ebx
                jl      short loc_5C7D3C
                cmp     [edi+4], ebx
                jbe     short loc_5C7D3C
                push    ebx
                push    eax
                push    esi
                call    ___sbh_alloc_block_from_page
                add     esp, 0Ch
                test    eax, eax
                jnz     short loc_5C7D98
                mov     ecx, dword ptr [esp+14h+var_4]
                mov     [edi+4], ebx

loc_5C7D3C:                             ; CODE XREF: ___sbh_alloc_block+3F↑j
                add     edi, 8
                add     esi, 1000h
                cmp     edi, ebp
                jb      short loc_5C7D1B

loc_5C7D49:                             ; CODE XREF: ___sbh_alloc_block+39↑j
                mov     ebp, [ecx+8]
                mov     edi, [ecx+10h]
                lea     esi, [ecx+18h]
                cmp     esi, ebp
                jnb     short loc_5C7D84

loc_5C7D56:                             ; CODE XREF: ___sbh_alloc_block+A2↓j
                mov     eax, dword ptr [esi]
                cmp     eax, ebx
                jl      short loc_5C7D77
                cmp     [esi+4], ebx
                jbe     short loc_5C7D77
                push    ebx
                push    eax
                push    edi
                call    ___sbh_alloc_block_from_page
                add     esp, 0Ch
                test    eax, eax
                jnz     short loc_5C7DB1
                mov     ecx, dword ptr [esp+14h+var_4]
                mov     [esi+4], ebx

loc_5C7D77:                             ; CODE XREF: ___sbh_alloc_block+7A↑j
                add     esi, 8
                add     edi, 1000h
                cmp     esi, ebp
                jb      short loc_5C7D56

loc_5C7D84:                             ; CODE XREF: ___sbh_alloc_block+19↑j
                mov     ecx, dword ptr [ecx]
                mov     eax, __sbh_p_starting_region
                cmp     ecx, eax
                mov     [esp+14h+var_4], ecx
                jz      short loc_5C7DCA
                jmp     loc_5C7CF3
; ---------------------------------------------------------------------------

loc_5C7D98:                             ; CODE XREF: ___sbh_alloc_block+53↑j
                mov     ecx, dword ptr [esp+14h+var_4]
                mov     __sbh_p_starting_region, ecx
                mov     edx, dword ptr [edi]
                sub     edx, ebx
                mov     [edi], edx
                mov     [ecx+8], edi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C7DB1:                             ; CODE XREF: ___sbh_alloc_block+8E↑j
                mov     ecx, dword ptr [esp+14h+var_4]
                mov     __sbh_p_starting_region, ecx
                mov     edx, dword ptr [esi]
                sub     edx, ebx
                mov     [esi], edx
                mov     [ecx+8], esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C7DCA:                             ; CODE XREF: ___sbh_alloc_block+B1↑j
                mov     ebp, offset __small_block_heap
                or      ecx, 0FFFFFFFFh

loc_5C7DD2:                             ; CODE XREF: ___sbh_alloc_block+10D↓j
                cmp     [ebp+10h], ecx
                jz      short loc_5C7DDE
                mov     eax, dword ptr [ebp+0Ch]
                test    eax, eax
                jnz     short loc_5C7DEF

loc_5C7DDE:                             ; CODE XREF: ___sbh_alloc_block+F5↑j
                mov     ebp, [ebp+0]
                cmp     ebp, offset __small_block_heap
                jz      loc_5C7ECD
                jmp     short loc_5C7DD2
; ---------------------------------------------------------------------------

loc_5C7DEF:                             ; CODE XREF: ___sbh_alloc_block+FC↑j
                mov     eax, dword ptr [ebp+0Ch]
                mov     esi, [ebp+10h]
                mov     edi, eax
                mov     [esp+14h+arg_0], eax
                sub     edi, ebp
                mov     edx, dword ptr [eax]
                sub     edi, 18h
                sar     edi, 3
                shl     edi, 0Ch
                add     edi, esi
                xor     esi, esi
                cmp     edx, ecx
                jnz     short loc_5C7E20

loc_5C7E10:                             ; CODE XREF: ___sbh_alloc_block+13E↓j
                cmp     esi, 10h
                jge     short loc_5C7E20
                mov     edx, dword ptr [eax+8]
                add     eax, 8
                inc     esi
                cmp     edx, ecx
                jz      short loc_5C7E10

loc_5C7E20:                             ; CODE XREF: ___sbh_alloc_block+12E↑j
                mov     eax, esi
                push    4               ; flProtect
                shl     eax, 0Ch
                push    1000h           ; flAllocationType
                push    eax             ; dwSize
                push    edi             ; lpAddress
                mov     [esp+24h+var_4], eax
                call    VirtualAlloc
                cmp     eax, edi
                jnz     loc_5C7F0B
                mov     edx, dword ptr [esp+14h+arg_0]
                mov     eax, dword ptr [esp+14h+var_4]
                xor     ecx, ecx
                test    esi, esi
                mov     ecx, edx
                jle     short loc_5C7E82
                lea     eax, [edi+4]

loc_5C7E53:                             ; CODE XREF: ___sbh_alloc_block+19C↓j
                lea     edx, [eax+4]
                mov     dword ptr [eax], 0F0h
                mov     [eax-4], edx
                mov     byte ptr [eax+0F4h], 0FFh
                mov     dword ptr [ecx], 0F0h
                mov     dword ptr [ecx+4], 0F1h
                add     eax, 1000h
                add     ecx, 8
                dec     esi
                jnz     short loc_5C7E53
                mov     edx, dword ptr [esp+14h+arg_0]

loc_5C7E82:                             ; CODE XREF: ___sbh_alloc_block+16E↑j
                lea     eax, [ebp+2018h]
                mov     __sbh_p_starting_region, ebp
                cmp     ecx, eax
                jnb     short loc_5C7EA0

loc_5C7E92:                             ; CODE XREF: ___sbh_alloc_block+1BC↓j
                cmp     dword ptr [ecx], 0FFFFFFFFh
                jz      short loc_5C7E9E
                add     ecx, 8
                cmp     ecx, eax
                jb      short loc_5C7E92

loc_5C7E9E:                             ; CODE XREF: ___sbh_alloc_block+1B5↑j
                cmp     ecx, eax

loc_5C7EA0:                             ; CODE XREF: ___sbh_alloc_block+1B0↑j
                sbb     eax, eax
                and     eax, ecx
                mov     [ebp+0Ch], eax
                mov     [edi+8], bl
                mov     [ebp+8], edx
                mov     ecx, dword ptr [edx]
                sub     ecx, ebx
                mov     [edx], ecx
                mov     eax, dword ptr [edi+4]
                sub     eax, ebx
                lea     ecx, [edi+ebx+8]
                mov     [edi+4], eax
                mov     [edi], ecx
                lea     eax, [edi+100h]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C7ECD:                             ; CODE XREF: ___sbh_alloc_block+107↑j
                call    ___sbh_new_region
                test    eax, eax
                jz      short loc_5C7F0B
                mov     ecx, dword ptr [eax+10h]
                mov     [ecx+8], bl
                lea     edx, [ecx+ebx+8]
                mov     __sbh_p_starting_region, eax
                mov     [ecx], edx
                mov     edx, 0F0h
                sub     edx, ebx
                and     ebx, 0FFh
                mov     [ecx+4], edx
                mov     edx, dword ptr [eax+18h]
                sub     edx, ebx
                mov     [eax+18h], edx
                lea     eax, [ecx+100h]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C7F0B:                             ; CODE XREF: ___sbh_alloc_block+15A↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                pop     ecx
                retn
___sbh_alloc_block endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___sbh_alloc_block_from_page proc near  ; CODE XREF: ___sbh_alloc_block+49↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                mov     edx, dword ptr [esp+arg_8]
                push    ebx
                push    ebp
                push    esi
                push    edi
                mov     edi, [esp+10h+arg_0]
                mov     eax, dword ptr [edi+4]
                mov     ecx, dword ptr [edi]
                cmp     eax, edx
                mov     [esp+10h+arg_0], ecx
                mov     esi, ecx
                lea     ebx, [edi+0F8h]
                jb      short loc_5C7F7B
                lea     eax, [ecx+edx]
                mov     [ecx], dl
                cmp     eax, ebx
                jnb     short loc_5C7F5A
                mov     esi, [edi]
                mov     eax, dword ptr [edi+4]
                add     esi, edx
                sub     eax, edx
                mov     [edi], esi
                mov     [edi+4], eax
                jmp     short loc_5C7F66
; ---------------------------------------------------------------------------

loc_5C7F5A:                             ; CODE XREF: ___sbh_alloc_block_from_page+28↑j
                lea     edx, [edi+8]
                mov     dword ptr [edi+4], 0
                mov     [edi], edx

loc_5C7F66:                             ; CODE XREF: ___sbh_alloc_block_from_page+38↑j
                lea     eax, [edi+edi*2]
                lea     eax, [eax+eax*4]
                mov     edx, eax
                lea     eax, [ecx+8]
                shl     eax, 4
                sub     eax, edx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C7F7B:                             ; CODE XREF: ___sbh_alloc_block_from_page+1F↑j
                add     eax, ecx
                cmp     byte ptr [eax], 0
                jz      short loc_5C7F84
                mov     esi, eax

loc_5C7F84:                             ; CODE XREF: ___sbh_alloc_block_from_page+60↑j
                lea     eax, [esi+edx]
                cmp     eax, ebx
                mov     ebx, dword ptr [esp+10h+arg_4]
                jnb     short loc_5C8004

loc_5C7F8F:                             ; CODE XREF: ___sbh_alloc_block_from_page+C3↓j
                mov     al, [esi]
                test    al, al
                jnz     short loc_5C7FD1
                cmp     byte ptr [esi+1], 0
                lea     eax, [esi+1]
                mov     ecx, 1
                jnz     short loc_5C7FAA

loc_5C7FA3:                             ; CODE XREF: ___sbh_alloc_block_from_page+88↓j
                inc     eax
                inc     ecx
                cmp     byte ptr [eax], 0
                jz      short loc_5C7FA3

loc_5C7FAA:                             ; CODE XREF: ___sbh_alloc_block_from_page+81↑j
                cmp     ecx, edx
                jnb     short loc_5C7FE7
                mov     ebp, [esp+10h+arg_0]
                cmp     esi, ebp
                jnz     short loc_5C7FBF
                mov     [edi+4], ecx
                mov     esi, eax
                mov     ecx, ebp
                jmp     short loc_5C7FD8
; ---------------------------------------------------------------------------

loc_5C7FBF:                             ; CODE XREF: ___sbh_alloc_block_from_page+94↑j
                sub     ebx, ecx
                cmp     ebx, edx
                jb      loc_5C808B
                mov     ecx, dword ptr [esp+10h+arg_0]
                mov     esi, eax
                jmp     short loc_5C7FD8
; ---------------------------------------------------------------------------

loc_5C7FD1:                             ; CODE XREF: ___sbh_alloc_block_from_page+73↑j
                and     eax, 0FFh
                add     esi, eax

loc_5C7FD8:                             ; CODE XREF: ___sbh_alloc_block_from_page+9D↑j
                lea     ebp, [esi+edx]
                lea     eax, [edi+0F8h]
                cmp     ebp, eax
                jb      short loc_5C7F8F
                jmp     short loc_5C8004
; ---------------------------------------------------------------------------

loc_5C7FE7:                             ; CODE XREF: ___sbh_alloc_block_from_page+8C↑j
                lea     eax, [esi+edx]
                lea     ebx, [edi+0F8h]
                cmp     eax, ebx
                jnb     short loc_5C7FFD
                sub     ecx, edx
                mov     [edi], eax
                mov     [edi+4], ecx
                jmp     short loc_5C8076
; ---------------------------------------------------------------------------

loc_5C7FFD:                             ; CODE XREF: ___sbh_alloc_block_from_page+D2↑j
                lea     ecx, [edi+8]
                mov     [edi], ecx
                jmp     short loc_5C806F
; ---------------------------------------------------------------------------

loc_5C8004:                             ; CODE XREF: ___sbh_alloc_block_from_page+6D↑j
                lea     ebp, [edi+8]
                mov     esi, ebp
                cmp     esi, ecx
                jnb     short loc_5C808B

loc_5C800D:                             ; CODE XREF: ___sbh_alloc_block_from_page+12E↓j
                lea     ecx, [esi+edx]
                lea     eax, [edi+0F8h]
                cmp     ecx, eax
                jnb     short loc_5C808B
                mov     al, [esi]
                test    al, al
                jnz     short loc_5C8043
                cmp     byte ptr [esi+1], 0
                lea     eax, [esi+1]
                mov     ecx, 1
                jnz     short loc_5C8035

loc_5C802E:                             ; CODE XREF: ___sbh_alloc_block_from_page+113↓j
                inc     eax
                inc     ecx
                cmp     byte ptr [eax], 0
                jz      short loc_5C802E

loc_5C8035:                             ; CODE XREF: ___sbh_alloc_block_from_page+10C↑j
                cmp     ecx, edx
                jnb     short loc_5C8057
                sub     ebx, ecx
                cmp     ebx, edx
                jb      short loc_5C808B
                mov     esi, eax
                jmp     short loc_5C804A
; ---------------------------------------------------------------------------

loc_5C8043:                             ; CODE XREF: ___sbh_alloc_block_from_page+FE↑j
                and     eax, 0FFh
                add     esi, eax

loc_5C804A:                             ; CODE XREF: ___sbh_alloc_block_from_page+121↑j
                cmp     esi, [esp+10h+arg_0]
                jb      short loc_5C800D
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C8057:                             ; CODE XREF: ___sbh_alloc_block_from_page+117↑j
                lea     eax, [esi+edx]
                lea     ebx, [edi+0F8h]
                cmp     eax, ebx
                jnb     short loc_5C806D
                sub     ecx, edx
                mov     [edi], eax
                mov     [edi+4], ecx
                jmp     short loc_5C8076
; ---------------------------------------------------------------------------

loc_5C806D:                             ; CODE XREF: ___sbh_alloc_block_from_page+142↑j
                mov     [edi], ebp

loc_5C806F:                             ; CODE XREF: ___sbh_alloc_block_from_page+E2↑j
                mov     dword ptr [edi+4], 0

loc_5C8076:                             ; CODE XREF: ___sbh_alloc_block_from_page+DB↑j
                lea     eax, [edi+edi*2]
                mov     [esi], dl
                lea     edx, [eax+eax*4]
                lea     eax, [esi+8]
                shl     eax, 4
                sub     eax, edx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C808B:                             ; CODE XREF: ___sbh_alloc_block_from_page+A3↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                retn
___sbh_alloc_block_from_page endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___sbh_resize_block proc near           ; CODE XREF: _realloc+AB↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                mov     ecx, dword ptr [esp+arg_0]
                push    ebx
                push    ebp
                mov     ebp, [esp+8+arg_4]
                push    esi
                push    edi
                mov     edi, [ecx+10h]
                mov     edx, ebp
                sub     edx, edi
                mov     edi, [esp+10h+arg_8]
                sar     edx, 0Ch
                mov     ebx, dword ptr [esp+10h+arg_C]
                xor     eax, eax
                lea     ecx, [ecx+edx*8+18h]
                xor     edx, edx
                mov     dl, [edi]
                mov     [esp+10h+arg_4], ecx
                mov     esi, edx
                cmp     esi, ebx
                jbe     short loc_5C80ED
                mov     [edi], bl
                mov     eax, dword ptr [ecx]
                sub     esi, ebx
                mov     dword ptr [ecx+4], 0F1h
                add     eax, esi
                mov     [ecx], eax
                mov     eax, 1
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C80ED:                             ; CODE XREF: ___sbh_resize_block+30↑j
                jnb     short loc_5C815F
                lea     ecx, [ebx+edi]
                lea     edx, [ebp+0F8h]
                cmp     ecx, edx
                ja      short loc_5C815F
                lea     edx, [esi+edi]
                cmp     edx, ecx
                jnb     short loc_5C810F

loc_5C8103:                             ; CODE XREF: ___sbh_resize_block+6B↓j
                cmp     byte ptr [edx], 0
                jnz     short loc_5C810D
                inc     edx
                cmp     edx, ecx
                jb      short loc_5C8103

loc_5C810D:                             ; CODE XREF: ___sbh_resize_block+66↑j
                cmp     edx, ecx

loc_5C810F:                             ; CODE XREF: ___sbh_resize_block+61↑j
                jnz     short loc_5C815F
                mov     [edi], bl
                mov     eax, dword ptr [ebp+0]
                cmp     edi, eax
                ja      short loc_5C814E
                cmp     ecx, eax
                jbe     short loc_5C814E
                lea     eax, [ebp+0F8h]
                cmp     ecx, eax
                jnb     short loc_5C8141
                mov     [ebp+0], ecx
                mov     dl, [ecx]
                xor     eax, eax
                test    dl, dl
                jnz     short loc_5C813C

loc_5C8133:                             ; CODE XREF: ___sbh_resize_block+9A↓j
                mov     dl, [eax+ecx+1]
                inc     eax
                test    dl, dl
                jz      short loc_5C8133

loc_5C813C:                             ; CODE XREF: ___sbh_resize_block+91↑j
                mov     [ebp+4], eax
                jmp     short loc_5C814E
; ---------------------------------------------------------------------------

loc_5C8141:                             ; CODE XREF: ___sbh_resize_block+86↑j
                lea     eax, [ebp+8]
                mov     dword ptr [ebp+4], 0
                mov     [ebp+0], eax

loc_5C814E:                             ; CODE XREF: ___sbh_resize_block+78↑j
                mov     eax, dword ptr [esp+10h+arg_4]
                sub     esi, ebx
                mov     ecx, dword ptr [eax]
                add     ecx, esi
                mov     [eax], ecx
                mov     eax, 1

loc_5C815F:                             ; CODE XREF: ___sbh_resize_block:loc_5C80ED↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
___sbh_resize_block endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___sbh_heap_check proc near

var_1C          = dword ptr -1Ch
var_18          = dword ptr -18h
var_14          = dword ptr -14h
var_10          = dword ptr -10h
var_C           = dword ptr -0Ch
var_8           = dword ptr -8
var_4           = dword ptr -4

                sub     esp, 1Ch
                push    ebx
                push    ebp
                push    esi
                push    edi
                xor     edi, edi
                mov     edx, offset __small_block_heap
                mov     [esp+2Ch+var_C], edi
                mov     [esp+2Ch+var_10], edx

loc_5C8186:                             ; CODE XREF: ___sbh_heap_check+14D↓j
                cmp     __sbh_p_starting_region, edx
                jnz     short loc_5C8192
                inc     [esp+2Ch+var_C]

loc_5C8192:                             ; CODE XREF: ___sbh_heap_check+1C↑j
                mov     ecx, dword ptr [edx+10h]
                cmp     ecx, 0FFFFFFFFh
                jz      loc_5C82AF
                mov     ebx, ecx
                lea     eax, [edx+18h]
                mov     [esp+2Ch+var_8], edi
                mov     [esp+2Ch+var_1C], edi
                lea     ebp, [ebx+8]
                mov     [esp+2Ch+var_4], eax

loc_5C81B2:                             ; CODE XREF: ___sbh_heap_check+139↓j
                cmp     dword ptr [eax], 0FFFFFFFFh
                jnz     short loc_5C81CF
                cmp     [esp+2Ch+var_1C], edi
                jnz     short loc_5C81C6
                cmp     [edx+0Ch], eax
                jnz     loc_5C82C2

loc_5C81C6:                             ; CODE XREF: ___sbh_heap_check+4B↑j
                inc     [esp+2Ch+var_1C]
                jmp     loc_5C8287
; ---------------------------------------------------------------------------

loc_5C81CF:                             ; CODE XREF: ___sbh_heap_check+45↑j
                mov     edx, dword ptr [ebx]
                lea     ecx, [ebp+0F0h]
                cmp     edx, ecx
                jnb     loc_5C82CD
                cmp     byte ptr [ecx], 0FFh
                jnz     loc_5C82DA
                xor     edx, edx
                xor     ecx, ecx
                mov     [esp+2Ch+var_18], ecx
                mov     [esp+2Ch+var_14], edi

loc_5C81F4:                             ; CODE XREF: ___sbh_heap_check+F9↓j
                lea     esi, [edx+ebp]
                cmp     esi, [ebx]
                jnz     short loc_5C8200
                inc     ecx
                mov     [esp+2Ch+var_18], ecx

loc_5C8200:                             ; CODE XREF: ___sbh_heap_check+89↑j
                cmp     byte ptr [esi], 0
                jnz     short loc_5C8212
                mov     esi, [esp+2Ch+var_14]
                inc     esi
                inc     edi
                mov     [esp+2Ch+var_14], esi
                inc     edx
                jmp     short loc_5C8263
; ---------------------------------------------------------------------------

loc_5C8212:                             ; CODE XREF: ___sbh_heap_check+93↑j
                cmp     edi, [eax+4]
                jge     loc_5C82E7
                cmp     ecx, 1
                jnz     short loc_5C8231
                cmp     edi, [ebp-4]
                jl      loc_5C82F4
                mov     [esp+2Ch+var_18], 2

loc_5C8231:                             ; CODE XREF: ___sbh_heap_check+AE↑j
                xor     eax, eax
                lea     ecx, [edx+1]
                mov     al, [esi]
                mov     esi, edx
                add     esi, eax
                xor     edi, edi
                cmp     ecx, esi
                jge     short loc_5C8259

loc_5C8242:                             ; CODE XREF: ___sbh_heap_check+E7↓j
                cmp     byte ptr [ecx+ebp], 0
                jnz     loc_5C8301
                xor     eax, eax
                inc     ecx
                mov     al, [edx+ebx+8]
                add     eax, edx
                cmp     ecx, eax
                jl      short loc_5C8242

loc_5C8259:                             ; CODE XREF: ___sbh_heap_check+D0↑j
                mov     eax, dword ptr [esp+2Ch+var_4]
                mov     edx, ecx
                mov     ecx, dword ptr [esp+2Ch+var_18]

loc_5C8263:                             ; CODE XREF: ___sbh_heap_check+A0↑j
                cmp     edx, 0F0h
                jl      short loc_5C81F4
                mov     edx, dword ptr [esp+2Ch+var_14]
                mov     esi, [eax]
                cmp     edx, esi
                jnz     loc_5C830E
                test    ecx, ecx
                jz      loc_5C831B
                mov     edx, dword ptr [esp+2Ch+var_10]
                xor     edi, edi

loc_5C8287:                             ; CODE XREF: ___sbh_heap_check+5A↑j
                mov     ecx, dword ptr [esp+2Ch+var_8]
                add     eax, 8
                inc     ecx
                add     ebx, 1000h
                add     ebp, 1000h
                cmp     ecx, 400h
                mov     [esp+2Ch+var_8], ecx
                mov     [esp+2Ch+var_4], eax
                jl      loc_5C81B2

loc_5C82AF:                             ; CODE XREF: ___sbh_heap_check+28↑j
                mov     edx, dword ptr [edx]
                cmp     edx, offset __small_block_heap
                mov     [esp+2Ch+var_10], edx
                jz      short loc_5C8328
                jmp     loc_5C8186
; ---------------------------------------------------------------------------

loc_5C82C2:                             ; CODE XREF: ___sbh_heap_check+50↑j
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 1Ch
                retn
; ---------------------------------------------------------------------------

loc_5C82CD:                             ; CODE XREF: ___sbh_heap_check+69↑j
                mov     eax, 0FFFFFFFEh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 1Ch
                retn
; ---------------------------------------------------------------------------

loc_5C82DA:                             ; CODE XREF: ___sbh_heap_check+72↑j
                mov     eax, 0FFFFFFFDh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 1Ch
                retn
; ---------------------------------------------------------------------------

loc_5C82E7:                             ; CODE XREF: ___sbh_heap_check+A5↑j
                mov     eax, 0FFFFFFFCh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 1Ch
                retn
; ---------------------------------------------------------------------------

loc_5C82F4:                             ; CODE XREF: ___sbh_heap_check+B3↑j
                mov     eax, 0FFFFFFFBh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 1Ch
                retn
; ---------------------------------------------------------------------------

loc_5C8301:                             ; CODE XREF: ___sbh_heap_check+D6↑j
                mov     eax, 0FFFFFFFAh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 1Ch
                retn
; ---------------------------------------------------------------------------

loc_5C830E:                             ; CODE XREF: ___sbh_heap_check+103↑j
                mov     eax, 0FFFFFFF9h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 1Ch
                retn
; ---------------------------------------------------------------------------

loc_5C831B:                             ; CODE XREF: ___sbh_heap_check+10B↑j
                mov     eax, 0FFFFFFF8h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 1Ch
                retn
; ---------------------------------------------------------------------------

loc_5C8328:                             ; CODE XREF: ___sbh_heap_check+14B↑j
                mov     eax, dword ptr [esp+2Ch+var_C]
                pop     edi
                neg     eax
                sbb     eax, eax
                pop     esi
                and     eax, 9
                pop     ebp
                add     eax, 0FFFFFFF7h
                pop     ebx
                add     esp, 1Ch
                retn
___sbh_heap_check endp

; ---------------------------------------------------------------------------

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _callnewh(size_t varSize)
__callnewh      proc near               ; CODE XREF: __nh_malloc+33↑p

varSize            = dword ptr  4

                mov     eax, _pnhHeap
                test    eax, eax
                jz      short loc_5C767D
                mov     ecx, dword ptr [esp+varSize]
                push    ecx
                call    eax ; _pnhHeap
                add     esp, 4
                test    eax, eax
                jz      short loc_5C767D
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5C767D:                             ; CODE XREF: __callnewh+7↑j
                xor     eax, eax
                retn
__callnewh      endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__heap_alloc    proc near               ; CODE XREF: __nh_malloc+1E↑p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                push    esi
                push    edi
                lea     esi, [eax+0Fh]
                mov     eax, __sbh_threshold
                and     esi, 0FFFFFFF0h
                cmp     esi, eax
                ja      short loc_5BF062
                push    9
                call    __lock
                mov     ecx, esi
                add     esp, 4
                shr     ecx, 4
                push    ecx
                call    ___sbh_alloc_block
                add     esp, 4
                mov     edi, eax
                push    9
                call    __unlock
                add     esp, 4
                test    edi, edi
                jz      short loc_5BF062
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5BF062:                             ; CODE XREF: __heap_alloc+13↑j
                mov     edx, _crtheap
                push    esi             ; dwBytes
                push    0               ; dwFlags
                push    edx             ; _crtheap
                call    HeapAlloc
                pop     edi
                pop     esi
                retn
__heap_alloc    endp

; ---------------------------------------------------------------------------
                align 10h


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__heap_term     proc near
                push    esi
                push    edi
                mov     edi, ds:VirtualFree
                mov     esi, offset __small_block_heap

loc_5C76CD:                             ; CODE XREF: __heap_term+26↓j
                mov     eax, dword ptr [esi+10h]
                test    eax, eax
                jz      short loc_5C76DE
                push    8000h           ; dwFreeType
                push    0               ; dwSize
                push    eax             ; lpAddress
                call    edi ; VirtualFree

loc_5C76DE:                             ; CODE XREF: __heap_term+12↑j
                mov     esi, [esi]
                cmp     esi, offset __small_block_heap
                jnz     short loc_5C76CD
                mov     eax, _crtheap
                push    eax             ; _crtheap
                call    HeapDestroy
                pop     edi
                pop     esi
                retn
__heap_term     endp

; ---------------------------------------------------------------------------
                align 10h


; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn

__amsg_exit     proc near               ; CODE XREF: ___onexitinit+18↑p

arg_0           = dword ptr  4

                cmp     __error_mode, 1
                jnz     short loc_5C1D5E
                call    __FF_MSGBANNER

loc_5C1D5E:                             ; CODE XREF: __amsg_exit+7↑j
                mov     eax, dword ptr [esp+arg_0]
                push    eax
                call    __NMSG_WRITE
                add     esp, 4
                push    0FFh            ; Code
                call    _aexit_rtn
                add     esp, 4
                retn
__amsg_exit     endp
; ---------------------------------------------------------------------------
                align 10h


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__FF_MSGBANNER  proc near               ; CODE XREF: __amsg_exit+9↑p
                mov     eax, __error_mode
                cmp     eax, 1
                jz      short loc_5CC617
                test    eax, eax
                jnz     short locret_5CC63C
                cmp     __app_type, 1
                jnz     short locret_5CC63C

loc_5CC617:                             ; CODE XREF: __FF_MSGBANNER+8↑j
                push    0FCh
                call    __NMSG_WRITE
                mov     eax, _adbgmsg
                add     esp, 4
                test    eax, eax
                jz      short loc_5CC62F
                call    eax ; _adbgmsg

loc_5CC62F:                             ; CODE XREF: __FF_MSGBANNER+2B↑j
                push    0FFh
                call    __NMSG_WRITE
                add     esp, 4

locret_5CC63C:                          ; CODE XREF: __FF_MSGBANNER+C↑j
                retn
__FF_MSGBANNER  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__NMSG_WRITE    proc near               ; CODE XREF: _abort+2↑p

NumberOfBytesWritten= dword ptr -1A8h
var_1A4         = byte ptr -1A4h
Filename        = byte ptr -104h
arg_0           = dword ptr  4

                mov     ecx, dword ptr [esp+arg_0]
                sub     esp, 1A8h
                mov     eax, offset rterrs
                push    ebx
                push    ebp
                push    esi
                push    edi
                xor     ebp, ebp

loc_5CC655:                             ; CODE XREF: __NMSG_WRITE+22↓j
                cmp     ecx, [eax]
                jz      short loc_5CC664
                add     eax, 8
                inc     ebp
                cmp     eax, offset rterrs+90h ;end of rterrs
                jb      short loc_5CC655

loc_5CC664:                             ; CODE XREF: __NMSG_WRITE+17↑j
                cmp     ecx, rterrs[ebp*8]
                jnz     loc_5CC80B
                mov     eax, __error_mode
                cmp     eax, 1
                jz      loc_5CC7CD
                test    eax, eax
                jnz     short loc_5CC690
                cmp     __app_type, 1
                jz      loc_5CC7CD

loc_5CC690:                             ; CODE XREF: __NMSG_WRITE+41↑j
                cmp     ecx, 0FCh
                jz      loc_5CC80B
                lea     eax, [esp+1B8h+Filename]
                push    104h            ; nSize
                push    eax             ; lpFilename
                push    0               ; hModule
                call    GetModuleFileNameA
                test    eax, eax
                jnz     short loc_5CC6CB
                mov     ecx, 5
                mov     esi, offset aProgramNameUnk ; "<program name unknown>"
                lea     edi, [esp+1B8h+Filename]
                rep movsd
                movsw
                movsb

loc_5CC6CB:                             ; CODE XREF: __NMSG_WRITE+73↑j
                lea     edi, [esp+1B8h+Filename]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                lea     ebx, [esp+1B8h+Filename]
                repne scasb
                not     ecx
                cmp     ecx, 3Ch ; '<'
                jbe     short loc_5CC714
                lea     edi, [esp+1B8h+Filename]
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                push    3               ; Count
                mov     ebx, ecx
                lea     ecx, [esp+1BCh+Filename]
                sub     ecx, 3Bh ; ';'
                push    offset asc_614AAC ; "..."
                add     ebx, ecx
                push    ebx             ; Destination
                call    _strncpy
                add     esp, 0Ch

loc_5CC714:                             ; CODE XREF: __NMSG_WRITE+A5↑j
                mov     ecx, 6
                mov     esi, offset aRuntimeErrorPr ; "Runtime Error!\n\nProgram: "
                lea     edi, [esp+1B8h+var_1A4]
                xor     eax, eax
                rep movsd
                movsw
                or      ecx, 0FFFFFFFFh
                mov     edi, ebx
                repne scasb
                not     ecx
                sub     edi, ecx
                lea     edx, [esp+1B8h+var_1A4]
                mov     ebx, ecx
                mov     esi, edi
                or      ecx, 0FFFFFFFFh
                mov     edi, edx
                repne scasb
                mov     ecx, ebx
                dec     edi
                shr     ecx, 2
                rep movsd
                mov     ecx, ebx
                lea     edx, [esp+1B8h+var_1A4]
                and     ecx, 3
                push    12010h
                rep movsb
                mov     edi, offset asc_614A8C ; "\n\n"
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                sub     edi, ecx
                push    offset aMicrosoftVisua ; "Microsoft Visual C++ Runtime Library"
                mov     esi, edi
                mov     ebx, ecx
                mov     edi, edx
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     ecx, ebx
                dec     edi
                shr     ecx, 2
                rep movsd
                mov     ecx, ebx
                lea     edx, [esp+1C0h+var_1A4]
                and     ecx, 3
                rep movsb
                mov     edi, rterrs+4h[ebp*8]
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     ebx, ecx
                mov     edi, edx
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     ecx, ebx
                dec     edi
                shr     ecx, 2
                rep movsd
                mov     ecx, ebx
                lea     eax, [esp+1C0h+var_1A4]
                and     ecx, 3
                push    eax
                rep movsb
                call    ___crtMessageBoxA
                add     esp, 0Ch
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 1A8h
                retn
; ---------------------------------------------------------------------------

loc_5CC7CD:                             ; CODE XREF: __NMSG_WRITE+39↑j
                mov     eax, __pioinfo
                test    eax, eax
                jz      short loc_5CC7DE
                mov     esi, [eax+48h]
                cmp     esi, 0FFFFFFFFh
                jnz     short loc_5CC7E8

loc_5CC7DE:                             ; CODE XREF: __NMSG_WRITE+194↑j
                push    0FFFFFFF4h      ; nStdHandle
                call    GetStdHandle
                mov     esi, eax

loc_5CC7E8:                             ; CODE XREF: __NMSG_WRITE+19C↑j
                mov     edx, rterrs+4h[ebp*8]
                lea     ecx, [esp+1B8h+NumberOfBytesWritten]
                push    0               ; lpOverlapped
                push    ecx             ; lpNumberOfBytesWritten
                mov     edi, edx
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                dec     ecx
                push    ecx             ; nNumberOfBytesToWrite
                push    edx             ; lpBuffer
                push    esi             ; hFile
                call    WriteFile

loc_5CC80B:                             ; CODE XREF: __NMSG_WRITE+2B↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 1A8h
                retn
__NMSG_WRITE    endp

; ---------------------------------------------------------------------------
                align 10h



; =============== S U B R O U T I N E =======================================

; Attributes: library function

___crtMessageBoxA proc near             ; CODE XREF: __NMSG_WRITE+17A↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                mov     eax, pfnMessageBoxA
                push    ebx
                xor     ebx, ebx
                push    esi
                test    eax, eax
                push    edi
                jnz     short loc_5D3380
                push    offset LibFileName ; "user32.dll"
                call    LoadLibraryA
                mov     esi, eax
                test    esi, esi
                jz      short loc_5D33B9
                mov     edi, ds:GetProcAddress
                push    offset aMessageboxa ; "MessageBoxA"
                push    esi             ; hModule
                call    edi ; GetProcAddress
                test    eax, eax
                mov     pfnMessageBoxA, eax
                jz      short loc_5D33B9
                push    offset aGetactivewindo ; "GetActiveWindow"
                push    esi             ; hModule
                call    edi ; GetProcAddress
                push    offset aGetlastactivep ; "GetLastActivePopup"
                push    esi             ; hModule
                mov     pfnGetActiveWindow, eax
                call    edi ; GetProcAddress
                mov     pfnGetLastActivePopup, eax

loc_5D3380:                             ; CODE XREF: ___crtMessageBoxA+C↑j
                mov     eax, pfnGetActiveWindow
                test    eax, eax
                jz      short loc_5D338D
                call    eax ; pfnGetActiveWindow
                mov     ebx, eax

loc_5D338D:                             ; CODE XREF: ___crtMessageBoxA+57↑j
                test    ebx, ebx
                jz      short loc_5D339F
                mov     eax, pfnGetLastActivePopup
                test    eax, eax
                jz      short loc_5D339F
                push    ebx
                call    eax ; pfnGetLastActivePopup
                mov     ebx, eax

loc_5D339F:                             ; CODE XREF: ___crtMessageBoxA+5F↑j
                mov     eax, dword ptr [esp+0Ch+arg_8]
                mov     ecx, dword ptr [esp+0Ch+arg_4]
                mov     edx, dword ptr [esp+0Ch+arg_0]
                push    eax
                push    ecx
                push    edx
                push    ebx
                call    pfnMessageBoxA
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D33B9:                             ; CODE XREF: ___crtMessageBoxA+1D↑j
                pop     edi
                pop     esi
                xor     eax, eax
                pop     ebx
                retn
___crtMessageBoxA endp

; ---------------------------------------------------------------------------
                align 10h


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int (__cdecl *__cdecl _set_new_handler(int (__cdecl *)(unsigned int)))(unsigned int)
?_set_new_handler@@YAP6AHI@ZP6AHI@Z@Z proc near

arg_0           = dword ptr  4

                push    esi
                push    9
                call    __lock
                mov     eax, dword ptr [esp+8+arg_0]
                mov     esi, _pnhHeap
                add     esp, 4
                mov     _pnhHeap, eax
                push    9
                call    __unlock
                add     esp, 4
                mov     eax, esi
                pop     esi
                retn
?_set_new_handler@@YAP6AHI@ZP6AHI@Z@Z endp



; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn

; void __cdecl __noreturn _exit(int Code)
__exit          proc near               ; CODE XREF: sub_4823BD+997↑p

Code            = dword ptr  4

                mov     eax, dword ptr [esp+Code]
                push    0               ; int
                push    1               ; int
                push    eax             ; uExitCode
                call    _doexit
                add     esp, 0Ch
                retn
__exit          endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl doexit(UINT uExitCode, int, int)
_doexit         proc near               ; CODE XREF: _exit+9↑p

uExitCode       = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                push    ebx
                push    ebp
                push    esi
                call    __lockexit
                mov     eax, _C_Exit_Done
                mov     ebp, [esp+0Ch+uExitCode]
                cmp     eax, 1
                jnz     short loc_5C10D4
                push    ebp             ; uExitCode
                call    GetCurrentProcess
                push    eax             ; hProcess
                call    TerminateProcess

loc_5C10D4:                             ; CODE XREF: _doexit+14↑j
                mov     eax, dword ptr [esp+0Ch+arg_4]
                mov     ebx, dword ptr [esp+0Ch+arg_8]
                test    eax, eax
                mov     _C_Termination_Done, 1
                mov     _exitflag, bl
                jnz     short loc_5C112E
                mov     ecx, __onexitbegin
                test    ecx, ecx
                jz      short loc_5C111C
                mov     esi, __onexitend
                sub     esi, 4
                cmp     esi, ecx
                jb      short loc_5C111C

loc_5C1107:                             ; CODE XREF: _doexit+6A↓j
                mov     eax, dword ptr [esi]
                test    eax, eax
                jz      short loc_5C1115
                call    eax
                mov     ecx, __onexitbegin

loc_5C1115:                             ; CODE XREF: _doexit+5B↑j
                sub     esi, 4
                cmp     esi, ecx
                jnb     short loc_5C1107

loc_5C111C:                             ; CODE XREF: _doexit+48↑j
                push    offset __xp_z ; Last
                push    offset __xp_a ; First
                call    __initterm
                add     esp, 8

loc_5C112E:                             ; CODE XREF: _doexit+3E↑j
                push    offset __xt_z ; Last
                push    offset __xt_a ; First
                call    __initterm
                add     esp, 8
                test    ebx, ebx
                jz      short loc_5C114D
                call    __unlockexit
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C114D:                             ; CODE XREF: _doexit+92↑j
                push    ebp             ; uExitCode
                mov     _C_Exit_Done, 1
                call    ExitProcess
                pop     esi
                pop     ebp
                pop     ebx
                retn

_doexit         endp

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; void __cdecl _initterm(_PVFV *First, _PVFV *Last)
__initterm      proc near               ; CODE XREF: __cinit+15↑p

First           = dword ptr  4
Last            = dword ptr  8

                push    esi
                mov     esi, [esp+4+First]
                push    edi
                mov     edi, [esp+8+Last]
                cmp     esi, edi
                jnb     short loc_5C11AD

loc_5C119E:                             ; CODE XREF: __initterm+1B↓j
                mov     eax, dword ptr [esi]
                test    eax, eax
                jz      short loc_5C11A6
                call    eax

loc_5C11A6:                             ; CODE XREF: __initterm+12↑j
                add     esi, 4
                cmp     esi, edi
                jb      short loc_5C119E

loc_5C11AD:                             ; CODE XREF: __initterm+C↑j
                pop     edi
                pop     esi
                retn
__initterm      endp

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__lockexit      proc near               ; CODE XREF: __onexit+1↑p
                push    0Dh
                call    __lock
                add     esp, 4
                retn
__lockexit      endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__unlockexit    proc near               ; CODE XREF: __onexit+4B↑p
                push    0Dh
                call    __unlock
                add     esp, 4
                retn
__unlockexit    endp

; ----------------------------


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; _onexit_t __cdecl _onexit(_onexit_t Func)
__onexit        proc near               ; CODE XREF: _atexit+5↓p

Func            = dword ptr  4

                push    esi
                call    __lockexit
                mov     eax, __onexitbegin
                push    eax             ; Block
                call    __msize
                mov     ecx, __onexitend
                mov     edx, __onexitbegin
                mov     esi, ecx
                add     esp, 4
                sub     esi, edx
                add     esi, 4
                cmp     eax, esi
                jnb     short loc_5BEEB3
                push    edx             ; Block
                call    __msize
                mov     ecx, __onexitbegin
                add     esp, 4
                add     eax, 10h
                push    eax             ; varSize
                push    ecx             ; Block
                call    _realloc
                add     esp, 8
                test    eax, eax
                jnz     short loc_5BEE94
                call    __unlockexit
                xor     eax, eax
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5BEE94:                             ; CODE XREF: __onexit+49↑j
                mov     edx, __onexitend
                mov     esi, __onexitbegin
                sub     edx, esi
                mov     __onexitbegin, eax
                sar     edx, 2
                lea     ecx, [eax+edx*4]
                mov     __onexitend, ecx

loc_5BEEB3:                             ; CODE XREF: __onexit+29↑j
                mov     esi, [esp+4+Func]
                mov     [ecx], esi
                mov     eax, __onexitend
                add     eax, 4
                mov     __onexitend, eax
                call    __unlockexit
                mov     eax, esi
                pop     esi
                retn
__onexit        endp

; ---------------------------------------------------------------------------

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___onexitinit   proc near               ; DATA XREF: .data:0062C240↓o
                push    80h             ; varSize
                call    _malloc
                add     esp, 4
                mov     __onexitbegin, eax
                test    eax, eax
                jnz     short loc_5BEF15
                push    18h
                call    __amsg_exit
; ---------------------------------------------------------------------------
                mov     eax, __onexitbegin
                add     esp, 4

loc_5BEF15:                             ; CODE XREF: ___onexitinit+14↑j
                mov     dword ptr [eax], 0
                mov     eax, __onexitbegin
                mov     __onexitend, eax
                retn
___onexitinit   endp

; ---------------------------------------------------------------------------


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; size_t __cdecl _msize(void *Block)
__msize         proc near               ; CODE XREF: __onexit+C↑p

var_8           = byte ptr -8
var_4           = byte ptr -4
lpMem           = dword ptr  4

                sub     esp, 8
                push    esi
                push    9
                call    __lock
                mov     esi, [esp+10h+lpMem]
                add     esp, 4
                lea     eax, [esp+0Ch+var_8]
                lea     ecx, [esp+0Ch+var_4]
                push    eax
                push    ecx
                push    esi
                call    ___sbh_find_block
                add     esp, 0Ch
                test    eax, eax
                jz      short loc_5C60E3
                xor     edx, edx
                push    9
                mov     dl, [eax]
                mov     esi, edx
                shl     esi, 4
                call    __unlock
                add     esp, 4
                mov     eax, esi
                pop     esi
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C60E3:                             ; CODE XREF: __msize+27↑j
                push    9
                call    __unlock
                mov     eax, _crtheap
                add     esp, 4
                push    esi             ; lpMem
                push    0               ; dwFlags
                push    eax             ; _crtheap
                call    HeapSize
                mov     esi, eax
                pop     esi
                add     esp, 8
                retn
__msize         endp

; ---------------------------------------------------------------------------


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__heap_init     proc near               ; CODE XREF: start+57↑p
                push    0               ; dwMaximumSize
                push    1000h           ; dwInitialSize
                push    0               ; flOptions
                call    HeapCreate
                test    eax, eax
                mov     _crtheap, eax
                jnz     short loc_5C7699
                retn
; ---------------------------------------------------------------------------

loc_5C7699:                             ; CODE XREF: __heap_init+16↑j
                call    ___sbh_new_region
                test    eax, eax
                jnz     short loc_5C76B1
                mov     eax, _crtheap
                push    eax             ; _crtheap
                call    HeapDestroy
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------

loc_5C76B1:                             ; CODE XREF: __heap_init+20↑j
                mov     eax, 1
                retn
__heap_init     endp

; ---------------------------------------------------------------------------



; =============== S U B R O U T I N E =======================================

; Attributes: library function

__mtinitlocks   proc near               ; CODE XREF: __mtinit+1↑p
                mov     eax, [_locktable+44h]
                push    esi
                mov     esi, ds:InitializeCriticalSection
                push    eax             ; lpCriticalSection
                call    esi ; InitializeCriticalSection
                mov     ecx, _locktable+34h
                push    ecx             ; lpCriticalSection
                call    esi ; InitializeCriticalSection
                mov     edx, _locktable+24h
                push    edx             ; lpCriticalSection
                call    esi ; InitializeCriticalSection
                mov     eax, _locktable+4h
                push    eax             ; lpCriticalSection
                call    esi ; InitializeCriticalSection
                pop     esi
                retn
__mtinitlocks   endp

; ---------------------------------------------------------------------------


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__mtdeletelocks proc near               ; CODE XREF: .text:__mtterm↑p
                push    esi
                push    edi
                mov     edi, ds:DeleteCriticalSection
                mov     esi, offset _locktable

loc_5C773D:                             ; CODE XREF: __mtdeletelocks+4A↓j
                mov     eax, dword ptr [esi]
                test    eax, eax
                jz      short loc_5C7771
                cmp     esi, offset _locktable+44h
                jz      short loc_5C7771
                cmp     esi, offset _locktable+34h
                jz      short loc_5C7771
                cmp     esi, offset _locktable+24h
                jz      short loc_5C7771
                cmp     esi, offset _locktable+4h
                jz      short loc_5C7771
                push    eax             ; lpCriticalSection
                call    edi ; DeleteCriticalSection
                mov     eax, dword ptr [esi]
                push    eax             ; Block
                call    _free
                add     esp, 4

loc_5C7771:                             ; CODE XREF: __mtdeletelocks+11↑j
                add     esi, 4
                cmp     esi, offset __small_block_heap
                jl      short loc_5C773D
                mov     ecx, _locktable+24h
                push    ecx             ; lpCriticalSection
                call    edi ; DeleteCriticalSection
                mov     edx, _locktable+34h
                push    edx             ; lpCriticalSection
                call    edi ; DeleteCriticalSection
                mov     eax, [_locktable+44h]
                push    eax             ; lpCriticalSection
                call    edi ; DeleteCriticalSection
                mov     ecx, _locktable+4h
                push    ecx             ; lpCriticalSection
                call    edi ; DeleteCriticalSection
                pop     edi
                pop     esi
                retn
__mtdeletelocks endp

; ---------------------------------------------------------------------------


; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn

; void __cdecl __noreturn exit(int Code)
_exit           proc near               ; CODE XREF: start+B2↓p

Code            = dword ptr  4

                mov     eax, dword ptr [esp+Code]
                push    0               ; int
                push    0               ; int
                push    eax             ; uExitCode
                call    _doexit
                add     esp, 0Ch
                retn
_exit           endp

; ---------------------------------------------------------------------------



; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void __cdecl _cexit()
__cexit         proc near
                push    1               ; int
                push    0               ; int
                push    0               ; uExitCode
                call    _doexit
                add     esp, 0Ch
                retn
__cexit         endp

; ---------------------------------------------------------------------------


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void __cdecl _c_exit()
__c_exit        proc near
                push    1               ; int
                push    1               ; int
                push    0               ; uExitCode
                call    _doexit
                add     esp, 0Ch
                retn
__c_exit        endp

; ---------------------------------------------------------------------------



; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void *__cdecl _expand(void *Block, size_t varSize)
__expand        proc near               ; CODE XREF: AfxCriticalNewHandler(uint)+3D↓p

var_4           = dword ptr -4
lpMem           = dword ptr  4
varSize            = dword ptr  8

                push    ecx
                mov     eax, dword ptr [esp+4+varSize]
                push    ebx
                push    esi
                cmp     eax, 0FFFFFFE0h
                push    edi
                jbe     short loc_5C6124
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C6124:                             ; CODE XREF: __expand+B↑j
                test    eax, eax
                jbe     short loc_5C6130
                lea     esi, [eax+0Fh]
                and     esi, 0FFFFFFF0h
                jmp     short loc_5C6135
; ---------------------------------------------------------------------------

loc_5C6130:                             ; CODE XREF: __expand+16↑j
                mov     esi, 10h

loc_5C6135:                             ; CODE XREF: __expand+1E↑j
                push    9
                call    __lock
                mov     edi, [esp+14h+lpMem]
                add     esp, 4
                lea     eax, [esp+10h+varSize]
                lea     ecx, [esp+10h+var_4]
                push    eax
                push    ecx
                push    edi
                call    ___sbh_find_block
                add     esp, 0Ch
                test    eax, eax
                jz      short loc_5C6194
                mov     ecx, __sbh_threshold
                xor     ebx, ebx
                cmp     esi, ecx
                ja      short loc_5C6183
                mov     edx, dword ptr [esp+10h+varSize]
                shr     esi, 4
                push    esi
                push    eax
                mov     eax, dword ptr [esp+18h+var_4]
                push    edx
                push    eax
                call    ___sbh_resize_block
                add     esp, 10h
                test    eax, eax
                jz      short loc_5C6183
                mov     ebx, edi

loc_5C6183:                             ; CODE XREF: __expand+54↑j
                push    9
                call    __unlock
                add     esp, 4
                mov     eax, ebx
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C6194:                             ; CODE XREF: __expand+48↑j
                push    9
                call    __unlock
                mov     ecx, _crtheap
                add     esp, 4
                push    esi             ; dwBytes
                push    edi             ; lpMem
                push    10h             ; dwFlags
                push    ecx             ; _crtheap
                call    HeapReAlloc
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
__expand        endp

; ---------------------------------------------------------------------------


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__mtinit        proc near               ; CODE XREF: start:loc_5C1C0A↑p
                push    esi
                call    __mtinitlocks
                call    TlsAlloc
                cmp     eax, 0FFFFFFFFh
                mov     __tlsindex, eax
                jz      short loc_5C6D48
                push    74h ; 't'       ; varSize
                push    1               ; Count
                call    _calloc
                mov     esi, eax
                add     esp, 8
                test    esi, esi
                jz      short loc_5C6D48
                mov     eax, __tlsindex
                push    esi             ; lpTlsValue
                push    eax             ; __tlsindex
                call    TlsSetValue
                test    eax, eax
                jz      short loc_5C6D48
                push    esi
                call    __initptd
                add     esp, 4
                call    GetCurrentThreadId
                mov     [esi], eax
                mov     dword ptr [esi+4], 0FFFFFFFFh
                mov     eax, 1
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C6D48:                             ; CODE XREF: __mtinit+14↑j
                xor     eax, eax
                pop     esi
                retn
__mtinit        endp

; ---------------------------------------------------------------------------


__mtterm:
                call    __mtdeletelocks
                mov     eax, __tlsindex
                cmp     eax, 0FFFFFFFFh
                jz      short locret_5C6D70
                push    eax
                call    TlsFree
                mov     __tlsindex, 0FFFFFFFFh

locret_5C6D70:                          ; CODE XREF: .text:005C6D5D↑j
                retn
; ---------------------------------------------------------------------------


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__initptd       proc near               ; CODE XREF: __beginthread+17↑p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                mov     dword ptr [eax+50h], offset _XcptActTab
                mov     dword ptr [eax+14h], 1
                retn
__initptd       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__getptd        proc near               ; CODE XREF: _CallSETranslator(EHExceptionRecord *,EHRegistrationNode *,void *,void *,_s_FuncInfo const *,int,EHRegistrationNode *)+8A↑p
                push    esi
                push    edi
                call    GetLastError
                mov     edi, eax
                mov     eax, __tlsindex
                push    eax             ; __tlsindex
                call    TlsGetValue
                mov     esi, eax
                test    esi, esi
                jnz     short loc_5C6E0E
                push    74h ; 't'       ; varSize
                push    1               ; Count
                call    _calloc
                mov     esi, eax
                add     esp, 8
                test    esi, esi
                jz      short loc_5C6E04
                mov     ecx, __tlsindex
                push    esi             ; lpTlsValue
                push    ecx             ; __tlsindex
                call    TlsSetValue
                test    eax, eax
                jz      short loc_5C6E04
                push    esi
                call    __initptd
                add     esp, 4
                call    GetCurrentThreadId
                push    edi             ; dwErrCode
                mov     [esi], eax
                mov     dword ptr [esi+4], 0FFFFFFFFh
                call    SetLastError
                mov     eax, esi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C6E04:                             ; CODE XREF: __getptd+2C↑j
                push    10h
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5C6E0E:                             ; CODE XREF: __getptd+1A↑j
                push    edi             ; dwErrCode
                call    SetLastError
                mov     eax, esi
                pop     edi
                pop     esi
                retn
__getptd        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _freeptd(void *Block)
__freeptd       proc near               ; CODE XREF: __endthread+31↑p

Block           = dword ptr  4

                mov     eax, __tlsindex
                cmp     eax, 0FFFFFFFFh
                jz      locret_5C6EBC
                push    esi
                mov     esi, [esp+4+Block]
                test    esi, esi
                jnz     short loc_5C6E44
                push    eax             ; __tlsindex
                call    TlsGetValue
                mov     esi, eax
                test    esi, esi
                jz      short loc_5C6EAD

loc_5C6E44:                             ; CODE XREF: __freeptd+15↑j
                mov     eax, dword ptr [esi+24h]
                test    eax, eax
                jz      short loc_5C6E54
                push    eax             ; Block
                call    _free
                add     esp, 4

loc_5C6E54:                             ; CODE XREF: __freeptd+29↑j
                mov     eax, dword ptr [esi+28h]
                test    eax, eax
                jz      short loc_5C6E64
                push    eax             ; Block
                call    _free
                add     esp, 4

loc_5C6E64:                             ; CODE XREF: __freeptd+39↑j
                mov     eax, dword ptr [esi+30h]
                test    eax, eax
                jz      short loc_5C6E74
                push    eax             ; Block
                call    _free
                add     esp, 4

loc_5C6E74:                             ; CODE XREF: __freeptd+49↑j
                mov     eax, dword ptr [esi+38h]
                test    eax, eax
                jz      short loc_5C6E84
                push    eax             ; Block
                call    _free
                add     esp, 4

loc_5C6E84:                             ; CODE XREF: __freeptd+59↑j
                mov     eax, dword ptr [esi+40h]
                test    eax, eax
                jz      short loc_5C6E94
                push    eax             ; Block
                call    _free
                add     esp, 4

loc_5C6E94:                             ; CODE XREF: __freeptd+69↑j
                mov     eax, dword ptr [esi+44h]
                test    eax, eax
                jz      short loc_5C6EA4
                push    eax             ; Block
                call    _free
                add     esp, 4

loc_5C6EA4:                             ; CODE XREF: __freeptd+79↑j
                push    esi             ; Block
                call    _free
                add     esp, 4

loc_5C6EAD:                             ; CODE XREF: __freeptd+22↑j
                mov     eax, __tlsindex
                push    0               ; lpTlsValue
                push    eax             ; __tlsindex
                call    TlsSetValue
                pop     esi

locret_5C6EBC:                          ; CODE XREF: __freeptd+8↑j
                retn
__freeptd       endp

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; _crt_signal_t __cdecl signal(int Signal, _crt_signal_t Function)
_signal         proc near

Signal          = dword ptr  4
Function        = dword ptr  8

                push    ebx
                push    ebp
                push    esi
                mov     esi, [esp+0Ch+Function]
                cmp     esi, 4
                push    edi
                jz      loc_5CC295
                cmp     esi, 3
                jz      loc_5CC295
                mov     ebp, [esp+10h+Signal]
                cmp     ebp, 2
                jz      loc_5CC1B9
                cmp     ebp, 15h
                jz      loc_5CC1B9
                cmp     ebp, 16h
                jz      loc_5CC1B9
                cmp     ebp, 0Fh
                jz      loc_5CC1B9
                cmp     ebp, 8
                jz      short loc_5CC125
                cmp     ebp, 4
                jz      short loc_5CC125
                cmp     ebp, 0Bh
                jnz     loc_5CC295

loc_5CC125:                             ; CODE XREF: _signal+45↑j
                call    __getptd
                mov     ebx, eax
                cmp     dword ptr [ebx+50h], offset _XcptActTab
                jnz     short loc_5CC16D
                mov     eax, [_XcptActTabSize]
                push    eax             ; varSize
                call    _malloc
                add     esp, 4
                mov     [ebx+50h], eax
                test    eax, eax
                jz      loc_5CC295
                mov     ecx, [_XcptActTabSize]
                mov     esi, offset _XcptActTab
                mov     edx, ecx
                mov     edi, eax
                shr     ecx, 2
                rep movsd
                mov     ecx, edx
                and     ecx, 3
                rep movsb
                mov     esi, [esp+10h+Function]

loc_5CC16D:                             ; CODE XREF: _signal+63↑j
                mov     eax, dword ptr [ebx+50h]
                push    eax
                push    ebp
                call    _siglookup
                add     esp, 8
                test    eax, eax
                jz      loc_5CC295
                mov     ecx, dword ptr [eax+4]
                mov     edi, [eax+8]
                cmp     ecx, ebp
                jnz     loc_5CC28E

loc_5CC190:                             ; CODE XREF: _signal+E0↓j
                mov     [eax+8], esi
                mov     ecx, _XcptActTabCount
                mov     edx, dword ptr [ebx+50h]
                add     eax, 0Ch
                lea     ecx, [ecx+ecx*2]
                lea     ecx, [edx+ecx*4]
                cmp     eax, ecx
                jnb     loc_5CC28E
                cmp     [eax+4], ebp
                jz      short loc_5CC190
                mov     eax, edi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CC1B9:                             ; CODE XREF: _signal+21↑j
                push    1
                call    __lock
                add     esp, 4
                cmp     ebp, 2
                jz      short loc_5CC1CD
                cmp     ebp, 15h
                jnz     short loc_5CC1F1

loc_5CC1CD:                             ; CODE XREF: _signal+F6↑j
                mov     eax, ConsoleCtrlHandler_Installed
                test    eax, eax
                jnz     short loc_5CC1F1
                push    1               ; Add
                push    offset _ctrlevent_capture@4 ; HandlerRoutine
                call    SetConsoleCtrlHandler
                cmp     eax, 1
                jnz     loc_5CC2A8
                mov     ConsoleCtrlHandler_Installed, eax

loc_5CC1F1:                             ; CODE XREF: _signal+FB↑j
                add     ebp, 0FFFFFFFEh
                cmp     ebp, 14h
                ja      loc_5CC280      ; jumptable 005CC205 case 4
                xor     edx, edx
                mov     dl, ss:byte_5CC2E8[ebp]
                jmp     ds:jpt_5CC205[edx*4] ; switch 5 cases
; ---------------------------------------------------------------------------

loc_5CC20C::                             ; CODE XREF: _signal+135↑j
                mov     edi, dword_70D584 ; jumptable 005CC205 case 0
                push    1
                mov     dword_70D584, esi
                call    __unlock
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CC229::                             ; CODE XREF: _signal+135↑j
                mov     edi, dword_70D588 ; jumptable 005CC205 case 2
                push    1
                mov     dword_70D588, esi
                call    __unlock
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CC246::                             ; CODE XREF: _signal+135↑j
                mov     edi, dword_70D58C ; jumptable 005CC205 case 3
                push    1
                mov     dword_70D58C, esi
                call    __unlock
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CC263::                             ; CODE XREF: _signal+135↑j
                mov     edi, dword_70D590 ; jumptable 005CC205 case 1
                push    1
                mov     dword_70D590, esi
                call    __unlock
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CC280::                             ; CODE XREF: _signal+127↑j
                mov     edi, [esp+10h+Function] ; jumptable 005CC205 case 4
                push    1
                call    __unlock
                add     esp, 4

loc_5CC28E:                             ; CODE XREF: _signal+BA↑j
                mov     eax, edi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CC295:                             ; CODE XREF: _signal+B↑j
                call    __errno
                mov     dword ptr [eax], 16h
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CC2A8:                             ; CODE XREF: _signal+116↑j
                call    GetLastError
                mov     esi, eax
                call    ___doserrno
                push    1
                mov     [eax], esi
                call    __unlock
                add     esp, 4
                call    __errno
                pop     edi
                pop     esi
                mov     dword ptr [eax], 16h
                pop     ebp
                or      eax, 0FFFFFFFFh
                pop     ebx
                retn
_signal         endp

; ---------------------------------------------------------------------------
jpt_5CC205      dd offset loc_5CC20C    ; DATA XREF: _signal+135↑r
                dd offset loc_5CC263    ; jump table for switch statement
                dd offset loc_5CC229
                dd offset loc_5CC246
                dd offset loc_5CC280
byte_5CC2E8     db 0                    ; DATA XREF: _signal+12F↑r
                db 3 dup(4)
                dd 2 dup(4040404h), 4040104h, 2040404h, 90909003h



; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int *__cdecl _errno()
__errno         proc near               ; CODE XREF: __fseek_lk:loc_5C0856↑p
                call    __getptd
                add     eax, 8
                retn
__errno         endp

; ---------------------------------------------------------------------------


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; unsigned int *__cdecl __doserrno()
___doserrno     proc near               ; CODE XREF: __set_osfhnd+8F↑p
                call    __getptd
                add     eax, 0Ch
                retn
___doserrno     endp

; ---------------------------------------------------------------------------

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_siglookup      proc near               ; CODE XREF: _signal+A2↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     edx, dword ptr [esp+arg_0]
                push    esi
                mov     esi, [esp+4+arg_4]
                push    edi
                mov     edi, _XcptActTabCount
                mov     ecx, dword ptr [esi+4]
                mov     eax, esi
                cmp     ecx, edx
                jz      short loc_5CC5CB
                lea     ecx, [edi+edi*2]
                lea     ecx, [esi+ecx*4]

loc_5CC5BF:                             ; CODE XREF: _siglookup+29↓j
                add     eax, 0Ch
                cmp     eax, ecx
                jnb     short loc_5CC5CB
                cmp     [eax+4], edx
                jnz     short loc_5CC5BF

loc_5CC5CB:                             ; CODE XREF: _siglookup+17↑j
                lea     ecx, [edi+edi*2]
                lea     ecx, [esi+ecx*4]
                cmp     eax, ecx
                jnb     short loc_5CC5DA
                cmp     [eax+4], edx
                jz      short loc_5CC5DC

loc_5CC5DA:                             ; CODE XREF: _siglookup+33↑j
                xor     eax, eax

loc_5CC5DC:                             ; CODE XREF: _siglookup+38↑j
                pop     edi
                pop     esi
                retn
_siglookup      endp

; ---------------------------------------------------------------------------

; ---------------------------------------------------------------------------
;005C793D
                push    0FFh
                call    ExitProcess
; ---------------------------------------------------------------------------
                retn
; ---------------------------------------------------------------------------

;005C793D
                mov     eax, __sbh_threshold
                retn
; ---------------------------------------------------------------------------








; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; void __stdcall _JumpToContinuation(void *, struct EHRegistrationNode *)
?_JumpToContinuation@@YGXPAXPAUEHRegistrationNode@@@Z proc near

var_4           = dword ptr -4
arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch

                push    ebp
                mov     ebp, esp
                push    ecx
                push    ebx
                push    esi
                push    edi
                mov     eax, dword ptr [ebp+arg_4]
                add     eax, 0Ch
                mov     [ebp+var_4], eax
                mov     ebx, fs:0
                mov     eax, dword ptr [ebx]
                mov     fs:0, eax
                mov     eax, dword ptr [ebp+arg_0]
                mov     ebx, dword ptr [ebp+arg_4]
                mov     esp, [ebx-4]
                mov     ebp, [ebp+var_4]
                jmp     eax
?_JumpToContinuation@@YGXPAXPAUEHRegistrationNode@@@Z endp

; ---------------------------------------------------------------------------
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn    8
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; ?_CallMemberFunction0@@YGXPAX0@Z
; doubtful name
; Attributes: library function

sub_5BE5C0      proc near               ; CODE XREF: _DestructExceptionObject(EHExceptionRecord *,uchar)+43↓p

arg_4           = dword ptr  8

                pop     eax
                pop     ecx
                xchg    eax, [esp-8+arg_4]
                jmp     eax
sub_5BE5C0      endp ; sp-analysis failed

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; ?_CallMemberFunction0@@YGXPAX0@Z
; doubtful name
; Attributes: library function

sub_5BE5D0      proc near               ; CODE XREF: BuildCatchObject(EHExceptionRecord *,EHRegistrationNode *,_s_HandlerType const *,_s_CatchableType const *)+1CD↓p

arg_4           = dword ptr  8

                pop     eax
                pop     ecx
                xchg    eax, [esp-8+arg_4]
                jmp     eax
sub_5BE5D0      endp ; sp-analysis failed

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; ?_CallMemberFunction0@@YGXPAX0@Z
; doubtful name
; Attributes: library function

sub_5BE5E0      proc near               ; CODE XREF: BuildCatchObject(EHExceptionRecord *,EHRegistrationNode *,_s_HandlerType const *,_s_CatchableType const *)+1B0↓p

arg_4           = dword ptr  8

                pop     eax
                pop     ecx
                xchg    eax, [esp-8+arg_4]
                jmp     eax
sub_5BE5E0      endp ; sp-analysis failed

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; void __stdcall _UnwindNestedFrames(PVOID TargetFrame, PEXCEPTION_RECORD ExceptionRecord)
?_UnwindNestedFrames@@YGXPAUEHRegistrationNode@@PAUEHExceptionRecord@@@Z proc near

var_8           = dword ptr -8
TargetIp        = dword ptr -4
TargetFrame     = dword ptr  8
ExceptionRecord = dword ptr  0Ch

                push    ebp
                mov     ebp, esp
                sub     esp, 8
                push    ebx
                push    esi
                push    edi
                mov     eax, fs:0
                mov     [ebp+var_8], eax
                mov     [ebp+TargetIp], offset $ReturnPoint$12098
                push    0               ; ReturnValue
                mov     eax, dword ptr [ebp+ExceptionRecord]
                push    eax             ; ExceptionRecord
                mov     ecx, dword ptr [ebp+TargetIp]
                push    ecx             ; TargetIp
                mov     edx, dword ptr [ebp+TargetFrame]
                push    edx             ; TargetFrame
                call    RtlUnwind

$ReturnPoint$12098:                     ; DATA XREF: _UnwindNestedFrames(EHRegistrationNode *,EHExceptionRecord *)+12↑o
                mov     eax, dword ptr [ebp+ExceptionRecord]
                mov     ecx, dword ptr [eax+4]
                and     ecx, 0FFFFFFFDh
                mov     edx, dword ptr [ebp+ExceptionRecord]
                mov     [edx+4], ecx
                mov     eax, fs:0
                mov     ebx, dword ptr [ebp+var_8]
                mov     [ebx], eax
                mov     fs:0, ebx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn    8
?_UnwindNestedFrames@@YGXPAUEHRegistrationNode@@PAUEHExceptionRecord@@@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; int __cdecl __CxxFrameHandler(PEXCEPTION_RECORD ExceptionRecord, struct EHRegistrationNode *, struct _CONTEXT *, void *)
___CxxFrameHandler proc near            ; CODE XREF: sub_401000+1F5F6A↓j

var_4           = dword ptr -4
ExceptionRecord = dword ptr  8
arg_4           = dword ptr  0Ch
arg_8           = dword ptr  10h
arg_C           = dword ptr  14h

                push    ebp
                mov     ebp, esp
                sub     esp, 4
                push    ebx
                push    esi
                push    edi
                cld
                mov     [ebp+var_4], eax
                mov     eax, dword ptr [ebp+var_4]
                mov     ecx, dword ptr [ebp+arg_C]
                mov     edx, dword ptr [ebp+arg_8]
                push    0               ; char
                push    0               ; TargetFrame
                push    0               ; int
                push    eax             ; struct _s_FuncInfo *
                mov     eax, dword ptr [ebp+arg_4]
                push    ecx             ; void *
                mov     ecx, dword ptr [ebp+ExceptionRecord]
                push    edx             ; struct _CONTEXT *
                push    eax             ; struct EHRegistrationNode *
                push    ecx             ; ExceptionRecord
                call    ___InternalCxxFrameHandler
                add     esp, 20h
                mov     [ebp+arg_C], eax
                pop     edi
                pop     esi
                pop     ebx
                mov     eax, dword ptr [ebp+arg_C]
                mov     esp, ebp
                pop     ebp
                retn
___CxxFrameHandler endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; __stdcall __CxxLongjmpUnwind(x)
___CxxLongjmpUnwind@4 proc near

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                mov     ecx, dword ptr [eax+1Ch]
                mov     edx, dword ptr [eax+28h]
                mov     eax, dword ptr [eax+18h]
                push    ecx
                push    edx
                push    0
                push    eax
                call    ___FrameUnwindToState
                add     esp, 10h
                retn    4
___CxxLongjmpUnwind@4 endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; void *__cdecl _CallCatchBlock2(struct EHRegistrationNode *, const struct _s_FuncInfo *, void *, int, unsigned int)
?_CallCatchBlock2@@YAPAXPAUEHRegistrationNode@@PBU_s_FuncInfo@@PAXHK@Z proc near

var_14          = dword ptr -14h
var_10          = dword ptr -10h
var_C           = dword ptr -0Ch
var_8           = dword ptr -8
var_4           = dword ptr -4
arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch
arg_8           = dword ptr  10h
arg_C           = dword ptr  14h
arg_10          = dword ptr  18h

                push    ebp
                mov     ebp, esp
                sub     esp, 14h
                mov     edx, dword ptr [ebp+arg_C]
                mov     eax, dword ptr [ebp+arg_4]
                mov     ecx, dword ptr [ebp+arg_0]
                inc     edx
                mov     [ebp+var_14], 0
                mov     [ebp+var_10], offset ?CatchGuardHandler@@YA?AW4_EXCEPTION_DISPOSITION@@PAUEHExceptionRecord@@PAUCatchGuardRN@@PAX2@Z ; CatchGuardHandler(EHExceptionRecord *,CatchGuardRN *,void *,void *)
                mov     [ebp+var_C], eax
                mov     [ebp+var_8], ecx
                mov     [ebp+var_4], edx
                mov     eax, fs:0
                mov     [ebp+var_14], eax
                lea     eax, [ebp+var_14]
                mov     fs:0, eax
                mov     eax, dword ptr [ebp+arg_10]
                push    eax
                push    ecx
                mov     ecx, dword ptr [ebp+arg_8]
                push    ecx
                call    __CallSettingFrame@12 ; _CallSettingFrame(x,x,x)
                mov     ecx, eax
                mov     eax, dword ptr [ebp+var_14]
                mov     fs:0, eax
                mov     eax, ecx
                mov     esp, ebp
                pop     ebp
                retn
?_CallCatchBlock2@@YAPAXPAUEHRegistrationNode@@PBU_s_FuncInfo@@PAXHK@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static bp-based frame

; enum _EXCEPTION_DISPOSITION __cdecl CatchGuardHandler(PEXCEPTION_RECORD ExceptionRecord, PVOID TargetFrame, struct _CONTEXT *, void *)
?CatchGuardHandler@@YA?AW4_EXCEPTION_DISPOSITION@@PAUEHExceptionRecord@@PAUCatchGuardRN@@PAX2@Z proc near

ExceptionRecord = dword ptr  8
TargetFrame     = dword ptr  0Ch
arg_8           = dword ptr  10h

                push    ebp
                mov     ebp, esp
                cld
                mov     eax, dword ptr [ebp+TargetFrame]
                push    0               ; char
                push    eax             ; TargetFrame
                mov     ecx, dword ptr [eax+10h]
                mov     edx, dword ptr [eax+8]
                push    ecx             ; int
                mov     ecx, dword ptr [ebp+arg_8]
                push    edx             ; struct _s_FuncInfo *
                mov     edx, dword ptr [eax+0Ch]
                mov     eax, dword ptr [ebp+ExceptionRecord]
                push    0               ; void *
                push    ecx             ; struct _CONTEXT *
                push    edx             ; struct EHRegistrationNode *
                push    eax             ; ExceptionRecord
                call    ___InternalCxxFrameHandler
                add     esp, 20h
                pop     ebp
                retn
?CatchGuardHandler@@YA?AW4_EXCEPTION_DISPOSITION@@PAUEHExceptionRecord@@PAUCatchGuardRN@@PAX2@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; int __cdecl _CallSETranslator(struct EHExceptionRecord *, struct EHRegistrationNode *, void *, void *, const struct _s_FuncInfo *, int, struct EHRegistrationNode *)
?_CallSETranslator@@YAHPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAX2PBU_s_FuncInfo@@H1@Z proc near

var_34          = dword ptr -34h
var_30          = dword ptr -30h
var_2C          = dword ptr -2Ch
var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
var_1C          = dword ptr -1Ch
var_18          = dword ptr -18h
var_14          = dword ptr -14h
var_10          = dword ptr -10h
var_C           = dword ptr -0Ch
var_8           = dword ptr -8
var_4           = dword ptr -4
arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch
arg_8           = dword ptr  10h
arg_10          = dword ptr  18h
arg_14          = dword ptr  1Ch
arg_18          = dword ptr  20h

                push    ebp
                mov     ebp, esp
                sub     esp, 34h
                push    ebx
                push    esi
                push    edi
                mov     [ebp+var_28], 0
                mov     [ebp+var_24], offset ?TranslatorGuardHandler@@YA?AW4_EXCEPTION_DISPOSITION@@PAUEHExceptionRecord@@PAUTranslatorGuardRN@@PAX2@Z ; TranslatorGuardHandler(EHExceptionRecord *,TranslatorGuardRN *,void *,void *)
                mov     eax, dword ptr [ebp+arg_10]
                mov     [ebp+var_20], eax
                mov     ecx, dword ptr [ebp+arg_4]
                mov     [ebp+var_1C], ecx
                mov     edx, dword ptr [ebp+arg_14]
                mov     [ebp+var_18], edx
                mov     eax, dword ptr [ebp+arg_18]
                mov     [ebp+var_14], eax
                mov     [ebp+var_10], 0
                mov     [ebp+var_C], 0
                mov     [ebp+var_8], 0
                mov     [ebp+var_4], 0
                mov     [ebp+var_10], offset $ExceptionContinuation$12229
                mov     [ebp+var_C], esp
                mov     [ebp+var_8], ebp
                mov     eax, fs:0
                mov     [ebp+var_28], eax
                lea     eax, [ebp+var_28]
                mov     fs:0, eax
                mov     [ebp+var_34], 1
                mov     ecx, dword ptr [ebp+arg_0]
                mov     [ebp+var_30], ecx
                mov     edx, dword ptr [ebp+arg_8]
                mov     [ebp+var_2C], edx
                lea     eax, [ebp+var_30]
                push    eax
                mov     ecx, dword ptr [ebp+arg_0]
                mov     edx, dword ptr [ecx]
                push    edx
                call    __getptd
                call    dword ptr [eax+68h]
                add     esp, 8
                mov     [ebp+var_34], 0

$ExceptionContinuation$12229:           ; DATA XREF: _CallSETranslator(EHExceptionRecord *,EHRegistrationNode *,void *,void *,_s_FuncInfo const *,int,EHRegistrationNode *)+4B↑o
                cmp     [ebp+var_4], 0
                jz      short loc_5BE7F9
                mov     ebx, fs:0
                mov     eax, dword ptr [ebx]
                mov     ebx, dword ptr [ebp+var_28]
                mov     [ebx], eax
                mov     fs:0, ebx
                jmp     short loc_5BE802
; ---------------------------------------------------------------------------

loc_5BE7F9:                             ; CODE XREF: _CallSETranslator(EHExceptionRecord *,EHRegistrationNode *,void *,void *,_s_FuncInfo const *,int,EHRegistrationNode *)+A0↑j
                mov     eax, dword ptr [ebp+var_28]
                mov     fs:0, eax

loc_5BE802:                             ; CODE XREF: _CallSETranslator(EHExceptionRecord *,EHRegistrationNode *,void *,void *,_s_FuncInfo const *,int,EHRegistrationNode *)+B7↑j
                mov     eax, dword ptr [ebp+var_34]
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn
?_CallSETranslator@@YAHPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAX2PBU_s_FuncInfo@@H1@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static bp-based frame

; enum _EXCEPTION_DISPOSITION __cdecl TranslatorGuardHandler(PEXCEPTION_RECORD ExceptionRecord, PVOID TargetFrame, struct _CONTEXT *, void *)
?TranslatorGuardHandler@@YA?AW4_EXCEPTION_DISPOSITION@@PAUEHExceptionRecord@@PAUTranslatorGuardRN@@PAX2@Z proc near

ExceptionRecord = dword ptr  8
TargetFrame     = dword ptr  0Ch
arg_8           = dword ptr  10h

                push    ebp
                mov     ebp, esp
                push    ebx
                push    esi
                push    edi
                cld
                mov     eax, dword ptr [ebp+ExceptionRecord]
                mov     ecx, dword ptr [eax+4]
                and     ecx, 66h
                test    ecx, ecx
                jz      short loc_5BE835
                mov     edx, dword ptr [ebp+TargetFrame]
                mov     dword ptr [edx+24h], 1
                mov     eax, 1
                jmp     short loc_5BE88C
; ---------------------------------------------------------------------------

loc_5BE835:                             ; CODE XREF: TranslatorGuardHandler(EHExceptionRecord *,TranslatorGuardRN *,void *,void *)+12↑j
                push    1               ; char
                mov     eax, dword ptr [ebp+TargetFrame]
                mov     ecx, dword ptr [eax+14h]
                push    ecx             ; TargetFrame
                mov     edx, dword ptr [ebp+TargetFrame]
                mov     eax, dword ptr [edx+10h]
                push    eax             ; int
                mov     ecx, dword ptr [ebp+TargetFrame]
                mov     edx, dword ptr [ecx+8]
                push    edx             ; struct _s_FuncInfo *
                push    0               ; void *
                mov     eax, dword ptr [ebp+arg_8]
                push    eax             ; struct _CONTEXT *
                mov     ecx, dword ptr [ebp+TargetFrame]
                mov     edx, dword ptr [ecx+0Ch]
                push    edx             ; struct EHRegistrationNode *
                mov     eax, dword ptr [ebp+ExceptionRecord]
                push    eax             ; ExceptionRecord
                call    ___InternalCxxFrameHandler
                add     esp, 20h
                mov     ecx, dword ptr [ebp+TargetFrame]
                cmp     dword ptr [ecx+24h], 0
                jnz     short loc_5BE87B
                mov     edx, dword ptr [ebp+ExceptionRecord]
                push    edx             ; ExceptionRecord
                mov     eax, dword ptr [ebp+TargetFrame]
                push    eax             ; TargetFrame
                call    ?_UnwindNestedFrames@@YGXPAUEHRegistrationNode@@PAUEHExceptionRecord@@@Z ; _UnwindNestedFrames(EHRegistrationNode *,EHExceptionRecord *)

loc_5BE87B:                             ; CODE XREF: TranslatorGuardHandler(EHExceptionRecord *,TranslatorGuardRN *,void *,void *)+5C↑j
                mov     ebx, dword ptr [ebp+TargetFrame]
                mov     esp, [ebx+1Ch]
                mov     ebp, [ebx+20h]
                jmp     dword ptr [ebx+18h]
; ---------------------------------------------------------------------------
                mov     eax, 1

loc_5BE88C:                             ; CODE XREF: TranslatorGuardHandler(EHExceptionRecord *,TranslatorGuardRN *,void *,void *)+23↑j
                pop     edi
                pop     esi
                pop     ebx
                pop     ebp
                retn
?TranslatorGuardHandler@@YA?AW4_EXCEPTION_DISPOSITION@@PAUEHExceptionRecord@@PAUTranslatorGuardRN@@PAX2@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; const struct _s_TryBlockMapEntry *__cdecl _GetRangeOfTrysToCheck(const struct _s_FuncInfo *, int, int, unsigned int *, unsigned int *)
?_GetRangeOfTrysToCheck@@YAPBU_s_TryBlockMapEntry@@PBU_s_FuncInfo@@HHPAI1@Z proc near

var_4           = dword ptr -4
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h

                push    ecx
                mov     eax, dword ptr [esp+4+arg_0]
                push    ebx
                mov     ebx, dword ptr [esp+8+arg_4]
                push    ebp
                mov     ecx, dword ptr [eax+10h]
                push    esi
                mov     esi, [eax+0Ch]
                push    edi
                test    ebx, ebx
                mov     [esp+14h+var_4], ecx
                mov     ebp, esi
                mov     edi, esi
                jl      short loc_5BE8F4

loc_5BE8BF:                             ; CODE XREF: _GetRangeOfTrysToCheck(_s_FuncInfo const *,int,int,uint *,uint *)+4E↓j
                cmp     esi, 0FFFFFFFFh
                jnz     short loc_5BE8C9
                call    sub_5C6F90
; ---------------------------------------------------------------------------

loc_5BE8C9:                             ; CODE XREF: _GetRangeOfTrysToCheck(_s_FuncInfo const *,int,int,uint *,uint *)+22↑j
                mov     eax, dword ptr [esp+14h+var_4]
                dec     esi
                mov     ecx, dword ptr [esp+14h+arg_8]
                lea     edx, [esi+esi*4]
                lea     eax, [eax+edx*4]
                cmp     [eax+4], ecx
                jge     short loc_5BE8E2
                cmp     ecx, [eax+8]
                jle     short loc_5BE8E7

loc_5BE8E2:                             ; CODE XREF: _GetRangeOfTrysToCheck(_s_FuncInfo const *,int,int,uint *,uint *)+3B↑j
                cmp     esi, 0FFFFFFFFh
                jnz     short loc_5BE8EC

loc_5BE8E7:                             ; CODE XREF: _GetRangeOfTrysToCheck(_s_FuncInfo const *,int,int,uint *,uint *)+40↑j
                mov     ebp, edi
                dec     ebx
                mov     edi, esi

loc_5BE8EC:                             ; CODE XREF: _GetRangeOfTrysToCheck(_s_FuncInfo const *,int,int,uint *,uint *)+45↑j
                test    ebx, ebx
                jge     short loc_5BE8BF
                mov     eax, dword ptr [esp+14h+arg_0]

loc_5BE8F4:                             ; CODE XREF: _GetRangeOfTrysToCheck(_s_FuncInfo const *,int,int,uint *,uint *)+1D↑j
                mov     ecx, dword ptr [esp+14h+arg_C]
                mov     edx, dword ptr [esp+14h+arg_10]
                inc     esi
                mov     [ecx], esi
                mov     [edx], ebp
                cmp     ebp, [eax+0Ch]
                ja      short loc_5BE90A
                cmp     esi, ebp
                jbe     short loc_5BE90F

loc_5BE90A:                             ; CODE XREF: _GetRangeOfTrysToCheck(_s_FuncInfo const *,int,int,uint *,uint *)+64↑j
                call    sub_5C6F90
; ---------------------------------------------------------------------------

loc_5BE90F:                             ; CODE XREF: _GetRangeOfTrysToCheck(_s_FuncInfo const *,int,int,uint *,uint *)+68↑j
                mov     ecx, dword ptr [esp+14h+var_4]
                lea     eax, [esi+esi*4]
                pop     edi
                pop     esi
                pop     ebp
                lea     eax, [ecx+eax*4]
                pop     ebx
                pop     ecx
                retn
?_GetRangeOfTrysToCheck@@YAPBU_s_TryBlockMapEntry@@PBU_s_FuncInfo@@HHPAI1@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; int __cdecl _global_unwind2(PVOID TargetFrame)
__global_unwind2 proc near              ; CODE XREF: __except_handler3+5A↓p

TargetFrame     = dword ptr  8

                push    ebp
                mov     ebp, esp
                push    ebx
                push    esi
                push    edi
                push    ebp
                push    0               ; ReturnValue
                push    0               ; ExceptionRecord
                push    offset _gu_return ; TargetIp
                push    [ebp+TargetFrame] ; TargetFrame
                call    RtlUnwind

_gu_return:                             ; DATA XREF: __global_unwind2+B↑o
                pop     ebp
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn
__global_unwind2 endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__unwind_handler proc near              ; DATA XREF: __local_unwind2+A↓o

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_C           = dword ptr  10h

                mov     ecx, dword ptr [esp+arg_0]
                test    dword ptr [ecx+4], 6
                mov     eax, 1
                jz      short _uh_return
                mov     eax, dword ptr [esp+arg_4]
                mov     edx, dword ptr [esp+arg_C]
                mov     [edx], eax
                mov     eax, 3

_uh_return:                             ; CODE XREF: __unwind_handler+10↑j
                retn
__unwind_handler endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__local_unwind2 proc near               ; CODE XREF: __except_handler3+67↓p

var_14          = dword ptr -14h
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                push    ebx
                push    esi
                push    edi
                mov     eax, dword ptr [esp+0Ch+arg_0]
                push    eax
                push    0FFFFFFFEh
                push    offset __unwind_handler
                push    dword ptr fs:0
                mov     fs:0, esp

_lu_top:                                ; CODE XREF: __local_unwind2:__NLG_Return2↓j
                mov     eax, dword ptr [esp+1Ch+arg_0]
                mov     ebx, dword ptr [eax+8]
                mov     esi, [eax+0Ch]
                cmp     esi, 0FFFFFFFFh
                jz      short _lu_done
                cmp     esi, [esp+1Ch+arg_4]
                jz      short _lu_done
                lea     esi, [esi+esi*2]
                mov     ecx, dword ptr [ebx+esi*4]
                mov     [esp+1Ch+var_14], ecx
                mov     [eax+0Ch], ecx
                cmp     dword ptr [ebx+esi*4+4], 0
                jnz     short __NLG_Return2
                push    101h
                mov     eax, dword ptr [ebx+esi*4+8]
                call    __NLG_Notify
                call    dword ptr [ebx+esi*4+8]

__NLG_Return2:                          ; CODE XREF: __local_unwind2+44↑j
                jmp     short _lu_top
; ---------------------------------------------------------------------------

_lu_done:                               ; CODE XREF: __local_unwind2+2A↑j
                pop     dword ptr fs:0
                add     esp, 0Ch
                pop     edi
                pop     esi
                pop     ebx
                retn
__local_unwind2 endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _abnormal_termination()
__abnormal_termination proc near        ; CODE XREF: CallCatchBlock(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,_s_FuncInfo const *,void *,int,ulong)+136↓p
                xor     eax, eax
                mov     ecx, fs:0
                cmp     dword ptr [ecx+4], offset __unwind_handler
                jnz     short _at_done
                mov     edx, dword ptr [ecx+0Ch]
                mov     edx, dword ptr [edx+0Ch]
                cmp     [ecx+8], edx
                jnz     short _at_done
                mov     eax, 1

_at_done:                               ; CODE XREF: __abnormal_termination+10↑j
                retn
__abnormal_termination endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__NLG_Notify1   proc near               ; CODE XREF: _CallSettingFrame(x,x,x)+1E↓p
                push    ebx
                push    ecx
                mov     ebx, offset unk_63ED10
                jmp     short __NLG_Go
__NLG_Notify1   endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__NLG_Notify    proc near               ; CODE XREF: __local_unwind2+4F↑p
                push    ebx
                push    ecx
                mov     ebx, offset unk_63ED10
                mov     ecx, dword ptr [ebp+8]

__NLG_Go:                               ; CODE XREF: __NLG_Notify1+7↑j
                mov     [ebx+8], ecx
                mov     [ebx+4], eax
                mov     [ebx+0Ch], ebp

__NLG_Dispatch:
                pop     ecx
                pop     ebx
                retn    4
__NLG_Notify    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; void *__cdecl memcpy(void *, const void *Src, size_t varSize)
_memcpy         proc near               ; CODE XREF: sub_4019E0+1C0↑p

arg_0           = dword ptr  8
Src             = dword ptr  0Ch
varSize            = dword ptr  10h

                push    ebp
                mov     ebp, esp
                push    edi
                push    esi
                mov     esi, [ebp+Src]
                mov     ecx, dword ptr [ebp+varSize]
                mov     edi, [ebp+arg_0]
                mov     eax, ecx
                mov     edx, ecx
                add     eax, esi
                cmp     edi, esi
                jbe     short loc_5BEA30
                cmp     edi, eax
                jb      loc_5BEBA8

loc_5BEA30:                             ; CODE XREF: _memcpy+16↑j
                test    edi, 3
                jnz     short loc_5BEA4C
                shr     ecx, 2
                and     edx, 3
                cmp     ecx, 8          ; switch 8 cases
                jb      short loc_5BEA6C

def_5BEA6C:                             ; jumptable 005BEA6C default case
                rep movsd
                jmp     ds:jpt_5BEA45[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------

loc_5BEA4C:                             ; CODE XREF: _memcpy+26↑j
                mov     eax, edi
                mov     edx, 3
                sub     ecx, 4
                jb      short loc_5BEA64
                and     eax, 3
                add     ecx, eax
                jmp     dword ptr ds:loc_5BEA6C+4[eax*4]
; ---------------------------------------------------------------------------

loc_5BEA64:                             ; CODE XREF: _memcpy+46↑j
                jmp     dword ptr ds:loc_5BEB68[ecx*4] ; jumptable 005BEA45 case 0
; ---------------------------------------------------------------------------
                align 4

loc_5BEA6C:                             ; CODE XREF: _memcpy+31↑j
                jmp     ds:jpt_5BEA6C[ecx*4] ; switch jump
; ---------------------------------------------------------------------------
                align 4
                dd offset loc_5BEA80
                dd offset loc_5BEAAC
                dd offset loc_5BEAD0
; ---------------------------------------------------------------------------

loc_5BEA80:                             ; DATA XREF: _memcpy+64↑o
                and     edx, ecx
                mov     al, [esi]
                mov     [edi], al
                mov     al, [esi+1]
                mov     [edi+1], al
                mov     al, [esi+2]
                shr     ecx, 2
                mov     [edi+2], al
                add     esi, 3
                add     edi, 3
                cmp     ecx, 8
                jb      short loc_5BEA6C
                rep movsd
                jmp     ds:jpt_5BEA45[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 4

loc_5BEAAC:                             ; DATA XREF: _memcpy+68↑o
                and     edx, ecx
                mov     al, [esi]
                mov     [edi], al
                mov     al, [esi+1]
                shr     ecx, 2
                mov     [edi+1], al
                add     esi, 2
                add     edi, 2
                cmp     ecx, 8
                jb      short loc_5BEA6C
                rep movsd
                jmp     ds:jpt_5BEA45[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 10h

loc_5BEAD0:                             ; DATA XREF: _memcpy+6C↑o
                and     edx, ecx
                mov     al, [esi]
                mov     [edi], al
                inc     esi
                shr     ecx, 2
                inc     edi
                cmp     ecx, 8
                jb      short loc_5BEA6C
                rep movsd
                jmp     ds:jpt_5BEA45[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 4
jpt_5BEA6C      dd offset loc_5BEB4F    ; DATA XREF: _memcpy:loc_5BEA6C↑r
                dd offset loc_5BEB3C    ; jump table for switch statement
                dd offset loc_5BEB34
                dd offset loc_5BEB2C
                dd offset loc_5BEB24
                dd offset loc_5BEB1C
                dd offset loc_5BEB14
                dd offset loc_5BEB0C
; ---------------------------------------------------------------------------

loc_5BEB0C:                             ; CODE XREF: _memcpy:loc_5BEA6C↑j
                mov     eax, dword ptr [esi+ecx*4-1Ch] ; jumptable 005BEA6C case 7
                mov     [edi+ecx*4-1Ch], eax

loc_5BEB14:                             ; CODE XREF: _memcpy:loc_5BEA6C↑j
                mov     eax, dword ptr [esi+ecx*4-18h] ; jumptable 005BEA6C case 6
                mov     [edi+ecx*4-18h], eax

loc_5BEB1C:                             ; CODE XREF: _memcpy:loc_5BEA6C↑j
                mov     eax, dword ptr [esi+ecx*4-14h] ; jumptable 005BEA6C case 5
                mov     [edi+ecx*4-14h], eax

loc_5BEB24:                             ; CODE XREF: _memcpy:loc_5BEA6C↑j
                mov     eax, dword ptr [esi+ecx*4-10h] ; jumptable 005BEA6C case 4
                mov     [edi+ecx*4-10h], eax

loc_5BEB2C:                             ; CODE XREF: _memcpy:loc_5BEA6C↑j
                mov     eax, dword ptr [esi+ecx*4-0Ch] ; jumptable 005BEA6C case 3
                mov     [edi+ecx*4-0Ch], eax

loc_5BEB34:                             ; CODE XREF: _memcpy:loc_5BEA6C↑j
                mov     eax, dword ptr [esi+ecx*4-8] ; jumptable 005BEA6C case 2
                mov     [edi+ecx*4-8], eax

loc_5BEB3C:                             ; CODE XREF: _memcpy:loc_5BEA6C↑j
                mov     eax, dword ptr [esi+ecx*4-4] ; jumptable 005BEA6C case 1
                mov     [edi+ecx*4-4], eax
                lea     eax, ds:0[ecx*4]
                add     esi, eax
                add     edi, eax

loc_5BEB4F:                             ; CODE XREF: _memcpy:loc_5BEA6C↑j
                jmp     ds:jpt_5BEA45[edx*4] ; jumptable 005BEA6C case 0
; ---------------------------------------------------------------------------
                align 4
jpt_5BEA45      dd offset loc_5BEB68    ; DATA XREF: _memcpy+35↑r
                dd offset loc_5BEB70    ; jump table for switch statement
                dd offset loc_5BEB7C
                dd offset loc_5BEB90
; ---------------------------------------------------------------------------

loc_5BEB68:                             ; CODE XREF: _memcpy+35↑j
                mov     eax, dword ptr [ebp+arg_0] ; jumptable 005BEA45 case 0
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_5BEB70:                             ; CODE XREF: _memcpy+35↑j
                mov     al, [esi]       ; jumptable 005BEA45 case 1
                mov     [edi], al
                mov     eax, dword ptr [ebp+arg_0]
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 4

loc_5BEB7C:                             ; CODE XREF: _memcpy+35↑j
                mov     al, [esi]       ; jumptable 005BEA45 case 2
                mov     [edi], al
                mov     al, [esi+1]
                mov     [edi+1], al
                mov     eax, dword ptr [ebp+arg_0]
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_5BEB90:                             ; CODE XREF: _memcpy+35↑j
                mov     al, [esi]       ; jumptable 005BEA45 case 3
                mov     [edi], al
                mov     al, [esi+1]
                mov     [edi+1], al
                mov     al, [esi+2]
                mov     [edi+2], al
                mov     eax, dword ptr [ebp+arg_0]
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 4

loc_5BEBA8:                             ; CODE XREF: _memcpy+1A↑j
                lea     esi, [ecx+esi-4]
                lea     edi, [ecx+edi-4]
                test    edi, 3
                jnz     short loc_5BEBDC
                shr     ecx, 2
                and     edx, 3
                cmp     ecx, 8
                jb      short loc_5BEBD0
                std
                rep movsd
                cld
                jmp     ds:jpt_5BEBF4[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 10h

loc_5BEBD0:                             ; CODE XREF: _memcpy+1B1↑j
                neg     ecx
                jmp     ds:jpt_5BEBD2[ecx*4] ; switch 1 cases
; ---------------------------------------------------------------------------
                align 4

loc_5BEBDC:                             ; CODE XREF: _memcpy+1A6↑j
                mov     eax, edi
                mov     edx, 3
                cmp     ecx, 4          ; switch 4 cases
                jb      short loc_5BEBF4

def_5BEBF4:                             ; jumptable 005BEBF4 default case
                and     eax, 3
                sub     ecx, eax
                jmp     dword ptr ds:loc_5BEBF4+4[eax*4]
; ---------------------------------------------------------------------------

loc_5BEBF4:                             ; CODE XREF: _memcpy+1D6↑j
                jmp     ds:jpt_5BEBF4[ecx*4] ; switch jump
; ---------------------------------------------------------------------------
                align 4
                dd offset loc_5BEC07+1
; ---------------------------------------------------------------------------
                sub     ah, ch
                pop     ebx
                add     [eax-14h], dl
                pop     ebx

loc_5BEC07:                             ; DATA XREF: _memcpy+1EC↑o
                add     [edx-2EDCFCBAh], cl
                mov     [edi+3], al
                dec     esi
                shr     ecx, 2
                dec     edi
                cmp     ecx, 8
                jb      short loc_5BEBD0
                std
                rep movsd
                cld
                jmp     ds:jpt_5BEBF4[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 4
                mov     al, [esi+3]
                and     edx, ecx
                mov     [edi+3], al
                mov     al, [esi+2]
                shr     ecx, 2
                mov     [edi+2], al
                sub     esi, 2
                sub     edi, 2
                cmp     ecx, 8
                jb      short loc_5BEBD0
                std
                rep movsd
                cld
                jmp     ds:jpt_5BEBF4[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 10h
                mov     al, [esi+3]
                and     edx, ecx
                mov     [edi+3], al
                mov     al, [esi+2]
                mov     [edi+2], al
                mov     al, [esi+1]
                shr     ecx, 2
                mov     [edi+1], al
                sub     esi, 3
                sub     edi, 3
                cmp     ecx, 8
                jb      loc_5BEBD0
                std
                rep movsd
                cld
                jmp     ds:jpt_5BEBF4[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 4
                dd offset loc_5BECA4
                dd offset loc_5BECAC
                dd offset loc_5BECB4
                dd offset loc_5BECBC
                dd offset loc_5BECC4
                dd offset loc_5BECCC
                dd offset loc_5BECD4
jpt_5BEBD2      dd offset loc_5BECE7    ; DATA XREF: _memcpy+1C2↑r
; ---------------------------------------------------------------------------

loc_5BECA4:                             ; DATA XREF: _memcpy+274↑o
                mov     eax, dword ptr [esi+ecx*4+1Ch]
                mov     [edi+ecx*4+1Ch], eax

loc_5BECAC:                             ; DATA XREF: _memcpy+278↑o
                mov     eax, dword ptr [esi+ecx*4+18h]
                mov     [edi+ecx*4+18h], eax

loc_5BECB4:                             ; DATA XREF: _memcpy+27C↑o
                mov     eax, dword ptr [esi+ecx*4+14h]
                mov     [edi+ecx*4+14h], eax

loc_5BECBC:                             ; DATA XREF: _memcpy+280↑o
                mov     eax, dword ptr [esi+ecx*4+10h]
                mov     [edi+ecx*4+10h], eax

loc_5BECC4:                             ; DATA XREF: _memcpy+284↑o
                mov     eax, dword ptr [esi+ecx*4+0Ch]
                mov     [edi+ecx*4+0Ch], eax

loc_5BECCC:                             ; DATA XREF: _memcpy+288↑o
                mov     eax, dword ptr [esi+ecx*4+8]
                mov     [edi+ecx*4+8], eax

loc_5BECD4:                             ; DATA XREF: _memcpy+28C↑o
                mov     eax, dword ptr [esi+ecx*4+4]
                mov     [edi+ecx*4+4], eax
                lea     eax, ds:0[ecx*4]
                add     esi, eax
                add     edi, eax

loc_5BECE7:                             ; CODE XREF: _memcpy+1C2↑j
                jmp     ds:jpt_5BEBF4[edx*4] ; jumptable 005BEBD2 case 0
; ---------------------------------------------------------------------------
                align 10h
jpt_5BEBF4      dd offset loc_5BED00    ; DATA XREF: _memcpy+1B7↑r
                dd offset loc_5BED08    ; jump table for switch statement
                dd offset loc_5BED18
                dd offset loc_5BED2C
; ---------------------------------------------------------------------------

loc_5BED00:                             ; CODE XREF: _memcpy+1B7↑j
                mov     eax, dword ptr [ebp+arg_0] ; jumptable 005BEBC7 case 0
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 4

loc_5BED08:                             ; CODE XREF: _memcpy+1B7↑j
                mov     al, [esi+3]     ; jumptable 005BEBC7 case 1
                mov     [edi+3], al
                mov     eax, dword ptr [ebp+arg_0]
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 4

loc_5BED18:                             ; CODE XREF: _memcpy+1B7↑j
                mov     al, [esi+3]     ; jumptable 005BEBC7 case 2
                mov     [edi+3], al
                mov     al, [esi+2]
                mov     [edi+2], al
                mov     eax, dword ptr [ebp+arg_0]
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 4

loc_5BED2C:                             ; CODE XREF: _memcpy+1B7↑j
                mov     al, [esi+3]     ; jumptable 005BEBC7 case 3
                mov     [edi+3], al
                mov     al, [esi+2]
                mov     [edi+2], al
                mov     al, [esi+1]
                mov     [edi+1], al
                mov     eax, dword ptr [ebp+arg_0]
                pop     esi
                pop     edi
                leave
                retn
_memcpy         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void *__cdecl memset(void *, int Val, size_t varSize)
_memset         proc near               ; CODE XREF: sub_401E50+10↑p

arg_0           = dword ptr  4
Val             = dword ptr  8
varSize            = dword ptr  0Ch

                mov     edx, dword ptr [esp+varSize]
                mov     ecx, dword ptr [esp+arg_0]
                test    edx, edx
                jz      short toend
                xor     eax, eax
                mov     al, byte ptr [esp+Val]
                push    edi
                mov     edi, ecx
                cmp     edx, 4
                jb      short tail
                neg     ecx
                and     ecx, 3
                jz      short dwords
                sub     edx, ecx

adjust_loop:                            ; CODE XREF: _memset+27↓j
                mov     [edi], al
                inc     edi
                dec     ecx
                jnz     short adjust_loop

dwords:                                 ; CODE XREF: _memset+1F↑j
                mov     ecx, eax
                shl     eax, 8
                add     eax, ecx
                mov     ecx, eax
                shl     eax, 10h
                add     eax, ecx
                mov     ecx, edx
                and     edx, 3
                shr     ecx, 2
                jz      short tail
                rep stosd

main_loop_tail:
                test    edx, edx
                jz      short finish

tail:                                   ; CODE XREF: _memset+18↑j
                mov     [edi], al
                inc     edi
                dec     edx
                jnz     short tail

finish:                                 ; CODE XREF: _memset+45↑j
                mov     eax, dword ptr [esp+4+arg_0]
                pop     edi
                retn
; ---------------------------------------------------------------------------

toend:                                  ; CODE XREF: _memset+A↑j
                mov     eax, dword ptr [esp+arg_0]
                retn
_memset         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl strcmp(const char *Str1, const char *Str2)
_strcmp         proc near               ; CODE XREF: sub_402A20+11↑p

Str1            = dword ptr  4
Str2            = dword ptr  8

                mov     edx, dword ptr [esp+Str1]
                mov     ecx, dword ptr [esp+Str2]
                test    edx, 3
                jnz     short loc_5BEDFC

loc_5BEDC0:                             ; CODE XREF: _strcmp+3C↓j
                mov     eax, dword ptr [edx]
                cmp     al, [ecx]
                jnz     short loc_5BEDF4
                or      al, al
                jz      short loc_5BEDF0
                cmp     ah, [ecx+1]
                jnz     short loc_5BEDF4
                or      ah, ah
                jz      short loc_5BEDF0
                shr     eax, 10h
                cmp     al, [ecx+2]
                jnz     short loc_5BEDF4
                or      al, al
                jz      short loc_5BEDF0
                cmp     ah, [ecx+3]
                jnz     short loc_5BEDF4
                add     ecx, 4
                add     edx, 4
                or      ah, ah
                jnz     short loc_5BEDC0
                mov     eax, eax

loc_5BEDF0:                             ; CODE XREF: _strcmp+18↑j
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------
                align 4

loc_5BEDF4:                             ; CODE XREF: _strcmp+14↑j
                sbb     eax, eax
                shl     eax, 1
                inc     eax
                retn
; ---------------------------------------------------------------------------
                align 4

loc_5BEDFC:                             ; CODE XREF: _strcmp+E↑j
                test    edx, 1
                jz      short loc_5BEE18
                mov     al, [edx]
                inc     edx
                cmp     al, [ecx]
                jnz     short loc_5BEDF4
                inc     ecx
                or      al, al
                jz      short loc_5BEDF0
                test    edx, 2
                jz      short loc_5BEDC0

loc_5BEE18:                             ; CODE XREF: _strcmp+52↑j
                mov     ax, [edx]
                add     edx, 2
                cmp     al, [ecx]
                jnz     short loc_5BEDF4
                or      al, al
                jz      short loc_5BEDF0
                cmp     ah, [ecx+1]
                jnz     short loc_5BEDF4
                or      ah, ah
                jz      short loc_5BEDF0
                add     ecx, 2
                jmp     short loc_5BEDC0
_strcmp         endp

; ---------------------------------------------------------------------------
                align 10h



; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl atexit(void (__cdecl *)())
_atexit         proc near               ; CODE XREF: sub_402ACE+8↑p

Func            = dword ptr  4

                mov     eax, dword ptr [esp+Func]
                push    eax             ; Func
                call    __onexit
                add     esp, 4
                neg     eax
                sbb     eax, eax
                neg     eax
                dec     eax
                retn
_atexit         endp

; ---------------------------------------------------------------------------
                align 10h



; =============== S U B R O U T I N E =======================================

; Attributes: library function

__fpmath        proc near               ; CODE XREF: __cinit+9↓p
                call    __cfltcvt_init_0
                call    __ms_p5_mp_test_fdiv
                mov     dword_70D324, eax
                call    __setdefaultprecision
                fnclex
                retn
__fpmath        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


nullsub_1       proc near               ; CODE XREF: _threadstart(x)+4D↓p
                retn
nullsub_1       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__cfltcvt_init_0 proc near              ; CODE XREF: __fpmath↑p
                mov     eax, offset __cfltcvt
                mov     off_63F12C, offset __cropzeros
                mov     off_63F128, eax
                mov     off_63F130, offset __fassign
                mov     off_63F134, offset __forcdecpt
                mov     off_63F138, offset __positive
                mov     off_63F13C, eax
                retn
__cfltcvt_init_0 endp

; ---------------------------------------------------------------------------
                align 10h
                mov     ecx, dword ptr [esp+4]
                mov     eax, dword_70D320
                mov     dword_70D320, ecx
                retn






; =============== S U B R O U T I N E =======================================

; Attributes: library function

__CIsqrt        proc near

var_8           = qword ptr -8

                sub     esp, 8
                fst     [esp+8+var_8]
                call    __checkTOS_withFB
                call    loc_5BF10D
                add     esp, 8
                retn
__CIsqrt        endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl sqrt(double X)
_sqrt           proc near               ; CODE XREF: sub_403730+387↑p

var_4           = word ptr -4
X               = qword ptr  4

; FUNCTION CHUNK AT 005C860E SIZE 00000037 BYTES

                lea     edx, [esp+X]
                call    __fload_withFB

loc_5BF10D:                             ; CODE XREF: __CIsqrt+B↑p
                push    edx
                fstcw   [esp+4+var_4]
                mov     eax, dword ptr [esp+4+X+4]
                jz      short loc_5BF169
                cmp     [esp+4+var_4], 27Fh
                jz      short loc_5BF125
                call    __load_CW

loc_5BF125:                             ; CODE XREF: _sqrt+1A↑j
                test    eax, 80000000h
                jnz     short loc_5BF14B
                fsqrt

loc_5BF12E:                             ; CODE XREF: _sqrt+5C↓j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                mov     edx, 5
                lea     ecx, aSqrt      ; "sqrt"
                jmp     __math_exit
; ---------------------------------------------------------------------------

loc_5BF14B:                             ; CODE XREF: _sqrt+26↑j
                test    eax, 7FF00000h
                jnz     short loc_5BF17E
                test    eax, 0FFFFFh
                jnz     short loc_5BF17E
                cmp     dword ptr [esp+4+X], 0
                jnz     short loc_5BF17E
                jmp     short loc_5BF12E
; ---------------------------------------------------------------------------

loc_5BF162:                             ; CODE XREF: _sqrt+6A↓j
                call    __convertTOStoQNaN
                jmp     short loc_5BF18B
; ---------------------------------------------------------------------------

loc_5BF169:                             ; CODE XREF: _sqrt+12↑j
                test    eax, 0FFFFFh
                jnz     short loc_5BF162
                cmp     dword ptr [esp+4+X], 0
                jnz     short loc_5BF162
                and     eax, 80000000h
                jz      short loc_5BF12E

loc_5BF17E:                             ; CODE XREF: _sqrt+4C↑j
                fstp    st
                fld     tbyte ptr [tbyte_641230]
                mov     eax, 1

loc_5BF18B:                             ; CODE XREF: _sqrt+63↑j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                mov     edx, 5
                lea     ecx, aSqrt      ; "sqrt"
                call    __startOneArgErrorHandling
                pop     edx
                retn
_sqrt           endp

; ---------------------------------------------------------------------------
                align 4

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

__ftol          proc near               ; CODE XREF: sub_403730+398↑p

var_C           = qword ptr -0Ch
var_4           = word ptr -4
var_2           = word ptr -2

                push    ebp
                mov     ebp, esp
                add     esp, 0FFFFFFF4h
                fstcw   [ebp+var_2]
                wait
                mov     ax, [ebp+var_2]
                or      ah, 0Ch
                mov     [ebp+var_4], ax
                fldcw   [ebp+var_4]
                fistp   [ebp+var_C]
                fldcw   [ebp+var_2]
                mov     eax, dword ptr [ebp+var_C]
                mov     edx, dword ptr [ebp+var_C+4]
                leave
                retn
__ftol          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl abs(int Number)
_abs            proc near               ; CODE XREF: sub_404A2C+169↑p

Number          = dword ptr  4

                mov     eax, dword ptr [esp+Number]
                test    eax, eax
                jge     short locret_5BF1EA
                neg     eax

locret_5BF1EA:                          ; CODE XREF: _abs+6↑j
                retn
_abs            endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int sprintf(char *const Buffer, const char *const Format, ...)
_sprintf        proc near               ; CODE XREF: sub_406F7B+3BE6↑p

File            = FILE ptr -20h
Buffer          = dword ptr  4
Format          = dword ptr  8
arg_8           = dword ptr  0Ch

                sub     esp, 20h
                mov     eax, dword ptr [esp+20h+Buffer]
                mov     ecx, dword ptr [esp+20h+Format]
                mov     [esp+20h+File._base], eax
                mov     [esp+20h+File._ptr], eax
                lea     eax, [esp+20h+arg_8]
                push    esi
                push    eax             ; int
                lea     edx, [esp+28h+File]
                push    ecx             ; int
                push    edx             ; File
                mov     [esp+30h+File._flag], 42h ; 'B'
                mov     [esp+30h+File._cnt], 7FFFFFFFh
                call    __output
                mov     esi, eax
                mov     eax, dword ptr [esp+30h+File._cnt]
                add     esp, 0Ch
                dec     eax
                mov     [esp+24h+File._cnt], eax
                js      short loc_5BF242
                mov     eax, dword ptr [esp+24h+File._ptr]
                mov     byte ptr [eax], 0
                mov     eax, esi
                pop     esi
                add     esp, 20h
                retn
; ---------------------------------------------------------------------------

loc_5BF242:                             ; CODE XREF: _sprintf+42↑j
                lea     ecx, [esp+24h+File]
                push    ecx             ; File
                push    0               ; Ch
                call    __flsbuf
                add     esp, 8
                mov     eax, esi
                pop     esi
                add     esp, 20h
                retn
_sprintf        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__CItan         proc near

var_8           = qword ptr -8

                sub     esp, 8
                fst     [esp+8+var_8]
                call    __checkTOS_withFB
                call    loc_5BF27D
                add     esp, 8
                retn
__CItan         endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl tan(double X)
_tan            proc near               ; CODE XREF: sub_406F7B+1AB1↑p

var_4           = word ptr -4
X               = qword ptr  4

; FUNCTION CHUNK AT 005C860E SIZE 00000037 BYTES

                lea     edx, [esp+X]
                call    __fload_withFB

loc_5BF27D:                             ; CODE XREF: __CItan+B↑p
                push    edx
                fstcw   [esp+4+var_4]
                jz      short loc_5BF2D8
                cmp     [esp+4+var_4], 27Fh
                jz      short loc_5BF292
                fldcw   ds:word_614678

loc_5BF292:                             ; CODE XREF: _tan+16↑j
                fptan
                fstsw   ax
                fstp    st
                sahf
                jp      short loc_5BF2B9

loc_5BF29C:                             ; CODE XREF: _tan+5B↓j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                mov     edx, 20h ; ' '
                lea     ecx, aTan_0
                jmp     __math_exit
; ---------------------------------------------------------------------------

loc_5BF2B9:                             ; CODE XREF: _tan+26↑j
                fld     ds:tbyte_61467A
                fxch    st(1)

loc_5BF2C1:                             ; CODE XREF: _tan+53↓j
                fprem1
                fstsw   ax
                sahf
                jp      short loc_5BF2C1
                fstp    st(1)
                fptan
                fstp    st
                jmp     short loc_5BF29C
; ---------------------------------------------------------------------------

loc_5BF2D1:                             ; CODE XREF: _tan+69↓j
                call    __convertTOStoQNaN
                jmp     short loc_5BF2F3
; ---------------------------------------------------------------------------

loc_5BF2D8:                             ; CODE XREF: _tan+E↑j
                test    eax, 0FFFFFh
                jnz     short loc_5BF2D1
                cmp     dword ptr [esp+4+X], 0
                jnz     short loc_5BF2D1
                fstp    st
                fld     tbyte ptr [tbyte_641230]
                mov     eax, 1

loc_5BF2F3:                             ; CODE XREF: _tan+62↑j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                mov     edx, 20h ; ' '
                lea     ecx, aTan_0
                call    __startOneArgErrorHandling
                pop     edx
                retn
_tan            endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl strcpy(char *Destination, const char *Source)
_strcpy         proc near               ; CODE XREF: .text:0040D78D↑p

Destination     = dword ptr  4
Source          = dword ptr  8

                push    edi
                mov     edi, [esp+4+Destination]
                jmp     short loc_5BF391
_strcpy         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl strcat(char *Destination, const char *Source)
_strcat         proc near               ; CODE XREF: sub_41DA52+1EE↑p

Destination     = dword ptr  4
Source          = dword ptr  8

                mov     ecx, dword ptr [esp+Destination]
                push    edi
                test    ecx, 3
                jz      short loc_5BF34C

loc_5BF33D:                             ; CODE XREF: _strcat+1A↓j
                mov     al, [ecx]
                inc     ecx
                test    al, al
                jz      short loc_5BF37F
                test    ecx, 3
                jnz     short loc_5BF33D

loc_5BF34C:                             ; CODE XREF: _strcat+B↑j
                mov     eax, dword ptr [ecx]
                mov     edx, 7EFEFEFFh
                add     edx, eax
                xor     eax, 0FFFFFFFFh
                xor     eax, edx
                add     ecx, 4
                test    eax, 81010100h
                jz      short loc_5BF34C
                mov     eax, dword ptr [ecx-4]
                test    al, al
                jz      short loc_5BF38E
                test    ah, ah
                jz      short loc_5BF389
                test    eax, 0FF0000h
                jz      short loc_5BF384
                test    eax, 0FF000000h
                jz      short loc_5BF37F
                jmp     short loc_5BF34C
; ---------------------------------------------------------------------------

loc_5BF37F:                             ; CODE XREF: _strcat+12↑j
                lea     edi, [ecx-1]
                jmp     short loc_5BF391
; ---------------------------------------------------------------------------

loc_5BF384:                             ; CODE XREF: _strcat+44↑j
                lea     edi, [ecx-2]
                jmp     short loc_5BF391
; ---------------------------------------------------------------------------

loc_5BF389:                             ; CODE XREF: _strcat+3D↑j
                lea     edi, [ecx-3]
                jmp     short loc_5BF391
; ---------------------------------------------------------------------------

loc_5BF38E:                             ; CODE XREF: _strcat+39↑j
                lea     edi, [ecx-4]

loc_5BF391:                             ; CODE XREF: _strcpy+5↑j
                mov     ecx, dword ptr [esp+4+Source]
                test    ecx, 3
                jz      short loc_5BF3B6

loc_5BF39D:                             ; CODE XREF: _strcat+7D↓j
                mov     dl, [ecx]
                inc     ecx
                test    dl, dl
                jz      short loc_5BF408
                mov     [edi], dl
                inc     edi
                test    ecx, 3
                jnz     short loc_5BF39D
                jmp     short loc_5BF3B6
; ---------------------------------------------------------------------------

loc_5BF3B1:                             ; CODE XREF: _strcat+9E↓j
                mov     [edi], edx
                add     edi, 4

loc_5BF3B6:                             ; CODE XREF: _strcat+6B↑j
                mov     edx, 7EFEFEFFh
                mov     eax, dword ptr [ecx]
                add     edx, eax
                xor     eax, 0FFFFFFFFh
                xor     eax, edx
                mov     edx, dword ptr [ecx]
                add     ecx, 4
                test    eax, 81010100h
                jz      short loc_5BF3B1
                test    dl, dl
                jz      short loc_5BF408
                test    dh, dh
                jz      short loc_5BF3FF
                test    edx, 0FF0000h
                jz      short loc_5BF3F2
                test    edx, 0FF000000h
                jz      short loc_5BF3EA
                jmp     short loc_5BF3B1
; ---------------------------------------------------------------------------

loc_5BF3EA:                             ; CODE XREF: _strcat+B6↑j
                mov     [edi], edx
                mov     eax, dword ptr [esp+4+Destination]
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_5BF3F2:                             ; CODE XREF: _strcat+AE↑j
                mov     [edi], dx
                mov     eax, dword ptr [esp+4+Destination]
                mov     byte ptr [edi+2], 0
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_5BF3FF:                             ; CODE XREF: _strcat+A6↑j
                mov     [edi], dx
                mov     eax, dword ptr [esp+4+Destination]
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_5BF408:                             ; CODE XREF: _strcat+72↑j
                mov     [edi], dl
                mov     eax, dword ptr [esp+4+Destination]
                pop     edi
                retn
_strcat         endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void __thiscall type_info::~type_info(type_info *__hidden varThis)
??1type_info@@UAE@XZ proc near          ; CODE XREF: type_info::`scalar deleting destructor'(uint)+3↓p
                push    esi
                mov     esi, ecx
                push    1Bh
                mov     dword ptr [esi], offset ??_7type_info@@6B@ ; const type_info::`vftable'
                call    __lock
                mov     esi, [esi+4]
                add     esp, 4
                test    esi, esi
                jz      short loc_5BF433
                push    esi             ; Block
                call    _free
                add     esp, 4

loc_5BF433:                             ; CODE XREF: type_info::~type_info(void)+18↑j
                push    1Bh
                call    __unlock
                add     esp, 4
                pop     esi
                retn
??1type_info@@UAE@XZ endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void *__thiscall type_info::`scalar deleting destructor'(type_info *__hidden varThis, char)
??_Gtype_info@@UAEPAXI@Z proc near      ; DATA XREF: .rdata:const type_info::`vftable'↓o

arg_0           = byte ptr  4

                push    esi
                mov     esi, ecx
                call    ??1type_info@@UAE@XZ ; type_info::~type_info(void)
                test    [esp+4+arg_0], 1
                jz      short loc_5BF458
                push    esi             ; Block
                call    ??3@YAXPAX@Z    ; operator delete(void *)
                add     esp, 4

loc_5BF458:                             ; CODE XREF: type_info::`scalar deleting destructor'(uint)+D↑j
                mov     eax, esi
                pop     esi
                retn    4
??_Gtype_info@@UAEPAXI@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; public: int __thiscall type_info::operator==(class type_info const &)const
??8type_info@@QBEHABV0@@Z proc near

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                push    ebx
                push    esi
                lea     esi, [ecx+9]
                add     eax, 9

loc_5BF46C:                             ; CODE XREF: type_info::operator==(type_info const &)+2E↓j
                mov     dl, [eax]
                mov     bl, [esi]
                mov     cl, dl
                cmp     dl, bl
                jnz     short loc_5BF4A0
                test    cl, cl
                jz      short loc_5BF490
                mov     dl, [eax+1]
                mov     bl, [esi+1]
                mov     cl, dl
                cmp     dl, bl
                jnz     short loc_5BF4A0
                add     eax, 2
                add     esi, 2
                test    cl, cl
                jnz     short loc_5BF46C

loc_5BF490:                             ; CODE XREF: type_info::operator==(type_info const &)+18↑j
                xor     eax, eax
                xor     ecx, ecx
                test    eax, eax
                setz    cl
                mov     eax, ecx
                pop     esi
                pop     ebx
                retn    4
; ---------------------------------------------------------------------------

loc_5BF4A0:                             ; CODE XREF: type_info::operator==(type_info const &)+14↑j
                sbb     eax, eax
                pop     esi
                sbb     eax, 0FFFFFFFFh
                xor     ecx, ecx
                test    eax, eax
                setz    cl
                mov     eax, ecx
                pop     ebx
                retn    4
??8type_info@@QBEHABV0@@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; public: int __thiscall type_info::operator!=(class type_info const &)const
??9type_info@@QBEHABV0@@Z proc near

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                push    ebx
                push    esi
                lea     esi, [ecx+9]
                add     eax, 9

loc_5BF4CC:                             ; CODE XREF: type_info::operator!=(type_info const &)+2E↓j
                mov     dl, [eax]
                mov     bl, [esi]
                mov     cl, dl
                cmp     dl, bl
                jnz     short loc_5BF500
                test    cl, cl
                jz      short loc_5BF4F0
                mov     dl, [eax+1]
                mov     bl, [esi+1]
                mov     cl, dl
                cmp     dl, bl
                jnz     short loc_5BF500
                add     eax, 2
                add     esi, 2
                test    cl, cl
                jnz     short loc_5BF4CC

loc_5BF4F0:                             ; CODE XREF: type_info::operator!=(type_info const &)+18↑j
                xor     eax, eax
                xor     ecx, ecx
                test    eax, eax
                setnz   cl
                mov     eax, ecx
                pop     esi
                pop     ebx
                retn    4
; ---------------------------------------------------------------------------

loc_5BF500:                             ; CODE XREF: type_info::operator!=(type_info const &)+14↑j
                sbb     eax, eax
                pop     esi
                sbb     eax, 0FFFFFFFFh
                xor     ecx, ecx
                test    eax, eax
                setnz   cl
                mov     eax, ecx
                pop     ebx
                retn    4
??9type_info@@QBEHABV0@@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __thiscall type_info::before(type_info *__hidden varThis, const struct type_info *)
?before@type_info@@QBEHABV1@@Z proc near

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                push    ebx
                push    esi
                lea     esi, [ecx+9]
                add     eax, 9

loc_5BF52C:                             ; CODE XREF: type_info::before(type_info const &)+2E↓j
                mov     dl, [eax]
                mov     bl, [esi]
                mov     cl, dl
                cmp     dl, bl
                jnz     short loc_5BF560
                test    cl, cl
                jz      short loc_5BF550
                mov     dl, [eax+1]
                mov     bl, [esi+1]
                mov     cl, dl
                cmp     dl, bl
                jnz     short loc_5BF560
                add     eax, 2
                add     esi, 2
                test    cl, cl
                jnz     short loc_5BF52C

loc_5BF550:                             ; CODE XREF: type_info::before(type_info const &)+18↑j
                xor     eax, eax
                xor     ecx, ecx
                test    eax, eax
                setnle  cl
                mov     eax, ecx
                pop     esi
                pop     ebx
                retn    4
; ---------------------------------------------------------------------------

loc_5BF560:                             ; CODE XREF: type_info::before(type_info const &)+14↑j
                sbb     eax, eax
                pop     esi
                sbb     eax, 0FFFFFFFFh
                xor     ecx, ecx
                test    eax, eax
                setnle  cl
                mov     eax, ecx
                pop     ebx
                retn    4
?before@type_info@@QBEHABV1@@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; const char *__thiscall type_info::raw_name(type_info *__hidden varThis)
?raw_name@type_info@@QBEPBDXZ proc near
                lea     eax, [ecx+8]
                retn
?raw_name@type_info@@QBEPBDXZ endp

; ---------------------------------------------------------------------------
                align 10h
                mov     eax, ecx
                mov     dword ptr [eax], offset ??_7type_info@@6B@ ; const type_info::`vftable'
                retn    4
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; private: class type_info & __thiscall type_info::operator=(class type_info const &)
??4type_info@@AAEAAV0@ABV0@@Z proc near
                mov     eax, ecx
                retn    4
??4type_info@@AAEAAV0@ABV0@@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl isalpha(int C)
_isalpha        proc near               ; CODE XREF: sub_447842+14↑p

varC               = dword ptr  4

                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF5CC
                mov     eax, dword ptr [esp+varC]
                push    103h            ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5BF5CC:                             ; CODE XREF: _isalpha+7↑j
                mov     ecx, dword ptr [esp+varC]
                mov     edx, off_641268
                mov     ax, [edx+ecx*2]
                and     eax, 103h
                retn
_isalpha        endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl isupper(int C)
_isupper        proc near               ; CODE XREF: sub_513C82+2BE↑p

varC               = dword ptr  4

                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF5F9
                mov     eax, dword ptr [esp+varC]
                push    1               ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5BF5F9:                             ; CODE XREF: _isupper+7↑j
                mov     ecx, dword ptr [esp+varC]
                mov     edx, off_641268
                mov     al, [edx+ecx*2]
                and     eax, 1
                retn
_isupper        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl islower(int C)
_islower        proc near               ; CODE XREF: sub_5B156A+36A↑p

varC               = dword ptr  4

                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF629
                mov     eax, dword ptr [esp+varC]
                push    2               ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5BF629:                             ; CODE XREF: _islower+7↑j
                mov     ecx, dword ptr [esp+varC]
                mov     edx, off_641268
                mov     al, [edx+ecx*2]
                and     eax, 2
                retn
_islower        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl isdigit(int C)
_isdigit        proc near               ; CODE XREF: sub_4E87D3+941↑p

varC               = dword ptr  4

                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF659
                mov     eax, dword ptr [esp+varC]
                push    4               ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5BF659:                             ; CODE XREF: _isdigit+7↑j
                mov     ecx, dword ptr [esp+varC]
                mov     edx, off_641268
                mov     al, [edx+ecx*2]
                and     eax, 4
                retn
_isdigit        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl isxdigit(int C)
_isxdigit       proc near

varC               = dword ptr  4

                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF68C
                mov     eax, dword ptr [esp+varC]
                push    80h             ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5BF68C:                             ; CODE XREF: _isxdigit+7↑j
                mov     ecx, dword ptr [esp+varC]
                mov     edx, off_641268
                mov     al, [edx+ecx*2]
                and     eax, 80h
                retn
_isxdigit       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl isspace(int C)
_isspace        proc near               ; CODE XREF: sub_4E87D3+795↑p

varC               = dword ptr  4

                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF6B9
                mov     eax, dword ptr [esp+varC]
                push    8               ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5BF6B9:                             ; CODE XREF: _isspace+7↑j
                mov     ecx, dword ptr [esp+varC]
                mov     edx, off_641268
                mov     al, [edx+ecx*2]
                and     eax, 8
                retn
_isspace        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl ispunct(int C)
_ispunct        proc near

varC               = dword ptr  4

                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF6E9
                mov     eax, dword ptr [esp+varC]
                push    10h             ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5BF6E9:                             ; CODE XREF: _ispunct+7↑j
                mov     ecx, dword ptr [esp+varC]
                mov     edx, off_641268
                mov     al, [edx+ecx*2]
                and     eax, 10h
                retn
_ispunct        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl isalnum(int C)
_isalnum        proc near               ; CODE XREF: sub_4DA96A+B↑p

varC               = dword ptr  4

                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF71C
                mov     eax, dword ptr [esp+varC]
                push    107h            ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5BF71C:                             ; CODE XREF: _isalnum+7↑j
                mov     ecx, dword ptr [esp+varC]
                mov     edx, off_641268
                mov     ax, [edx+ecx*2]
                and     eax, 107h
                retn
_isalnum        endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl isprint(int C)
_isprint        proc near               ; CODE XREF: sub_40DA14+88A4↑p

varC               = dword ptr  4

                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF74C
                mov     eax, dword ptr [esp+varC]
                push    157h            ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5BF74C:                             ; CODE XREF: _isprint+7↑j
                mov     ecx, dword ptr [esp+varC]
                mov     edx, off_641268
                mov     ax, [edx+ecx*2]
                and     eax, 157h
                retn
_isprint        endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl isgraph(int C)
_isgraph        proc near

varC               = dword ptr  4

                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF77C
                mov     eax, dword ptr [esp+varC]
                push    117h            ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5BF77C:                             ; CODE XREF: _isgraph+7↑j
                mov     ecx, dword ptr [esp+varC]
                mov     edx, off_641268
                mov     ax, [edx+ecx*2]
                and     eax, 117h
                retn
_isgraph        endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl iscntrl(int C)
_iscntrl        proc near

varC               = dword ptr  4

                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF7A9
                mov     eax, dword ptr [esp+varC]
                push    20h ; ' '       ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5BF7A9:                             ; CODE XREF: _iscntrl+7↑j
                mov     ecx, dword ptr [esp+varC]
                mov     edx, off_641268
                mov     al, [edx+ecx*2]
                and     eax, 20h
                retn
_iscntrl        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __isascii(int C)
___isascii      proc near

varC               = dword ptr  4

                cmp     [esp+varC], 80h
                sbb     eax, eax
                neg     eax
                retn
___isascii      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __toascii(int C)
___toascii      proc near

varC               = dword ptr  4

                mov     eax, dword ptr [esp+varC]
                and     eax, 7Fh
                retn
___toascii      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __iscsymf(int C)
___iscsymf      proc near

varC               = dword ptr  4

                mov     eax, [g_SrcSizeInBytes]
                push    esi
                cmp     eax, 1
                jle     short loc_5BF7FF
                mov     esi, [esp+4+varC]
                push    103h            ; Type
                push    esi             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5BF811
; ---------------------------------------------------------------------------

loc_5BF7FF:                             ; CODE XREF: ___iscsymf+9↑j
                mov     esi, [esp+4+varC]
                mov     eax, off_641268
                mov     ax, [eax+esi*2]
                and     eax, 103h

loc_5BF811:                             ; CODE XREF: ___iscsymf+1D↑j
                test    eax, eax
                jnz     short loc_5BF81C
                cmp     esi, 5Fh ; '_'
                jz      short loc_5BF81C
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5BF81C:                             ; CODE XREF: ___iscsymf+33↑j
                mov     eax, 1
                pop     esi
                retn
___iscsymf      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __iscsym(int C)
___iscsym       proc near

varC               = dword ptr  4

                mov     eax, [g_SrcSizeInBytes]
                push    esi
                cmp     eax, 1
                jle     short loc_5BF84F
                mov     esi, [esp+4+varC]
                push    107h            ; Type
                push    esi             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5BF861
; ---------------------------------------------------------------------------

loc_5BF84F:                             ; CODE XREF: ___iscsym+9↑j
                mov     esi, [esp+4+varC]
                mov     eax, off_641268
                mov     ax, [eax+esi*2]
                and     eax, 107h

loc_5BF861:                             ; CODE XREF: ___iscsym+1D↑j
                test    eax, eax
                jnz     short loc_5BF86C
                cmp     esi, 5Fh ; '_'
                jz      short loc_5BF86C
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5BF86C:                             ; CODE XREF: ___iscsym+33↑j
                mov     eax, 1
                pop     esi
                retn
___iscsym       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl atol(const char *String)
_atol           proc near               ; CODE XREF: sub_449903+29↑p

String          = dword ptr  4

                push    ebx
                push    ebp
                push    esi
                push    edi
                mov     edi, [esp+10h+String]

loc_5BF888:                             ; CODE XREF: _atol+37↓j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF8A2
                xor     eax, eax
                push    8               ; Type
                mov     al, [edi]
                push    eax             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5BF8B2
; ---------------------------------------------------------------------------

loc_5BF8A2:                             ; CODE XREF: _atol+F↑j
                mov     edx, off_641268
                xor     ecx, ecx
                mov     cl, [edi]
                mov     al, [edx+ecx*2]
                and     eax, 8

loc_5BF8B2:                             ; CODE XREF: _atol+20↑j
                test    eax, eax
                jz      short loc_5BF8B9
                inc     edi
                jmp     short loc_5BF888
; ---------------------------------------------------------------------------

loc_5BF8B9:                             ; CODE XREF: _atol+34↑j
                xor     eax, eax
                mov     al, [edi]
                inc     edi
                mov     esi, eax
                cmp     esi, 2Dh ; '-'
                mov     ebp, esi
                jz      short loc_5BF8CC
                cmp     esi, 2Bh ; '+'
                jnz     short loc_5BF8D3

loc_5BF8CC:                             ; CODE XREF: _atol+45↑j
                xor     ecx, ecx
                mov     cl, [edi]
                inc     edi
                mov     esi, ecx

loc_5BF8D3:                             ; CODE XREF: _atol+4A↑j
                xor     ebx, ebx

loc_5BF8D5:                             ; CODE XREF: _atol+89↓j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF8EB
                push    4               ; Type
                push    esi             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5BF8F7
; ---------------------------------------------------------------------------

loc_5BF8EB:                             ; CODE XREF: _atol+5C↑j
                mov     edx, off_641268
                mov     al, [edx+esi*2]
                and     eax, 4

loc_5BF8F7:                             ; CODE XREF: _atol+69↑j
                test    eax, eax
                jz      short loc_5BF90B
                lea     eax, [ebx+ebx*4]
                xor     ecx, ecx
                mov     cl, [edi]
                inc     edi
                lea     ebx, [esi+eax*2-30h]
                mov     esi, ecx
                jmp     short loc_5BF8D5
; ---------------------------------------------------------------------------

loc_5BF90B:                             ; CODE XREF: _atol+79↑j
                cmp     ebp, 2Dh ; '-'
                mov     eax, ebx
                jnz     short loc_5BF914
                neg     eax

loc_5BF914:                             ; CODE XREF: _atol+90↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
_atol           endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl atoi(const char *String)
_atoi           proc near               ; CODE XREF: sub_40DA14+87F9↑p

String          = dword ptr  4

                mov     eax, dword ptr [esp+String]
                push    eax             ; String
                call    _atol
                add     esp, 4
                retn
_atoi           endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; __int64 __cdecl _atoi64(const char *String)
__atoi64        proc near

var_4           = dword ptr -4
String          = dword ptr  4

                push    ecx
                push    ebx
                push    ebp
                push    esi
                push    edi
                mov     edi, [esp+14h+String]

loc_5BF939:                             ; CODE XREF: __atoi64+38↓j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF953
                xor     eax, eax
                push    8               ; Type
                mov     al, [edi]
                push    eax             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5BF963
; ---------------------------------------------------------------------------

loc_5BF953:                             ; CODE XREF: __atoi64+10↑j
                mov     edx, off_641268
                xor     ecx, ecx
                mov     cl, [edi]
                mov     al, [edx+ecx*2]
                and     eax, 8

loc_5BF963:                             ; CODE XREF: __atoi64+21↑j
                test    eax, eax
                jz      short loc_5BF96A
                inc     edi
                jmp     short loc_5BF939
; ---------------------------------------------------------------------------

loc_5BF96A:                             ; CODE XREF: __atoi64+35↑j
                xor     eax, eax
                mov     al, [edi]
                inc     edi
                mov     esi, eax
                cmp     esi, 2Dh ; '-'
                mov     [esp+14h+var_4], esi
                jz      short loc_5BF97F
                cmp     esi, 2Bh ; '+'
                jnz     short loc_5BF986

loc_5BF97F:                             ; CODE XREF: __atoi64+48↑j
                xor     ecx, ecx
                mov     cl, [edi]
                inc     edi
                mov     esi, ecx

loc_5BF986:                             ; CODE XREF: __atoi64+4D↑j
                xor     ebx, ebx
                xor     ebp, ebp

loc_5BF98A:                             ; CODE XREF: __atoi64+AA↓j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5BF9A0
                push    4               ; Type
                push    esi             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5BF9AC
; ---------------------------------------------------------------------------

loc_5BF9A0:                             ; CODE XREF: __atoi64+61↑j
                mov     edx, off_641268
                mov     al, [edx+esi*2]
                and     eax, 4

loc_5BF9AC:                             ; CODE XREF: __atoi64+6E↑j
                test    eax, eax
                jz      short loc_5BF9DC
                lea     eax, [esi-30h]
                push    0
                cdq
                mov     esi, eax
                push    0Ah
                push    ebp
                mov     [esp+20h+String], esi
                push    ebx
                mov     esi, edx
                call    __allmul
                mov     ecx, dword ptr [esp+14h+String]
                add     ecx, eax
                adc     esi, edx
                xor     edx, edx
                mov     dl, [edi]
                mov     ebp, esi
                mov     ebx, ecx
                mov     esi, edx
                inc     edi
                jmp     short loc_5BF98A
; ---------------------------------------------------------------------------

loc_5BF9DC:                             ; CODE XREF: __atoi64+7E↑j
                mov     eax, dword ptr [esp+14h+var_4]
                cmp     eax, 2Dh ; '-'
                mov     eax, ebx
                jnz     short loc_5BF9F6
                neg     eax
                mov     edx, ebp
                adc     edx, 0
                neg     edx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5BF9F6:                             ; CODE XREF: __atoi64+B5↑j
                pop     edi
                mov     edx, ebp
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
__atoi64        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl strstr(const char *varStr, const char *varSubStr)
_strstr         proc near               ; CODE XREF: sub_40DA14+87A6↑p

varStr             = dword ptr  4
varSubStr          = dword ptr  8

                mov     ecx, dword ptr [esp+varSubStr]
                push    edi
                push    ebx
                push    esi
                mov     dl, [ecx]
                mov     edi, [esp+0Ch+varStr]
                test    dl, dl
                jz      short empty_str2
                mov     dh, [ecx+1]
                test    dh, dh
                jz      short strchr_call

findnext:                               ; CODE XREF: _strstr+52↓j
                mov     esi, edi
                mov     ecx, dword ptr [esp+0Ch+varSubStr]
                mov     al, [edi]
                inc     esi
                cmp     al, dl
                jz      short first_char_found
                test    al, al
                jz      short not_found

loop_start:                             ; CODE XREF: _strstr+32↓j
                mov     al, [esi]
                inc     esi

in_loop:                                ; CODE XREF: _strstr+3F↓j
                cmp     al, dl
                jz      short first_char_found
                test    al, al
                jnz     short loop_start

not_found:                              ; CODE XREF: _strstr+27↑j
                pop     esi
                pop     ebx
                pop     edi
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------

first_char_found:                       ; CODE XREF: _strstr+23↑j
                mov     al, [esi]
                inc     esi
                cmp     al, dh
                jnz     short in_loop

two_first_chars_equal:
                lea     edi, [esi-1]

compare_loop:                           ; CODE XREF: _strstr+63↓j
                mov     ah, [ecx+2]
                test    ah, ah
                jz      short match
                mov     al, [esi]
                add     esi, 2
                cmp     al, ah
                jnz     short findnext
                mov     al, [ecx+3]
                test    al, al
                jz      short match
                mov     ah, [esi-1]
                add     ecx, 2
                cmp     al, ah
                jz      short compare_loop
                jmp     short findnext
; ---------------------------------------------------------------------------

strchr_call:                            ; CODE XREF: _strstr+16↑j
                xor     eax, eax
                pop     esi
                pop     ebx
                pop     edi
                mov     al, dl
                jmp     ___from_strstr_to_strchr
; ---------------------------------------------------------------------------

match:                                  ; CODE XREF: _strstr+49↑j
                lea     eax, [edi-1]
                pop     esi
                pop     ebx
                pop     edi
                retn
; ---------------------------------------------------------------------------

empty_str2:                             ; CODE XREF: _strstr+F↑j
                mov     eax, edi
                pop     esi
                pop     ebx
                pop     edi
                retn
_strstr         endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl strncpy(char *Destination, const char *Source, size_t Count)
_strncpy        proc near               ; CODE XREF: sub_40DA14+6602↑p

Destination     = dword ptr  4
Source          = dword ptr  8
Count           = dword ptr  0Ch

                mov     ecx, dword ptr [esp+Count]
                push    edi
                test    ecx, ecx
                jz      short finish_0
                push    esi
                push    ebx
                mov     ebx, ecx
                mov     esi, [esp+0Ch+Source]
                test    esi, 3
                mov     edi, [esp+0Ch+Destination]
                jnz     short src_misaligned
                shr     ecx, 2
                jnz     short main_loop_entrance
                jmp     short copy_tail_loop
; ---------------------------------------------------------------------------

src_misaligned:                         ; CODE XREF: _strncpy+1B↑j
                mov     al, [esi]
                inc     esi
                mov     [edi], al
                inc     edi
                dec     ecx
                jz      short fill_tail_end1
                test    al, al
                jz      short align_dest
                test    esi, 3
                jnz     short src_misaligned
                mov     ebx, ecx
                shr     ecx, 2
                jnz     short main_loop_entrance

tail_loop_start:                        ; CODE XREF: _strncpy+8F↓j
                and     ebx, 3
                jz      short fill_tail_end1

copy_tail_loop:                         ; CODE XREF: _strncpy+22↑j
                mov     al, [esi]
                inc     esi
                mov     [edi], al
                inc     edi
                test    al, al
                jz      short fill_tail_zero_bytes
                dec     ebx
                jnz     short copy_tail_loop

fill_tail_end1:                         ; CODE XREF: _strncpy+2B↑j
                mov     eax, dword ptr [esp+0Ch+Destination]
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------

align_dest:                             ; CODE XREF: _strncpy+2F↑j
                test    edi, 3
                jz      short dest_align_loop_end

dest_align_loop:                        ; CODE XREF: _strncpy+72↓j
                mov     [edi], al
                inc     edi
                dec     ecx
                jz      fill_tail_end
                test    edi, 3
                jnz     short dest_align_loop

dest_align_loop_end:                    ; CODE XREF: _strncpy+60↑j
                mov     ebx, ecx
                shr     ecx, 2
                jnz     short fill_dwords_with_EOS

finish_loop:                            ; CODE XREF: _strncpy+7F↓j
                mov     [edi], al
                inc     edi

fill_tail_zero_bytes:                   ; CODE XREF: _strncpy+4D↑j
                dec     ebx
                jnz     short finish_loop
                pop     ebx
                pop     esi

finish_0:                               ; CODE XREF: _strncpy+7↑j
                mov     eax, dword ptr [esp+4+Destination]
                pop     edi
                retn
; ---------------------------------------------------------------------------

main_loop:                              ; CODE XREF: _strncpy+A9↓j
                mov     [edi], edx
                add     edi, 4
                dec     ecx
                jz      short tail_loop_start

main_loop_entrance:                     ; CODE XREF: _strncpy+20↑j
                mov     edx, 7EFEFEFFh
                mov     eax, dword ptr [esi]
                add     edx, eax
                xor     eax, 0FFFFFFFFh
                xor     eax, edx
                mov     edx, dword ptr [esi]
                add     esi, 4
                test    eax, 81010100h
                jz      short main_loop
                test    dl, dl
                jz      short _byte_0
                test    dh, dh
                jz      short _byte_1
                test    edx, 0FF0000h
                jz      short _byte_2
                test    edx, 0FF000000h
                jnz     short main_loop
                mov     [edi], edx
                jmp     short fill_with_EOS_dwords
; ---------------------------------------------------------------------------

_byte_2:                                ; CODE XREF: _strncpy+B9↑j
                and     edx, 0FFFFh
                mov     [edi], edx
                jmp     short fill_with_EOS_dwords
; ---------------------------------------------------------------------------

_byte_1:                                ; CODE XREF: _strncpy+B1↑j
                and     edx, 0FFh
                mov     [edi], edx
                jmp     short fill_with_EOS_dwords
; ---------------------------------------------------------------------------

_byte_0:                                ; CODE XREF: _strncpy+AD↑j
                xor     edx, edx
                mov     [edi], edx

fill_with_EOS_dwords:                   ; CODE XREF: _strncpy+C5↑j
                add     edi, 4
                xor     eax, eax
                dec     ecx
                jz      short fill_tail

fill_dwords_with_EOS:                   ; CODE XREF: _strncpy+79↑j
                xor     eax, eax

fill_with_EOS_loop:                     ; CODE XREF: _strncpy+EF↓j
                mov     [edi], eax
                add     edi, 4
                dec     ecx
                jnz     short fill_with_EOS_loop

fill_tail:                              ; CODE XREF: _strncpy+E5↑j
                and     ebx, 3
                jnz     short finish_loop

fill_tail_end:                          ; CODE XREF: _strncpy+66↑j
                mov     eax, dword ptr [esp+0Ch+Destination]
                pop     ebx
                pop     esi
                pop     edi
                retn
_strncpy        endp

; ---------------------------------------------------------------------------
                align 10h
; START OF FUNCTION CHUNK FOR _strchr

loc_5BFB80:                             ; CODE XREF: _strchr+1D↓j
                lea     eax, [edx-1]
                pop     ebx
                retn
; END OF FUNCTION CHUNK FOR _strchr
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl strchr(const char *varStr, int Val)
_strchr         proc near               ; CODE XREF: sub_40DA14+2759↑p

varStr             = dword ptr  4
Val             = dword ptr  8

; FUNCTION CHUNK AT 005BFB80 SIZE 00000005 BYTES

                xor     eax, eax
                mov     al, byte ptr [esp+Val]

___from_strstr_to_strchr:               ; CODE XREF: _strstr+6E↑j
                push    ebx
                mov     ebx, eax
                shl     eax, 8
                mov     edx, dword ptr [esp+4+varStr]
                test    edx, 3
                jz      short loc_5BFBBB

loc_5BFBA8:                             ; CODE XREF: _strchr+29↓j
                mov     cl, [edx]
                inc     edx
                cmp     cl, bl
                jz      short loc_5BFB80
                test    cl, cl
                jz      short loc_5BFC04
                test    edx, 3
                jnz     short loc_5BFBA8

loc_5BFBBB:                             ; CODE XREF: _strchr+16↑j
                or      ebx, eax
                push    edi
                mov     eax, ebx
                shl     ebx, 10h
                push    esi
                or      ebx, eax

loc_5BFBC6:                             ; CODE XREF: _strchr+61↓j
                mov     ecx, dword ptr [edx]
                mov     edi, 7EFEFEFFh
                mov     eax, ecx
                mov     esi, edi
                xor     ecx, ebx
                add     esi, eax
                add     edi, ecx
                xor     ecx, 0FFFFFFFFh
                xor     eax, 0FFFFFFFFh
                xor     ecx, edi
                xor     eax, esi
                add     edx, 4
                and     ecx, 81010100h
                jnz     short loc_5BFC08
                and     eax, 81010100h
                jz      short loc_5BFBC6
                and     eax, 1010100h
                jnz     short loc_5BFC02
                and     esi, 80000000h
                jnz     short loc_5BFBC6

loc_5BFC02:                             ; CODE XREF: _strchr+68↑j
                pop     esi
                pop     edi

loc_5BFC04:                             ; CODE XREF: _strchr+21↑j
                pop     ebx
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------

loc_5BFC08:                             ; CODE XREF: _strchr+5A↑j
                mov     eax, dword ptr [edx-4]
                cmp     al, bl
                jz      short loc_5BFC45
                test    al, al
                jz      short loc_5BFC02
                cmp     ah, bl
                jz      short loc_5BFC3E
                test    ah, ah
                jz      short loc_5BFC02
                shr     eax, 10h
                cmp     al, bl
                jz      short loc_5BFC37
                test    al, al
                jz      short loc_5BFC02
                cmp     ah, bl
                jz      short loc_5BFC30
                test    ah, ah
                jz      short loc_5BFC02
                jmp     short loc_5BFBC6
; ---------------------------------------------------------------------------

loc_5BFC30:                             ; CODE XREF: _strchr+98↑j
                pop     esi
                pop     edi
                lea     eax, [edx-1]
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5BFC37:                             ; CODE XREF: _strchr+90↑j
                lea     eax, [edx-2]
                pop     esi
                pop     edi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5BFC3E:                             ; CODE XREF: _strchr+85↑j
                lea     eax, [edx-3]
                pop     esi
                pop     edi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5BFC45:                             ; CODE XREF: _strchr+7D↑j
                lea     eax, [edx-4]
                pop     esi
                pop     edi
                pop     ebx
                retn
_strchr         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__alloca_probe  proc near               ; CODE XREF: sub_40DA14+1E↑p

arg_0           = byte ptr  4

                push    ecx
                cmp     eax, 1000h
                lea     ecx, [esp+4+arg_0]
                jb      short lastpage

probepages:                             ; CODE XREF: __alloca_probe+1E↓j
                sub     ecx, 1000h
                sub     eax, 1000h
                test    [ecx], eax
                cmp     eax, 1000h
                jnb     short probepages

lastpage:                               ; CODE XREF: __alloca_probe+A↑j
                sub     ecx, eax
                mov     eax, esp
                test    [ecx], eax
                mov     esp, ecx
                mov     ecx, dword ptr [eax]
                mov     eax, dword ptr [eax+4]
                push    eax
                retn
__alloca_probe  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================



_exp      proc near               ; CODE XREF: sub_41B7B7+CF↑p
                mov     edx, offset unk_6414BA
                jmp     __ctrandisp1
_exp      endp


; ---------------------------------------------------------------------------
                mov     edx, offset unk_6414BA
                jmp     __cintrindisp1
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void __cdecl srand(unsigned int Seed)
_srand          proc near               ; CODE XREF: sub_45C489+6D↑p

Seed            = dword ptr  4

                call    __getptd
                mov     ecx, dword ptr [esp+Seed]
                mov     [eax+14h], ecx
                retn
_srand          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl rand()
_rand           proc near               ; CODE XREF: sub_41B8D0+AA7↑p
                call    __getptd
                mov     ecx, dword ptr [eax+14h]
                lea     edx, [ecx+ecx*2]
                lea     edx, [ecx+edx*4]
                shl     edx, 4
                add     edx, ecx
                shl     edx, 8
                sub     edx, ecx
                lea     ecx, [ecx+edx*4+269EC3h]
                mov     [eax+14h], ecx
                mov     eax, ecx
                shr     eax, 10h
                and     eax, 7FFFh
                retn
_rand           endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; size_t __cdecl strlen(const char *varStr)
_strlen         proc near               ; CODE XREF: sub_41DA52+1D2↑p

varStr             = dword ptr  4

                mov     ecx, dword ptr [esp+varStr]
                test    ecx, 3
                jz      short main_loop_0

str_misaligned:                         ; CODE XREF: _strlen+19↓j
                mov     al, [ecx]
                inc     ecx
                test    al, al
                jz      short _byte_3
                test    ecx, 3
                jnz     short str_misaligned
                add     eax, 0

main_loop_0:                            ; CODE XREF: _strlen+A↑j
                mov     eax, dword ptr [ecx]
                mov     edx, 7EFEFEFFh
                add     edx, eax
                xor     eax, 0FFFFFFFFh
                xor     eax, edx
                add     ecx, 4
                test    eax, 81010100h
                jz      short main_loop_0
                mov     eax, dword ptr [ecx-4]
                test    al, al
                jz      short loc_5BFD51
                test    ah, ah
                jz      short loc_5BFD47
                test    eax, 0FF0000h
                jz      short loc_5BFD3D
                test    eax, 0FF000000h
                jz      short _byte_3
                jmp     short main_loop_0
; ---------------------------------------------------------------------------

_byte_3:                                ; CODE XREF: _strlen+11↑j
                lea     eax, [ecx-1]
                mov     ecx, dword ptr [esp+varStr]
                sub     eax, ecx
                retn
; ---------------------------------------------------------------------------

loc_5BFD3D:                             ; CODE XREF: _strlen+48↑j
                lea     eax, [ecx-2]
                mov     ecx, dword ptr [esp+varStr]
                sub     eax, ecx
                retn
; ---------------------------------------------------------------------------

loc_5BFD47:                             ; CODE XREF: _strlen+41↑j
                lea     eax, [ecx-3]
                mov     ecx, dword ptr [esp+varStr]
                sub     eax, ecx
                retn
; ---------------------------------------------------------------------------

loc_5BFD51:                             ; CODE XREF: _strlen+3D↑j
                lea     eax, [ecx-4]
                mov     ecx, dword ptr [esp+varStr]
                sub     eax, ecx
                retn
_strlen         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; void *__cdecl memcpy_0(void *, const void *Src, size_t varSize)
_memcpy_0       proc near               ; CODE XREF: sub_41FC80+81↑p

arg_0           = dword ptr  8
Src             = dword ptr  0Ch
varSize            = dword ptr  10h

                push    ebp
                mov     ebp, esp
                push    edi
                push    esi
                mov     esi, [ebp+Src]
                mov     ecx, dword ptr [ebp+varSize]
                mov     edi, [ebp+arg_0]
                mov     eax, ecx
                mov     edx, ecx
                add     eax, esi
                cmp     edi, esi
                jbe     short loc_5BFD80
                cmp     edi, eax
                jb      loc_5BFEF8

loc_5BFD80:                             ; CODE XREF: _memcpy_0+16↑j
                test    edi, 3
                jnz     short loc_5BFD9C
                shr     ecx, 2
                and     edx, 3
                cmp     ecx, 8          ; switch 8 cases
                jb      short loc_5BFDBC

def_5BFDBC:                             ; jumptable 005BFDBC default case
                rep movsd
                jmp     ds:jpt_5BFD95[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------

loc_5BFD9C:                             ; CODE XREF: _memcpy_0+26↑j
                mov     eax, edi
                mov     edx, 3
                sub     ecx, 4
                jb      short loc_5BFDB4
                and     eax, 3
                add     ecx, eax
                jmp     dword ptr ds:loc_5BFDBC+4[eax*4]
; ---------------------------------------------------------------------------

loc_5BFDB4:                             ; CODE XREF: _memcpy_0+46↑j
                jmp     dword ptr ds:loc_5BFEB8[ecx*4] ; jumptable 005BFD95 case 0
; ---------------------------------------------------------------------------
                align 4

loc_5BFDBC:                             ; CODE XREF: _memcpy_0+31↑j
                jmp     ds:jpt_5BFDBC[ecx*4] ; switch jump
; ---------------------------------------------------------------------------
                align 4
                dd offset loc_5BFDD0
                dd offset loc_5BFDFC
                dd offset loc_5BFE20
; ---------------------------------------------------------------------------

loc_5BFDD0:                             ; DATA XREF: _memcpy_0+64↑o
                and     edx, ecx
                mov     al, [esi]
                mov     [edi], al
                mov     al, [esi+1]
                mov     [edi+1], al
                mov     al, [esi+2]
                shr     ecx, 2
                mov     [edi+2], al
                add     esi, 3
                add     edi, 3
                cmp     ecx, 8
                jb      short loc_5BFDBC
                rep movsd
                jmp     ds:jpt_5BFD95[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 4

loc_5BFDFC:                             ; DATA XREF: _memcpy_0+68↑o
                and     edx, ecx
                mov     al, [esi]
                mov     [edi], al
                mov     al, [esi+1]
                shr     ecx, 2
                mov     [edi+1], al
                add     esi, 2
                add     edi, 2
                cmp     ecx, 8
                jb      short loc_5BFDBC
                rep movsd
                jmp     ds:jpt_5BFD95[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 10h

loc_5BFE20:                             ; DATA XREF: _memcpy_0+6C↑o
                and     edx, ecx
                mov     al, [esi]
                mov     [edi], al
                inc     esi
                shr     ecx, 2
                inc     edi
                cmp     ecx, 8
                jb      short loc_5BFDBC
                rep movsd
                jmp     ds:jpt_5BFD95[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 4
jpt_5BFDBC      dd offset loc_5BFE9F    ; DATA XREF: _memcpy_0:loc_5BFDBC↑r
                dd offset loc_5BFE8C    ; jump table for switch statement
                dd offset loc_5BFE84
                dd offset loc_5BFE7C
                dd offset loc_5BFE74
                dd offset loc_5BFE6C
                dd offset loc_5BFE64
                dd offset loc_5BFE5C
; ---------------------------------------------------------------------------

loc_5BFE5C:                             ; CODE XREF: _memcpy_0:loc_5BFDBC↑j
                mov     eax, dword ptr [esi+ecx*4-1Ch] ; jumptable 005BFDBC case 7
                mov     [edi+ecx*4-1Ch], eax

loc_5BFE64:                             ; CODE XREF: _memcpy_0:loc_5BFDBC↑j
                mov     eax, dword ptr [esi+ecx*4-18h] ; jumptable 005BFDBC case 6
                mov     [edi+ecx*4-18h], eax

loc_5BFE6C:                             ; CODE XREF: _memcpy_0:loc_5BFDBC↑j
                mov     eax, dword ptr [esi+ecx*4-14h] ; jumptable 005BFDBC case 5
                mov     [edi+ecx*4-14h], eax

loc_5BFE74:                             ; CODE XREF: _memcpy_0:loc_5BFDBC↑j
                mov     eax, dword ptr [esi+ecx*4-10h] ; jumptable 005BFDBC case 4
                mov     [edi+ecx*4-10h], eax

loc_5BFE7C:                             ; CODE XREF: _memcpy_0:loc_5BFDBC↑j
                mov     eax, dword ptr [esi+ecx*4-0Ch] ; jumptable 005BFDBC case 3
                mov     [edi+ecx*4-0Ch], eax

loc_5BFE84:                             ; CODE XREF: _memcpy_0:loc_5BFDBC↑j
                mov     eax, dword ptr [esi+ecx*4-8] ; jumptable 005BFDBC case 2
                mov     [edi+ecx*4-8], eax

loc_5BFE8C:                             ; CODE XREF: _memcpy_0:loc_5BFDBC↑j
                mov     eax, dword ptr [esi+ecx*4-4] ; jumptable 005BFDBC case 1
                mov     [edi+ecx*4-4], eax
                lea     eax, ds:0[ecx*4]
                add     esi, eax
                add     edi, eax

loc_5BFE9F:                             ; CODE XREF: _memcpy_0:loc_5BFDBC↑j
                jmp     ds:jpt_5BFD95[edx*4] ; jumptable 005BFDBC case 0
; ---------------------------------------------------------------------------
                align 4
jpt_5BFD95      dd offset loc_5BFEB8    ; DATA XREF: _memcpy_0+35↑r
                dd offset loc_5BFEC0    ; jump table for switch statement
                dd offset loc_5BFECC
                dd offset loc_5BFEE0
; ---------------------------------------------------------------------------

loc_5BFEB8:                             ; CODE XREF: _memcpy_0+35↑j
                mov     eax, dword ptr [ebp+arg_0] ; jumptable 005BFD95 case 0
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_5BFEC0:                             ; CODE XREF: _memcpy_0+35↑j
                mov     al, [esi]       ; jumptable 005BFD95 case 1
                mov     [edi], al
                mov     eax, dword ptr [ebp+arg_0]
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 4

loc_5BFECC:                             ; CODE XREF: _memcpy_0+35↑j
                mov     al, [esi]       ; jumptable 005BFD95 case 2
                mov     [edi], al
                mov     al, [esi+1]
                mov     [edi+1], al
                mov     eax, dword ptr [ebp+arg_0]
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 10h

loc_5BFEE0:                             ; CODE XREF: _memcpy_0+35↑j
                mov     al, [esi]       ; jumptable 005BFD95 case 3
                mov     [edi], al
                mov     al, [esi+1]
                mov     [edi+1], al
                mov     al, [esi+2]
                mov     [edi+2], al
                mov     eax, dword ptr [ebp+arg_0]
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 4

loc_5BFEF8:                             ; CODE XREF: _memcpy_0+1A↑j
                lea     esi, [ecx+esi-4]
                lea     edi, [ecx+edi-4]
                test    edi, 3
                jnz     short loc_5BFF2C
                shr     ecx, 2
                and     edx, 3
                cmp     ecx, 8
                jb      short loc_5BFF20
                std
                rep movsd
                cld
                jmp     ds:jpt_5BFF44[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 10h

loc_5BFF20:                             ; CODE XREF: _memcpy_0+1B1↑j
                neg     ecx
                jmp     ds:jpt_5BFF22[ecx*4] ; switch 1 cases
; ---------------------------------------------------------------------------
                align 4

loc_5BFF2C:                             ; CODE XREF: _memcpy_0+1A6↑j
                mov     eax, edi
                mov     edx, 3
                cmp     ecx, 4          ; switch 4 cases
                jb      short loc_5BFF44

def_5BFF44:                             ; jumptable 005BFF44 default case
                and     eax, 3
                sub     ecx, eax
                jmp     dword ptr ds:loc_5BFF44+4[eax*4]
; ---------------------------------------------------------------------------

loc_5BFF44:                             ; CODE XREF: _memcpy_0+1D6↑j
                jmp     ds:jpt_5BFF44[ecx*4] ; switch jump
; ---------------------------------------------------------------------------
                align 4
                dd offset loc_5BFF58
                dd offset loc_5BFF78
                dd offset loc_5BFFA0
; ---------------------------------------------------------------------------

loc_5BFF58:                             ; DATA XREF: _memcpy_0+1EC↑o
                mov     al, [esi+3]
                and     edx, ecx
                mov     [edi+3], al
                dec     esi
                shr     ecx, 2
                dec     edi
                cmp     ecx, 8
                jb      short loc_5BFF20
                std
                rep movsd
                cld
                jmp     ds:jpt_5BFF44[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 4

loc_5BFF78:                             ; DATA XREF: _memcpy_0+1F0↑o
                mov     al, [esi+3]
                and     edx, ecx
                mov     [edi+3], al
                mov     al, [esi+2]
                shr     ecx, 2
                mov     [edi+2], al
                sub     esi, 2
                sub     edi, 2
                cmp     ecx, 8
                jb      short loc_5BFF20
                std
                rep movsd
                cld
                jmp     ds:jpt_5BFF44[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 10h

loc_5BFFA0:                             ; DATA XREF: _memcpy_0+1F4↑o
                mov     al, [esi+3]
                and     edx, ecx
                mov     [edi+3], al
                mov     al, [esi+2]
                mov     [edi+2], al
                mov     al, [esi+1]
                shr     ecx, 2
                mov     [edi+1], al
                sub     esi, 3
                sub     edi, 3
                cmp     ecx, 8
                jb      loc_5BFF20
                std
                rep movsd
                cld
                jmp     ds:jpt_5BFF44[edx*4] ; switch 4 cases
; ---------------------------------------------------------------------------
                align 4
                dd offset loc_5BFFF4
                dd offset loc_5BFFFC
                dd offset loc_5C0004
                dd offset loc_5C000C
                dd offset loc_5C0014
                dd offset loc_5C001C
                dd offset loc_5C0024
jpt_5BFF22      dd offset loc_5C0037    ; DATA XREF: _memcpy_0+1C2↑r
; ---------------------------------------------------------------------------

loc_5BFFF4:                             ; DATA XREF: _memcpy_0+274↑o
                mov     eax, dword ptr [esi+ecx*4+1Ch]
                mov     [edi+ecx*4+1Ch], eax

loc_5BFFFC:                             ; DATA XREF: _memcpy_0+278↑o
                mov     eax, dword ptr [esi+ecx*4+18h]
                mov     [edi+ecx*4+18h], eax

loc_5C0004:                             ; DATA XREF: _memcpy_0+27C↑o
                mov     eax, dword ptr [esi+ecx*4+14h]
                mov     [edi+ecx*4+14h], eax

loc_5C000C:                             ; DATA XREF: _memcpy_0+280↑o
                mov     eax, dword ptr [esi+ecx*4+10h]
                mov     [edi+ecx*4+10h], eax

loc_5C0014:                             ; DATA XREF: _memcpy_0+284↑o
                mov     eax, dword ptr [esi+ecx*4+0Ch]
                mov     [edi+ecx*4+0Ch], eax

loc_5C001C:                             ; DATA XREF: _memcpy_0+288↑o
                mov     eax, dword ptr [esi+ecx*4+8]
                mov     [edi+ecx*4+8], eax

loc_5C0024:                             ; DATA XREF: _memcpy_0+28C↑o
                mov     eax, dword ptr [esi+ecx*4+4]
                mov     [edi+ecx*4+4], eax
                lea     eax, ds:0[ecx*4]
                add     esi, eax
                add     edi, eax

loc_5C0037:                             ; CODE XREF: _memcpy_0+1C2↑j
                jmp     ds:jpt_5BFF44[edx*4] ; jumptable 005BFF22 case 0
; ---------------------------------------------------------------------------
                align 10h
jpt_5BFF44      dd offset loc_5C0050    ; DATA XREF: _memcpy_0+1B7↑r
                dd offset loc_5C0058    ; jump table for switch statement
                dd offset loc_5C0068
                dd offset loc_5C007C
; ---------------------------------------------------------------------------

loc_5C0050:                             ; CODE XREF: _memcpy_0+1B7↑j
                mov     eax, dword ptr [ebp+arg_0] ; jumptable 005BFF17 case 0
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 4

loc_5C0058:                             ; CODE XREF: _memcpy_0+1B7↑j
                mov     al, [esi+3]     ; jumptable 005BFF17 case 1
                mov     [edi+3], al
                mov     eax, dword ptr [ebp+arg_0]
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 4

loc_5C0068:                             ; CODE XREF: _memcpy_0+1B7↑j
                mov     al, [esi+3]     ; jumptable 005BFF17 case 2
                mov     [edi+3], al
                mov     al, [esi+2]
                mov     [edi+2], al
                mov     eax, dword ptr [ebp+arg_0]
                pop     esi
                pop     edi
                leave
                retn
; ---------------------------------------------------------------------------
                align 4

loc_5C007C:                             ; CODE XREF: _memcpy_0+1B7↑j
                mov     al, [esi+3]     ; jumptable 005BFF17 case 3
                mov     [edi+3], al
                mov     al, [esi+2]
                mov     [edi+2], al
                mov     al, [esi+1]
                mov     [edi+1], al
                mov     eax, dword ptr [ebp+arg_0]
                pop     esi
                pop     edi
                leave
                retn
_memcpy_0       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; void __stdcall `eh vector destructor iterator'(void *, unsigned int, int, void (__thiscall *)(void *))
??_M@YGXPAXIHP6EX0@Z@Z proc near        ; CODE XREF: sub_42DD66+64↑p

var_1C          = dword ptr -1Ch
ms_exc          = CPPEH_RECORD ptr -18h
arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch
arg_8           = dword ptr  10h
arg_C           = dword ptr  14h

; __unwind { // __except_handler3
                push    ebp
                mov     ebp, esp
                push    0FFFFFFFFh
                push    offset stru_6143F8
                push    offset __except_handler3
                mov     eax, fs:0
                push    eax
                mov     fs:0, esp
                add     esp, 0FFFFFFF4h
                push    ebx
                push    esi
                push    edi
                xor     eax, eax
                mov     [ebp+var_1C], eax
                mov     ecx, dword ptr [ebp+arg_8]
                mov     edi, [ebp+arg_4]
                imul    ecx, edi
                mov     esi, [ebp+arg_0]
                add     esi, ecx
                mov     [ebp+arg_0], esi
;   __try { // __finally(loc_5C0113)
                mov     [ebp+ms_exc.registration.TryLevel], eax

loc_5C00DC:                             ; CODE XREF: `eh vector destructor iterator'(void *,uint,int,void (*)(void *))+4B↓j
                dec     [ebp+arg_8]
                js      short loc_5C00ED
                sub     esi, edi
                mov     [ebp+arg_0], esi
                mov     ecx, esi
                call    [ebp+arg_C]
                jmp     short loc_5C00DC
; ---------------------------------------------------------------------------

loc_5C00ED:                             ; CODE XREF: `eh vector destructor iterator'(void *,uint,int,void (*)(void *))+3F↑j
                mov     [ebp+var_1C], 1
;   } // starts at 5C00D9
                mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh
                call    loc_5C0119
; ---------------------------------------------------------------------------

loc_5C0100:                             ; CODE XREF: `eh vector destructor iterator'(void *,uint,int,void (*)(void *)):loc_5C012F↓j
                mov     ecx, dword ptr [ebp+ms_exc.registration.Next]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn    10h
; ---------------------------------------------------------------------------

loc_5C0113:                             ; DATA XREF: .rdata:stru_6143F8↓o
;   __finally // owned by 5C00D9
                mov     edi, [ebp+arg_4]
                mov     esi, [ebp+arg_0]

loc_5C0119:                             ; CODE XREF: `eh vector destructor iterator'(void *,uint,int,void (*)(void *))+5B↑j
                mov     eax, dword ptr [ebp+var_1C]
                test    eax, eax
                jnz     short loc_5C012F
                mov     edx, dword ptr [ebp+arg_C]
                push    edx             ; void (__thiscall *)(void *)
                mov     eax, dword ptr [ebp+arg_8]
                push    eax             ; int
                push    edi             ; unsigned int
                push    esi             ; void *
                call    ?__ArrayUnwind@@YGXPAXIHP6EX0@Z@Z ; __ArrayUnwind(void *,uint,int,void (*)(void *))

loc_5C012F:                             ; CODE XREF: `eh vector destructor iterator'(void *,uint,int,void (*)(void *))+7E↑j
                retn
; } // starts at 5C00A0
??_M@YGXPAXIHP6EX0@Z@Z endp

; ---------------------------------------------------------------------------
                mov     ecx, dword ptr [ebp-10h]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn    10h
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; void __stdcall __ArrayUnwind(void *, unsigned int, int, void (__thiscall *)(void *))
?__ArrayUnwind@@YGXPAXIHP6EX0@Z@Z proc near

ms_exc          = CPPEH_RECORD ptr -18h
arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch
arg_8           = dword ptr  10h
arg_C           = dword ptr  14h

; __unwind { // __except_handler3
                push    ebp
                mov     ebp, esp
                push    0FFFFFFFFh
                push    offset stru_614408
                push    offset __except_handler3
                mov     eax, fs:0
                push    eax
                mov     fs:0, esp
                sub     esp, 8
                push    ebx
                push    esi
                push    edi
                mov     [ebp+ms_exc.old_esp], esp
;   __try { // __except at loc_5C019D
                mov     [ebp+ms_exc.registration.TryLevel], 0

loc_5C017D:                             ; CODE XREF: __ArrayUnwind(void *,uint,int,void (*)(void *))+3E↓j
                dec     [ebp+arg_8]
                js      short loc_5C01A0
                mov     ecx, dword ptr [ebp+arg_0]
                sub     ecx, [ebp+arg_4]
                mov     [ebp+arg_0], ecx
                call    [ebp+arg_C]
                jmp     short loc_5C017D
; ---------------------------------------------------------------------------

loc_5C0190:                             ; DATA XREF: .rdata:stru_614408↓o
;   __except filter // owned by 5C0176
                mov     eax, dword ptr [ebp+ms_exc.exc_ptr]
                push    eax
                call    sub_5C01C0      ; ?FrameUnwindFilter@@YAHPAU_EXCEPTION_POINTERS@@@Z
                add     esp, 4
                retn
; ---------------------------------------------------------------------------

loc_5C019D:                             ; DATA XREF: .rdata:stru_614408↓o
;   __except(loc_5C0190) // owned by 5C0176
                mov     esp, [ebp+ms_exc.old_esp]
;   } // starts at 5C0176

loc_5C01A0:                             ; CODE XREF: __ArrayUnwind(void *,uint,int,void (*)(void *))+30↑j
                mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh
                mov     ecx, dword ptr [ebp+ms_exc.registration.Next]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn    10h
; } // starts at 5C0150
?__ArrayUnwind@@YGXPAXIHP6EX0@Z@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; ?FrameUnwindFilter@@YAHPAU_EXCEPTION_POINTERS@@@Z
; doubtful name
; Attributes: library function static

sub_5C01C0      proc near               ; CODE XREF: __ArrayUnwind(void *,uint,int,void (*)(void *))+44↑p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                mov     ecx, dword ptr [eax]
                cmp     dword ptr [ecx], 0E06D7363h
                jnz     short loc_5C01D3
                call    ?terminate@@YAXXZ ; terminate(void)
; ---------------------------------------------------------------------------

loc_5C01D3:                             ; CODE XREF: sub_5C01C0+C↑j
                xor     eax, eax
                retn
sub_5C01C0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; void __stdcall `eh vector constructor iterator'(void *, unsigned int, int, void (__thiscall *)(void *), void (__thiscall *)(void *))
??_L@YGXPAXIHP6EX0@Z1@Z proc near       ; CODE XREF: sub_42DC65+42↑p

var_20          = dword ptr -20h
var_1C          = dword ptr -1Ch
ms_exc          = CPPEH_RECORD ptr -18h
arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch
arg_8           = dword ptr  10h
arg_C           = dword ptr  14h
arg_10          = dword ptr  18h

; __unwind { // __except_handler3
                push    ebp
                mov     ebp, esp
                push    0FFFFFFFFh
                push    offset stru_614418
                push    offset __except_handler3
                mov     eax, fs:0
                push    eax
                mov     fs:0, esp
                add     esp, 0FFFFFFF0h
                push    ebx
                push    esi
                push    edi
                xor     esi, esi
                mov     [ebp+var_20], esi
;   __try { // __finally(loc_5C024F)
                mov     [ebp+ms_exc.registration.TryLevel], esi
                mov     [ebp+var_1C], esi
                mov     ebx, dword ptr [ebp+arg_4]
                mov     edi, [ebp+arg_0]

loc_5C0214:                             ; CODE XREF: `eh vector constructor iterator'(void *,uint,int,void (*)(void *),void (*)(void *))+47↓j
                cmp     esi, [ebp+arg_8]
                jge     short loc_5C0229
                mov     ecx, edi
                call    [ebp+arg_C]
                add     edi, ebx
                mov     [ebp+arg_0], edi
                inc     esi
                mov     [ebp+var_1C], esi
                jmp     short loc_5C0214
; ---------------------------------------------------------------------------

loc_5C0229:                             ; CODE XREF: `eh vector constructor iterator'(void *,uint,int,void (*)(void *),void (*)(void *))+37↑j
                mov     [ebp+var_20], 1
;   } // starts at 5C0208
                mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh
                call    loc_5C0258
; ---------------------------------------------------------------------------

loc_5C023C:                             ; CODE XREF: `eh vector constructor iterator'(void *,uint,int,void (*)(void *),void (*)(void *)):loc_5C026B↓j
                mov     ecx, dword ptr [ebp+ms_exc.registration.Next]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn    14h
; ---------------------------------------------------------------------------

loc_5C024F:                             ; DATA XREF: .rdata:stru_614418↓o
;   __finally // owned by 5C0208
                mov     ebx, dword ptr [ebp+arg_4]
                mov     edi, [ebp+arg_0]
                mov     esi, [ebp+var_1C]

loc_5C0258:                             ; CODE XREF: `eh vector constructor iterator'(void *,uint,int,void (*)(void *),void (*)(void *))+57↑j
                mov     eax, dword ptr [ebp+var_20]
                test    eax, eax
                jnz     short loc_5C026B
                mov     eax, dword ptr [ebp+arg_10]
                push    eax             ; void (__thiscall *)(void *)
                push    esi             ; int
                push    ebx             ; unsigned int
                push    edi             ; void *
                call    ?__ArrayUnwind@@YGXPAXIHP6EX0@Z@Z ; __ArrayUnwind(void *,uint,int,void (*)(void *))

loc_5C026B:                             ; CODE XREF: `eh vector constructor iterator'(void *,uint,int,void (*)(void *),void (*)(void *))+7D↑j
                retn
; } // starts at 5C01E0
??_L@YGXPAXIHP6EX0@Z1@Z endp

; ---------------------------------------------------------------------------
                mov     ecx, dword ptr [ebp-10h]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn    14h
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl _itoa(int Value, char *Buffer, int Radix)
__itoa          proc near               ; CODE XREF: sub_43A820+16↑p

Value           = dword ptr  4
Buffer          = dword ptr  8
Radix           = dword ptr  0Ch

                mov     ecx, dword ptr [esp+Radix]
                mov     eax, dword ptr [esp+Value]
                cmp     ecx, 0Ah
                push    esi
                jnz     short loc_5C02A8
                test    eax, eax
                jge     short loc_5C02A8
                mov     esi, [esp+4+Buffer]
                push    1
                push    0Ah
                push    esi
                push    eax
                call    _xtoa
                add     esp, 10h
                mov     eax, esi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C02A8:                             ; CODE XREF: __itoa+C↑j
                mov     esi, [esp+4+Buffer]
                push    0
                push    ecx
                push    esi
                push    eax
                call    _xtoa
                add     esp, 10h
                mov     eax, esi
                pop     esi
                retn
__itoa          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_xtoa           proc near               ; CODE XREF: __itoa+1C↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                mov     eax, dword ptr [esp+arg_C]
                push    ebx
                push    ebp
                push    esi
                mov     esi, [esp+0Ch+arg_4]
                push    edi
                test    eax, eax
                jz      short loc_5C02DC
                mov     edi, [esp+10h+arg_0]
                mov     byte ptr [esi], 2Dh ; '-'
                inc     esi
                neg     edi
                jmp     short loc_5C02E0
; ---------------------------------------------------------------------------

loc_5C02DC:                             ; CODE XREF: _xtoa+E↑j
                mov     edi, [esp+10h+arg_0]

loc_5C02E0:                             ; CODE XREF: _xtoa+1A↑j
                mov     ebp, [esp+10h+arg_8]
                mov     ebx, esi

loc_5C02E6:                             ; CODE XREF: _xtoa+48↓j
                mov     eax, edi
                xor     edx, edx
                div     ebp
                mov     eax, edi
                mov     ecx, edx
                xor     edx, edx
                div     ebp
                cmp     ecx, 9
                mov     edi, eax
                jbe     short loc_5C0300
                add     cl, 57h ; 'W'
                jmp     short loc_5C0303
; ---------------------------------------------------------------------------

loc_5C0300:                             ; CODE XREF: _xtoa+39↑j
                add     cl, 30h ; '0'

loc_5C0303:                             ; CODE XREF: _xtoa+3E↑j
                mov     [esi], cl
                inc     esi
                test    edi, edi
                ja      short loc_5C02E6
                mov     byte ptr [esi], 0
                dec     esi

loc_5C030E:                             ; CODE XREF: _xtoa+5A↓j
                mov     cl, [ebx]
                mov     al, [esi]
                mov     [esi], cl
                mov     [ebx], al
                dec     esi
                inc     ebx
                cmp     ebx, esi
                jb      short loc_5C030E
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
_xtoa           endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl _ltoa(int Value, char *Buffer, int Radix)
__ltoa          proc near

Value           = dword ptr  4
Buffer          = dword ptr  8
Radix           = dword ptr  0Ch

                mov     ecx, dword ptr [esp+Radix]
                mov     edx, dword ptr [esp+Value]
                cmp     ecx, 0Ah
                push    esi
                jnz     short loc_5C035B
                test    edx, edx
                jge     short loc_5C035B
                mov     esi, [esp+4+Buffer]
                mov     eax, 1
                push    eax
                push    ecx
                push    esi
                push    edx
                call    _xtoa
                add     esp, 10h
                mov     eax, esi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C035B:                             ; CODE XREF: __ltoa+C↑j
                mov     esi, [esp+4+Buffer]
                xor     eax, eax
                push    eax
                push    ecx
                push    esi
                push    edx
                call    _xtoa
                add     esp, 10h
                mov     eax, esi
                pop     esi
                retn
__ltoa          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl _ultoa(unsigned int Value, char *Buffer, int Radix)
__ultoa         proc near

Value           = dword ptr  4
Buffer          = dword ptr  8
Radix           = dword ptr  0Ch

                mov     eax, dword ptr [esp+Radix]
                mov     ecx, dword ptr [esp+Value]
                push    esi
                mov     esi, [esp+4+Buffer]
                push    0
                push    eax
                push    esi
                push    ecx
                call    _xtoa
                add     esp, 10h
                mov     eax, esi
                pop     esi
                retn
__ultoa         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl _i64toa(__int64 Value, char *Buffer, int Radix)
__i64toa        proc near

Value           = qword ptr  4
Buffer          = dword ptr  0Ch
Radix           = dword ptr  10h

                mov     ecx, dword ptr [esp+Radix]
                mov     edx, dword ptr [esp+Value+4]
                push    esi
                push    edi
                mov     edi, dword ptr [esp+8+Value]
                cmp     ecx, 0Ah
                jnz     short loc_5C03D5
                test    edx, edx
                jg      short loc_5C03D5
                jl      short loc_5C03BD
                test    edi, edi
                jnb     short loc_5C03D5

loc_5C03BD:                             ; CODE XREF: __i64toa+17↑j
                mov     esi, [esp+8+Buffer]
                mov     eax, 1
                push    eax
                push    ecx
                push    esi
                push    edx
                push    edi
                call    _x64toa@20      ; x64toa(x,x,x,x,x)
                mov     eax, esi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C03D5:                             ; CODE XREF: __i64toa+11↑j
                mov     esi, [esp+8+Buffer]
                xor     eax, eax
                push    eax
                push    ecx
                push    esi
                push    edx
                push    edi
                call    _x64toa@20      ; x64toa(x,x,x,x,x)
                mov     eax, esi
                pop     edi
                pop     esi
                retn
__i64toa        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; __stdcall x64toa(x, x, x, x, x)
_x64toa@20      proc near               ; CODE XREF: __i64toa+2B↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h

                mov     eax, dword ptr [esp+arg_10]
                push    ebx
                push    ebp
                push    esi
                mov     esi, [esp+0Ch+arg_8]
                push    edi
                test    eax, eax
                jz      short loc_5C0404
                mov     byte ptr [esi], 2Dh ; '-'
                inc     esi

loc_5C0404:                             ; CODE XREF: x64toa(x,x,x,x,x)+E↑j
                mov     ebp, [esp+10h+arg_4]
                mov     edi, [esp+10h+arg_0]
                mov     [esp+10h+arg_8], esi

loc_5C0410:                             ; CODE XREF: x64toa(x,x,x,x,x)+56↓j
                xor     eax, eax
                push    eax
                mov     eax, dword ptr [esp+14h+arg_C]
                push    eax
                push    ebp
                push    edi
                call    __aullrem
                mov     ebx, eax
                xor     eax, eax
                push    eax
                mov     eax, dword ptr [esp+14h+arg_C]
                push    eax
                push    ebp
                push    edi
                call    __aulldiv
                cmp     ebx, 9
                mov     edi, eax
                mov     ebp, edx
                jbe     short loc_5C043E
                add     bl, 57h ; 'W'
                jmp     short loc_5C0441
; ---------------------------------------------------------------------------

loc_5C043E:                             ; CODE XREF: x64toa(x,x,x,x,x)+47↑j
                add     bl, 30h ; '0'

loc_5C0441:                             ; CODE XREF: x64toa(x,x,x,x,x)+4C↑j
                mov     [esi], bl
                inc     esi
                test    ebp, ebp
                ja      short loc_5C0410
                jb      short loc_5C044E
                test    edi, edi
                ja      short loc_5C0410

loc_5C044E:                             ; CODE XREF: x64toa(x,x,x,x,x)+58↑j
                mov     byte ptr [esi], 0
                dec     esi

loc_5C0452:                             ; CODE XREF: x64toa(x,x,x,x,x)+78↓j
                mov     eax, dword ptr [esp+10h+arg_8]
                mov     cl, [esi]
                dec     esi
                mov     dl, [eax]
                inc     eax
                mov     [esi+1], dl
                mov     [eax-1], cl
                cmp     eax, esi
                mov     [esp+10h+arg_8], eax
                jb      short loc_5C0452
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn    14h
_x64toa@20      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl _ui64toa(unsigned __int64 Value, char *Buffer, int Radix)
__ui64toa       proc near

Value           = qword ptr  4
Buffer          = dword ptr  0Ch
Radix           = dword ptr  10h

                mov     eax, dword ptr [esp+Radix]
                mov     ecx, dword ptr [esp+Value+4]
                mov     edx, dword ptr [esp+Value]
                push    esi
                mov     esi, [esp+4+Buffer]
                push    0
                push    eax
                push    esi
                push    ecx
                push    edx
                call    _x64toa@20      ; x64toa(x,x,x,x,x)
                mov     eax, esi
                pop     esi
                retn
__ui64toa       endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void __cdecl qsort(void *Base, size_t NumOfElements, size_t SizeOfElements, _CoreCrtNonSecureSearchSortCompareFunction CompareFunction)
_qsort          proc near               ; CODE XREF: sub_43EAA0+138↑p

var_100         = dword ptr -100h
var_FC          = dword ptr -0FCh
var_F8          = dword ptr -0F8h
var_F4          = dword ptr -0F4h
var_F0          = byte ptr -0F0h
var_78          = byte ptr -78h
Base            = dword ptr  4
NumOfElements   = dword ptr  8
SizeOfElements  = dword ptr  0Ch
fnCompareFunction = dword ptr  10h

                mov     eax, dword ptr [esp+NumOfElements]
                sub     esp, 100h
                cmp     eax, 2
                push    ebx
                push    ebp
                push    esi
                push    edi
                jb      loc_5C054D
                mov     ebx, dword ptr [esp+110h+SizeOfElements]
                test    ebx, ebx
                jz      loc_5C054D
                lea     esi, [eax-1]
                mov     edi, [esp+110h+Base]
                imul    esi, ebx
                add     esi, edi
                lea     eax, [esp+110h+var_F0]
                lea     ecx, [esp+110h+var_78]
                mov     [esp+110h+var_F4], 0
                mov     [esp+110h+var_100], esi
                mov     [esp+110h+var_FC], eax
                mov     [esp+110h+var_F8], ecx

loc_5C04F4:                             ; CODE XREF: _qsort+AB↓j
                mov     eax, esi
                xor     edx, edx
                sub     eax, edi
                div     ebx
                inc     eax
                cmp     eax, 8
                ja      short loc_5C0558
                mov     edx, dword ptr [esp+110h+fnCompareFunction]
                push    edx
                push    ebx
                push    esi
                push    edi
                call    _shortsort
                add     esp, 10h

loc_5C0515:                             ; CODE XREF: _qsort+157↓j
                mov     eax, dword ptr [esp+110h+var_F4]
                mov     esi, [esp+110h+var_F8]
                mov     edx, dword ptr [esp+110h+var_FC]
                mov     ecx, 4
                dec     eax
                sub     esi, ecx
                sub     edx, ecx
                mov     [esp+110h+var_F4], eax
                test    eax, eax
                mov     [esp+110h+var_F8], esi
                mov     [esp+110h+var_FC], edx
                jl      short loc_5C054D
                mov     eax, dword ptr [esp+110h+var_FC]
                mov     edx, esi
                mov     ecx, dword ptr [eax]
                mov     edi, [edx]
                mov     [esp+110h+var_100], ecx
                mov     esi, ecx
                jmp     short loc_5C04F4
; ---------------------------------------------------------------------------

loc_5C054D:                             ; CODE XREF: _qsort+11↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 100h
                retn
; ---------------------------------------------------------------------------

loc_5C0558:                             ; CODE XREF: _qsort+60↑j
                shr     eax, 1
                imul    eax, ebx
                push    ebx
                add     eax, edi
                push    edi
                push    eax
                call    _swap
                add     esp, 0Ch
                mov     ebp, edi
                add     esi, ebx

loc_5C056E:                             ; CODE XREF: _qsort+E6↓j
                mov     eax, dword ptr [esp+110h+var_100]
                add     ebp, ebx
                cmp     ebp, eax
                ja      short loc_5C0588
                push    edi
                push    ebp
                call    [esp+118h+fnCompareFunction]
                add     esp, 8
                test    eax, eax
                jle     short loc_5C056E

loc_5C0588:                             ; CODE XREF: _qsort+D6↑j
                sub     esi, ebx
                cmp     esi, edi
                jbe     short loc_5C059E
                push    edi
                push    esi
                call    [esp+118h+fnCompareFunction]
                add     esp, 8
                test    eax, eax
                jge     short loc_5C0588

loc_5C059E:                             ; CODE XREF: _qsort+EC↑j
                cmp     esi, ebp
                push    ebx
                push    esi
                jb      short loc_5C05AF
                push    ebp
                call    _swap
                add     esp, 0Ch
                jmp     short loc_5C056E
; ---------------------------------------------------------------------------

loc_5C05AF:                             ; CODE XREF: _qsort+102↑j
                push    edi
                call    _swap
                mov     edx, dword ptr [esp+11Ch+var_100]
                mov     ecx, esi
                mov     eax, edx
                sub     ecx, edi
                add     esp, 0Ch
                sub     eax, ebp
                dec     ecx
                cmp     ecx, eax
                jl      short loc_5C0608
                lea     eax, [edi+ebx]
                cmp     eax, esi
                jnb     short loc_5C05F5
                mov     eax, dword ptr [esp+110h+var_F8]
                mov     ecx, dword ptr [esp+110h+var_FC]
                sub     esi, ebx
                mov     [eax], edi
                mov     edi, [esp+110h+var_F4]
                mov     [ecx], esi
                inc     edi
                add     eax, 4
                add     ecx, 4
                mov     [esp+110h+var_F4], edi
                mov     [esp+110h+var_F8], eax
                mov     [esp+110h+var_FC], ecx

loc_5C05F5:                             ; CODE XREF: _qsort+12E↑j
                cmp     ebp, edx
                jnb     loc_5C0515
                mov     esi, [esp+110h+var_100]
                mov     edi, ebp
                jmp     loc_5C04F4
; ---------------------------------------------------------------------------

loc_5C0608:                             ; CODE XREF: _qsort+127↑j
                cmp     ebp, edx
                jnb     short loc_5C062F
                mov     eax, dword ptr [esp+110h+var_F8]
                mov     ecx, dword ptr [esp+110h+var_FC]
                mov     [eax], ebp
                mov     ebp, [esp+110h+var_F4]
                mov     [ecx], edx
                inc     ebp
                add     eax, 4
                add     ecx, 4
                mov     [esp+110h+var_F4], ebp
                mov     [esp+110h+var_F8], eax
                mov     [esp+110h+var_FC], ecx

loc_5C062F:                             ; CODE XREF: _qsort+16A↑j
                lea     ecx, [edi+ebx]
                cmp     ecx, esi
                jnb     loc_5C0515
                sub     esi, ebx
                mov     [esp+110h+var_100], esi
                jmp     loc_5C04F4
_qsort          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_shortsort      proc near               ; CODE XREF: _qsort+6D↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                push    ebx
                mov     ebx, dword ptr [esp+4+arg_0]
                push    edi
                mov     edi, [esp+8+arg_4]
                cmp     edi, ebx
                jbe     short loc_5C06A6
                push    esi
                push    ebp
                mov     ebp, [esp+10h+arg_8]
                lea     eax, [ebp+ebx+0]
                mov     [esp+10h+arg_4], eax
                jmp     short loc_5C0672
; ---------------------------------------------------------------------------

loc_5C066E:                             ; CODE XREF: _shortsort+52↓j
                mov     ebx, dword ptr [esp+10h+arg_0]

loc_5C0672:                             ; CODE XREF: _shortsort+1C↑j
                mov     esi, [esp+10h+arg_4]
                cmp     esi, edi
                ja      short loc_5C068F

loc_5C067A:                             ; CODE XREF: _shortsort+3D↓j
                push    ebx
                push    esi
                call    [esp+18h+arg_C]
                add     esp, 8
                test    eax, eax
                jle     short loc_5C0689
                mov     ebx, esi

loc_5C0689:                             ; CODE XREF: _shortsort+35↑j
                add     esi, ebp
                cmp     esi, edi
                jbe     short loc_5C067A

loc_5C068F:                             ; CODE XREF: _shortsort+28↑j
                push    ebp
                push    edi
                push    ebx
                call    _swap
                mov     eax, dword ptr [esp+1Ch+arg_0]
                sub     edi, ebp
                add     esp, 0Ch
                cmp     edi, eax
                ja      short loc_5C066E
                pop     ebp
                pop     esi

loc_5C06A6:                             ; CODE XREF: _shortsort+C↑j
                pop     edi
                pop     ebx
                retn
_shortsort      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_swap           proc near               ; CODE XREF: _qsort+C2↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                mov     eax, dword ptr [esp+arg_0]
                mov     ecx, dword ptr [esp+arg_4]
                cmp     eax, ecx
                push    esi
                jz      short loc_5C06DA
                mov     edx, dword ptr [esp+4+arg_8]
                mov     esi, edx
                dec     edx
                test    esi, esi
                jz      short loc_5C06DA
                push    ebx
                lea     esi, [edx+1]

loc_5C06CC:                             ; CODE XREF: _swap+27↓j
                mov     bl, [ecx]
                mov     dl, [eax]
                mov     [eax], bl
                inc     eax
                mov     [ecx], dl
                inc     ecx
                dec     esi
                jnz     short loc_5C06CC
                pop     ebx

loc_5C06DA:                             ; CODE XREF: _swap+B↑j
                pop     esi
                retn
_swap           endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl fclose(FILE *Stream)
_fclose         proc near               ; CODE XREF: sub_43ED94+3C8↑p

Stream          = dword ptr  4

                push    esi
                mov     esi, [esp+4+Stream]
                push    edi
                or      edi, 0FFFFFFFFh
                test    byte ptr [esi+0Ch], 40h
                jz      short loc_5C06FB
                mov     dword ptr [esi+0Ch], 0
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C06FB:                             ; CODE XREF: _fclose+D↑j
                push    esi             ; Stream
                call    __lock_file
                add     esp, 4
                push    esi
                call    __fclose_lk
                add     esp, 4
                mov     edi, eax
                push    esi             ; Stream
                call    __unlock_file
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
_fclose         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__fclose_lk     proc near               ; CODE XREF: _fclose+25↑p

arg_0           = dword ptr  4

                push    esi
                mov     esi, [esp+4+arg_0]
                push    edi
                or      edi, 0FFFFFFFFh
                test    byte ptr [esi+0Ch], 83h
                jz      short loc_5C0779
                push    esi
                call    __flush
                add     esp, 4
                mov     edi, eax
                push    esi
                call    __freebuf
                mov     eax, dword ptr [esi+10h]
                add     esp, 4
                push    eax             ; FileHandle
                call    __close
                add     esp, 4
                test    eax, eax
                jge     short loc_5C0762
                or      edi, 0FFFFFFFFh
                mov     dword ptr [esi+0Ch], 0
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C0762:                             ; CODE XREF: __fclose_lk+31↑j
                mov     eax, dword ptr [esi+1Ch]
                test    eax, eax
                jz      short loc_5C0779
                push    eax             ; Block
                call    _free
                add     esp, 4
                mov     dword ptr [esi+1Ch], 0

loc_5C0779:                             ; CODE XREF: __fclose_lk+D↑j
                mov     eax, edi
                mov     dword ptr [esi+0Ch], 0
                pop     edi
                pop     esi
                retn
__fclose_lk     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl fseek(FILE *Stream, int varOffset, int Origin)
_fseek          proc near               ; CODE XREF: sub_43ED94+2AE↑p

Stream          = dword ptr  4
varOffset          = dword ptr  8
Origin          = dword ptr  0Ch

                push    esi
                mov     esi, [esp+4+Stream]
                push    edi
                push    esi             ; Stream
                call    __lock_file
                mov     eax, dword ptr [esp+0Ch+Origin]
                mov     ecx, dword ptr [esp+0Ch+varOffset]
                add     esp, 4
                push    eax             ; Origin
                push    ecx             ; varOffset
                push    esi             ; int
                call    __fseek_lk
                add     esp, 0Ch
                mov     edi, eax
                push    esi             ; Stream
                call    __unlock_file
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
_fseek          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _fseek_lk(int, int varOffset, int Origin)
__fseek_lk      proc near               ; CODE XREF: _fseek+1A↑p

arg_0           = dword ptr  4
varOffset          = dword ptr  8
Origin          = dword ptr  0Ch

                push    esi
                mov     esi, [esp+4+arg_0]
                push    edi
                mov     eax, dword ptr [esi+0Ch]
                test    al, 83h
                jz      short loc_5C0856
                mov     edi, [esp+8+Origin]
                test    edi, edi
                jz      short loc_5C07EF
                cmp     edi, 1
                jz      short loc_5C07EF
                cmp     edi, 2
                jnz     short loc_5C0856

loc_5C07EF:                             ; CODE XREF: __fseek_lk+13↑j
                and     al, 0EFh
                cmp     edi, 1
                mov     [esi+0Ch], eax
                jnz     short loc_5C080E
                push    esi
                call    __ftell_lk
                mov     ecx, dword ptr [esp+0Ch+varOffset]
                add     esp, 4
                add     ecx, eax
                xor     edi, edi
                mov     [esp+8+varOffset], ecx

loc_5C080E:                             ; CODE XREF: __fseek_lk+27↑j
                push    esi
                call    __flush
                mov     eax, dword ptr [esi+0Ch]
                add     esp, 4
                test    al, 80h
                jz      short loc_5C0825
                and     al, 0FCh
                mov     [esi+0Ch], eax
                jmp     short loc_5C0839
; ---------------------------------------------------------------------------

loc_5C0825:                             ; CODE XREF: __fseek_lk+4C↑j
                test    al, 1
                jz      short loc_5C0839
                test    al, 8
                jz      short loc_5C0839
                test    ah, 4
                jnz     short loc_5C0839
                mov     dword ptr [esi+18h], 200h

loc_5C0839:                             ; CODE XREF: __fseek_lk+53↑j
                mov     eax, dword ptr [esp+8+varOffset]
                mov     ecx, dword ptr [esi+10h]
                push    edi             ; Origin
                push    eax             ; varOffset
                push    ecx             ; FileHandle
                call    __lseek
                add     esp, 0Ch
                inc     eax
                neg     eax
                sbb     eax, eax
                neg     eax
                dec     eax
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C0856:                             ; CODE XREF: __fseek_lk+B↑j
                call    __errno
                mov     dword ptr [eax], 16h
                pop     edi
                or      eax, 0FFFFFFFFh
                pop     esi
                retn
__fseek_lk      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


; int __cdecl _fread(void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream)
_fread      proc near               ; CODE XREF: sub_43ED94+286↑p

Buffer          = dword ptr  4
ElementSize     = dword ptr  8
ElementCount    = dword ptr  0Ch
Stream          = dword ptr  10h

                push    esi
                mov     esi, [esp+4+Stream]
                push    edi
                push    esi             ; Stream
                call    __lock_file
                mov     eax, dword ptr [esp+0Ch+ElementCount]
                mov     ecx, dword ptr [esp+0Ch+ElementSize]
                mov     edx, dword ptr [esp+0Ch+Buffer]
                add     esp, 4
                push    esi             ; Stream
                push    eax             ; ElementCount
                push    ecx             ; ElementSize
                push    edx             ; Buffer
                call    _fread_lk
                add     esp, 10h
                mov     edi, eax
                push    esi             ; Stream
                call    __unlock_file
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
_fread      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; size_t __cdecl fread(void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream)
_fread_lk          proc near               ; CODE XREF: _fread+1F↑p

var_4           = dword ptr -4
Buffer          = dword ptr  4
ElementSize     = dword ptr  8
ElementCount    = dword ptr  0Ch
Stream          = dword ptr  10h

                push    ecx
                push    ebx
                push    ebp
                mov     ebp, [esp+0Ch+ElementCount]
                push    esi
                imul    ebp, [esp+10h+ElementSize]
                push    edi
                mov     edi, [esp+14h+Buffer]
                test    ebp, ebp
                mov     [esp+14h+Buffer], edi
                mov     [esp+14h+var_4], ebp
                jnz     short loc_5C08D6
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C08D6:                             ; CODE XREF: _fread_lk+1C↑j
                mov     ebx, dword ptr [esp+14h+Stream]
                test    dword ptr [ebx+0Ch], 10Ch
                jz      short loc_5C08EC
                mov     esi, [ebx+18h]
                mov     [esp+14h+Stream], esi
                jmp     short loc_5C08F8
; ---------------------------------------------------------------------------

loc_5C08EC:                             ; CODE XREF: _fread_lk+31↑j
                mov     [esp+14h+Stream], 1000h
                mov     esi, [esp+14h+Stream]

loc_5C08F8:                             ; CODE XREF: _fread_lk+3A↑j
                test    dword ptr [ebx+0Ch], 10Ch
                jz      short loc_5C093E
                mov     eax, dword ptr [ebx+4]
                test    eax, eax
                jz      short loc_5C093E
                cmp     ebp, eax
                jnb     short loc_5C090E
                mov     eax, ebp

loc_5C090E:                             ; CODE XREF: _fread_lk+5A↑j
                mov     esi, [ebx]
                mov     ecx, eax
                mov     edx, ecx
                sub     ebp, eax
                shr     ecx, 2
                rep movsd
                mov     ecx, edx
                and     ecx, 3
                rep movsb
                mov     esi, [ebx+4]
                mov     edx, dword ptr [ebx]
                mov     ecx, dword ptr [esp+14h+Buffer]
                sub     esi, eax
                add     edx, eax
                add     ecx, eax
                mov     [ebx+4], esi
                mov     [ebx], edx
                mov     [esp+14h+Buffer], ecx
                mov     edi, ecx
                jmp     short loc_5C098E
; ---------------------------------------------------------------------------

loc_5C093E:                             ; CODE XREF: _fread_lk+4F↑j
                cmp     ebp, esi
                jb      short loc_5C0971
                test    esi, esi
                mov     eax, ebp
                jz      short loc_5C0950
                xor     edx, edx
                div     esi
                mov     eax, ebp
                sub     eax, edx

loc_5C0950:                             ; CODE XREF: _fread_lk+96↑j
                push    eax             ; MaxCharCount
                mov     eax, dword ptr [ebx+10h]
                push    edi             ; DstBuf
                push    eax             ; FileHandle
                call    __read
                add     esp, 0Ch
                test    eax, eax
                jz      short loc_5C09A4
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5C09BF
                sub     ebp, eax
                add     edi, eax
                mov     [esp+14h+Buffer], edi
                jmp     short loc_5C0992
; ---------------------------------------------------------------------------

loc_5C0971:                             ; CODE XREF: _fread_lk+90↑j
                push    ebx             ; File
                call    __filbuf
                add     esp, 4
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5C09DA
                mov     [edi], al
                mov     ecx, dword ptr [ebx+18h]
                inc     edi
                dec     ebp
                mov     [esp+14h+Buffer], edi
                mov     [esp+14h+Stream], ecx

loc_5C098E:                             ; CODE XREF: _fread_lk+8C↑j
                mov     esi, [esp+14h+Stream]

loc_5C0992:                             ; CODE XREF: _fread_lk+BF↑j
                test    ebp, ebp
                jnz     loc_5C08F8
                mov     eax, dword ptr [esp+14h+ElementCount]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C09A4:                             ; CODE XREF: _fread_lk+B0↑j
                mov     edx, dword ptr [ebx+0Ch]
                mov     eax, dword ptr [esp+14h+var_4]
                or      edx, 10h
                sub     eax, ebp
                mov     [ebx+0Ch], edx
                xor     edx, edx
                div     [esp+14h+ElementSize]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C09BF:                             ; CODE XREF: _fread_lk+B5↑j
                mov     edx, dword ptr [ebx+0Ch]
                mov     eax, dword ptr [esp+14h+var_4]
                or      edx, 20h
                sub     eax, ebp
                mov     [ebx+0Ch], edx
                xor     edx, edx
                div     [esp+14h+ElementSize]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C09DA:                             ; CODE XREF: _fread_lk+CD↑j
                mov     eax, dword ptr [esp+14h+var_4]
                xor     edx, edx
                sub     eax, ebp
                div     [esp+14h+ElementSize]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
_fread_lk          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; FILE *__cdecl _fsopen(const char *FileName, const char *Mode, int ShFlag)
__fsopen        proc near               ; CODE XREF: _fopen+C↓p

FileName        = dword ptr  4
Mode            = dword ptr  8
ShFlag          = dword ptr  0Ch

                push    esi
                call    __getstream
                mov     esi, eax
                test    esi, esi
                jnz     short loc_5C09FE
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C09FE:                             ; CODE XREF: __fsopen+A↑j
                mov     eax, dword ptr [esp+4+ShFlag]
                mov     ecx, dword ptr [esp+4+Mode]
                mov     edx, dword ptr [esp+4+FileName]
                push    edi
                push    esi             ; int
                push    eax             ; ShareFlag
                push    ecx             ; int
                push    edx             ; FileName
                call    __openfile
                add     esp, 10h
                mov     edi, eax
                push    esi             ; Stream
                call    __unlock_file
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
__fsopen        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; FILE *__cdecl fopen(const char *FileName, const char *Mode)
_fopen          proc near               ; CODE XREF: sub_43ED94+266↑p

FileName        = dword ptr  4
Mode            = dword ptr  8

                mov     eax, dword ptr [esp+Mode]
                mov     ecx, dword ptr [esp+FileName]
                push    40h ; '@'       ; ShFlag
                push    eax             ; Mode
                push    ecx             ; FileName
                call    __fsopen
                add     esp, 0Ch
                retn
_fopen          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int sscanf(const char *const Buffer, const char *const Format, ...)
_sscanf         proc near               ; CODE XREF: sub_441FEE+50↑p

Stream          = FILE ptr -20h
Buffer          = dword ptr  4
Format          = dword ptr  8
arg_8           = dword ptr  0Ch

                sub     esp, 20h
                push    edi
                mov     edi, [esp+24h+Buffer]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                mov     [esp+24h+Stream._base], edi
                mov     [esp+24h+Stream._ptr], edi
                repne scasb
                not     ecx
                dec     ecx
                lea     eax, [esp+24h+arg_8]
                mov     [esp+24h+Stream._cnt], ecx
                mov     ecx, dword ptr [esp+24h+Format]
                push    eax             ; int
                lea     edx, [esp+28h+Stream]
                push    ecx             ; int
                push    edx             ; Stream
                mov     [esp+30h+Stream._flag], 49h ; 'I'
                call    __input
                add     esp, 0Ch
                pop     edi
                add     esp, 20h
                retn
_sscanf         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn

__purecall      proc near               ; DATA XREF: .rdata:0060A310↓o
                push    19h
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4
                retn
__purecall      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; int __cdecl _strcmpi(const char *String1, const char *String2)
__strcmpi       proc near               ; CODE XREF: sub_44D275+3DF↑p

var_10          = dword ptr -10h
String1         = dword ptr  8
String2         = dword ptr  0Ch

                push    ebp
                mov     ebp, esp
                push    edi
                push    esi
                push    ebx
                mov     esi, [ebp+String2]
                mov     edi, [ebp+String1]
                lea     eax, dword_70D550
                cmp     dword ptr [eax+8], 0
                jnz     short loc_5C0B03
                mov     al, 0FFh
                mov     eax, eax

loc_5C0ACC:                             ; CODE XREF: __strcmpi+28↓j
                or      al, al
                jz      short loc_5C0AFE
                mov     al, [esi]
                inc     esi
                mov     ah, [edi]
                inc     edi
                cmp     ah, al
                jz      short loc_5C0ACC
                sub     al, 41h ; 'A'
                cmp     al, 1Ah
                sbb     cl, cl
                and     cl, 20h
                add     al, cl
                add     al, 41h ; 'A'
                xchg    ah, al
                sub     al, 41h ; 'A'
                cmp     al, 1Ah
                sbb     cl, cl
                and     cl, 20h
                add     al, cl
                add     al, 41h ; 'A'
                cmp     al, ah
                jz      short loc_5C0ACC
                sbb     al, al
                sbb     al, 0FFh

loc_5C0AFE:                             ; CODE XREF: __strcmpi+1E↑j
                movsx   eax, al
                jmp     short loc_5C0B7B
; ---------------------------------------------------------------------------

loc_5C0B03:                             ; CODE XREF: __strcmpi+16↑j
                lock inc Addend
                cmp     dword_70E964, 0
                jg      short loc_5C0B17
                push    0
                jmp     short loc_5C0B2C
; ---------------------------------------------------------------------------

loc_5C0B17:                             ; CODE XREF: __strcmpi+61↑j
                lock dec Addend
                push    13h
                call    __lock
                mov     [esp+10h+var_10], 1

loc_5C0B2C:                             ; CODE XREF: __strcmpi+65↑j
                mov     eax, 0FFh
                xor     ebx, ebx
                nop

loc_5C0B34:                             ; CODE XREF: __strcmpi+90↓j
                or      al, al
                jz      short loc_5C0B5F
                mov     al, [esi]
                inc     esi
                mov     bl, [edi]
                inc     edi
                cmp     al, bl
                jz      short loc_5C0B34
                push    eax             ; C
                push    ebx             ; C
                call    _tolower_0
                mov     ebx, eax
                add     esp, 4
                call    _tolower_0
                add     esp, 4
                cmp     bl, al
                jz      short loc_5C0B34
                sbb     eax, eax
                sbb     eax, 0FFFFFFFFh

loc_5C0B5F:                             ; CODE XREF: __strcmpi+86↑j
                mov     ebx, eax
                pop     eax
                or      eax, eax
                jnz     short loc_5C0B6F
                lock dec Addend
                jmp     short loc_5C0B79
; ---------------------------------------------------------------------------

loc_5C0B6F:                             ; CODE XREF: __strcmpi+B4↑j
                push    13h
                call    __unlock
                add     esp, 4

loc_5C0B79:                             ; CODE XREF: __strcmpi+BD↑j
                mov     eax, ebx

loc_5C0B7B:                             ; CODE XREF: __strcmpi+51↑j
                pop     ebx
                pop     esi
                pop     edi
                leave
                retn
__strcmpi       endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__CIpow         proc near

var_10          = qword ptr -10h
var_8           = qword ptr -8

                sub     esp, 10h
                fxch    st(1)
                fstp    [esp+10h+var_10]
                fst     [esp+10h+var_8]
                mov     eax, dword ptr [esp+10h+var_8+4]
                call    loc_5C0BA2
                add     esp, 10h
                retn
__CIpow         endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl pow(double X, double Y)
_pow            proc near               ; CODE XREF: sub_45A8CC+67↑p

var_8C          = qword ptr -8Ch
var_84          = qword ptr -84h
var_4           = word ptr -4
X               = qword ptr  4
Y               = qword ptr  0Ch
arg_12          = byte ptr  16h

; FUNCTION CHUNK AT 005C860E SIZE 00000037 BYTES

                lea     edx, [esp+Y]
                call    __fload_withFB

loc_5C0BA2:                             ; CODE XREF: __CIpow+10↑p
                mov     ecx, eax
                push    eax
                fstcw   [esp+4+var_4]
                cmp     [esp+4+var_4], 27Fh
                jz      short loc_5C0BB6
                call    __load_CW

loc_5C0BB6:                             ; CODE XREF: _pow+16↑j
                and     ecx, 7FF00000h
                lea     edx, [esp+4+X]
                cmp     ecx, 7FF00000h
                jz      loc_5C0C69
                call    __fload_withFB
                jz      loc_5C0C65
                test    eax, 7FF00000h
                jz      loc_5C0CD8

loc_5C0BE2:                             ; CODE XREF: _pow+14C↓j
                mov     cl, byte ptr [esp+4+X+7]
                and     cl, 80h
                jnz     loc_5C0D50

loc_5C0BEF:                             ; CODE XREF: _pow+1C2↓j
                fyl2x
                call    __twoToTOS
                cmp     cl, 1
                jnz     short loc_5C0BFD
                fchs

loc_5C0BFD:                             ; CODE XREF: _pow+60↑j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                lea     ecx, aPow_0
                mov     edx, 1Dh
                jmp     __check_range_exit
; ---------------------------------------------------------------------------

loc_5C0C1A:                             ; CODE XREF: _pow+BA↓j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                lea     ecx, aPow_0
                mov     edx, 1Dh
                call    __startTwoArgErrorHandling
                pop     edx
                retn
; ---------------------------------------------------------------------------

loc_5C0C39:                             ; CODE XREF: _pow+DB↓j
                lea     edx, [esp+X+4]
                call    __fload_withFB
                test    [esp+arg_12], 8
                jnz     short loc_5C0C4C
                inc     ecx
                jmp     short loc_5C0C7F
; ---------------------------------------------------------------------------

loc_5C0C4C:                             ; CODE XREF: _pow+AE↑j
                faddp   st(1), st
                mov     eax, 1
                jmp     short loc_5C0C1A
; ---------------------------------------------------------------------------

loc_5C0C55:                             ; CODE XREF: _pow+102↓j
                test    byte ptr [esp+Y+2], 8
                jnz     short loc_5C0C4C

loc_5C0C5C:                             ; CODE XREF: _pow+106↓j
                faddp   st(1), st
                mov     eax, 7
                jmp     short loc_5C0C1A
; ---------------------------------------------------------------------------

loc_5C0C65:                             ; CODE XREF: _pow+38↑j
                xor     ecx, ecx
                jmp     short loc_5C0C7F
; ---------------------------------------------------------------------------

loc_5C0C69:                             ; CODE XREF: _pow+2D↑j
                xor     ecx, ecx
                and     eax, 0FFFFFh
                or      eax, dword ptr [esp+4+Y]
                jnz     short loc_5C0C39
                lea     edx, [esp+4+X]
                call    __fload_withFB

loc_5C0C7F:                             ; CODE XREF: _pow+B1↑j
                mov     eax, dword ptr [esp+4+X+4]
                mov     edx, eax
                and     eax, 7FF00000h
                and     edx, 0FFFFFh
                cmp     eax, 7FF00000h
                jnz     short loc_5C0C9D
                or      edx, dword ptr [esp+4+X]
                jnz     short loc_5C0C55

loc_5C0C9D:                             ; CODE XREF: _pow+FC↑j
                test    ecx, ecx
                jnz     short loc_5C0C5C
                sub     esp, 74h
                mov     ecx, esp
                push    ecx             ; int
                sub     esp, 10h
                fstp    [esp+8Ch+var_8C] ; double
                fstp    [esp+8Ch+var_84] ; X
                fsave   byte ptr [ecx+8]
                call    __powhlp
                add     esp, 10h
                pop     ecx
                frstor  byte ptr [ecx+8]
                fld     qword ptr [ecx]
                add     esp, 74h
                test    eax, eax
                jz      __fast_exit
                mov     eax, 1
                jmp     loc_5C0C1A
; ---------------------------------------------------------------------------

loc_5C0CD8:                             ; CODE XREF: _pow+43↑j
                mov     eax, dword ptr [esp+4+X+4]
                and     eax, 0FFFFFh
                or      eax, dword ptr [esp+4+X]
                jnz     loc_5C0BE2
                fstp    st
                mov     eax, dword ptr [esp+4+Y+4]
                test    eax, 7FF00000h
                jz      short loc_5C0D35
                call    sub_5C0D75
                mov     ch, byte ptr [esp+4+X+7]
                shr     ch, 7
                test    dword ptr [esp+4+Y+7], 80h
                jz      short loc_5C0D24
                fld     tbyte ptr [tbyte_641480]
                test    ch, cl
                jz      short loc_5C0D1A
                fchs

loc_5C0D1A:                             ; CODE XREF: _pow+17D↑j
                mov     eax, 2
                jmp     loc_5C0C1A
; ---------------------------------------------------------------------------

loc_5C0D24:                             ; CODE XREF: _pow+173↑j
                fldz
                test    ch, cl
                jz      __fast_exit
                fchs
                jmp     __fast_exit
; ---------------------------------------------------------------------------

loc_5C0D35:                             ; CODE XREF: _pow+15D↑j
                fstp    st
                and     eax, 0FFFFFh
                or      eax, dword ptr [esp+4+Y]
                jnz     short loc_5C0D49
                fld1
                jmp     __fast_exit
; ---------------------------------------------------------------------------

loc_5C0D49:                             ; CODE XREF: _pow+1A7↑j
                fldz
                jmp     __fast_exit
; ---------------------------------------------------------------------------

loc_5C0D50:                             ; CODE XREF: _pow+50↑j
                fld     st(1)
                call    sub_5C0D75
                fchs
                test    cl, cl
                jnz     loc_5C0BEF
                fstp    st
                fstp    st
                fld     tbyte ptr [tbyte_641230]
                mov     eax, 1
                jmp     loc_5C0C1A
_pow            endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

sub_5C0D75      proc near               ; CODE XREF: _pow+15F↑p
                fld     st
                frndint
                fcomp   st(1)
                mov     cl, 0
                fstsw   ax
                sahf
                jnz     short loc_5C0D9A
                fmul    dbl_63ED80
                inc     cl
                fld     st
                frndint
                fcompp
                fstsw   ax
                sahf
                jnz     short locret_5C0D99
                inc     cl

locret_5C0D99:                          ; CODE XREF: sub_5C0D75+20↑j
                retn
; ---------------------------------------------------------------------------

loc_5C0D9A:                             ; CODE XREF: sub_5C0D75+C↑j
                fstp    st
                retn
sub_5C0D75      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl memcmp(const void *Buf1, const void *Buf2, size_t varSize)
_memcmp         proc near               ; CODE XREF: sub_45AE1D+168↑p

Buf1            = dword ptr  4
Buf2            = dword ptr  8
varSize            = dword ptr  0Ch

                mov     eax, dword ptr [esp+varSize]
                test    eax, eax
                jz      short retnull
                mov     edx, dword ptr [esp+Buf1]
                push    esi
                push    edi
                mov     esi, edx
                mov     edi, [esp+8+Buf2]
                or      edx, edi
                and     edx, 3
                jz      short dwords_0
                test    eax, 1
                jz      short main_loop_1
                mov     cl, [esi]
                cmp     cl, [edi]
                jnz     short not_equal
                inc     esi
                inc     edi
                dec     eax
                jz      short done

main_loop_1:                            ; CODE XREF: _memcmp+20↑j
                mov     cl, [esi]
                mov     dl, [edi]
                cmp     cl, dl
                jnz     short not_equal
                mov     cl, [esi+1]
                mov     dl, [edi+1]
                cmp     cl, dl
                jnz     short not_equal
                add     edi, 2
                add     esi, 2
                sub     eax, 2
                jnz     short main_loop_1

done:                                   ; CODE XREF: _memcmp+2B↑j
                pop     edi
                pop     esi

retnull:                                ; CODE XREF: _memcmp+6↑j
                retn
; ---------------------------------------------------------------------------

dwords_0:                               ; CODE XREF: _memcmp+19↑j
                mov     ecx, eax
                and     eax, 3
                shr     ecx, 2
                jz      short tail_loop_start_0
                repe cmpsd
                jz      short tail_loop_start_0
                mov     ecx, dword ptr [esi-4]
                mov     edx, dword ptr [edi-4]
                cmp     cl, dl
                jnz     short difference_in_tail
                cmp     ch, dh
                jnz     short difference_in_tail
                shr     ecx, 10h
                shr     edx, 10h
                cmp     cl, dl
                jnz     short difference_in_tail
                cmp     ch, dh

difference_in_tail:                     ; CODE XREF: _memcmp+63↑j
                mov     eax, 0

not_equal:                              ; CODE XREF: _memcmp+26↑j
                sbb     eax, eax
                pop     edi
                sbb     eax, 0FFFFFFFFh
                pop     esi
                retn
; ---------------------------------------------------------------------------

tail_loop_start_0:                      ; CODE XREF: _memcmp+55↑j
                test    eax, eax
                jz      short done
                mov     edx, dword ptr [esi]
                mov     ecx, dword ptr [edi]
                cmp     dl, cl
                jnz     short difference_in_tail
                dec     eax
                jz      short tail_done
                cmp     dh, ch
                jnz     short difference_in_tail
                dec     eax
                jz      short tail_done
                and     ecx, 0FF0000h
                and     edx, 0FF0000h
                cmp     edx, ecx
                jnz     short difference_in_tail
                dec     eax

tail_done:                              ; CODE XREF: _memcmp+8F↑j
                pop     edi
                pop     esi
                retn
_memcmp         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _tolower(int C)
__tolower       proc near

varC               = dword ptr  4

                mov     eax, dword ptr [esp+varC]
                add     eax, 20h ; ' '
                retn
__tolower       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl tolower(int C)
_tolower        proc near               ; CODE XREF: sub_47641D+76↑p

varC               = dword ptr  4

                mov     eax, dword_70D558
                test    eax, eax
                jnz     short loc_5C0E7B
                mov     eax, dword ptr [esp+varC]
                cmp     eax, 41h ; 'A'
                jl      short locret_5C0EE1
                cmp     eax, 5Ah ; 'Z'
                jg      short locret_5C0EE1
                add     eax, 20h ; ' '
                retn
; ---------------------------------------------------------------------------

loc_5C0E7B:                             ; CODE XREF: _tolower+7↑j
                push    edi
                push    esi
                push    ebx
                push    offset Addend   ; lpAddend
                call    InterlockedIncrement
                mov     eax, dword_70E964
                mov     edi, ds:InterlockedDecrement
                test    eax, eax
                jz      short loc_5C0EB0
                push    offset Addend   ; lpAddend
                call    edi ; InterlockedDecrement
                push    13h
                call    __lock
                add     esp, 4
                mov     esi, 1
                jmp     short loc_5C0EB2
; ---------------------------------------------------------------------------

loc_5C0EB0:                             ; CODE XREF: _tolower+36↑j
                xor     esi, esi

loc_5C0EB2:                             ; CODE XREF: _tolower+4E↑j
                mov     eax, dword ptr [esp+0Ch+varC]
                push    eax             ; C
                call    _tolower_0
                add     esp, 4
                mov     ebx, eax
                test    esi, esi
                jz      short loc_5C0ED5
                push    13h
                call    __unlock
                add     esp, 4
                mov     eax, ebx
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_5C0ED5:                             ; CODE XREF: _tolower+63↑j
                push    offset Addend   ; lpAddend
                call    edi ; InterlockedDecrement
                mov     eax, ebx
                pop     ebx
                pop     esi
                pop     edi

locret_5C0EE1:                          ; CODE XREF: _tolower+10↑j
                retn
_tolower        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl tolower_0(int C)
_tolower_0      proc near               ; CODE XREF: __strcmpi+94↑p

DestStr         = byte ptr -8
varC               = dword ptr  4

                mov     eax, dword_70D558
                sub     esp, 8
                test    eax, eax
                push    ebx
                jnz     short loc_5C0F1B
                mov     eax, dword ptr [esp+0Ch+varC]
                cmp     eax, 41h ; 'A'
                jl      loc_5C0FE7
                cmp     eax, 5Ah ; 'Z'
                jg      loc_5C0FE7
                add     eax, 20h ; ' '
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C0F1B:                             ; CODE XREF: _tolower_0+B↑j
                mov     ebx, dword ptr [esp+0Ch+varC]
                cmp     ebx, 100h
                jge     short loc_5C0F53
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5C0F3D
                push    1               ; Type
                push    ebx             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5C0F48
; ---------------------------------------------------------------------------

loc_5C0F3D:                             ; CODE XREF: _tolower_0+3E↑j
                mov     eax, off_641268
                mov     al, [eax+ebx*2]
                and     eax, 1

loc_5C0F48:                             ; CODE XREF: _tolower_0+4B↑j
                test    eax, eax
                jnz     short loc_5C0F53
                mov     eax, ebx
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C0F53:                             ; CODE XREF: _tolower_0+35↑j
                mov     edx, off_641268
                mov     eax, ebx
                sar     eax, 8
                mov     ecx, eax
                and     ecx, 0FFh
                test    byte ptr [edx+ecx*2+1], 80h
                jz      short loc_5C0F81
                mov     byte ptr [esp+0Ch+varC], al
                mov     byte ptr [esp+0Ch+varC+1], bl
                mov     byte ptr [esp+0Ch+varC+2], 0
                mov     eax, 2
                jmp     short loc_5C0F8F
; ---------------------------------------------------------------------------

loc_5C0F81:                             ; CODE XREF: _tolower_0+7B↑j
                mov     byte ptr [esp+0Ch+varC], bl
                mov     byte ptr [esp+0Ch+varC+1], 0
                mov     eax, 1

loc_5C0F8F:                             ; CODE XREF: _tolower_0+8F↑j
                push    0               ; CodePage
                lea     ecx, [esp+10h+DestStr]
                push    3               ; cchDest
                push    ecx             ; lpDestStr
                lea     edx, [esp+18h+varC]
                push    eax             ; lpWideCharStr
                mov     eax, dword_70D558
                push    edx             ; lpSrcStr
                push    100h            ; dwMapFlags
                push    eax             ; Locale
                call    ___crtLCMapStringA
                add     esp, 1Ch
                test    eax, eax
                jnz     short loc_5C0FBC
                mov     eax, ebx
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C0FBC:                             ; CODE XREF: _tolower_0+C3↑j
                cmp     eax, 1
                jnz     short loc_5C0FCF
                mov     eax, dword ptr [esp+0Ch+DestStr]
                and     eax, 0FFh
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C0FCF:                             ; CODE XREF: _tolower_0+CF↑j
                mov     eax, dword ptr [esp+0Ch+DestStr+1]
                mov     ecx, dword ptr [esp+0Ch+DestStr]
                and     eax, 0FFh
                and     ecx, 0FFh
                shl     eax, 8
                or      eax, ecx

loc_5C0FE7:                             ; CODE XREF: _tolower_0+14↑j
                pop     ebx
                add     esp, 8
                retn
_tolower_0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; char *__cdecl strrchr(const char *varStr, int Ch)
_strrchr        proc near               ; CODE XREF: sub_47B24E+9B7↑p

varStr             = dword ptr  8
arg_4           = dword ptr  0Ch

                push    ebp
                mov     ebp, esp
                push    edi
                mov     edi, [ebp+varStr]
                xor     eax, eax
                or      ecx, 0FFFFFFFFh
                repne scasb
                inc     ecx
                neg     ecx
                dec     edi
                mov     al, byte ptr [ebp+arg_4]
                std
                repne scasb
                inc     edi
                cmp     [edi], al
                jz      short returndi
                xor     eax, eax
                jmp     short toend_0
; ---------------------------------------------------------------------------

returndi:                               ; CODE XREF: _strrchr+1B↑j
                mov     eax, edi

toend_0:                                ; CODE XREF: _strrchr+1F↑j
                cld
                pop     edi
                leave
                retn
_strrchr        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__cinit         proc near               ; CODE XREF: start+C4↓p
                mov     eax, off_63ED28
                test    eax, eax
                jz      short loc_5C102B
                call    eax ; __fpmath

loc_5C102B:                             ; CODE XREF: __cinit+7↑j
                push    offset __xc_z     ; Last
                push    offset __xc_a    ; First
                call    __initterm
                add     esp, 8
                push    offset __xi_z ; Last
                push    offset __xi_a ; First
                call    __initterm
                add     esp, 8
                retn
__cinit         endp







; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn

; void __stdcall __noreturn _CxxThrowException(void *pExceptionObject, _ThrowInfo *pThrowInfo)
__CxxThrowException@8 proc near         ; CODE XREF: sub_4835B0+E2↑p

dwExceptionCode = dword ptr -20h
dwExceptionFlags= dword ptr -1Ch
nNumberOfArguments= dword ptr -10h
Arguments       = dword ptr -0Ch
var_8           = dword ptr -8
var_4           = dword ptr -4
pExceptionObject= dword ptr  4
pThrowInfo      = dword ptr  8

                sub     esp, 20h
                mov     eax, dword ptr [esp+20h+pExceptionObject]
                push    esi
                push    edi
                mov     ecx, 8
                mov     esi, offset unk_614428
                lea     edi, [esp+28h+dwExceptionCode]
                rep movsd
                mov     ecx, dword ptr [esp+28h+pThrowInfo]
                mov     [esp+28h+var_8], eax
                mov     eax, dword ptr [esp+28h+nNumberOfArguments]
                lea     edx, [esp+28h+Arguments]
                mov     [esp+28h+var_4], ecx
                mov     ecx, dword ptr [esp+28h+dwExceptionFlags]
                push    edx             ; lpArguments
                mov     edx, dword ptr [esp+2Ch+dwExceptionCode]
                push    eax             ; nNumberOfArguments
                push    ecx             ; dwExceptionFlags
                push    edx             ; dwExceptionCode
                call    RaiseException
                pop     edi
                pop     esi
                add     esp, 20h
                retn    8
__CxxThrowException@8 endp

; ---------------------------------------------------------------------------
                align 10h
                push    esi
                inc     ebx
                xor     dh, [eax]
                pop     eax
                inc     ebx
                xor     [eax], dh

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; int __cdecl _except_handler3(int, PVOID TargetFrame, int)
__except_handler3 proc near             ; DATA XREF: sub_48A756+A↑o

var_8           = dword ptr -8
var_4           = dword ptr -4
arg_0           = dword ptr  8
TargetFrame     = dword ptr  0Ch
arg_8           = dword ptr  10h

                push    ebp
                mov     ebp, esp
                sub     esp, 8
                push    ebx
                push    esi
                push    edi
                push    ebp
                cld
                mov     ebx, dword ptr [ebp+TargetFrame]
                mov     eax, dword ptr [ebp+arg_0]
                test    dword ptr [eax+4], 6
                jnz     _lh_unwinding
                mov     [ebp+var_8], eax
                mov     eax, dword ptr [ebp+arg_8]
                mov     [ebp+var_4], eax
                lea     eax, [ebp+var_8]
                mov     [ebx-4], eax
                mov     esi, [ebx+0Ch]
                mov     edi, [ebx+8]

_lh_top:                                ; CODE XREF: __except_handler3+90↓j
                cmp     esi, 0FFFFFFFFh
                jz      short _lh_bagit
                lea     ecx, [esi+esi*2]
                cmp     dword ptr [edi+ecx*4+4], 0
                jz      short _lh_continue
                push    esi
                push    ebp
                lea     ebp, [ebx+10h]
                call    dword ptr [edi+ecx*4+4]
                pop     ebp
                pop     esi
                mov     ebx, dword ptr [ebp+TargetFrame]
                or      eax, eax
                jz      short _lh_continue
                js      short _lh_dismiss
                mov     edi, [ebx+8]
                push    ebx             ; TargetFrame
                call    __global_unwind2
                add     esp, 4
                lea     ebp, [ebx+10h]
                push    esi
                push    ebx
                call    __local_unwind2
                add     esp, 8
                lea     ecx, [esi+esi*2]
                push    1
                mov     eax, dword ptr [edi+ecx*4+8]
                call    __NLG_Notify
                mov     eax, dword ptr [edi+ecx*4]
                mov     [ebx+0Ch], eax
                call    dword ptr [edi+ecx*4+8]

_lh_continue:                           ; CODE XREF: __except_handler3+40↑j
                mov     edi, [ebx+8]
                lea     ecx, [esi+esi*2]
                mov     esi, [edi+ecx*4]
                jmp     short _lh_top
; ---------------------------------------------------------------------------

_lh_dismiss:                            ; CODE XREF: __except_handler3+54↑j
                mov     eax, 0
                jmp     short _lh_return
; ---------------------------------------------------------------------------

_lh_bagit:                              ; CODE XREF: __except_handler3+36↑j
                mov     eax, 1
                jmp     short _lh_return
; ---------------------------------------------------------------------------

_lh_unwinding:                          ; CODE XREF: __except_handler3+18↑j
                push    ebp
                lea     ebp, [ebx+10h]
                push    0FFFFFFFFh
                push    ebx
                call    __local_unwind2
                add     esp, 8
                pop     ebp
                mov     eax, 1

_lh_return:                             ; CODE XREF: __except_handler3+97↑j
                pop     ebp
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn
__except_handler3 endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; __stdcall _seh_longjmp_unwind(x)
__seh_longjmp_unwind@4 proc near

arg_0           = dword ptr  4

                push    ebp
                mov     ecx, dword ptr [esp+4+arg_0]
                mov     ebp, [ecx]
                mov     eax, dword ptr [ecx+1Ch]
                push    eax
                mov     eax, dword ptr [ecx+18h]
                push    eax
                call    __local_unwind2
                add     esp, 8
                pop     ebp
                retn    4
__seh_longjmp_unwind@4 endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn

; void __cdecl __noreturn abort()
_abort          proc near               ; CODE XREF: sub_48DD3A+47↑p
                push    0Ah
                call    __NMSG_WRITE
                add     esp, 4
                push    16h             ; Signal
                call    _raise
                add     esp, 4
                push    3               ; Code
                call    __exit
_abort          endp

; ---------------------------------------------------------------------------
                add     esp, 4
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__CIsin         proc near

var_8           = qword ptr -8

                sub     esp, 8
                fst     [esp+8+var_8]
                call    __checkTOS_withFB
                call    loc_5C131D
                add     esp, 8
                retn
__CIsin         endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl sin(double X)
_sin            proc near               ; CODE XREF: sub_4A952B+26F↑p

var_4           = word ptr -4
X               = qword ptr  4

; FUNCTION CHUNK AT 005C860E SIZE 00000037 BYTES

                lea     edx, [esp+X]
                call    __fload_withFB

loc_5C131D:                             ; CODE XREF: __CIsin+B↑p
                push    edx
                fstcw   [esp+4+var_4]
                jz      short loc_5C1374
                cmp     [esp+4+var_4], 27Fh
                jz      short loc_5C1332
                fldcw   ds:word_614678

loc_5C1332:                             ; CODE XREF: _sin+16↑j
                fsin
                fstsw   ax
                sahf
                jp      short loc_5C1357

loc_5C133A:                             ; CODE XREF: _sin+57↓j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                mov     edx, 1Eh
                lea     ecx, aSin_0
                jmp     __math_exit
; ---------------------------------------------------------------------------

loc_5C1357:                             ; CODE XREF: _sin+24↑j
                fld     ds:tbyte_61467A
                fxch    st(1)

loc_5C135F:                             ; CODE XREF: _sin+51↓j
                fprem1
                fstsw   ax
                sahf
                jp      short loc_5C135F
                fstp    st(1)
                fsin
                jmp     short loc_5C133A
; ---------------------------------------------------------------------------

loc_5C136D:                             ; CODE XREF: _sin+65↓j
                call    __convertTOStoQNaN
                jmp     short loc_5C138F
; ---------------------------------------------------------------------------

loc_5C1374:                             ; CODE XREF: _sin+E↑j
                test    eax, 0FFFFFh
                jnz     short loc_5C136D
                cmp     dword ptr [esp+4+X], 0
                jnz     short loc_5C136D
                fstp    st
                fld     tbyte ptr [tbyte_641230]
                mov     eax, 1

loc_5C138F:                             ; CODE XREF: _sin+5E↑j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                mov     edx, 1Eh
                lea     ecx, aSin_0
                call    __startOneArgErrorHandling
                pop     edx
                retn
_sin            endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


_atan2      proc near               ; CODE XREF: sub_4A952B+230↑p
                mov     edx, offset unk_6416E0
                jmp     __ctrandisp2
_atan2      endp

; ---------------------------------------------------------------------------
                mov     edx, offset unk_6416E0
                jmp     __cintrindisp2
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__CIcos         proc near

var_8           = qword ptr -8

                sub     esp, 8
                fst     [esp+8+var_8]
                call    __checkTOS_withFB
                call    loc_5C13ED
                add     esp, 8
                retn
__CIcos         endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl cos(double X)
_cos            proc near               ; CODE XREF: sub_4A952B+69↑p

var_4           = word ptr -4
X               = qword ptr  4

; FUNCTION CHUNK AT 005C860E SIZE 00000037 BYTES

                lea     edx, [esp+X]
                call    __fload_withFB

loc_5C13ED:                             ; CODE XREF: __CIcos+B↑p
                push    edx
                fstcw   [esp+4+var_4]
                jz      short loc_5C1444
                cmp     [esp+4+var_4], 27Fh
                jz      short loc_5C1402
                fldcw   ds:word_614678

loc_5C1402:                             ; CODE XREF: _cos+16↑j
                fcos
                fstsw   ax
                sahf
                jp      short loc_5C1427

loc_5C140A:                             ; CODE XREF: _cos+57↓j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                mov     edx, 12h
                lea     ecx, aCos_0
                jmp     __math_exit
; ---------------------------------------------------------------------------

loc_5C1427:                             ; CODE XREF: _cos+24↑j
                fld     ds:tbyte_61467A
                fxch    st(1)

loc_5C142F:                             ; CODE XREF: _cos+51↓j
                fprem1
                fstsw   ax
                sahf
                jp      short loc_5C142F
                fstp    st(1)
                fcos
                jmp     short loc_5C140A
; ---------------------------------------------------------------------------

loc_5C143D:                             ; CODE XREF: _cos+65↓j
                call    __convertTOStoQNaN
                jmp     short loc_5C145F
; ---------------------------------------------------------------------------

loc_5C1444:                             ; CODE XREF: _cos+E↑j
                test    eax, 0FFFFFh
                jnz     short loc_5C143D
                cmp     dword ptr [esp+4+X], 0
                jnz     short loc_5C143D
                fstp    st
                fld     tbyte ptr [tbyte_641230]
                mov     eax, 1

loc_5C145F:                             ; CODE XREF: _cos+5E↑j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                mov     edx, 12h
                lea     ecx, aCos_0
                call    __startOneArgErrorHandling
                pop     edx
                retn
_cos            endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl fabs(double X)
_fabs           proc near               ; CODE XREF: sub_4A952B+43↑p

var_20          = qword ptr -20h
var_8           = qword ptr -8
X               = qword ptr  4

                sub     esp, 8
                push    ebx
                push    esi
                push    edi
                push    0FFFFh
                push    133Fh
                call    __ctrlfp
                mov     esi, eax
                mov     eax, dword ptr [esp+1Ch+X+6]
                and     eax, 7FF0h
                add     esp, 8
                cmp     eax, 7FF0h
                jnz     loc_5C1536
                mov     edi, dword ptr [esp+14h+X+4]
                mov     ebx, dword ptr [esp+14h+X]
                push    edi
                push    ebx
                call    __sptype
                add     esp, 8
                dec     eax
                jz      short loc_5C151D
                dec     eax
                jz      short loc_5C1502
                dec     eax
                push    esi             ; int
                jz      short loc_5C14EF
                fld     [esp+18h+X]
                fsub    qword ptr [dbl_614448]
                sub     esp, 8
                fstp    [esp+20h+var_20] ; double
                push    edi             ; int
                push    ebx             ; int
                push    15h             ; int
                push    8               ; char
                call    __except1
                add     esp, 1Ch
                pop     edi
                pop     esi
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C14EF:                             ; CODE XREF: _fabs+48↑j
                push    edi
                push    ebx             ; double
                push    15h             ; int
                call    __handle_qnan1
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C1502:                             ; CODE XREF: _fabs+44↑j
                push    0FFFFh
                push    esi
                call    __ctrlfp
                fld     [esp+1Ch+X]
                fchs
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C151D:                             ; CODE XREF: _fabs+41↑j
                push    0FFFFh
                push    esi
                call    __ctrlfp
                fld     [esp+1Ch+X]
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C1536:                             ; CODE XREF: _fabs+28↑j
                mov     ecx, dword ptr [esp+14h+X+4]
                mov     edx, dword ptr [esp+14h+X]
                and     ecx, 7FFFFFFFh
                push    0FFFFh
                push    esi
                mov     dword ptr [esp+1Ch+var_8+4], ecx
                mov     dword ptr [esp+1Ch+var_8], edx
                call    __ctrlfp
                fld     [esp+1Ch+var_8]
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebx
                add     esp, 8
                retn
_fabs           endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__CIatan        proc near

var_8           = qword ptr -8

                sub     esp, 8
                fst     [esp+8+var_8]
                call    __checkTOS_withFB
                call    loc_5C158D
                add     esp, 8
                retn
__CIatan        endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl atan(double X)
_atan           proc near               ; CODE XREF: sub_4AA0AF+70↑p

var_4           = word ptr -4
X               = qword ptr  4

; FUNCTION CHUNK AT 005C860E SIZE 00000037 BYTES

                lea     edx, [esp+X]
                call    __fload_withFB

loc_5C158D:                             ; CODE XREF: __CIatan+B↑p
                push    edx
                fstcw   [esp+4+var_4]
                jz      short loc_5C15CA
                cmp     [esp+4+var_4], 27Fh
                jz      short loc_5C15A2
                fldcw   ds:word_614678

loc_5C15A2:                             ; CODE XREF: _atan+16↑j
                fld1
                fpatan

loc_5C15A6:                             ; CODE XREF: _atan+61↓j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                mov     edx, 0Fh
                lea     ecx, aAtan      ; "atan"
                jmp     __math_exit
; ---------------------------------------------------------------------------

loc_5C15C3:                             ; CODE XREF: _atan+4B↓j
                call    __convertTOStoQNaN
                jmp     short loc_5C15F0
; ---------------------------------------------------------------------------

loc_5C15CA:                             ; CODE XREF: _atan+E↑j
                test    eax, 0FFFFFh
                jnz     short loc_5C15C3
                cmp     dword ptr [esp+4+X], 0
                jnz     short loc_5C15C3
                fstp    st
                fld     tbyte_64123A
                test    eax, 80000000h
                jz      short loc_5C15A6
                fchs
                jmp     short loc_5C15A6
; ---------------------------------------------------------------------------
                mov     eax, 1

loc_5C15F0:                             ; CODE XREF: _atan+44↑j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                mov     edx, 0Fh
                lea     ecx, aAtan      ; "atan"
                call    __startOneArgErrorHandling
                pop     edx
                retn
_atan           endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__CIlog10       proc near

var_8           = qword ptr -8

                sub     esp, 8
                fst     [esp+8+var_8]
                call    __checkTOS_withFB
                call    loc_5C162D
                add     esp, 8
                retn
__CIlog10       endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl log10(double X)
_log10          proc near               ; CODE XREF: sub_4B5072+6C7↑p

var_4           = word ptr -4
X               = qword ptr  4

; FUNCTION CHUNK AT 005C860E SIZE 00000037 BYTES

                lea     edx, [esp+X]
                call    __fload_withFB

loc_5C162D:                             ; CODE XREF: __CIlog10+B↑p
                push    edx
                fstcw   [esp+4+var_4]
                jz      short loc_5C1677
                mov     eax, dword ptr [esp+4+X+4]
                cmp     [esp+4+var_4], 27Fh
                jz      short loc_5C1646
                fldcw   ds:word_614678

loc_5C1646:                             ; CODE XREF: _log10+1A↑j
                test    eax, 7FF00000h
                jz      short loc_5C16A2
                test    eax, 80000000h
                jnz     short loc_5C168C

loc_5C1654:                             ; CODE XREF: _log10+83↓j
                fldlg2
                fxch    st(1)
                fyl2x

loc_5C165A:                             ; CODE XREF: _log10+66↓j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                lea     ecx, aLog10     ; "log10"
                mov     edx, 1Bh
                jmp     __math_exit
; ---------------------------------------------------------------------------

loc_5C1677:                             ; CODE XREF: _log10+E↑j
                test    eax, 0FFFFFh
                jnz     short loc_5C169B
                cmp     dword ptr [esp+4+X], 0
                jnz     short loc_5C169B
                and     eax, 80000000h
                jz      short loc_5C165A

loc_5C168C:                             ; CODE XREF: _log10+2E↑j
                fstp    st
                fld     tbyte ptr [tbyte_641230]
                mov     eax, 1
                jmp     short loc_5C16BD
; ---------------------------------------------------------------------------

loc_5C169B:                             ; CODE XREF: _log10+58↑j
                call    __convertTOStoQNaN
                jmp     short loc_5C16BD
; ---------------------------------------------------------------------------

loc_5C16A2:                             ; CODE XREF: _log10+27↑j
                test    eax, 0FFFFFh
                jnz     short loc_5C1654
                cmp     dword ptr [esp+4+X], 0
                jnz     short loc_5C1654
                fstp    st
                fld     tbyte ptr [tbyte_64148A]
                mov     eax, 2

loc_5C16BD:                             ; CODE XREF: _log10+75↑j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                lea     ecx, aLog10     ; "log10"
                mov     edx, 1Bh
                call    __startOneArgErrorHandling
                pop     edx
                retn
_log10          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl _hypot(double X, double Y)
__hypot         proc near               ; CODE XREF: .text:004CB616↑p

X               = qword ptr  4
Y               = qword ptr  0Ch

                mov     eax, dword ptr [esp+Y+4]
                mov     ecx, dword ptr [esp+Y]
                mov     edx, dword ptr [esp+X+4]
                push    18h             ; int
                push    eax
                mov     eax, dword ptr [esp+8+X]
                push    ecx             ; double
                push    edx             ; int
                push    eax             ; int
                call    __hypothlp
                add     esp, 14h
                retn
__hypot         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl _cabs(struct _complex Complex_value)
__cabs          proc near

Complex_value   = _complex ptr  4

                mov     eax, dword ptr [esp+Complex_value.y+4]
                mov     ecx, dword ptr [esp+Complex_value.y]
                mov     edx, dword ptr [esp+Complex_value.x+4]
                push    11h             ; int
                push    eax
                mov     eax, dword ptr [esp+8+Complex_value.x]
                push    ecx             ; double
                push    edx             ; int
                push    eax             ; int
                call    __hypothlp
                add     esp, 14h
                retn
__cabs          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl _hypothlp(int, int, double, int)
__hypothlp      proc near               ; CODE XREF: __hypot+16↑p

X               = qword ptr -2Ch
var_10          = dword ptr -10h
var_C           = dword ptr -0Ch
var_8           = qword ptr -8
arg_0           = dword ptr  4
arg_8           = qword ptr  0Ch
arg_10          = dword ptr  14h

                sub     esp, 10h
                push    ebx
                push    ebp
                push    esi
                push    edi
                push    0FFFFh
                push    133Fh
                call    __ctrlfp
                mov     ebx, eax
                mov     eax, dword ptr [esp+32h]
                mov     ecx, eax
                add     esp, 8
                and     ecx, 7FF0h
                cmp     ecx, 7FF0h
                mov     ecx, dword ptr [esp+20h+arg_8+6]
                jz      loc_5C197F
                mov     edx, ecx
                and     edx, 7FF0h
                cmp     edx, 7FF0h
                jz      loc_5C197F
                fld     qword ptr [esp+20h+arg_0]
                fcomp   qword ptr [dbl_614450]
                fnstsw  ax
                test    ah, 1
                jz      short loc_5C1786
                fld     qword ptr [esp+20h+arg_0]
                fchs
                fstp    qword ptr [esp+20h+arg_0]

loc_5C1786:                             ; CODE XREF: __hypothlp+5A↑j
                fld     [esp+20h+arg_8]
                fcomp   qword ptr [dbl_614450]
                fnstsw  ax
                test    ah, 1
                jz      short loc_5C17A1
                fld     [esp+20h+arg_8]
                fchs
                fstp    [esp+20h+arg_8]

loc_5C17A1:                             ; CODE XREF: __hypothlp+75↑j
                fld     [esp+20h+arg_8]
                fcomp   qword ptr [esp+20h+arg_0]
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5C17BE
                mov     esi, dword ptr [esp+20h+arg_8]
                mov     edi, dword ptr [esp+20h+arg_8+4]
                mov     dword ptr [esp+20h+var_8], esi
                jmp     short loc_5C17CA
; ---------------------------------------------------------------------------

loc_5C17BE:                             ; CODE XREF: __hypothlp+8E↑j
                mov     esi, [esp+20h+arg_0]
                mov     edi, [esp+28h]
                mov     dword ptr [esp+20h+var_8], esi

loc_5C17CA:                             ; CODE XREF: __hypothlp+9C↑j
                mov     dword ptr [esp+20h+var_8+4], edi
                fld     [esp+20h+var_8]
                fcomp   qword ptr [dbl_614450]
                fnstsw  ax
                test    ah, 40h
                jz      short loc_5C17FB
                push    0FFFFh
                push    ebx
                call    __ctrlfp
                fld     qword ptr [dbl_614450]
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 10h
                retn
; ---------------------------------------------------------------------------

loc_5C17FB:                             ; CODE XREF: __hypothlp+BD↑j
                fld     qword ptr [esp+20h+arg_0]
                fdiv    [esp+20h+var_8]
                lea     eax, [esp+20h+var_C]
                push    eax             ; int
                sub     esp, 8
                fstp    qword ptr [esp+2Ch+arg_0]
                fld     qword ptr [esp+38h]
                fdiv    [esp+2Ch+var_8]
                fstp    qword ptr [esp+38h]
                fld     qword ptr [esp+2Ch+arg_0]
                fmul    qword ptr [esp+2Ch+arg_0]
                fld     qword ptr [esp+38h]
                fmul    qword ptr [esp+38h]
                faddp   st(1), st
                fstp    [esp+2Ch+X]     ; X
                call    _sqrt
                fstp    [esp+2Ch+X]     ; double
                call    __decomp
                fstp    [esp+2Ch+var_8]
                add     esp, 0Ch
                lea     ecx, [esp+20h+var_10]
                push    ecx             ; int
                push    edi
                push    esi             ; double
                call    __decomp
                fmul    [esp+2Ch+var_8]
                add     esp, 0Ch
                fstp    [esp+20h+var_8]
                mov     esi, dword ptr [esp+20h+var_8+4]
                mov     edi, dword ptr [esp+20h+var_8]
                push    esi
                push    edi
                call    __get_exp
                mov     ebp, [esp+28h+var_10]
                mov     edx, dword ptr [esp+28h+var_C]
                add     eax, ebp
                add     esp, 8
                add     eax, edx
                cmp     eax, 400h
                jle     short loc_5C18CA
                add     eax, 0FFFFFA00h
                push    eax
                push    esi
                push    edi
                call    __set_exp
                fstp    [esp+2Ch+var_8]
                mov     edx, dword ptr [esp+2Ch+var_8+4]
                mov     eax, dword ptr [esp+2Ch+var_8]
                mov     ecx, dword ptr [esp+3Ch]
                add     esp, 0Ch
                push    ebx             ; int
                push    edx
                mov     edx, dword ptr [esp+28h+arg_8]
                push    eax             ; double
                mov     eax, dword ptr [esp+34h]
                push    ecx             ; int
                mov     ecx, dword ptr [esp+30h+arg_0]
                push    edx             ; int
                mov     edx, dword ptr [esp+34h+arg_10]
                push    eax             ; int
                push    ecx             ; int
                push    edx             ; int
                push    11h             ; char
                call    __except2
                add     esp, 24h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 10h
                retn
; ---------------------------------------------------------------------------

loc_5C18CA:                             ; CODE XREF: __hypothlp+15E↑j
                cmp     eax, 0FFFFFC03h
                jge     short loc_5C191B
                add     eax, 600h
                push    eax
                push    esi
                push    edi
                call    __set_exp
                fstp    [esp+2Ch+var_8]
                mov     eax, dword ptr [esp+2Ch+var_8+4]
                mov     ecx, dword ptr [esp+2Ch+var_8]
                mov     edx, dword ptr [esp+3Ch]
                add     esp, 0Ch
                push    ebx             ; int
                push    eax
                mov     eax, dword ptr [esp+28h+arg_8]
                push    ecx             ; double
                mov     ecx, dword ptr [esp+34h]
                push    edx             ; int
                mov     edx, dword ptr [esp+30h+arg_0]
                push    eax             ; int
                mov     eax, dword ptr [esp+34h+arg_10]
                push    ecx             ; int
                push    edx             ; int
                push    eax             ; int
                push    12h             ; char
                call    __except2
                add     esp, 24h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 10h
                retn
; ---------------------------------------------------------------------------

loc_5C191B:                             ; CODE XREF: __hypothlp+1AF↑j
                push    eax
                push    esi
                push    edi
                call    __set_exp
                fstp    [esp+2Ch+var_8]
                add     esp, 0Ch
                test    bl, 20h
                jz      short loc_5C1949
                push    0FFFFh
                push    ebx
                call    __ctrlfp
                fld     [esp+28h+var_8]
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 10h
                retn
; ---------------------------------------------------------------------------

loc_5C1949:                             ; CODE XREF: __hypothlp+20D↑j
                mov     ecx, dword ptr [esp+20h+var_8+4]
                mov     edx, dword ptr [esp+20h+var_8]
                mov     eax, dword ptr [esp+30h]
                push    ebx             ; int
                push    ecx
                mov     ecx, dword ptr [esp+28h+arg_8]
                push    edx             ; double
                mov     edx, dword ptr [esp+34h]
                push    eax             ; int
                mov     eax, dword ptr [esp+30h+arg_0]
                push    ecx             ; int
                mov     ecx, dword ptr [esp+34h+arg_10]
                push    edx             ; int
                push    eax             ; int
                push    ecx             ; int
                push    10h             ; char
                call    __except2
                add     esp, 24h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 10h
                retn
; ---------------------------------------------------------------------------

loc_5C197F:                             ; CODE XREF: __hypothlp+31↑j
                mov     edi, [esp+20h+arg_0]
                mov     ebp, [esp+28h]
                and     eax, 7FF8h
                cmp     ax, 7FF0h
                jnz     short loc_5C199E
                test    ebp, 7FFFFh
                jnz     short loc_5C19C1
                test    edi, edi
                jnz     short loc_5C19C1

loc_5C199E:                             ; CODE XREF: __hypothlp+270↑j
                mov     edx, dword ptr [esp+30h]
                mov     esi, dword ptr [esp+20h+arg_8]
                and     ecx, 7FF8h
                cmp     cx, 7FF0h
                jnz     short loc_5C19F3
                test    edx, 7FFFFh
                jnz     short loc_5C19C9
                test    esi, esi
                jz      short loc_5C19F3
                jmp     short loc_5C19C9
; ---------------------------------------------------------------------------

loc_5C19C1:                             ; CODE XREF: __hypothlp+278↑j
                mov     edx, dword ptr [esp+30h]
                mov     esi, dword ptr [esp+20h+arg_8]

loc_5C19C9:                             ; CODE XREF: __hypothlp+299↑j
                fld     [esp+20h+arg_8]
                fadd    qword ptr [esp+20h+arg_0]
                push    ebx             ; int
                sub     esp, 8
                fstp    [esp+2Ch+X]     ; double
                push    edx             ; int
                mov     edx, dword ptr [esp+30h+arg_10]
                push    esi             ; int
                push    ebp             ; int
                push    edi             ; int
                push    edx             ; int
                push    8               ; char
                call    __except2
                add     esp, 24h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 10h
                retn
; ---------------------------------------------------------------------------

loc_5C19F3:                             ; CODE XREF: __hypothlp+291↑j
                cmp     ax, 7FF8h
                jz      short loc_5C1A1C
                cmp     cx, 7FF8h
                jz      short loc_5C1A1C
                push    0FFFFh
                push    ebx
                call    __ctrlfp
                fld     qword ptr [g_Number]
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 10h
                retn
; ---------------------------------------------------------------------------

loc_5C1A1C:                             ; CODE XREF: __hypothlp+2D7↑j
                mov     eax, dword ptr [esp+20h+arg_10]
                push    ebx
                push    edx
                push    esi
                push    ebp
                push    edi
                push    eax
                call    __handle_qnan2
                add     esp, 18h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 10h
                retn
__hypothlp      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__CIacos        proc near

var_8           = qword ptr -8

                sub     esp, 8
                fst     [esp+8+var_8]
                call    __checkTOS_withFB
                call    loc_5C1A5D
                add     esp, 8
                retn
__CIacos        endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl acos(double X)
_acos           proc near               ; CODE XREF: sub_4CC944+76↑p

var_4           = word ptr -4
X               = qword ptr  4

; FUNCTION CHUNK AT 005C860E SIZE 00000037 BYTES

                lea     edx, [esp+X]
                call    __fload_withFB

loc_5C1A5D:                             ; CODE XREF: __CIacos+B↑p
                push    edx
                fstcw   [esp+4+var_4]
                jz      short loc_5C1AD1
                cmp     [esp+4+var_4], 27Fh
                jz      short loc_5C1A71
                call    __load_CW

loc_5C1A71:                             ; CODE XREF: _acos+16↑j
                cmp     eax, 3FF00000h
                jnb     short loc_5C1AA5
                fld1
                fadd    st, st(1)
                fld1
                fsub    st, st(2)
                fmulp   st(1), st
                fsqrt
                fxch    st(1)
                fpatan

loc_5C1A88:                             ; CODE XREF: _acos+70↓j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                mov     edx, 0Dh
                lea     ecx, aAcos      ; "acos"
                jmp     __math_exit
; ---------------------------------------------------------------------------

loc_5C1AA5:                             ; CODE XREF: _acos+22↑j
                ja      short loc_5C1ADF
                mov     eax, dword ptr [esp+4+X+4]
                mov     ecx, eax
                and     eax, 0FFFFFh
                or      eax, dword ptr [esp+4+X]
                jnz     short loc_5C1ADF
                and     ecx, 80000000h
                fstp    st
                jz      short loc_5C1AC6
                fldpi
                jmp     short loc_5C1A88
; ---------------------------------------------------------------------------

loc_5C1AC6:                             ; CODE XREF: _acos+6C↑j
                fldz
                jmp     short loc_5C1A88
; ---------------------------------------------------------------------------

loc_5C1ACA:                             ; CODE XREF: _acos+82↓j
                call    __convertTOStoQNaN
                jmp     short loc_5C1AEC
; ---------------------------------------------------------------------------

loc_5C1AD1:                             ; CODE XREF: _acos+E↑j
                test    eax, 0FFFFFh
                jnz     short loc_5C1ACA
                cmp     dword ptr [esp+4+X], 0
                jnz     short loc_5C1ACA

loc_5C1ADF:                             ; CODE XREF: _acos:loc_5C1AA5↑j
                fstp    st
                fld     tbyte ptr [tbyte_641230]
                mov     eax, 1

loc_5C1AEC:                             ; CODE XREF: _acos+7B↑j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                mov     edx, 0Dh
                lea     ecx, aAcos      ; "acos"
                call    __startOneArgErrorHandling
                pop     edx
                retn
_acos           endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl fgets(char *Buffer, int MaxCount, FILE *Stream)
_fgets          proc near               ; CODE XREF: .text:004E541A↑p

Buffer          = dword ptr  4
MaxCount        = dword ptr  8
Stream          = dword ptr  0Ch

                push    ebx
                mov     ebx, dword ptr [esp+4+MaxCount]
                push    ebp
                mov     ebp, [esp+8+Buffer]
                push    edi
                mov     edi, ebp
                test    ebx, ebx
                mov     [esp+0Ch+Buffer], ebp
                jg      short loc_5C1B2B
                xor     eax, eax
                pop     edi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C1B2B:                             ; CODE XREF: _fgets+13↑j
                push    esi
                mov     esi, [esp+10h+Stream]
                push    esi             ; Stream
                call    __lock_file
                add     esp, 4
                dec     ebx
                jz      short loc_5C1B68

loc_5C1B3C:                             ; CODE XREF: _fgets+56↓j
                mov     eax, dword ptr [esi+4]
                dec     eax
                mov     [esi+4], eax
                js      short loc_5C1B50
                mov     ecx, dword ptr [esi]
                xor     eax, eax
                mov     al, [ecx]
                inc     ecx
                mov     [esi], ecx
                jmp     short loc_5C1B59
; ---------------------------------------------------------------------------

loc_5C1B50:                             ; CODE XREF: _fgets+33↑j
                push    esi             ; File
                call    __filbuf
                add     esp, 4

loc_5C1B59:                             ; CODE XREF: _fgets+3E↑j
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5C1B7F
                mov     [edi], al
                inc     edi
                cmp     al, 0Ah
                jz      short loc_5C1B68
                dec     ebx
                jnz     short loc_5C1B3C

loc_5C1B68:                             ; CODE XREF: _fgets+2A↑j
                mov     byte ptr [edi], 0
                mov     edi, [esp+10h+Buffer]
                push    esi             ; Stream
                call    __unlock_file
                add     esp, 4
                mov     eax, edi
                pop     esi
                pop     edi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C1B7F:                             ; CODE XREF: _fgets+4C↑j
                cmp     edi, ebp
                jnz     short loc_5C1B68
                push    esi             ; Stream
                xor     edi, edi
                call    __unlock_file
                add     esp, 4
                mov     eax, edi
                pop     esi
                pop     edi
                pop     ebp
                pop     ebx
                retn
_fgets          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn bp-based frame

                public start
start           proc near

Code            = dword ptr -68h
var_64          = dword ptr -64h
var_60          = dword ptr -60h
StartupInfo     = _STARTUPINFOA ptr -5Ch
ms_exc          = CPPEH_RECORD ptr -18h

; __unwind { // __except_handler3
                push    ebp
                mov     ebp, esp
                push    0FFFFFFFFh
                push    offset stru_614458
                push    offset __except_handler3
                mov     eax, fs:0
                push    eax
                mov     fs:0, esp
                add     esp, 0FFFFFFA8h
                push    ebx
                push    esi
                push    edi
                mov     [ebp+ms_exc.old_esp], esp
                call    GetVersion
                xor     edx, edx
                mov     dl, ah
                mov     dword_70D338, edx
                mov     ecx, eax
                and     ecx, 0FFh
                mov     dword_70D334, ecx
                shl     ecx, 8
                add     ecx, edx
                mov     dword_70D330, ecx
                shr     eax, 10h
                mov     dword_70D32C, eax
                call    __heap_init
                test    eax, eax
                jnz     short loc_5C1C0A
                push    1Ch
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5C1C0A:                             ; CODE XREF: start+5E↑j
                call    __mtinit
                test    eax, eax
                jnz     short loc_5C1C1D
                push    10h
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5C1C1D:                             ; CODE XREF: start+71↑j
;   __try { // __except at loc_5C1D12
                mov     [ebp+ms_exc.registration.TryLevel], 0
                call    __ioinit
                call    ___initmbctable
                call    GetCommandLineA
                mov     dword_70E970, eax
                call    ___crtGetEnvironmentStringsA
                mov     dword_70D36C, eax
                test    eax, eax
                jz      short loc_5C1C50
                mov     eax, dword_70E970
                test    eax, eax
                jnz     short loc_5C1C5A

loc_5C1C50:                             ; CODE XREF: start+A5↑j
                push    0FFFFFFFFh      ; Code
                call    _exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5C1C5A:                             ; CODE XREF: start+AE↑j
                call    __setargv
                call    __setenvp
                call    __cinit
                mov     esi, dword_70E970
                mov     [ebp+var_64], esi
                cmp     byte ptr [esi], 22h ; '"'
                jnz     loc_5C1D39

loc_5C1C7B:                             ; CODE XREF: start+F9↓j
                inc     esi
                mov     [ebp+var_64], esi
                mov     al, [esi]
                cmp     al, 22h ; '"'
                jz      short loc_5C1CA1
                test    al, al
                jz      short loc_5C1CA1
                and     eax, 0FFh
                push    eax             ; Ch
                call    __ismbblead
                add     esp, 4
                test    eax, eax
                jz      short loc_5C1C7B
                inc     esi
                mov     [ebp+var_64], esi
                jmp     short loc_5C1C7B
; ---------------------------------------------------------------------------

loc_5C1CA1:                             ; CODE XREF: start+E3↑j
                cmp     byte ptr [esi], 22h ; '"'
                jnz     short loc_5C1CAA
                inc     esi
                mov     [ebp+var_64], esi

loc_5C1CAA:                             ; CODE XREF: start+104↑j
                mov     al, [esi]
                test    al, al
                jz      short loc_5C1CBA
                cmp     al, 20h ; ' '
                ja      short loc_5C1CBA
                inc     esi
                mov     [ebp+var_64], esi
                jmp     short loc_5C1CAA
; ---------------------------------------------------------------------------

loc_5C1CBA:                             ; CODE XREF: start+10E↑j
                mov     [ebp+StartupInfo.dwFlags], 0
                lea     eax, [ebp+StartupInfo]
                push    eax             ; lpStartupInfo
                call    GetStartupInfoA
                test    byte ptr [ebp+StartupInfo.dwFlags], 1
                jz      short loc_5C1CDB
                mov     eax, dword ptr [ebp+StartupInfo.wShowWindow]
                and     eax, 0FFFFh
                jmp     short loc_5C1CE0
; ---------------------------------------------------------------------------

loc_5C1CDB:                             ; CODE XREF: start+12F↑j
                mov     eax, 0Ah

loc_5C1CE0:                             ; CODE XREF: start+139↑j
                push    eax             ; nShowCmd
                push    esi             ; lpCmdLine
                push    0               ; hPrevInstance
                push    0               ; lpModuleName
                call    GetModuleHandleA
                push    eax             ; hInstance
                call    _WinMain@16     ; WinMain(x,x,x,x)
                mov     [ebp+var_60], eax
                push    eax             ; Code
                call    _exit
; ---------------------------------------------------------------------------
                jmp     short loc_5C1D1E
; ---------------------------------------------------------------------------

loc_5C1CFD:                             ; DATA XREF: .rdata:stru_614458↓o
;   __except filter // owned by 5C1C1D
                mov     eax, dword ptr [ebp+ms_exc.exc_ptr]
                mov     ecx, dword ptr [eax]
                mov     ecx, dword ptr [ecx]
                mov     [ebp+Code], ecx
                push    eax             ; ExceptionInfo
                push    ecx             ; int
                call    __XcptFilter
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C1D12:                             ; DATA XREF: .rdata:stru_614458↓o
;   __except(loc_5C1CFD) // owned by 5C1C1D
                mov     esp, [ebp+ms_exc.old_esp]
                mov     edx, dword ptr [ebp+Code]
                push    edx             ; Code
                call    __exit
; ---------------------------------------------------------------------------

loc_5C1D1E:                             ; CODE XREF: start+15B↑j
                add     esp, 4
;   } // starts at 5C1C1D
                mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh
                mov     ecx, dword ptr [ebp+ms_exc.registration.Next]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_5C1D39:                             ; CODE XREF: start+D5↑j
                cmp     byte ptr [esi], 20h ; ' '
                jbe     loc_5C1CAA
                inc     esi
                mov     [ebp+var_64], esi
                jmp     short loc_5C1D39
; } // starts at 5C1BA0
start           endp

; ---------------------------------------------------------------------------
                align 10h


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void *__cdecl memchr(const void *Buf, int Val, size_t MaxCount)
_memchr         proc near               ; CODE XREF: sub_4E6DE0+113↑p

Buf             = dword ptr  4
Val             = dword ptr  8
MaxCount        = dword ptr  0Ch

                mov     eax, dword ptr [esp+MaxCount]
                push    ebx
                test    eax, eax
                jz      short retnull_0
                mov     edx, dword ptr [esp+4+Buf]
                xor     ebx, ebx
                mov     bl, byte ptr [esp+4+Val]
                test    edx, 3
                jz      short main_loop_start

str_misaligned_0:                       ; CODE XREF: _memchr+2B↓j
                mov     cl, [edx]
                inc     edx
                xor     cl, bl
                jz      short found
                dec     eax
                jz      short retnull_0
                test    edx, 3
                jnz     short str_misaligned_0

main_loop_start:                        ; CODE XREF: _memchr+19↑j
                sub     eax, 4
                jb      short tail_less_then_4
                push    edi
                mov     edi, ebx
                shl     ebx, 8
                add     ebx, edi
                mov     edi, ebx
                shl     ebx, 10h
                add     ebx, edi
                jmp     short main_loop_entry
; ---------------------------------------------------------------------------

return_from_main:                       ; CODE XREF: _memchr+58↓j
                pop     edi

tail_less_then_4:                       ; CODE XREF: _memchr+30↑j
                add     eax, 4
                jz      short retnull_0

tail_loop:                              ; CODE XREF: _memchr+51↓j
                mov     cl, [edx]
                inc     edx
                xor     cl, bl
                jz      short found
                dec     eax
                jnz     short tail_loop

retnull_0:                              ; CODE XREF: _memchr+7↑j
                pop     ebx
                retn
; ---------------------------------------------------------------------------

main_loop_2:                            ; CODE XREF: _memchr+73↓j
                sub     eax, 4
                jb      short return_from_main

main_loop_entry:                        ; CODE XREF: _memchr+41↑j
                mov     ecx, dword ptr [edx]
                xor     ecx, ebx
                mov     edi, 7EFEFEFFh
                add     edi, ecx
                xor     ecx, 0FFFFFFFFh
                xor     ecx, edi
                add     edx, 4
                and     ecx, 81010100h
                jz      short main_loop_2

char_is_found:
                mov     ecx, dword ptr [edx-4]
                xor     cl, bl
                jz      short loc_5C1E1F
                xor     ch, bl
                jz      short loc_5C1E19
                shr     ecx, 10h
                xor     cl, bl
                jz      short loc_5C1E13
                xor     ch, bl
                jz      short loc_5C1E0D
                jmp     short main_loop_2
; ---------------------------------------------------------------------------

loc_5C1E0D:                             ; CODE XREF: _memchr+89↑j
                pop     edi

found:                                  ; CODE XREF: _memchr+20↑j
                lea     eax, [edx-1]
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C1E13:                             ; CODE XREF: _memchr+85↑j
                lea     eax, [edx-2]
                pop     edi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C1E19:                             ; CODE XREF: _memchr+7E↑j
                lea     eax, [edx-3]
                pop     edi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C1E1F:                             ; CODE XREF: _memchr+7A↑j
                lea     eax, [edx-4]
                pop     edi
                pop     ebx
                retn
_memchr         endp

; ---------------------------------------------------------------------------
                align 10h



; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl atof(const char *String)
_atof           proc near               ; CODE XREF: sub_4E87D3+F80↑p

var_18          = byte ptr -18h
String          = dword ptr  4

                sub     esp, 18h
                push    esi
                mov     esi, [esp+1Ch+String]
                push    edi

loc_5C1FE9:                             ; CODE XREF: _atof+38↓j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5C2003
                xor     eax, eax
                push    8               ; Type
                mov     al, [esi]
                push    eax             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5C2013
; ---------------------------------------------------------------------------

loc_5C2003:                             ; CODE XREF: _atof+10↑j
                mov     edx, off_641268
                xor     ecx, ecx
                mov     cl, [esi]
                mov     al, [edx+ecx*2]
                and     eax, 8

loc_5C2013:                             ; CODE XREF: _atof+21↑j
                test    eax, eax
                jz      short loc_5C201A
                inc     esi
                jmp     short loc_5C1FE9
; ---------------------------------------------------------------------------

loc_5C201A:                             ; CODE XREF: _atof+35↑j
                mov     edi, esi
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                push    0
                repne scasb
                not     ecx
                dec     ecx
                push    0
                push    ecx
                lea     eax, [esp+2Ch+var_18]
                push    esi
                push    eax
                call    __fltin2
                fld     qword ptr [eax+10h]
                add     esp, 14h
                pop     edi
                pop     esi
                add     esp, 18h
                retn
_atof           endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int fprintf(FILE *const Stream, const char *const Format, ...)
_fprintf        proc near               ; CODE XREF: .text:004E9E03↑p

Stream          = dword ptr  4
Format          = dword ptr  8
arg_8           = dword ptr  0Ch

                push    ebx
                push    esi
                mov     esi, [esp+8+Stream]
                push    edi
                push    esi             ; Stream
                call    __lock_file
                add     esp, 4
                push    esi
                call    __stbuf
                mov     ecx, dword ptr [esp+10h+Format]
                add     esp, 4
                mov     edi, eax
                lea     eax, [esp+0Ch+arg_8]
                push    eax             ; int
                push    ecx             ; int
                push    esi             ; File
                call    __output
                add     esp, 0Ch
                mov     ebx, eax
                push    esi
                push    edi
                call    __ftbuf
                add     esp, 8
                push    esi             ; Stream
                call    __unlock_file
                add     esp, 4
                mov     eax, ebx
                pop     edi
                pop     esi
                pop     ebx
                retn
_fprintf        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl strncat(char *Destination, const char *Source, size_t Count)
_strncat        proc near               ; CODE XREF: .text:004EA29D↑p

Destination     = dword ptr  4
Source          = dword ptr  8
Count           = dword ptr  0Ch

                mov     ecx, dword ptr [esp+Count]
                push    edi
                test    ecx, ecx
                jz      finish_1
                mov     edi, [esp+4+Destination]
                push    esi
                test    edi, 3
                push    ebx
                jz      short find_end_of_front_string_loop

front_misaligned:                       ; CODE XREF: _strncat+28↓j
                mov     al, [edi]
                inc     edi
                test    al, al
                jz      short start_byte_3
                test    edi, 3
                jnz     short front_misaligned

find_end_of_front_string_loop:          ; CODE XREF: _strncat+19↑j
                mov     eax, dword ptr [edi]
                mov     edx, 7EFEFEFFh
                add     edx, eax
                xor     eax, 0FFFFFFFFh
                xor     eax, edx
                add     edi, 4
                test    eax, 81010100h
                jz      short find_end_of_front_string_loop
                mov     eax, dword ptr [edi-4]
                test    al, al
                jz      short start_byte_0
                test    ah, ah
                jz      short start_byte_1
                test    eax, 0FF0000h
                jz      short start_byte_2
                test    eax, 0FF000000h
                jnz     short find_end_of_front_string_loop

start_byte_3:                           ; CODE XREF: _strncat+20↑j
                dec     edi
                jmp     short copy_start
; ---------------------------------------------------------------------------

start_byte_2:                           ; CODE XREF: _strncat+52↑j
                sub     edi, 2
                jmp     short copy_start
; ---------------------------------------------------------------------------

start_byte_1:                           ; CODE XREF: _strncat+4B↑j
                sub     edi, 3
                jmp     short copy_start
; ---------------------------------------------------------------------------

start_byte_0:                           ; CODE XREF: _strncat+47↑j
                sub     edi, 4

copy_start:                             ; CODE XREF: _strncat+5C↑j
                mov     esi, [esp+0Ch+Source]
                test    esi, 3
                jnz     short back_misaligned
                mov     ebx, ecx
                shr     ecx, 2
                jnz     short main_loop_entrance_0
                jmp     short tail_loop_start_1
; ---------------------------------------------------------------------------

back_misaligned:                        ; CODE XREF: _strncat+75↑j
                mov     dl, [esi]
                inc     esi
                test    dl, dl
                jz      short loc_5C215A
                mov     [edi], dl
                inc     edi
                dec     ecx
                jz      short empty_counter
                test    esi, 3
                jnz     short back_misaligned
                mov     ebx, ecx
                shr     ecx, 2
                jnz     short main_loop_entrance_0

tail_loop_start_1:                      ; CODE XREF: _strncat+7E↑j
                mov     ecx, ebx
                and     ecx, 3
                jz      short empty_counter

tail_loop_0:                            ; CODE XREF: _strncat+AE↓j
                mov     dl, [esi]
                inc     esi
                mov     [edi], dl
                inc     edi
                test    dl, dl
                jz      short finish1
                dec     ecx
                jnz     short tail_loop_0

empty_counter:                          ; CODE XREF: _strncat+8B↑j
                mov     [edi], cl

finish1:                                ; CODE XREF: _strncat+AB↑j
                pop     ebx
                pop     esi

finish_1:                               ; CODE XREF: _strncat+7↑j
                mov     eax, dword ptr [esp+4+Destination]
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_5C215A:                             ; CODE XREF: _strncat+85↑j
                mov     [edi], dl
                mov     eax, dword ptr [esp+0Ch+Destination]
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------

main_loop_3:                            ; CODE XREF: _strncat+E4↓j
                mov     [edi], edx
                add     edi, 4
                dec     ecx
                jz      short tail_loop_start_1

main_loop_entrance_0:                   ; CODE XREF: _strncat+7C↑j
                mov     edx, 7EFEFEFFh
                mov     eax, dword ptr [esi]
                add     edx, eax
                xor     eax, 0FFFFFFFFh
                xor     eax, edx
                mov     edx, dword ptr [esi]
                add     esi, 4
                test    eax, 81010100h
                jz      short main_loop_3
                test    dl, dl
                jz      short loc_5C215A
                test    dh, dh
                jz      short loc_5C21B8
                test    edx, 0FF0000h
                jz      short loc_5C21A8
                test    edx, 0FF000000h
                jnz     short main_loop_3
                mov     [edi], edx
                mov     eax, dword ptr [esp+0Ch+Destination]
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_5C21A8:                             ; CODE XREF: _strncat+F4↑j
                mov     [edi], dx
                xor     edx, edx
                mov     eax, dword ptr [esp+0Ch+Destination]
                mov     [edi+2], dl
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_5C21B8:                             ; CODE XREF: _strncat+EC↑j
                mov     [edi], dx
                mov     eax, dword ptr [esp+0Ch+Destination]
                pop     ebx
                pop     esi
                pop     edi
                retn
_strncat        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; int __cdecl _strnicmp(const char *String1, const char *String2, size_t MaxCount)
__strnicmp      proc near               ; CODE XREF: sub_4ECA9E+A1↑p

var_10          = dword ptr -10h
String1         = dword ptr  8
String2         = dword ptr  0Ch
MaxCount        = dword ptr  10h

                push    ebp
                mov     ebp, esp
                push    edi
                push    esi
                push    ebx
                mov     ecx, dword ptr [ebp+MaxCount]
                or      ecx, ecx
                jz      loc_5C22CA
                mov     esi, [ebp+String1]
                mov     edi, [ebp+String2]
                lea     eax, dword_70D550
                cmp     dword ptr [eax+8], 0
                jnz     short loc_5C2241
                mov     bh, 41h ; 'A'
                mov     bl, 5Ah ; 'Z'
                mov     dh, 20h ; ' '
                db      2Eh
                mov     eax, eax

loc_5C21FC:                             ; CODE XREF: __strnicmp+53↓j
                mov     ah, [esi]
                or      ah, ah
                mov     al, [edi]
                jz      short loc_5C2225
                or      al, al
                jz      short loc_5C2225
                inc     esi
                inc     edi
                cmp     ah, bh
                jb      short loc_5C2214
                cmp     ah, bl
                ja      short loc_5C2214
                add     ah, dh

loc_5C2214:                             ; CODE XREF: __strnicmp+3C↑j
                cmp     al, bh
                jb      short loc_5C221E
                cmp     al, bl
                ja      short loc_5C221E
                add     al, dh

loc_5C221E:                             ; CODE XREF: __strnicmp+46↑j
                cmp     ah, al
                jnz     short loc_5C222F
                dec     ecx
                jnz     short loc_5C21FC

loc_5C2225:                             ; CODE XREF: __strnicmp+32↑j
                xor     ecx, ecx
                cmp     ah, al
                jz      loc_5C22CA

loc_5C222F:                             ; CODE XREF: __strnicmp+50↑j
                mov     ecx, 0FFFFFFFFh
                jb      loc_5C22CA
                neg     ecx
                jmp     loc_5C22CA
; ---------------------------------------------------------------------------

loc_5C2241:                             ; CODE XREF: __strnicmp+21↑j
                lock inc Addend
                cmp     dword_70E964, 0
                jg      short loc_5C2255
                push    0
                jmp     short loc_5C226E
; ---------------------------------------------------------------------------

loc_5C2255:                             ; CODE XREF: __strnicmp+7F↑j
                lock dec Addend
                mov     ebx, ecx
                push    13h
                call    __lock
                mov     [esp+10h+var_10], 1
                mov     ecx, ebx

loc_5C226E:                             ; CODE XREF: __strnicmp+83↑j
                xor     eax, eax
                xor     ebx, ebx
                mov     eax, eax

loc_5C2274:                             ; CODE XREF: __strnicmp+CD↓j
                mov     al, [esi]
                or      eax, eax
                mov     bl, [edi]
                jz      short loc_5C229F
                or      ebx, ebx
                jz      short loc_5C229F
                inc     esi
                inc     edi
                push    ecx
                push    eax             ; C
                push    ebx             ; C
                call    _tolower_0
                mov     ebx, eax
                add     esp, 4
                call    _tolower_0
                add     esp, 4
                pop     ecx
                cmp     eax, ebx
                jnz     short loc_5C22A5
                dec     ecx
                jnz     short loc_5C2274

loc_5C229F:                             ; CODE XREF: __strnicmp+AA↑j
                xor     ecx, ecx
                cmp     eax, ebx
                jz      short loc_5C22AE

loc_5C22A5:                             ; CODE XREF: __strnicmp+CA↑j
                mov     ecx, 0FFFFFFFFh
                jb      short loc_5C22AE
                neg     ecx

loc_5C22AE:                             ; CODE XREF: __strnicmp+D3↑j
                pop     eax
                or      eax, eax
                jnz     short loc_5C22BC
                lock dec Addend
                jmp     short loc_5C22CA
; ---------------------------------------------------------------------------

loc_5C22BC:                             ; CODE XREF: __strnicmp+E1↑j
                mov     ebx, ecx
                push    13h
                call    __unlock
                add     esp, 4
                mov     ecx, ebx

loc_5C22CA:                             ; CODE XREF: __strnicmp+B↑j
                mov     eax, ecx
                pop     ebx
                pop     esi
                pop     edi
                leave
                retn
__strnicmp      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void *__cdecl bsearch(const void *Key, const void *Base, size_t NumOfElements, size_t SizeOfElements, _CoreCrtNonSecureSearchSortCompareFunction CompareFunction)
_bsearch        proc near               ; CODE XREF: sub_4ECA9E+62↑p

Key             = dword ptr  4
Base            = dword ptr  8
NumOfElements   = dword ptr  0Ch
SizeOfElements  = dword ptr  10h
fnCompareFunction = dword ptr  14h

                mov     eax, dword ptr [esp+NumOfElements]
                push    ebx
                push    ebp
                push    esi
                push    edi
                mov     edi, [esp+10h+SizeOfElements]
                lea     ecx, [eax-1]
                mov     ebp, [esp+10h+Base]
                imul    ecx, edi
                add     ecx, ebp
                cmp     ebp, ecx
                mov     [esp+10h+Base], ecx
                ja      short loc_5C2378

loc_5C2300:                             ; CODE XREF: _bsearch+6A↓j
                mov     ebx, eax
                shr     ebx, 1
                jz      short loc_5C235A
                and     eax, 1
                mov     [esp+10h+NumOfElements], eax
                mov     eax, ebx
                jnz     short loc_5C2314
                lea     eax, [ebx-1]

loc_5C2314:                             ; CODE XREF: _bsearch+2F↑j
                mov     esi, edi
                imul    esi, eax
                mov     eax, dword ptr [esp+10h+Key]
                add     esi, ebp
                push    esi
                push    eax
                call    [esp+18h+fnCompareFunction]
                add     esp, 8
                test    eax, eax
                jz      short loc_5C2353
                jge     short loc_5C2341
                mov     eax, dword ptr [esp+10h+NumOfElements]
                sub     esi, edi
                test    eax, eax
                mov     [esp+10h+Base], esi
                jnz     short loc_5C2344
                lea     eax, [ebx-1]
                jmp     short loc_5C2346
; ---------------------------------------------------------------------------

loc_5C2341:                             ; CODE XREF: _bsearch+4C↑j
                lea     ebp, [esi+edi]

loc_5C2344:                             ; CODE XREF: _bsearch+5A↑j
                mov     eax, ebx

loc_5C2346:                             ; CODE XREF: _bsearch+5F↑j
                cmp     ebp, [esp+10h+Base]
                jbe     short loc_5C2300
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C2353:                             ; CODE XREF: _bsearch+4A↑j
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C235A:                             ; CODE XREF: _bsearch+24↑j
                test    eax, eax
                jz      short loc_5C2378
                mov     ecx, dword ptr [esp+10h+Key]
                push    ebp
                push    ecx
                call    [esp+18h+fnCompareFunction]
                add     esp, 8
                neg     eax
                sbb     eax, eax
                not     eax
                and     eax, ebp
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C2378:                             ; CODE XREF: _bsearch+1E↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                retn
_bsearch        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; uintptr_t __cdecl _beginthread(_beginthread_proc_type StartAddress, unsigned int StackSize, void *ArgList)
__beginthread   proc near               ; CODE XREF: .text:004F313D↑p

StartAddress    = dword ptr  4
dwStackSize     = dword ptr  8
ArgList         = dword ptr  0Ch

                push    esi
                push    edi
                push    74h ; 't'       ; varSize
                push    1               ; Count
                xor     edi, edi
                call    _calloc
                mov     esi, eax
                add     esp, 8
                test    esi, esi
                jz      short loc_5C23DF
                push    esi
                call    __initptd
                mov     edx, dword ptr [esp+0Ch+dwStackSize]
                mov     eax, dword ptr [esp+0Ch+StartAddress]
                mov     ecx, dword ptr [esp+0Ch+ArgList]
                add     esp, 4
                mov     [esi+48h], eax
                mov     [esi+4Ch], ecx
                push    esi             ; lpThreadId
                push    4               ; dwCreationFlags
                push    esi             ; lpParameter
                push    offset __threadstart@4 ; lpStartAddress
                push    edx             ; dwStackSize
                push    edi             ; lpThreadAttributes
                call    CreateThread
                mov     edi, eax
                test    edi, edi
                mov     [esi+4], edi
                jz      short loc_5C23D7
                push    edi             ; hThread
                call    ResumeThread
                cmp     eax, 0FFFFFFFFh
                jnz     short loc_5C23FB

loc_5C23D7:                             ; CODE XREF: __beginthread+49↑j
                call    GetLastError
                mov     edi, eax

loc_5C23DF:                             ; CODE XREF: __beginthread+14↑j
                push    esi             ; Block
                call    _free
                add     esp, 4
                test    edi, edi
                jz      short loc_5C23F5
                push    edi
                call    __dosmaperr
                add     esp, 4

loc_5C23F5:                             ; CODE XREF: __beginthread+6A↑j
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C23FB:                             ; CODE XREF: __beginthread+55↑j
                mov     eax, edi
                pop     edi
                pop     esi
                retn
__beginthread   endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn static bp-based frame

; DWORD __stdcall _threadstart(LPVOID lpThreadParameter)
__threadstart@4 proc near               ; DATA XREF: __beginthread+35↑o

Code            = dword ptr -1Ch
ms_exc          = CPPEH_RECORD ptr -18h
lpThreadParameter= dword ptr  8

; FUNCTION CHUNK AT 005C248B SIZE 0000001C BYTES

; __unwind { // __except_handler3
                push    ebp
                mov     ebp, esp
                push    0FFFFFFFFh
                push    offset stru_614468
                push    offset __except_handler3
                mov     eax, fs:0
                push    eax
                mov     fs:0, esp
                add     esp, 0FFFFFFF4h
                push    ebx
                push    esi
                push    edi
                mov     [ebp+ms_exc.old_esp], esp
                mov     esi, [ebp+lpThreadParameter]
                push    esi             ; lpTlsValue
                mov     eax, __tlsindex
                push    eax             ; __tlsindex
                call    TlsSetValue
                test    eax, eax
                jnz     short loc_5C2444
                push    10h
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5C2444:                             ; CODE XREF: _threadstart(x)+38↑j
                mov     eax, off_63ED2C
                test    eax, eax
                jz      short loc_5C244F
                call    eax ; nullsub_1

loc_5C244F:                             ; CODE XREF: _threadstart(x)+4B↑j
;   __try { // __except at loc_5C247C
                mov     [ebp+ms_exc.registration.TryLevel], 0
                mov     ecx, dword ptr [esi+4Ch]
                push    ecx
                call    dword ptr [esi+48h]
                add     esp, 4
                call    __endthread
; ---------------------------------------------------------------------------
                jmp     short loc_5C248B
; ---------------------------------------------------------------------------

loc_5C2467:                             ; DATA XREF: .rdata:stru_614468↓o
;   __except filter // owned by 5C244F
                mov     eax, dword ptr [ebp+ms_exc.exc_ptr]
                mov     edx, dword ptr [eax]
                mov     ecx, dword ptr [edx]
                mov     [ebp+Code], ecx
                push    eax             ; ExceptionInfo
                push    ecx             ; int
                call    __XcptFilter
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C247C:                             ; DATA XREF: .rdata:stru_614468↓o
;   __except(loc_5C2467) // owned by 5C244F
                mov     esp, [ebp+ms_exc.old_esp]
                mov     eax, dword ptr [ebp+Code]
                push    eax             ; Code
                call    __exit
;   } // starts at 5C244F
; } // starts at 5C2400
__threadstart@4 endp

; ---------------------------------------------------------------------------
                add     esp, 4
; START OF FUNCTION CHUNK FOR _threadstart(x)

loc_5C248B:                             ; CODE XREF: _threadstart(x)+65↑j
; __unwind { // __except_handler3
                mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh
                xor     eax, eax
                mov     ecx, dword ptr [ebp+ms_exc.registration.Next]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn    4
; } // starts at 5C248B
; END OF FUNCTION CHUNK FOR _threadstart(x)
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn

; void __cdecl _endthread()
__endthread     proc near               ; CODE XREF: CLlDriver_AcceptThreadTcp_522E8F+4D8↑p
                mov     eax, off_63ED30
                push    esi
                test    eax, eax
                jz      short loc_5C24BC
                call    eax ; nullsub_1

loc_5C24BC:                             ; CODE XREF: __endthread+8↑j
                call    __getptd
                mov     esi, eax
                test    esi, esi
                jnz     short loc_5C24D1
                push    10h
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5C24D1:                             ; CODE XREF: __endthread+15↑j
                mov     eax, dword ptr [esi+4]
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5C24E0
                push    eax             ; hObject
                call    CloseHandle

loc_5C24E0:                             ; CODE XREF: __endthread+27↑j
                push    esi             ; Block
                call    __freeptd
                add     esp, 4
                push    0               ; dwExitCode
                call    ExitThread
__endthread     endp

; ---------------------------------------------------------------------------
                pop     esi
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl remove(const char *FileName)
_remove         proc near               ; CODE XREF: __unlink+5↓p

lpFileName      = dword ptr  4

                mov     eax, dword ptr [esp+lpFileName]
                push    eax             ; lpFileName
                call    DeleteFileA
                test    eax, eax
                jnz     short loc_5C2517
                call    GetLastError
                jmp     short loc_5C2519
; ---------------------------------------------------------------------------

loc_5C2517:                             ; CODE XREF: _remove+D↑j
                xor     eax, eax

loc_5C2519:                             ; CODE XREF: _remove+15↑j
                test    eax, eax
                jz      short loc_5C252A
                push    eax
                call    __dosmaperr
                add     esp, 4
                or      eax, 0FFFFFFFFh
                retn
; ---------------------------------------------------------------------------

loc_5C252A:                             ; CODE XREF: _remove+1B↑j
                xor     eax, eax
                retn
_remove         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _unlink(const char *FileName)
__unlink        proc near               ; CODE XREF: sub_5214C5+307↑p

FileName        = dword ptr  4

                mov     eax, dword ptr [esp+FileName]
                push    eax             ; FileName
                call    _remove
                add     esp, 4
                retn
__unlink        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; intptr_t _spawnlp(int Mode, const char *FileName, const char *Arguments, ...)
__spawnlp       proc near               ; CODE XREF: sub_5214C5+118↑p

Mode            = dword ptr  4
FileName        = dword ptr  8
Arguments       = dword ptr  0Ch

                mov     ecx, dword ptr [esp+FileName]
                mov     edx, dword ptr [esp+Mode]
                lea     eax, [esp+Arguments]
                push    eax             ; Arguments
                push    ecx             ; FileName
                push    edx             ; Mode
                call    __spawnvp
                add     esp, 0Ch
                retn
__spawnlp       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__CIlog         proc near

var_8           = qword ptr -8

                sub     esp, 8
                fst     [esp+8+var_8]
                call    __checkTOS_withFB
                call    loc_5C257D
                add     esp, 8
                retn
__CIlog         endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl log(double X)
_log            proc near               ; CODE XREF: sub_53066C+E↑p

var_4           = word ptr -4
X               = qword ptr  4

; FUNCTION CHUNK AT 005C860E SIZE 00000037 BYTES

                lea     edx, [esp+X]
                call    __fload_withFB

loc_5C257D:                             ; CODE XREF: __CIlog+B↑p
                push    edx
                fstcw   [esp+4+var_4]
                jz      short loc_5C25C7
                mov     eax, dword ptr [esp+4+X+4]
                cmp     [esp+4+var_4], 27Fh
                jz      short loc_5C2596
                fldcw   ds:word_614678

loc_5C2596:                             ; CODE XREF: _log+1A↑j
                test    eax, 7FF00000h
                jz      short loc_5C25F2
                test    eax, 80000000h
                jnz     short loc_5C25DC

loc_5C25A4:                             ; CODE XREF: _log+83↓j
                fldln2
                fxch    st(1)
                fyl2x

loc_5C25AA:                             ; CODE XREF: _log+66↓j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                lea     ecx, aLog_0
                mov     edx, 1Ah
                jmp     __math_exit
; ---------------------------------------------------------------------------

loc_5C25C7:                             ; CODE XREF: _log+E↑j
                test    eax, 0FFFFFh
                jnz     short loc_5C25EB
                cmp     dword ptr [esp+4+X], 0
                jnz     short loc_5C25EB
                and     eax, 80000000h
                jz      short loc_5C25AA

loc_5C25DC:                             ; CODE XREF: _log+2E↑j
                fstp    st
                fld     tbyte ptr [tbyte_641230]
                mov     eax, 1
                jmp     short loc_5C260D
; ---------------------------------------------------------------------------

loc_5C25EB:                             ; CODE XREF: _log+58↑j
                call    __convertTOStoQNaN
                jmp     short loc_5C260D
; ---------------------------------------------------------------------------

loc_5C25F2:                             ; CODE XREF: _log+27↑j
                test    eax, 0FFFFFh
                jnz     short loc_5C25A4
                cmp     dword ptr [esp+4+X], 0
                jnz     short loc_5C25A4
                fstp    st
                fld     tbyte ptr [tbyte_64148A]
                mov     eax, 2

loc_5C260D:                             ; CODE XREF: _log+75↑j
                cmp     dword_70D320, 0
                jnz     __fast_exit
                lea     ecx, aLog_0
                mov     edx, 1Ah
                call    __startOneArgErrorHandling
                pop     edx
                retn
_log            endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__alldiv        proc near               ; CODE XREF: sub_599F90+26↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                push    edi
                push    esi
                push    ebx
                xor     edi, edi
                mov     eax, dword ptr [esp+0Ch+arg_4]
                or      eax, eax
                jge     short loc_5C2651
                inc     edi
                mov     edx, dword ptr [esp+0Ch+arg_0]
                neg     eax
                neg     edx
                sbb     eax, 0
                mov     [esp+0Ch+arg_4], eax
                mov     [esp+0Ch+arg_0], edx

loc_5C2651:                             ; CODE XREF: __alldiv+B↑j
                mov     eax, dword ptr [esp+0Ch+arg_C]
                or      eax, eax
                jge     short loc_5C266D
                inc     edi
                mov     edx, dword ptr [esp+0Ch+arg_8]
                neg     eax
                neg     edx
                sbb     eax, 0
                mov     [esp+0Ch+arg_C], eax
                mov     [esp+0Ch+arg_8], edx

loc_5C266D:                             ; CODE XREF: __alldiv+27↑j
                or      eax, eax
                jnz     short loc_5C2689
                mov     ecx, dword ptr [esp+0Ch+arg_8]
                mov     eax, dword ptr [esp+0Ch+arg_4]
                xor     edx, edx
                div     ecx
                mov     ebx, eax
                mov     eax, dword ptr [esp+0Ch+arg_0]
                div     ecx
                mov     edx, ebx
                jmp     short loc_5C26CA
; ---------------------------------------------------------------------------

loc_5C2689:                             ; CODE XREF: __alldiv+3F↑j
                mov     ebx, eax
                mov     ecx, dword ptr [esp+0Ch+arg_8]
                mov     edx, dword ptr [esp+0Ch+arg_4]
                mov     eax, dword ptr [esp+0Ch+arg_0]

loc_5C2697:                             ; CODE XREF: __alldiv+71↓j
                shr     ebx, 1
                rcr     ecx, 1
                shr     edx, 1
                rcr     eax, 1
                or      ebx, ebx
                jnz     short loc_5C2697
                div     ecx
                mov     esi, eax
                mul     [esp+0Ch+arg_C]
                mov     ecx, eax
                mov     eax, dword ptr [esp+0Ch+arg_8]
                mul     esi
                add     edx, ecx
                jb      short loc_5C26C5
                cmp     edx, [esp+0Ch+arg_4]
                ja      short loc_5C26C5
                jb      short loc_5C26C6
                cmp     eax, [esp+0Ch+arg_0]
                jbe     short loc_5C26C6

loc_5C26C5:                             ; CODE XREF: __alldiv+85↑j
                dec     esi

loc_5C26C6:                             ; CODE XREF: __alldiv+8D↑j
                xor     edx, edx
                mov     eax, esi

loc_5C26CA:                             ; CODE XREF: __alldiv+57↑j
                dec     edi
                jnz     short loc_5C26D4
                neg     edx
                neg     eax
                sbb     edx, 0

loc_5C26D4:                             ; CODE XREF: __alldiv+9B↑j
                pop     ebx
                pop     esi
                pop     edi
                retn    10h
__alldiv        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _toupper(int C)
__toupper       proc near

varC               = dword ptr  4

                mov     eax, dword ptr [esp+varC]
                add     eax, 0FFFFFFE0h
                retn
__toupper       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl toupper(int C)
_toupper        proc near               ; CODE XREF: sub_5B156A+37E↑p

varC               = dword ptr  4

                mov     eax, dword_70D558
                test    eax, eax
                jnz     short loc_5C270B
                mov     eax, dword ptr [esp+varC]
                cmp     eax, 61h ; 'a'
                jl      short locret_5C2771
                cmp     eax, 7Ah ; 'z'
                jg      short locret_5C2771
                sub     eax, 20h ; ' '
                retn
; ---------------------------------------------------------------------------

loc_5C270B:                             ; CODE XREF: _toupper+7↑j
                push    edi
                push    esi
                push    ebx
                push    offset Addend   ; lpAddend
                call    InterlockedIncrement
                mov     eax, dword_70E964
                mov     edi, ds:InterlockedDecrement
                test    eax, eax
                jz      short loc_5C2740
                push    offset Addend   ; lpAddend
                call    edi ; InterlockedDecrement
                push    13h
                call    __lock
                add     esp, 4
                mov     esi, 1
                jmp     short loc_5C2742
; ---------------------------------------------------------------------------

loc_5C2740:                             ; CODE XREF: _toupper+36↑j
                xor     esi, esi

loc_5C2742:                             ; CODE XREF: _toupper+4E↑j
                mov     eax, dword ptr [esp+0Ch+varC]
                push    eax             ; C
                call    _toupper_0
                add     esp, 4
                mov     ebx, eax
                test    esi, esi
                jz      short loc_5C2765
                push    13h
                call    __unlock
                add     esp, 4
                mov     eax, ebx
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_5C2765:                             ; CODE XREF: _toupper+63↑j
                push    offset Addend   ; lpAddend
                call    edi ; InterlockedDecrement
                mov     eax, ebx
                pop     ebx
                pop     esi
                pop     edi

locret_5C2771:                          ; CODE XREF: _toupper+10↑j
                retn
_toupper        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl toupper_0(int C)
_toupper_0      proc near               ; CODE XREF: _toupper+57↑p

DestStr         = byte ptr -8
varC               = dword ptr  4

                mov     eax, dword_70D558
                sub     esp, 8
                test    eax, eax
                push    ebx
                jnz     short loc_5C27AB
                mov     eax, dword ptr [esp+0Ch+varC]
                cmp     eax, 61h ; 'a'
                jl      loc_5C2877
                cmp     eax, 7Ah ; 'z'
                jg      loc_5C2877
                sub     eax, 20h ; ' '
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C27AB:                             ; CODE XREF: _toupper_0+B↑j
                mov     ebx, dword ptr [esp+0Ch+varC]
                cmp     ebx, 100h
                jge     short loc_5C27E3
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5C27CD
                push    2               ; Type
                push    ebx             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5C27D8
; ---------------------------------------------------------------------------

loc_5C27CD:                             ; CODE XREF: _toupper_0+3E↑j
                mov     eax, off_641268
                mov     al, [eax+ebx*2]
                and     eax, 2

loc_5C27D8:                             ; CODE XREF: _toupper_0+4B↑j
                test    eax, eax
                jnz     short loc_5C27E3
                mov     eax, ebx
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C27E3:                             ; CODE XREF: _toupper_0+35↑j
                mov     edx, off_641268
                mov     eax, ebx
                sar     eax, 8
                mov     ecx, eax
                and     ecx, 0FFh
                test    byte ptr [edx+ecx*2+1], 80h
                jz      short loc_5C2811
                mov     byte ptr [esp+0Ch+varC], al
                mov     byte ptr [esp+0Ch+varC+1], bl
                mov     byte ptr [esp+0Ch+varC+2], 0
                mov     eax, 2
                jmp     short loc_5C281F
; ---------------------------------------------------------------------------

loc_5C2811:                             ; CODE XREF: _toupper_0+7B↑j
                mov     byte ptr [esp+0Ch+varC], bl
                mov     byte ptr [esp+0Ch+varC+1], 0
                mov     eax, 1

loc_5C281F:                             ; CODE XREF: _toupper_0+8F↑j
                push    0               ; CodePage
                lea     ecx, [esp+10h+DestStr]
                push    3               ; cchDest
                push    ecx             ; lpDestStr
                lea     edx, [esp+18h+varC]
                push    eax             ; lpWideCharStr
                mov     eax, dword_70D558
                push    edx             ; lpSrcStr
                push    200h            ; dwMapFlags
                push    eax             ; Locale
                call    ___crtLCMapStringA
                add     esp, 1Ch
                test    eax, eax
                jnz     short loc_5C284C
                mov     eax, ebx
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C284C:                             ; CODE XREF: _toupper_0+C3↑j
                cmp     eax, 1
                jnz     short loc_5C285F
                mov     eax, dword ptr [esp+0Ch+DestStr]
                and     eax, 0FFh
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C285F:                             ; CODE XREF: _toupper_0+CF↑j
                mov     eax, dword ptr [esp+0Ch+DestStr+1]
                mov     ecx, dword ptr [esp+0Ch+DestStr]
                and     eax, 0FFh
                and     ecx, 0FFh
                shl     eax, 8
                or      eax, ecx

loc_5C2877:                             ; CODE XREF: _toupper_0+14↑j
                pop     ebx
                add     esp, 8
                retn
_toupper_0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int printf(const char *const Format, ...)
_printf         proc near               ; CODE XREF: sub_5B156A+1A4↑p

Format          = dword ptr  4
arg_4           = dword ptr  8

                push    esi
                push    edi
                push    offset _stdout
                push    1
                call    __lock_file2
                add     esp, 8
                push    offset _stdout
                call    __stbuf
                mov     ecx, dword ptr [esp+0Ch+Format]
                add     esp, 4
                mov     esi, eax
                lea     eax, [esp+8+arg_4]
                push    eax             ; int
                push    ecx             ; int
                push    offset _stdout     ; File
                call    __output
                add     esp, 0Ch
                mov     edi, eax
                push    offset _stdout
                push    esi
                call    __ftbuf
                add     esp, 8
                push    offset _stdout
                push    1
                call    __unlock_file2
                add     esp, 8
                mov     eax, edi
                pop     edi
                pop     esi
                retn
_printf         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__allmul        proc near               ; CODE XREF: sub_5B6E50+62↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                mov     eax, dword ptr [esp+arg_4]
                mov     ecx, dword ptr [esp+arg_C]
                or      ecx, eax
                mov     ecx, dword ptr [esp+arg_8]
                jnz     short hard
                mov     eax, dword ptr [esp+arg_0]
                mul     ecx
                retn    10h
; ---------------------------------------------------------------------------

hard:                                   ; CODE XREF: __allmul+E↑j
                push    ebx
                mul     ecx
                mov     ebx, eax
                mov     eax, dword ptr [esp+4+arg_0]
                mul     [esp+4+arg_C]
                add     ebx, eax
                mov     eax, dword ptr [esp+4+arg_0]
                mul     ecx
                add     edx, ebx
                pop     ebx
                retn    10h
__allmul        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; __time32_t __cdecl time(__time32_t *const Time)
_time           proc near               ; CODE XREF: sub_5B6EF0+9↑p

var_CC          = _SYSTEMTIME ptr -0CCh
SystemTime      = _SYSTEMTIME ptr -0BCh
TimeZoneInformation= _TIME_ZONE_INFORMATION ptr -0ACh
Time            = dword ptr  4

                sub     esp, 0CCh
                lea     eax, [esp+0CCh+SystemTime]
                push    eax             ; lpSystemTime
                call    GetLocalTime
                lea     ecx, [esp+0CCh+var_CC]
                push    ecx             ; lpSystemTime
                call    GetSystemTime
                mov     dx, [esp+0CCh+var_CC.wMinute]
                cmp     dx, word ptr dword_70D388+2
                jnz     short loc_5C2989
                mov     ax, [esp+0CCh+var_CC.wHour]
                cmp     ax, word ptr dword_70D388
                jnz     short loc_5C2989
                mov     cx, [esp+0CCh+var_CC.wDay]
                cmp     cx, word_70D386
                jnz     short loc_5C2989
                mov     dx, [esp+0CCh+var_CC.wMonth]
                cmp     dx, word ptr dword_70D380+2
                jnz     short loc_5C2989
                mov     ax, [esp+0CCh+var_CC.wYear]
                cmp     ax, word ptr dword_70D380
                jnz     short loc_5C2989
                mov     eax, dword_70D378
                jmp     short loc_5C29EF
; ---------------------------------------------------------------------------

loc_5C2989:                             ; CODE XREF: _time+28↑j
                lea     ecx, [esp+0CCh+TimeZoneInformation]
                push    ecx             ; lpTimeZoneInformation
                call    GetTimeZoneInformation
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5C29BF
                cmp     eax, 2
                jnz     short loc_5C29BB
                cmp     [esp+0CCh+TimeZoneInformation.DaylightDate.wMonth], 0
                jz      short loc_5C29BB
                mov     eax, dword ptr [esp+0CCh+TimeZoneInformation.DaylightBias]
                test    eax, eax
                jz      short loc_5C29BB
                mov     eax, 1
                jmp     short loc_5C29C2
; ---------------------------------------------------------------------------

loc_5C29BB:                             ; CODE XREF: _time+7C↑j
                xor     eax, eax
                jmp     short loc_5C29C2
; ---------------------------------------------------------------------------

loc_5C29BF:                             ; CODE XREF: _time+77↑j
                or      eax, 0FFFFFFFFh

loc_5C29C2:                             ; CODE XREF: _time+99↑j
                mov     edx, dword ptr [esp+0CCh+var_CC.wYear]
                mov     ecx, dword ptr [esp+4]
                mov     dword_70D380, edx
                mov     edx, dword ptr [esp+0CCh+var_CC.wHour]
                mov     dword ptr unk_70D384, ecx
                mov     ecx, dword ptr [esp+0CCh+var_CC.wSecond]
                mov     dword_70D378, eax
                mov     dword_70D388, edx
                mov     dword_70D38C, ecx

loc_5C29EF:                             ; CODE XREF: _time+67↑j
                mov     edx, dword ptr [esp+0CCh+SystemTime.wSecond]
                mov     ecx, dword ptr [esp+0CCh+SystemTime.wHour]
                push    eax
                mov     eax, dword ptr [esp+0D0h+SystemTime.wMinute]
                and     edx, 0FFFFh
                and     eax, 0FFFFh
                push    edx
                mov     edx, dword ptr [esp+1Eh]
                and     ecx, 0FFFFh
                push    eax
                mov     eax, dword ptr [esp+0D8h+SystemTime.wMonth]
                push    ecx
                mov     ecx, dword ptr [esp+0DCh+SystemTime.wYear]
                and     edx, 0FFFFh
                and     eax, 0FFFFh
                push    edx
                and     ecx, 0FFFFh
                push    eax
                push    ecx
                call    ___loctotime_t
                mov     ecx, dword ptr [esp+0E8h+Time]
                add     esp, 1Ch
                test    ecx, ecx
                jz      short loc_5C2A45
                mov     [ecx], eax

loc_5C2A45:                             ; CODE XREF: _time+121↑j
                add     esp, 0CCh
                retn
_time           endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__EH_prolog     proc near               ; CODE XREF: CThreadLocal<AFX_MODULE_THREAD_STATE>::CreateObject(void)+5↑p
                push    0FFFFFFFFh
                push    eax
                mov     eax, fs:0
                push    eax
                mov     eax, dword ptr [esp+0Ch]
                mov     fs:0, esp
                mov     [esp+0Ch], ebp
                lea     ebp, [esp+0Ch]
                push    eax
                retn
__EH_prolog     endp ; sp-analysis failed

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; size_t __cdecl wcslen(const wchar_t *String)
_wcslen         proc near               ; CODE XREF: ___crtGetEnvironmentStringsW+1B2↓p

String          = dword ptr  4

                mov     ecx, dword ptr [esp+String]
                cmp     word ptr [ecx], 0
                lea     eax, [ecx+2]
                jz      short loc_5C2A88

loc_5C2A7D:                             ; CODE XREF: _wcslen+16↓j
                mov     dx, [eax]
                add     eax, 2
                test    dx, dx
                jnz     short loc_5C2A7D

loc_5C2A88:                             ; CODE XREF: _wcslen+B↑j
                sub     eax, ecx
                sar     eax, 1
                dec     eax
                retn
_wcslen         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; unsigned __int8 *__cdecl _mbschr(const unsigned __int8 *varStr, unsigned int C)
__mbschr        proc near               ; CODE XREF: __spawnvpe+3F↓p

varStr             = dword ptr  4
Val             = dword ptr  8

                mov     eax, dword_70D4BC
                push    ebx
                push    esi
                push    edi
                test    eax, eax
                jnz     short loc_5C2AB2
                mov     eax, dword ptr [esp+0Ch+Val]
                mov     ecx, dword ptr [esp+0Ch+varStr]
                push    eax             ; Val
                push    ecx             ; varStr
                call    _strchr
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C2AB2:                             ; CODE XREF: __mbschr+A↑j
                push    19h
                call    __lock
                mov     edi, [esp+10h+varStr]
                mov     ebx, dword ptr [esp+10h+Val]
                add     esp, 4
                movzx   si, byte ptr [edi]
                test    si, si
                jz      short loc_5C2B13
                mov     cl, 4

loc_5C2ACF:                             ; CODE XREF: __mbschr+81↓j
                mov     edx, esi
                and     edx, 0FFh
                test    __mbctype+1h[edx], cl
                jz      short loc_5C2AFD
                mov     al, [edi+1]
                inc     edi
                test    al, al
                jz      short loc_5C2B31
                and     esi, 0FFFFh
                and     eax, 0FFh
                shl     esi, 8
                or      esi, eax
                cmp     ebx, esi
                jz      short loc_5C2B41
                jmp     short loc_5C2B08
; ---------------------------------------------------------------------------

loc_5C2AFD:                             ; CODE XREF: __mbschr+4D↑j
                mov     eax, esi
                and     eax, 0FFFFh
                cmp     ebx, eax
                jz      short loc_5C2B13

loc_5C2B08:                             ; CODE XREF: __mbschr+6B↑j
                movzx   si, byte ptr [edi+1]
                inc     edi
                test    si, si
                jnz     short loc_5C2ACF

loc_5C2B13:                             ; CODE XREF: __mbschr+3B↑j
                push    19h
                call    __unlock
                and     esi, 0FFFFh
                add     esp, 4
                xor     eax, eax
                cmp     ebx, esi
                setnz   al
                dec     eax
                and     eax, edi
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C2B31:                             ; CODE XREF: __mbschr+55↑j
                push    19h
                call    __unlock
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C2B41:                             ; CODE XREF: __mbschr+69↑j
                push    19h
                call    __unlock
                add     esp, 4
                lea     eax, [edi-1]
                pop     edi
                pop     esi
                pop     ebx
                retn
__mbschr        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; unsigned __int8 *__cdecl _mbspbrk(const unsigned __int8 *String, const unsigned __int8 *Control)
__mbspbrk       proc near               ; CODE XREF: sub_5DDDDB+9↓p

String          = dword ptr  4
Control         = dword ptr  8

                mov     eax, dword_70D4BC
                test    eax, eax
                jnz     short loc_5C2B7C
                mov     eax, dword ptr [esp+Control]
                mov     ecx, dword ptr [esp+String]
                push    eax             ; Control
                push    ecx             ; varStr
                call    _strpbrk
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C2B7C:                             ; CODE XREF: __mbspbrk+7↑j
                push    esi
                push    19h
                call    __lock
                mov     esi, [esp+8+String]
                add     esp, 4
                cmp     byte ptr [esi], 0
                jz      short loc_5C2BF9
                push    edi
                mov     edi, [esp+8+Control]
                push    ebp
                push    ebx
                mov     bl, [edi]
                mov     dl, 4

loc_5C2B9B:                             ; CODE XREF: __mbspbrk+94↓j
                test    bl, bl
                mov     eax, edi
                jz      short loc_5C2BD5

loc_5C2BA1:                             ; CODE XREF: __mbspbrk+73↓j
                mov     cl, [eax]
                mov     ebp, ecx
                and     ebp, 0FFh
                test    ss:__mbctype+1h[ebp], dl
                jz      short loc_5C2BC9
                cmp     cl, [esi]
                jnz     short loc_5C2BBF
                mov     cl, [eax+1]
                cmp     cl, [esi+1]
                jz      short loc_5C2BD5

loc_5C2BBF:                             ; CODE XREF: __mbspbrk+55↑j
                mov     cl, [eax+1]
                test    cl, cl
                jz      short loc_5C2BD5
                inc     eax
                jmp     short loc_5C2BCD
; ---------------------------------------------------------------------------

loc_5C2BC9:                             ; CODE XREF: __mbspbrk+51↑j
                cmp     cl, [esi]
                jz      short loc_5C2BD5

loc_5C2BCD:                             ; CODE XREF: __mbspbrk+67↑j
                mov     cl, [eax+1]
                inc     eax
                test    cl, cl
                jnz     short loc_5C2BA1

loc_5C2BD5:                             ; CODE XREF: __mbspbrk+3F↑j
                cmp     byte ptr [eax], 0
                jnz     short loc_5C2BF6
                xor     eax, eax
                mov     al, [esi]
                test    __mbctype+1h[eax], dl
                jz      short loc_5C2BEE
                mov     al, [esi+1]
                inc     esi
                test    al, al
                jz      short loc_5C2BF6

loc_5C2BEE:                             ; CODE XREF: __mbspbrk+84↑j
                mov     al, [esi+1]
                inc     esi
                test    al, al
                jnz     short loc_5C2B9B

loc_5C2BF6:                             ; CODE XREF: __mbspbrk+78↑j
                pop     ebx
                pop     ebp
                pop     edi

loc_5C2BF9:                             ; CODE XREF: __mbspbrk+2E↑j
                push    19h
                call    __unlock
                mov     al, [esi]
                add     esp, 4
                neg     al
                sbb     eax, eax
                and     eax, esi
                pop     esi
                retn
__mbspbrk       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; unsigned __int8 *__cdecl _mbsupr(unsigned __int8 *String)
__mbsupr        proc near               ; CODE XREF: .text:005DDE04↓p

String          = dword ptr  4

                push    ebx
                push    esi
                push    edi
                push    19h
                call    __lock
                mov     edi, [esp+10h+String]
                add     esp, 4
                mov     esi, edi
                cmp     byte ptr [edi], 0
                jz      loc_5C2CAE
                mov     bl, 4

loc_5C2C2E:                             ; CODE XREF: __mbsupr+7C↓j
                mov     cl, [esi]
                mov     eax, ecx
                and     eax, 0FFh
                test    __mbctype+1h[eax], bl
                jz      short loc_5C2C77
                mov     eax, dword_70D4BC
                mov     edx, Locale
                push    eax             ; CodePage
                lea     ecx, [esp+10h+String]
                push    2               ; cchDest
                push    ecx             ; lpDestStr
                push    2               ; lpWideCharStr
                push    esi             ; lpSrcStr
                push    200h            ; dwMapFlags
                push    edx             ; Locale
                call    ___crtLCMapStringA
                add     esp, 1Ch
                test    eax, eax
                jz      short loc_5C2C9E
                mov     ecx, dword ptr [esp+0Ch+String]
                cmp     eax, 1
                mov     [esi], cl
                jle     short loc_5C2C86
                inc     esi
                mov     [esi], ch
                jmp     short loc_5C2C86
; ---------------------------------------------------------------------------

loc_5C2C77:                             ; CODE XREF: __mbsupr+2D↑j
                cmp     cl, 61h ; 'a'
                jb      short loc_5C2C84
                cmp     cl, 7Ah ; 'z'
                ja      short loc_5C2C84
                add     eax, 0FFFFFFE0h

loc_5C2C84:                             ; CODE XREF: __mbsupr+6A↑j
                mov     [esi], al

loc_5C2C86:                             ; CODE XREF: __mbsupr+60↑j
                mov     al, [esi+1]
                inc     esi
                test    al, al
                jnz     short loc_5C2C2E
                push    19h
                call    __unlock
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C2C9E:                             ; CODE XREF: __mbsupr+55↑j
                push    19h
                call    __unlock
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C2CAE:                             ; CODE XREF: __mbsupr+16↑j
                push    19h
                call    __unlock
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                pop     ebx
                retn
__mbsupr        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; unsigned __int8 *__cdecl _mbslwr(unsigned __int8 *String)
__mbslwr        proc near               ; CODE XREF: CString::MakeLower(void)+A↓p

String          = dword ptr  4

                push    ebx
                push    esi
                push    edi
                push    19h
                call    __lock
                mov     edi, [esp+10h+String]
                add     esp, 4
                mov     esi, edi
                cmp     byte ptr [edi], 0
                jz      loc_5C2D5E
                mov     bl, 4

loc_5C2CDE:                             ; CODE XREF: __mbslwr+7C↓j
                mov     cl, [esi]
                mov     eax, ecx
                and     eax, 0FFh
                test    __mbctype+1h[eax], bl
                jz      short loc_5C2D27
                mov     eax, dword_70D4BC
                mov     edx, Locale
                push    eax             ; CodePage
                lea     ecx, [esp+10h+String]
                push    2               ; cchDest
                push    ecx             ; lpDestStr
                push    2               ; lpWideCharStr
                push    esi             ; lpSrcStr
                push    100h            ; dwMapFlags
                push    edx             ; Locale
                call    ___crtLCMapStringA
                add     esp, 1Ch
                test    eax, eax
                jz      short loc_5C2D4E
                mov     ecx, dword ptr [esp+0Ch+String]
                cmp     eax, 1
                mov     [esi], cl
                jle     short loc_5C2D36
                inc     esi
                mov     [esi], ch
                jmp     short loc_5C2D36
; ---------------------------------------------------------------------------

loc_5C2D27:                             ; CODE XREF: __mbslwr+2D↑j
                cmp     cl, 41h ; 'A'
                jb      short loc_5C2D34
                cmp     cl, 5Ah ; 'Z'
                ja      short loc_5C2D34
                add     eax, 20h ; ' '

loc_5C2D34:                             ; CODE XREF: __mbslwr+6A↑j
                mov     [esi], al

loc_5C2D36:                             ; CODE XREF: __mbslwr+60↑j
                mov     al, [esi+1]
                inc     esi
                test    al, al
                jnz     short loc_5C2CDE
                push    19h
                call    __unlock
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C2D4E:                             ; CODE XREF: __mbslwr+55↑j
                push    19h
                call    __unlock
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C2D5E:                             ; CODE XREF: __mbslwr+16↑j
                push    19h
                call    __unlock
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                pop     ebx
                retn
__mbslwr        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; unsigned __int8 *__cdecl _mbsrev(unsigned __int8 *String)
__mbsrev        proc near               ; CODE XREF: .text:005DDE28↓p

String          = dword ptr  4

                mov     eax, dword_70D4BC
                push    ebx
                push    esi
                mov     esi, [esp+8+String]
                push    edi
                mov     ebx, esi
                test    eax, eax
                mov     edi, esi
                jnz     short loc_5C2D91
                push    esi             ; varStr
                call    __strrev
                add     esp, 4
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C2D91:                             ; CODE XREF: __mbsrev+12↑j
                push    19h
                call    __lock
                mov     al, [esi]
                add     esp, 4
                test    al, al
                jz      short loc_5C2DC8

loc_5C2DA1:                             ; CODE XREF: __mbsrev+56↓j
                and     eax, 0FFh
                mov     al, __mbctype+1h[eax]
                and     al, 4
                inc     esi
                test    al, al
                jz      short loc_5C2DC2
                mov     al, [esi]
                test    al, al
                jz      short loc_5C2DC8
                mov     cl, [esi-1]
                mov     [esi-1], al
                mov     [esi], cl
                inc     esi

loc_5C2DC2:                             ; CODE XREF: __mbsrev+41↑j
                mov     al, [esi]
                test    al, al
                jnz     short loc_5C2DA1

loc_5C2DC8:                             ; CODE XREF: __mbsrev+2F↑j
                dec     esi
                cmp     edi, esi
                jnb     short loc_5C2DDB

loc_5C2DCD:                             ; CODE XREF: __mbsrev+69↓j
                mov     dl, [esi]
                mov     al, [edi]
                mov     [edi], dl
                inc     edi
                mov     [esi], al
                dec     esi
                cmp     edi, esi
                jb      short loc_5C2DCD

loc_5C2DDB:                             ; CODE XREF: __mbsrev+5B↑j
                push    19h
                call    __unlock
                add     esp, 4
                mov     eax, ebx
                pop     edi
                pop     esi
                pop     ebx
                retn
__mbsrev        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; uintptr_t __cdecl _beginthreadex(void *Security, unsigned int StackSize, _beginthreadex_proc_type StartAddress, void *ArgList, unsigned int InitFlag, unsigned int *ThrdAddr)
__beginthreadex proc near               ; CODE XREF: CWinThread::CreateThread(ulong,uint,_SECURITY_ATTRIBUTES *)+6B↓p

lpThreadAttributes= dword ptr  4
dwStackSize     = dword ptr  8
StartAddress    = dword ptr  0Ch
ArgList         = dword ptr  10h
dwCreationFlags = dword ptr  14h
lpThreadId      = dword ptr  18h

                push    esi
                push    edi
                push    74h ; 't'       ; varSize
                push    1               ; Count
                xor     edi, edi
                call    _calloc
                mov     esi, eax
                add     esp, 8
                test    esi, esi
                jz      short loc_5C2E50
                push    esi
                call    __initptd
                mov     eax, dword ptr [esp+0Ch+StartAddress]
                mov     edx, dword ptr [esp+0Ch+lpThreadId]
                mov     ecx, dword ptr [esp+0Ch+ArgList]
                add     esp, 4
                mov     [esi+48h], eax
                mov     eax, dword ptr [esp+8+dwCreationFlags]
                push    edx             ; lpThreadId
                mov     edx, dword ptr [esp+0Ch+lpThreadAttributes]
                mov     [esi+4Ch], ecx
                mov     ecx, dword ptr [esp+0Ch+dwStackSize]
                push    eax             ; dwCreationFlags
                push    esi             ; lpParameter
                push    offset __threadstartex@4 ; lpStartAddress
                push    ecx             ; dwStackSize
                push    edx             ; lpThreadAttributes
                mov     dword ptr [esi+4], 0FFFFFFFFh
                call    CreateThread
                test    eax, eax
                jnz     short loc_5C2E68
                call    GetLastError
                mov     edi, eax

loc_5C2E50:                             ; CODE XREF: __beginthreadex+14↑j
                push    esi             ; Block
                call    _free
                add     esp, 4
                test    edi, edi
                jz      short loc_5C2E66
                push    edi
                call    __dosmaperr
                add     esp, 4

loc_5C2E66:                             ; CODE XREF: __beginthreadex+6B↑j
                xor     eax, eax

loc_5C2E68:                             ; CODE XREF: __beginthreadex+56↑j
                pop     edi
                pop     esi
                retn
__beginthreadex endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn static bp-based frame

; DWORD __stdcall _threadstartex(LPVOID lpThreadParameter)
__threadstartex@4 proc near             ; DATA XREF: __beginthreadex+40↑o

Code            = dword ptr -1Ch
ms_exc          = CPPEH_RECORD ptr -18h
lpThreadParameter= dword ptr  8

; __unwind { // __except_handler3
                push    ebp
                mov     ebp, esp
                push    0FFFFFFFFh
                push    offset stru_614478
                push    offset __except_handler3
                mov     eax, fs:0
                push    eax
                mov     fs:0, esp
                add     esp, 0FFFFFFF4h
                push    ebx
                push    esi
                push    edi
                mov     [ebp+ms_exc.old_esp], esp
                mov     esi, [ebp+lpThreadParameter]
                push    esi             ; lpTlsValue
                mov     eax, __tlsindex
                push    eax             ; __tlsindex
                call    TlsSetValue
                test    eax, eax
                jnz     short loc_5C2EB4
                push    10h
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5C2EB4:                             ; CODE XREF: _threadstartex(x)+38↑j
                call    GetCurrentThreadId
                mov     [esi], eax
                mov     eax, off_63ED2C
                test    eax, eax
                jz      short loc_5C2EC7
                call    eax ; nullsub_1

loc_5C2EC7:                             ; CODE XREF: _threadstartex(x)+53↑j
;   __try { // __except at loc_5C2EF2
                mov     [ebp+ms_exc.registration.TryLevel], 0
                mov     ecx, dword ptr [esi+4Ch]
                push    ecx
                call    dword ptr [esi+48h]
                push    eax             ; ReturnCode
                call    __endthreadex
; ---------------------------------------------------------------------------
                jmp     short loc_5C2EFE
; ---------------------------------------------------------------------------

loc_5C2EDD:                             ; DATA XREF: .rdata:stru_614478↓o
;   __except filter // owned by 5C2EC7
                mov     eax, dword ptr [ebp+ms_exc.exc_ptr]
                mov     edx, dword ptr [eax]
                mov     ecx, dword ptr [edx]
                mov     [ebp+Code], ecx
                push    eax             ; ExceptionInfo
                push    ecx             ; int
                call    __XcptFilter
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C2EF2:                             ; DATA XREF: .rdata:stru_614478↓o
;   __except(loc_5C2EDD) // owned by 5C2EC7
                mov     esp, [ebp+ms_exc.old_esp]
                mov     eax, dword ptr [ebp+Code]
                push    eax             ; Code
                call    __exit
; ---------------------------------------------------------------------------

loc_5C2EFE:                             ; CODE XREF: _threadstartex(x)+6B↑j
                add     esp, 4
;   } // starts at 5C2EC7
                mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh
                xor     eax, eax
                mov     ecx, dword ptr [ebp+ms_exc.registration.Next]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn    4
; } // starts at 5C2E70
__threadstartex@4 endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn

; void __cdecl _endthreadex(unsigned int ReturnCode)
__endthreadex   proc near               ; CODE XREF: _threadstartex(x)+66↑p

dwExitCode      = dword ptr  4

                mov     eax, off_63ED30
                push    esi
                test    eax, eax
                jz      short loc_5C2F2C
                call    eax ; nullsub_1

loc_5C2F2C:                             ; CODE XREF: __endthreadex+8↑j
                call    __getptd
                mov     esi, eax
                test    esi, esi
                jnz     short loc_5C2F41
                push    10h
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5C2F41:                             ; CODE XREF: __endthreadex+15↑j
                push    esi             ; Block
                call    __freeptd
                mov     eax, dword ptr [esp+8+dwExitCode]
                add     esp, 4
                push    eax             ; dwExitCode
                call    ExitThread
__endthreadex   endp

; ---------------------------------------------------------------------------
                pop     esi
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; size_t __cdecl _mbsspn(const unsigned __int8 *varStr, const unsigned __int8 *Control)
__mbsspn        proc near               ; CODE XREF: CString::SpanIncluding(char const *)+10↓p

varStr             = dword ptr  4
Control         = dword ptr  8

                mov     eax, dword_70D4BC
                test    eax, eax
                jnz     short loc_5C2F7C
                mov     eax, dword ptr [esp+Control]
                mov     ecx, dword ptr [esp+varStr]
                push    eax             ; Control
                push    ecx             ; varStr
                call    _strspn
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C2F7C:                             ; CODE XREF: __mbsspn+7↑j
                push    edi
                push    esi
                push    19h
                call    __lock
                mov     edi, [esp+0Ch+varStr]
                add     esp, 4
                mov     esi, edi
                cmp     byte ptr [edi], 0
                jz      short loc_5C2FFE
                mov     edi, [esp+8+Control]
                push    ebp
                push    ebx
                mov     dl, 4
                mov     bl, [edi]

loc_5C2F9D:                             ; CODE XREF: __mbsspn+96↓j
                test    bl, bl
                mov     eax, edi
                jz      short loc_5C2FD7

loc_5C2FA3:                             ; CODE XREF: __mbsspn+75↓j
                mov     cl, [eax]
                mov     ebp, ecx
                and     ebp, 0FFh
                test    ss:__mbctype+1h[ebp], dl
                jz      short loc_5C2FCB
                cmp     cl, [esi]
                jnz     short loc_5C2FC1
                mov     cl, [eax+1]
                cmp     cl, [esi+1]
                jz      short loc_5C2FD7

loc_5C2FC1:                             ; CODE XREF: __mbsspn+57↑j
                mov     cl, [eax+1]
                test    cl, cl
                jz      short loc_5C2FD7
                inc     eax
                jmp     short loc_5C2FCF
; ---------------------------------------------------------------------------

loc_5C2FCB:                             ; CODE XREF: __mbsspn+53↑j
                cmp     cl, [esi]
                jz      short loc_5C2FD7

loc_5C2FCF:                             ; CODE XREF: __mbsspn+69↑j
                mov     cl, [eax+1]
                inc     eax
                test    cl, cl
                jnz     short loc_5C2FA3

loc_5C2FD7:                             ; CODE XREF: __mbsspn+41↑j
                cmp     byte ptr [eax], 0
                jz      short loc_5C2FF8
                xor     eax, eax
                mov     al, [esi]
                test    __mbctype+1h[eax], dl
                jz      short loc_5C2FF0
                mov     al, [esi+1]
                inc     esi
                test    al, al
                jz      short loc_5C2FF8

loc_5C2FF0:                             ; CODE XREF: __mbsspn+86↑j
                mov     al, [esi+1]
                inc     esi
                test    al, al
                jnz     short loc_5C2F9D

loc_5C2FF8:                             ; CODE XREF: __mbsspn+7A↑j
                mov     edi, [esp+10h+varStr]
                pop     ebx
                pop     ebp

loc_5C2FFE:                             ; CODE XREF: __mbsspn+31↑j
                push    19h
                call    __unlock
                add     esp, 4
                mov     eax, esi
                sub     eax, edi
                pop     esi
                pop     edi
                retn
__mbsspn        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; size_t __cdecl _mbscspn(const unsigned __int8 *String, const unsigned __int8 *Control)
__mbscspn       proc near               ; CODE XREF: CString::SpanExcluding(char const *)+10↓p

String          = dword ptr  4
Control         = dword ptr  8

                mov     eax, dword_70D4BC
                test    eax, eax
                jnz     short loc_5C302C
                mov     eax, dword ptr [esp+Control]
                mov     ecx, dword ptr [esp+String]
                push    eax             ; Control
                push    ecx             ; varStr
                call    _strcspn
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C302C:                             ; CODE XREF: __mbscspn+7↑j
                push    edi
                push    esi
                push    19h
                call    __lock
                mov     edi, [esp+0Ch+String]
                add     esp, 4
                mov     esi, edi
                cmp     byte ptr [edi], 0
                jz      short loc_5C30AE
                mov     edi, [esp+8+Control]
                push    ebp
                push    ebx
                mov     dl, 4
                mov     bl, [edi]

loc_5C304D:                             ; CODE XREF: __mbscspn+96↓j
                test    bl, bl
                mov     eax, edi
                jz      short loc_5C3087

loc_5C3053:                             ; CODE XREF: __mbscspn+75↓j
                mov     cl, [eax]
                mov     ebp, ecx
                and     ebp, 0FFh
                test    ss:__mbctype+1h[ebp], dl
                jz      short loc_5C307B
                cmp     cl, [esi]
                jnz     short loc_5C3071
                mov     cl, [eax+1]
                cmp     cl, [esi+1]
                jz      short loc_5C3087

loc_5C3071:                             ; CODE XREF: __mbscspn+57↑j
                mov     cl, [eax+1]
                test    cl, cl
                jz      short loc_5C3087
                inc     eax
                jmp     short loc_5C307F
; ---------------------------------------------------------------------------

loc_5C307B:                             ; CODE XREF: __mbscspn+53↑j
                cmp     cl, [esi]
                jz      short loc_5C3087

loc_5C307F:                             ; CODE XREF: __mbscspn+69↑j
                mov     cl, [eax+1]
                inc     eax
                test    cl, cl
                jnz     short loc_5C3053

loc_5C3087:                             ; CODE XREF: __mbscspn+41↑j
                cmp     byte ptr [eax], 0
                jnz     short loc_5C30A8
                xor     eax, eax
                mov     al, [esi]
                test    __mbctype+1h[eax], dl
                jz      short loc_5C30A0
                mov     al, [esi+1]
                inc     esi
                test    al, al
                jz      short loc_5C30A8

loc_5C30A0:                             ; CODE XREF: __mbscspn+86↑j
                mov     al, [esi+1]
                inc     esi
                test    al, al
                jnz     short loc_5C304D

loc_5C30A8:                             ; CODE XREF: __mbscspn+7A↑j
                mov     edi, [esp+10h+String]
                pop     ebx
                pop     ebp

loc_5C30AE:                             ; CODE XREF: __mbscspn+31↑j
                push    19h
                call    __unlock
                add     esp, 4
                mov     eax, esi
                sub     eax, edi
                pop     esi
                pop     edi
                retn
__mbscspn       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; unsigned __int8 *__cdecl _mbsrchr(const unsigned __int8 *String, unsigned int C)
__mbsrchr       proc near               ; CODE XREF: CFileFind::FindFile(char const *,ulong)+9E↑p

varStr             = dword ptr  4
argC               = dword ptr  8

                mov     eax, dword_70D4BC
                push    esi
                xor     esi, esi
                test    eax, eax
                jnz     short loc_5C30E0
                mov     eax, dword ptr [esp+4+argC]
                mov     ecx, dword ptr [esp+4+varStr]
                push    eax             ; Ch
                push    ecx             ; varStr
                call    _strrchr
                add     esp, 8
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C30E0:                             ; CODE XREF: __mbsrchr+A↑j
                push    edi
                push    ebp
                push    ebx
                push    19h
                call    __lock
                mov     edi, [esp+14h+argC]
                mov     edx, dword ptr [esp+14h+varStr]
                add     esp, 4
                mov     bl, 4

loc_5C30F7:                             ; CODE XREF: __mbsrchr+7D↓j
                mov     cl, [edx]
                mov     eax, ecx
                and     eax, 0FFh
                mov     ebp, eax
                and     ebp, 0FFh
                test    ss:__mbctype+1h[ebp], bl
                jz      short loc_5C3134
                mov     cl, [edx+1]
                inc     edx
                test    cl, cl
                jz      short loc_5C312E
                mov     ebp, ecx
                shl     eax, 8
                and     ebp, 0FFh
                or      eax, ebp
                cmp     edi, eax
                jnz     short loc_5C313A
                lea     esi, [edx-1]
                jmp     short loc_5C313A
; ---------------------------------------------------------------------------

loc_5C312E:                             ; CODE XREF: __mbsrchr+56↑j
                test    esi, esi
                jnz     short loc_5C313A
                jmp     short loc_5C3138
; ---------------------------------------------------------------------------

loc_5C3134:                             ; CODE XREF: __mbsrchr+4E↑j
                cmp     edi, eax
                jnz     short loc_5C313A

loc_5C3138:                             ; CODE XREF: __mbsrchr+72↑j
                mov     esi, edx

loc_5C313A:                             ; CODE XREF: __mbsrchr+67↑j
                inc     edx
                test    cl, cl
                jnz     short loc_5C30F7
                push    19h
                call    __unlock
                add     esp, 4
                mov     eax, esi
                pop     ebx
                pop     ebp
                pop     edi
                pop     esi
                retn
__mbsrchr       endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; unsigned __int8 *__cdecl _mbsstr(const unsigned __int8 *varStr, const unsigned __int8 *varSubstr)
__mbsstr        proc near               ; CODE XREF: CString::Find(char const *)+9↓p

varStr             = dword ptr  4
varSubStr          = dword ptr  8

                mov     eax, dword_70D4BC
                push    ebx
                push    ebp
                push    esi
                test    eax, eax
                push    edi
                jnz     short loc_5C3174
                mov     eax, dword ptr [esp+10h+varSubStr]
                mov     ecx, dword ptr [esp+10h+varStr]
                push    eax             ; varSubStr
                push    ecx             ; varStr
                call    _strstr
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C3174:                             ; CODE XREF: __mbsstr+B↑j
                mov     ebx, dword ptr [esp+10h+varSubStr]
                or      ecx, 0FFFFFFFFh
                mov     edi, ebx
                xor     eax, eax
                mov     esi, [esp+10h+varStr]
                repne scasb
                not     ecx
                dec     ecx
                mov     ebp, esi
                sub     ebp, ecx
                mov     edi, esi
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     al, [esi]
                not     ecx
                dec     ecx
                add     ebp, ecx
                test    al, al
                jz      short loc_5C31E5

loc_5C319E:                             ; CODE XREF: __mbsstr+85↓j
                cmp     esi, ebp
                ja      short loc_5C31E5
                mov     cl, [esi]
                mov     eax, ebx
                test    cl, cl
                jz      short loc_5C31C2
                mov     edx, esi
                sub     edx, ebx

loc_5C31AE:                             ; CODE XREF: __mbsstr+70↓j
                mov     cl, [eax]
                test    cl, cl
                jz      short loc_5C31C2
                cmp     [eax+edx], cl
                jnz     short loc_5C31C2
                mov     cl, [eax+edx+1]
                inc     eax
                test    cl, cl
                jnz     short loc_5C31AE

loc_5C31C2:                             ; CODE XREF: __mbsstr+58↑j
                cmp     byte ptr [eax], 0
                jz      short loc_5C31DE
                push    esi             ; Ptr
                call    __mbsinc
                mov     esi, eax
                add     esp, 4
                cmp     byte ptr [esi], 0
                jnz     short loc_5C319E
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C31DE:                             ; CODE XREF: __mbsstr+75↑j
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C31E5:                             ; CODE XREF: __mbsstr+4C↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                retn
__mbsstr        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl vsprintf(char *const Buffer, const char *const Format, va_list ArgList)
_vsprintf       proc near               ; CODE XREF: CString::FormatV(char const *,char *)+25A↓p

File            = FILE ptr -20h
Buffer          = dword ptr  4
Format          = dword ptr  8
ArgList         = dword ptr  0Ch

                sub     esp, 20h
                mov     eax, dword ptr [esp+20h+Buffer]
                mov     ecx, dword ptr [esp+20h+Format]
                mov     [esp+20h+File._base], eax
                mov     [esp+20h+File._ptr], eax
                mov     eax, dword ptr [esp+20h+ArgList]
                push    esi
                push    eax             ; int
                lea     edx, [esp+28h+File]
                push    ecx             ; int
                push    edx             ; File
                mov     [esp+30h+File._flag], 42h ; 'B'
                mov     [esp+30h+File._cnt], 7FFFFFFFh
                call    __output
                mov     esi, eax
                mov     eax, dword ptr [esp+30h+File._cnt]
                add     esp, 0Ch
                dec     eax
                mov     [esp+24h+File._cnt], eax
                js      short loc_5C3242
                mov     eax, dword ptr [esp+24h+File._ptr]
                mov     byte ptr [eax], 0
                mov     eax, esi
                pop     esi
                add     esp, 20h
                retn
; ---------------------------------------------------------------------------

loc_5C3242:                             ; CODE XREF: _vsprintf+42↑j
                lea     ecx, [esp+24h+File]
                push    ecx             ; File
                push    0               ; Ch
                call    __flsbuf
                add     esp, 8
                mov     eax, esi
                pop     esi
                add     esp, 20h
                retn
_vsprintf       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; size_t __cdecl _mbclen(const unsigned __int8 *String)
__mbclen        proc near               ; CODE XREF: CString::FormatV(char const *,char *)+228↓p

String          = dword ptr  4

                mov     ecx, dword ptr [esp+String]
                xor     eax, eax
                mov     al, [ecx]
                mov     al, __mbctype+1h[eax]
                and     al, 4
                neg     al
                sbb     eax, eax
                neg     eax
                inc     eax
                retn
__mbclen        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ismbcdigit(unsigned int C)
__ismbcdigit    proc near               ; CODE XREF: CString::FormatV(char const *,char *)+A0↓p

CharType        = word ptr -4
var_2           = word ptr -2
varC               = dword ptr  4

                push    ecx
                mov     eax, dword ptr [esp+4+varC]
                cmp     eax, 0FFh
                jbe     short loc_5C32F0
                mov     ecx, eax
                mov     byte ptr [esp+4+varC+1], al
                mov     eax, dword_70D4BC
                mov     [esp+4+CharType], 0
                shr     ecx, 8
                test    eax, eax
                mov     [esp+4+var_2], 0
                mov     byte ptr [esp+4+varC], cl
                jnz     short loc_5C32B2
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C32B2:                             ; CODE XREF: __ismbcdigit+2E↑j
                mov     edx, Locale
                lea     ecx, [esp+4+varC]
                push    edx             ; Locale
                push    eax             ; CodePage
                lea     eax, [esp+0Ch+CharType]
                push    eax             ; lpCharType
                push    2               ; cchSrc
                push    ecx             ; lpSrcStr
                push    1               ; dwInfoType
                call    ___crtGetStringTypeA
                add     esp, 18h
                test    eax, eax
                jnz     short loc_5C32D6
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C32D6:                             ; CODE XREF: __ismbcdigit+52↑j
                cmp     [esp+4+var_2], 0
                jnz     short loc_5C32EC
                test    byte ptr [esp+4+CharType], 4
                jz      short loc_5C32EC
                mov     eax, 1
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C32EC:                             ; CODE XREF: __ismbcdigit+5C↑j
                xor     eax, eax
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C32F0:                             ; CODE XREF: __ismbcdigit+A↑j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5C3306
                push    4               ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C3306:                             ; CODE XREF: __ismbcdigit+77↑j
                mov     edx, off_641268
                mov     al, [edx+eax*2]
                and     eax, 4
                pop     ecx
                retn
__ismbcdigit    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; unsigned __int8 *__cdecl _mbsinc(const unsigned __int8 *Ptr)
__mbsinc        proc near               ; CODE XREF: __mbsstr+78↑p

varPtr             = dword ptr  4

                mov     eax, dword ptr [esp+varPtr]
                xor     ecx, ecx
                mov     cl, [eax]
                mov     dl, __mbctype+1h[ecx]
                and     dl, 4
                inc     eax
                test    dl, dl
                jz      short locret_5C3337
                inc     eax

locret_5C3337:                          ; CODE XREF: __mbsinc+14↑j
                retn
__mbsinc        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ismbcspace(unsigned int C)
__ismbcspace    proc near               ; CODE XREF: CString::TrimRight(void)+18↓p

CharType        = word ptr -4
var_2           = word ptr -2
varC               = dword ptr  4

                push    ecx
                mov     eax, dword ptr [esp+4+varC]
                cmp     eax, 0FFh
                jbe     short loc_5C33B0
                mov     ecx, eax
                mov     byte ptr [esp+4+varC+1], al
                mov     eax, dword_70D4BC
                mov     [esp+4+CharType], 0
                shr     ecx, 8
                test    eax, eax
                mov     [esp+4+var_2], 0
                mov     byte ptr [esp+4+varC], cl
                jnz     short loc_5C3372
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C3372:                             ; CODE XREF: __ismbcspace+2E↑j
                mov     edx, Locale
                lea     ecx, [esp+4+varC]
                push    edx             ; Locale
                push    eax             ; CodePage
                lea     eax, [esp+0Ch+CharType]
                push    eax             ; lpCharType
                push    2               ; cchSrc
                push    ecx             ; lpSrcStr
                push    1               ; dwInfoType
                call    ___crtGetStringTypeA
                add     esp, 18h
                test    eax, eax
                jnz     short loc_5C3396
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C3396:                             ; CODE XREF: __ismbcspace+52↑j
                cmp     [esp+4+var_2], 0
                jnz     short loc_5C33AC
                test    byte ptr [esp+4+CharType], 8
                jz      short loc_5C33AC
                mov     eax, 1
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C33AC:                             ; CODE XREF: __ismbcspace+5C↑j
                xor     eax, eax
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C33B0:                             ; CODE XREF: __ismbcspace+A↑j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5C33C6
                push    8               ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C33C6:                             ; CODE XREF: __ismbcspace+77↑j
                mov     edx, off_641268
                mov     al, [edx+eax*2]
                and     eax, 8
                pop     ecx
                retn
__ismbcspace    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__alloc_osfhnd  proc near               ; CODE XREF: __open_osfhandle:loc_5C373E↓p

var_8           = dword ptr -8
var_4           = dword ptr -4

                sub     esp, 8
                push    ebx
                push    ebp
                push    esi
                push    edi
                push    12h
                mov     [esp+1Ch+var_8], 0FFFFFFFFh
                call    __lock
                xor     edi, edi
                add     esp, 4
                mov     [esp+18h+var_4], edi
                xor     ebx, ebx
                mov     ebp, offset __pioinfo

loc_5C3406:                             ; CODE XREF: __alloc_osfhnd+DF↓j
                mov     esi, [ebp+0]
                test    esi, esi
                jz      loc_5C34C7
                lea     eax, [esi+480h]
                cmp     esi, eax
                jnb     loc_5C349F

loc_5C341F:                             ; CODE XREF: __alloc_osfhnd+99↓j
                test    byte ptr [esi+4], 1
                jnz     short loc_5C346B
                mov     eax, dword ptr [esi+8]
                test    eax, eax
                jnz     short loc_5C3454
                push    11h
                call    __lock
                mov     eax, dword ptr [esi+8]
                add     esp, 4
                test    eax, eax
                jnz     short loc_5C344A
                lea     ecx, [esi+0Ch]
                push    ecx             ; lpCriticalSection
                call    InitializeCriticalSection
                inc     dword ptr [esi+8]

loc_5C344A:                             ; CODE XREF: __alloc_osfhnd+5B↑j
                push    11h
                call    __unlock
                add     esp, 4

loc_5C3454:                             ; CODE XREF: __alloc_osfhnd+4A↑j
                lea     edi, [esi+0Ch]
                push    edi             ; lpCriticalSection
                call    EnterCriticalSection
                test    byte ptr [esi+4], 1
                jz      short loc_5C347D
                push    edi             ; lpCriticalSection
                call    LeaveCriticalSection

loc_5C346B:                             ; CODE XREF: __alloc_osfhnd+43↑j
                mov     edx, dword ptr [ebp+0]
                add     esi, 24h ; '$'
                add     edx, 480h
                cmp     esi, edx
                jb      short loc_5C341F
                jmp     short loc_5C349F
; ---------------------------------------------------------------------------

loc_5C347D:                             ; CODE XREF: __alloc_osfhnd+82↑j
                mov     dword ptr [esi], 0FFFFFFFFh
                mov     eax, dword ptr [ebp+0]
                sub     esi, eax
                mov     eax, 38E38E39h
                imul    esi
                sar     edx, 3
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                add     edx, ebx
                mov     [esp+18h+var_8], edx

loc_5C349F:                             ; CODE XREF: __alloc_osfhnd+39↑j
                cmp     [esp+18h+var_8], 0FFFFFFFFh
                jnz     loc_5C3532
                mov     edi, [esp+18h+var_4]
                add     ebp, 4
                inc     edi
                add     ebx, 20h ; ' '
                cmp     ebp, offset uNumber
                mov     [esp+18h+var_4], edi
                jl      loc_5C3406
                jmp     short loc_5C3532
; ---------------------------------------------------------------------------

loc_5C34C7:                             ; CODE XREF: __alloc_osfhnd+2B↑j
                push    480h            ; varSize
                call    _malloc
                xor     edx, edx
                add     esp, 4
                cmp     eax, edx
                jz      short loc_5C3532
                mov     ebx, uNumber
                lea     ecx, [eax+480h]
                add     ebx, 20h ; ' '
                cmp     eax, ecx
                mov     __pioinfo[edi*4], eax
                mov     uNumber, ebx
                jnb     short loc_5C3520
                mov     cl, 0Ah

loc_5C34FC:                             ; CODE XREF: __alloc_osfhnd+13E↓j
                mov     byte ptr [eax+4], 0
                mov     dword ptr [eax], 0FFFFFFFFh
                mov     [eax+5], cl
                mov     [eax+8], edx
                mov     esi, __pioinfo[edi*4]
                add     eax, 24h ; '$'
                add     esi, 480h
                cmp     eax, esi
                jb      short loc_5C34FC

loc_5C3520:                             ; CODE XREF: __alloc_osfhnd+118↑j
                shl     edi, 5
                mov     eax, edi
                push    eax
                mov     [esp+1Ch+var_8], eax
                call    __lock_fhandle
                add     esp, 4

loc_5C3532:                             ; CODE XREF: __alloc_osfhnd+C4↑j
                push    12h
                call    __unlock
                mov     eax, dword ptr [esp+1Ch+var_8]
                add     esp, 4
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
__alloc_osfhnd  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _set_osfhnd(int, HANDLE hHandle)
__set_osfhnd    proc near               ; CODE XREF: __open_osfhandle+78↓p

arg_0           = dword ptr  4
hHandle         = dword ptr  8

                mov     ecx, dword ptr [esp+arg_0]
                mov     eax, uNumber
                push    ebx
                push    esi
                cmp     ecx, eax
                push    edi
                jnb     short loc_5C35D4
                mov     eax, ecx
                sar     eax, 5
                lea     edi, __pioinfo[eax*4]
                mov     eax, ecx
                and     eax, 1Fh
                mov     edx, dword ptr [edi]
                lea     esi, [eax+eax*8]
                shl     esi, 2
                cmp     dword ptr [edx+esi], 0FFFFFFFFh
                jnz     short loc_5C35D4
                mov     eax, __app_type
                mov     ebx, dword ptr [esp+0Ch+hHandle]
                cmp     eax, 1
                jnz     short loc_5C35C9
                sub     ecx, 0
                jz      short loc_5C35C0
                dec     ecx
                jz      short loc_5C35AC
                dec     ecx
                jnz     short loc_5C35C9
                push    ebx             ; hHandle
                push    0FFFFFFF4h      ; nStdHandle
                call    SetStdHandle
                mov     eax, dword ptr [edi]
                mov     [eax+esi], ebx
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C35AC:                             ; CODE XREF: __set_osfhnd+43↑j
                push    ebx             ; hHandle
                push    0FFFFFFF5h      ; nStdHandle
                call    SetStdHandle
                mov     eax, dword ptr [edi]
                mov     [eax+esi], ebx
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C35C0:                             ; CODE XREF: __set_osfhnd+40↑j
                push    ebx             ; hHandle
                push    0FFFFFFF6h      ; nStdHandle
                call    SetStdHandle

loc_5C35C9:                             ; CODE XREF: __set_osfhnd+3B↑j
                mov     eax, dword ptr [edi]
                mov     [eax+esi], ebx
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C35D4:                             ; CODE XREF: __set_osfhnd+E↑j
                call    __errno
                mov     dword ptr [eax], 9
                call    ___doserrno
                pop     edi
                mov     dword ptr [eax], 0
                pop     esi
                or      eax, 0FFFFFFFFh
                pop     ebx
                retn
__set_osfhnd    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__free_osfhnd   proc near               ; CODE XREF: __close_lk+59↓p

arg_0           = dword ptr  4

                mov     ecx, dword ptr [esp+arg_0]
                mov     eax, uNumber
                push    ebx
                push    esi
                cmp     ecx, eax
                push    edi
                jnb     short loc_5C3676
                mov     eax, ecx
                sar     eax, 5
                lea     edi, __pioinfo[eax*4]
                mov     eax, ecx
                and     eax, 1Fh
                mov     edx, dword ptr [edi]
                lea     esi, [eax+eax*8]
                shl     esi, 2
                mov     bl, [edx+esi+4]
                lea     eax, [edx+esi]
                mov     edx, 1
                test    dl, bl
                jz      short loc_5C3676
                cmp     dword ptr [eax], 0FFFFFFFFh
                jz      short loc_5C3676
                cmp     __app_type, edx
                jnz     short loc_5C3667
                sub     ecx, 0
                jz      short loc_5C365D
                dec     ecx
                jz      short loc_5C3657
                dec     ecx
                jnz     short loc_5C3667
                push    0
                push    0FFFFFFF4h
                jmp     short loc_5C3661
; ---------------------------------------------------------------------------

loc_5C3657:                             ; CODE XREF: __free_osfhnd+4C↑j
                push    0
                push    0FFFFFFF5h
                jmp     short loc_5C3661
; ---------------------------------------------------------------------------

loc_5C365D:                             ; CODE XREF: __free_osfhnd+49↑j
                push    0               ; hHandle
                push    0FFFFFFF6h      ; nStdHandle

loc_5C3661:                             ; CODE XREF: __free_osfhnd+55↑j
                call    SetStdHandle

loc_5C3667:                             ; CODE XREF: __free_osfhnd+44↑j
                mov     eax, dword ptr [edi]
                mov     dword ptr [eax+esi], 0FFFFFFFFh
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C3676:                             ; CODE XREF: __free_osfhnd+E↑j
                call    __errno
                mov     dword ptr [eax], 9
                call    ___doserrno
                pop     edi
                mov     dword ptr [eax], 0
                pop     esi
                or      eax, 0FFFFFFFFh
                pop     ebx
                retn
__free_osfhnd   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; intptr_t __cdecl _get_osfhandle(int FileHandle)
__get_osfhandle proc near               ; CODE XREF: __close_lk+7↓p

FileHandle      = dword ptr  4

                mov     eax, dword ptr [esp+FileHandle]
                mov     ecx, uNumber
                cmp     eax, ecx
                jnb     short loc_5C36CF
                mov     ecx, eax
                and     eax, 1Fh
                sar     ecx, 5
                lea     edx, [eax+eax*8]
                mov     eax, __pioinfo[ecx*4]
                mov     cl, [eax+edx*4+4]
                lea     eax, [eax+edx*4]
                test    cl, 1
                jz      short loc_5C36CF
                mov     eax, dword ptr [eax]
                retn
; ---------------------------------------------------------------------------

loc_5C36CF:                             ; CODE XREF: __get_osfhandle+C↑j
                call    __errno
                mov     dword ptr [eax], 9
                call    ___doserrno
                mov     dword ptr [eax], 0
                or      eax, 0FFFFFFFFh
                retn
__get_osfhandle endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _open_osfhandle(intptr_t OSFileHandle, int Flags)
__open_osfhandle proc near              ; CODE XREF: CStdioFile::Open(char const *,uint,CFileException *)+8F↓p

hFile           = dword ptr  4
Flags           = dword ptr  8

                mov     eax, dword ptr [esp+Flags]
                push    ebx
                xor     bl, bl
                push    esi
                test    al, 8
                push    edi
                jz      short loc_5C36FF
                mov     bl, 20h ; ' '

loc_5C36FF:                             ; CODE XREF: __open_osfhandle+B↑j
                test    ah, 40h
                jz      short loc_5C3707
                or      bl, 80h

loc_5C3707:                             ; CODE XREF: __open_osfhandle+12↑j
                mov     edi, [esp+0Ch+hFile]
                push    edi             ; hFile
                call    GetFileType
                test    eax, eax
                jnz     short loc_5C372C
                call    GetLastError
                push    eax
                call    __dosmaperr
                add     esp, 4
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C372C:                             ; CODE XREF: __open_osfhandle+24↑j
                cmp     eax, 2
                jnz     short loc_5C3736
                or      bl, 40h
                jmp     short loc_5C373E
; ---------------------------------------------------------------------------

loc_5C3736:                             ; CODE XREF: __open_osfhandle+3F↑j
                cmp     eax, 3
                jnz     short loc_5C373E
                or      bl, 8

loc_5C373E:                             ; CODE XREF: __open_osfhandle+44↑j
                call    __alloc_osfhnd
                mov     esi, eax
                cmp     esi, 0FFFFFFFFh
                jnz     short loc_5C3766
                call    __errno
                mov     dword ptr [eax], 18h
                call    ___doserrno
                mov     dword ptr [eax], 0
                or      eax, esi
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C3766:                             ; CODE XREF: __open_osfhandle+58↑j
                push    edi             ; hHandle
                push    esi             ; int
                call    __set_osfhnd
                mov     eax, esi
                mov     ecx, esi
                and     eax, 1Fh
                add     esp, 8
                sar     ecx, 5
                lea     edx, [eax+eax*8]
                or      bl, 1
                mov     eax, __pioinfo[ecx*4]
                push    esi
                mov     [eax+edx*4+4], bl
                call    __unlock_fhandle
                add     esp, 4
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebx
                retn
__open_osfhandle endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__lock_fhandle  proc near               ; CODE XREF: __alloc_osfhnd+14A↑p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                push    ebx
                mov     ecx, eax
                and     eax, 1Fh
                sar     ecx, 5
                push    esi
                push    edi
                mov     esi, __pioinfo[ecx*4]
                lea     ebx, __pioinfo[ecx*4]
                lea     edi, [eax+eax*8]
                shl     edi, 2
                add     esi, edi
                mov     eax, dword ptr [esi+8]
                test    eax, eax
                jnz     short loc_5C37F4
                push    11h
                call    __lock
                mov     eax, dword ptr [esi+8]
                add     esp, 4
                test    eax, eax
                jnz     short loc_5C37EA
                lea     edx, [esi+0Ch]
                push    edx             ; lpCriticalSection
                call    InitializeCriticalSection
                inc     dword ptr [esi+8]

loc_5C37EA:                             ; CODE XREF: __lock_fhandle+3B↑j
                push    11h
                call    __unlock
                add     esp, 4

loc_5C37F4:                             ; CODE XREF: __lock_fhandle+2A↑j
                mov     eax, dword ptr [ebx]
                lea     ecx, [eax+edi+0Ch]
                push    ecx             ; lpCriticalSection
                call    EnterCriticalSection
                pop     edi
                pop     esi
                pop     ebx
                retn
__lock_fhandle  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__unlock_fhandle proc near              ; CODE XREF: __open_osfhandle+9C↑p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                mov     ecx, eax
                and     eax, 1Fh
                sar     ecx, 5
                lea     edx, [eax+eax*8]
                mov     eax, __pioinfo[ecx*4]
                lea     ecx, [eax+edx*4+0Ch]
                push    ecx             ; lpCriticalSection
                call    LeaveCriticalSection
                retn
__unlock_fhandle endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__dosmaperr     proc near               ; CODE XREF: __beginthread+6D↑p

arg_0           = dword ptr  4

                push    esi
                call    ___doserrno
                mov     ecx, dword ptr [esp+4+arg_0]
                xor     esi, esi
                mov     [eax], ecx
                mov     eax, offset unk_63EE00

loc_5C3853:                             ; CODE XREF: __dosmaperr+20↓j
                cmp     ecx, [eax]
                jz      short loc_5C38A3
                add     eax, 8
                inc     esi
                cmp     eax, offset byte_63EF68
                jb      short loc_5C3853
                cmp     ecx, 13h
                jb      short loc_5C3879
                cmp     ecx, 24h ; '$'
                ja      short loc_5C3879
                call    __errno
                mov     dword ptr [eax], 0Dh
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C3879:                             ; CODE XREF: __dosmaperr+25↑j
                cmp     ecx, 0BCh
                jb      short loc_5C3896
                cmp     ecx, 0CAh
                ja      short loc_5C3896
                call    __errno
                mov     dword ptr [eax], 8
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C3896:                             ; CODE XREF: __dosmaperr+3F↑j
                call    __errno
                mov     dword ptr [eax], 16h
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C38A3:                             ; CODE XREF: __dosmaperr+15↑j
                call    __errno
                mov     ecx, dword_63EE04[esi*8]
                pop     esi
                mov     [eax], ecx
                retn
__dosmaperr     endp

; ---------------------------------------------------------------------------
                align 10h



; =============== S U B R O U T I N E =======================================

; Attributes: library function

; FILE *__cdecl _fdopen(int FileHandle, const char *Mode)
__fdopen        proc near               ; CODE XREF: CStdioFile::Open(char const *,uint,CFileException *)+A0↓p

FileHandle      = dword ptr  4
Mode            = dword ptr  8

                mov     eax, dword ptr [esp+FileHandle]
                mov     ecx, uNumber
                push    ebx
                push    ebp
                push    esi
                cmp     eax, ecx
                push    edi
                jnb     loc_5C39FF
                mov     ecx, eax
                and     eax, 1Fh
                sar     ecx, 5
                lea     edx, [eax+eax*8]
                mov     ebx, 1
                mov     eax, __pioinfo[ecx*4]
                test    [eax+edx*4+4], bl
                jz      loc_5C39FF
                call    __getstream
                mov     esi, eax
                test    esi, esi
                jz      loc_5C39FF
                mov     ebp, [esp+10h+Mode]
                mov     al, [ebp+0]
                cmp     al, 61h ; 'a'
                jz      short loc_5C3950
                cmp     al, 72h ; 'r'
                jz      short loc_5C394B
                cmp     al, 77h ; 'w'
                jz      short loc_5C3950
                xor     esi, esi
                push    esi             ; Stream
                call    __unlock_file
                add     esp, 4
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C394B:                             ; CODE XREF: __fdopen+53↑j
                mov     [esi+0Ch], ebx
                jmp     short loc_5C3957
; ---------------------------------------------------------------------------

loc_5C3950:                             ; CODE XREF: __fdopen+4F↑j
                mov     dword ptr [esi+0Ch], 2

loc_5C3957:                             ; CODE XREF: __fdopen+6E↑j
                mov     eax, dword_70D6C4
                mov     ecx, ebx
                mov     ebx, dword ptr [esi+0Ch]
                xor     edi, edi
                xor     edx, edx
                or      ebx, eax
                inc     ebp
                mov     [esi+0Ch], ebx
                mov     al, [ebp+0]
                test    al, al
                jz      short loc_5C39DD

loc_5C3972:                             ; CODE XREF: __fdopen+FB↓j
                test    ecx, ecx
                jz      short loc_5C39DD
                movsx   eax, al
                add     eax, 0FFFFFFD5h ; switch 74 cases
                cmp     eax, 49h
                ja      short def_5C3989 ; jumptable 005C3989 default case, cases 44-97,100-109,111-115
                xor     ebx, ebx
                mov     bl, ds:byte_5C3A20[eax]
                jmp     ds:jpt_5C3989[ebx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5C3990:                             ; CODE XREF: __fdopen+A9↑j
                mov     eax, dword ptr [esi+0Ch]  ; jumptable 005C3989 case 43
                test    al, 80h
                jnz     short def_5C3989 ; jumptable 005C3989 default case, cases 44-97,100-109,111-115
                and     al, 0FCh
                or      al, 80h
                mov     [esi+0Ch], eax
                jmp     short loc_5C39D5
; ---------------------------------------------------------------------------

loc_5C39A0:                             ; CODE XREF: __fdopen+A9↑j
                test    edx, edx        ; jumptable 005C3989 cases 98,116
                jnz     short def_5C3989 ; jumptable 005C3989 default case, cases 44-97,100-109,111-115
                mov     edx, 1
                jmp     short loc_5C39D5
; ---------------------------------------------------------------------------

loc_5C39AB:                             ; CODE XREF: __fdopen+A9↑j
                test    edi, edi        ; jumptable 005C3989 case 99
                jnz     short def_5C3989 ; jumptable 005C3989 default case, cases 44-97,100-109,111-115
                mov     eax, dword ptr [esi+0Ch]
                mov     edi, 1
                or      ah, 40h
                mov     [esi+0Ch], eax
                jmp     short loc_5C39D5
; ---------------------------------------------------------------------------

loc_5C39BF:                             ; CODE XREF: __fdopen+A9↑j
                test    edi, edi        ; jumptable 005C3989 case 110
                jnz     short def_5C3989 ; jumptable 005C3989 default case, cases 44-97,100-109,111-115
                mov     eax, dword ptr [esi+0Ch]
                mov     edi, 1
                and     ah, 0BFh
                mov     [esi+0Ch], eax
                jmp     short loc_5C39D5
; ---------------------------------------------------------------------------

def_5C3989:                             ; CODE XREF: __fdopen+9F↑j
                xor     ecx, ecx        ; jumptable 005C3989 default case, cases 44-97,100-109,111-115

loc_5C39D5:                             ; CODE XREF: __fdopen+BE↑j
                mov     al, [ebp+1]
                inc     ebp
                test    al, al
                jnz     short loc_5C3972

loc_5C39DD:                             ; CODE XREF: __fdopen+90↑j
                mov     eax, dword_70D6B8
                mov     ecx, dword ptr [esp+10h+FileHandle]
                inc     eax
                push    esi             ; Stream
                mov     dword_70D6B8, eax
                mov     [esi+10h], ecx
                call    __unlock_file
                add     esp, 4
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C39FF:                             ; CODE XREF: __fdopen+10↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                retn
__fdopen        endp

; ---------------------------------------------------------------------------
                align 4
jpt_5C3989      dd offset loc_5C3990    ; DATA XREF: __fdopen+A9↑r
                dd offset loc_5C39A0    ; jump table for switch statement
                dd offset loc_5C39AB
                dd offset loc_5C39BF
                dd offset loc_5C39A0
                dd offset def_5C3989
byte_5C3A20     db      0,     5,     5,     5
                db      5,     5,     5,     5 ; indirect table for switch statement
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     1
                db      2,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     3
                db      5,     5,     5,     5
                db      5,     4
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void __cdecl clearerr(FILE *Stream)
_clearerr       proc near               ; CODE XREF: CStdioFile::Read(void *,uint)+4E↓p

Stream          = dword ptr  4

                push    esi
                mov     esi, [esp+4+Stream]
                push    esi             ; Stream
                call    __lock_file
                mov     edx, dword ptr [esi+0Ch]
                mov     eax, dword ptr [esi+10h]
                add     esp, 4
                and     edx, 0FFFFFFCFh
                cmp     eax, 0FFFFFFFFh
                mov     [esi+0Ch], edx
                jz      short loc_5C3AB3
                mov     ecx, eax
                and     eax, 1Fh
                sar     ecx, 5
                lea     edx, [eax+eax*8]
                push    esi             ; Stream
                mov     eax, __pioinfo[ecx*4]
                lea     eax, [eax+edx*4]
                and     byte ptr [eax+4], 0FDh
                call    __unlock_file
                add     esp, 4
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C3AB3:                             ; CODE XREF: _clearerr+1D↑j
                mov     eax, offset unk_6418D8
                push    esi             ; Stream
                and     byte ptr [eax+4], 0FDh
                call    __unlock_file
                add     esp, 4
                pop     esi
                retn
_clearerr       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


; int __cdecl _fwrite(void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream)
_fwrite      proc near               ; CODE XREF: CStdioFile::Write(void const *,uint)+10↓p

Buffer          = dword ptr  4
ElementSize     = dword ptr  8
ElementCount    = dword ptr  0Ch
Stream          = dword ptr  10h

                push    esi
                mov     esi, [esp+4+Stream]
                push    edi
                push    esi             ; Stream
                call    __lock_file
                mov     eax, dword ptr [esp+0Ch+ElementCount]
                mov     ecx, dword ptr [esp+0Ch+ElementSize]
                mov     edx, dword ptr [esp+0Ch+Buffer]
                add     esp, 4
                push    esi             ; Stream
                push    eax             ; ElementCount
                push    ecx             ; ElementSize
                push    edx             ; Buffer
                call    _fwrite_lk
                add     esp, 10h
                mov     edi, eax
                push    esi             ; Stream
                call    __unlock_file
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
_fwrite      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; size_t __cdecl fwrite(const void *Buffer, size_t ElementSize, size_t ElementCount, FILE *Stream)
_fwrite_lk         proc near               ; CODE XREF: _fwrite+1F↑p

var_4           = dword ptr -4
Buffer          = dword ptr  4
ElementSize     = dword ptr  8
ElementCount    = dword ptr  0Ch
Stream          = dword ptr  10h

                push    ecx
                push    ebx
                push    ebp
                mov     ebp, [esp+0Ch+ElementCount]
                push    esi
                imul    ebp, [esp+10h+ElementSize]
                mov     esi, [esp+10h+Buffer]
                push    edi
                test    ebp, ebp
                mov     [esp+14h+Buffer], esi
                mov     [esp+14h+var_4], ebp
                jnz     short loc_5C3B36
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C3B36:                             ; CODE XREF: _fwrite_lk+1C↑j
                mov     ebx, dword ptr [esp+14h+Stream]
                test    dword ptr [ebx+0Ch], 10Ch
                jz      short loc_5C3B4C
                mov     edi, [ebx+18h]
                mov     [esp+14h+Stream], edi
                jmp     short loc_5C3B58
; ---------------------------------------------------------------------------

loc_5C3B4C:                             ; CODE XREF: _fwrite_lk+31↑j
                mov     [esp+14h+Stream], 1000h

loc_5C3B54:                             ; CODE XREF: _fwrite_lk+109↓j
                mov     edi, [esp+14h+Stream]

loc_5C3B58:                             ; CODE XREF: _fwrite_lk+3A↑j
                mov     ecx, dword ptr [ebx+0Ch]
                and     ecx, 108h
                jz      short loc_5C3BA0
                mov     eax, dword ptr [ebx+4]
                test    eax, eax
                jz      short loc_5C3BA0
                cmp     ebp, eax
                jnb     short loc_5C3B70
                mov     eax, ebp

loc_5C3B70:                             ; CODE XREF: _fwrite_lk+5C↑j
                mov     edi, [ebx]
                mov     ecx, eax
                mov     edx, ecx
                sub     ebp, eax
                shr     ecx, 2
                rep movsd
                mov     ecx, edx
                and     ecx, 3
                rep movsb
                mov     esi, [ebx+4]
                mov     edx, dword ptr [ebx]
                mov     ecx, dword ptr [esp+14h+Buffer]
                sub     esi, eax
                add     edx, eax
                add     ecx, eax
                mov     [ebx+4], esi
                mov     [ebx], edx
                mov     [esp+14h+Buffer], ecx
                mov     esi, ecx
                jmp     short loc_5C3C17
; ---------------------------------------------------------------------------

loc_5C3BA0:                             ; CODE XREF: _fwrite_lk+51↑j
                cmp     ebp, edi
                jb      short loc_5C3BEC
                test    ecx, ecx
                jz      short loc_5C3BB9
                push    ebx
                call    __flush
                add     esp, 4
                test    eax, eax
                jnz     loc_5C3C44

loc_5C3BB9:                             ; CODE XREF: _fwrite_lk+96↑j
                test    edi, edi
                jz      short loc_5C3BC9
                mov     eax, ebp
                xor     edx, edx
                div     edi
                mov     edi, ebp
                sub     edi, edx
                jmp     short loc_5C3BCB
; ---------------------------------------------------------------------------

loc_5C3BC9:                             ; CODE XREF: _fwrite_lk+AB↑j
                mov     edi, ebp

loc_5C3BCB:                             ; CODE XREF: _fwrite_lk+B7↑j
                mov     eax, dword ptr [ebx+10h]
                push    edi             ; MaxCharCount
                push    esi             ; Buf
                push    eax             ; FileHandle
                call    __write
                add     esp, 0Ch
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5C3C29
                sub     ebp, eax
                add     esi, eax
                cmp     eax, edi
                mov     [esp+14h+Buffer], esi
                jb      short loc_5C3C29
                jmp     short loc_5C3C17
; ---------------------------------------------------------------------------

loc_5C3BEC:                             ; CODE XREF: _fwrite_lk+92↑j
                movsx   ecx, byte ptr [esi]
                push    ebx             ; File
                push    ecx             ; Ch
                call    __flsbuf
                add     esp, 8
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5C3C44
                mov     eax, dword ptr [ebx+18h]
                inc     esi
                dec     ebp
                mov     [esp+14h+Buffer], esi
                test    eax, eax
                mov     [esp+14h+Stream], eax
                jg      short loc_5C3C17
                mov     [esp+14h+Stream], 1

loc_5C3C17:                             ; CODE XREF: _fwrite_lk+8E↑j
                test    ebp, ebp
                jnz     loc_5C3B54
                mov     eax, dword ptr [esp+14h+ElementCount]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C3C29:                             ; CODE XREF: _fwrite_lk+CC↑j
                mov     edx, dword ptr [ebx+0Ch]
                mov     eax, dword ptr [esp+14h+var_4]
                or      edx, 20h
                sub     eax, ebp
                mov     [ebx+0Ch], edx
                xor     edx, edx
                div     [esp+14h+ElementSize]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C3C44:                             ; CODE XREF: _fwrite_lk+A3↑j
                mov     eax, dword ptr [esp+14h+var_4]
                xor     edx, edx
                sub     eax, ebp
                div     [esp+14h+ElementSize]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
_fwrite_lk         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl fputs(const char *Buffer, FILE *Stream)
_fputs          proc near               ; CODE XREF: CStdioFile::WriteString(char const *)+A↓p

Buffer          = dword ptr  4
Stream          = dword ptr  8

                push    ebx
                mov     ebx, dword ptr [esp+4+Buffer]
                push    ebp
                push    esi
                push    edi
                mov     edi, ebx
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                mov     esi, [esp+10h+Stream]
                not     ecx
                dec     ecx
                push    esi             ; Stream
                mov     edi, ecx
                call    __lock_file
                add     esp, 4
                push    esi
                call    __stbuf
                add     esp, 4
                mov     ebp, eax
                push    esi             ; Stream
                push    edi             ; ElementCount
                push    1               ; ElementSize
                push    ebx             ; Buffer
                call    _fwrite_lk
                add     esp, 10h
                mov     ebx, eax
                push    esi
                push    ebp
                call    __ftbuf
                add     esp, 8
                push    esi             ; Stream
                call    __unlock_file
                add     esp, 4
                mov     eax, ebx
                sub     eax, edi
                pop     edi
                pop     esi
                neg     eax
                pop     ebp
                pop     ebx
                sbb     eax, eax
                retn
_fputs          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl ftell(FILE *Stream)
_ftell          proc near               ; CODE XREF: CStdioFile::Seek(long,uint)+2E↓p

Stream          = dword ptr  4

                push    esi
                mov     esi, [esp+4+Stream]
                push    edi
                push    esi             ; Stream
                call    __lock_file
                add     esp, 4
                push    esi
                call    __ftell_lk
                add     esp, 4
                mov     edi, eax
                push    esi             ; Stream
                call    __unlock_file
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
_ftell          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__ftell_lk      proc near               ; CODE XREF: __fseek_lk+2A↑p

var_8           = dword ptr -8
varOffset          = dword ptr -4
arg_0           = dword ptr  4

                sub     esp, 8
                push    ebx
                push    ebp
                push    esi
                mov     esi, [esp+14h+arg_0]
                push    edi
                mov     eax, dword ptr [esi+4]
                mov     ebx, dword ptr [esi+10h]
                test    eax, eax
                jge     short loc_5C3D0C
                mov     dword ptr [esi+4], 0

loc_5C3D0C:                             ; CODE XREF: __ftell_lk+13↑j
                push    1               ; Origin
                push    0               ; varOffset
                push    ebx             ; FileHandle
                call    __lseek
                mov     ecx, eax
                add     esp, 0Ch
                test    ecx, ecx
                mov     [esp+18h+varOffset], ecx
                jge     short loc_5C3D2E
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C3D2E:                             ; CODE XREF: __ftell_lk+31↑j
                mov     eax, dword ptr [esi+0Ch]
                test    eax, 108h
                jnz     short loc_5C3D47
                mov     eax, ecx
                mov     ecx, dword ptr [esi+4]
                sub     eax, ecx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C3D47:                             ; CODE XREF: __ftell_lk+46↑j
                mov     ecx, dword ptr [esi]
                mov     edi, [esi+8]
                mov     edx, ecx
                sub     edx, edi
                test    al, 3
                mov     [esp+18h+var_8], edx
                jz      loc_5C3E76
                mov     ebp, ebx
                mov     eax, ebx
                sar     ebp, 5
                and     eax, 1Fh
                mov     ebp, __pioinfo[ebp*4]
                lea     eax, [eax+eax*8]
                test    byte ptr [ebp+eax*4+4], 80h
                jz      short loc_5C3D8C
                mov     eax, edi
                cmp     eax, ecx
                jnb     short loc_5C3D8C

loc_5C3D7D:                             ; CODE XREF: __ftell_lk+96↓j
                cmp     byte ptr [eax], 0Ah
                jnz     short loc_5C3D83
                inc     edx

loc_5C3D83:                             ; CODE XREF: __ftell_lk+90↑j
                inc     eax
                cmp     eax, ecx
                jb      short loc_5C3D7D
                mov     [esp+18h+var_8], edx

loc_5C3D8C:                             ; CODE XREF: __ftell_lk+85↑j
                mov     eax, dword ptr [esp+18h+varOffset]
                test    eax, eax
                jnz     short loc_5C3D9E
                mov     eax, edx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C3D9E:                             ; CODE XREF: __ftell_lk+A2↑j
                test    byte ptr [esi+0Ch], 1
                jz      loc_5C3E67
                mov     eax, dword ptr [esi+4]
                test    eax, eax
                jnz     short loc_5C3DC4
                mov     ecx, dword ptr [esp+18h+varOffset]
                mov     edx, eax
                mov     [esp+18h+var_8], eax
                lea     eax, [ecx+edx]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C3DC4:                             ; CODE XREF: __ftell_lk+BD↑j
                lea     esi, [ecx+eax]
                mov     ecx, ebx
                mov     eax, ebx
                sub     esi, edi
                sar     ecx, 5
                and     eax, 1Fh
                lea     ebp, __pioinfo[ecx*4]
                lea     edi, [eax+eax*8]
                mov     eax, dword ptr [ebp+0]
                shl     edi, 2
                test    byte ptr [edi+eax+4], 80h
                jz      short loc_5C3E63
                push    2               ; Origin
                push    0               ; varOffset
                push    ebx             ; FileHandle
                call    __lseek
                mov     ecx, dword ptr [esp+24h+varOffset]
                add     esp, 0Ch
                cmp     eax, ecx
                jnz     short loc_5C3E22
                mov     edx, dword ptr [esp+18h+arg_0]
                mov     eax, dword ptr [edx+8]
                lea     ecx, [esi+eax]
                cmp     eax, ecx
                jnb     short loc_5C3E18

loc_5C3E0D:                             ; CODE XREF: __ftell_lk+126↓j
                cmp     byte ptr [eax], 0Ah
                jnz     short loc_5C3E13
                inc     esi

loc_5C3E13:                             ; CODE XREF: __ftell_lk+120↑j
                inc     eax
                cmp     eax, ecx
                jb      short loc_5C3E0D

loc_5C3E18:                             ; CODE XREF: __ftell_lk+11B↑j
                mov     eax, dword ptr [edx+0Ch]
                test    ah, 20h
                jz      short loc_5C3E5F
                jmp     short loc_5C3E5E
; ---------------------------------------------------------------------------

loc_5C3E22:                             ; CODE XREF: __ftell_lk+10D↑j
                push    0               ; Origin
                push    ecx             ; varOffset
                push    ebx             ; FileHandle
                call    __lseek
                add     esp, 0Ch
                cmp     esi, 200h
                ja      short loc_5C3E4D
                mov     ecx, dword ptr [esp+18h+arg_0]
                mov     eax, dword ptr [ecx+0Ch]
                test    al, 8
                jz      short loc_5C3E4D
                test    ah, 4
                jnz     short loc_5C3E4D
                mov     esi, 200h
                jmp     short loc_5C3E54
; ---------------------------------------------------------------------------

loc_5C3E4D:                             ; CODE XREF: __ftell_lk+144↑j
                mov     edx, dword ptr [esp+18h+arg_0]
                mov     esi, [edx+18h]

loc_5C3E54:                             ; CODE XREF: __ftell_lk+15B↑j
                mov     eax, dword ptr [ebp+0]
                test    byte ptr [edi+eax+4], 4
                jz      short loc_5C3E5F

loc_5C3E5E:                             ; CODE XREF: __ftell_lk+130↑j
                inc     esi

loc_5C3E5F:                             ; CODE XREF: __ftell_lk+12E↑j
                mov     edx, dword ptr [esp+18h+var_8]

loc_5C3E63:                             ; CODE XREF: __ftell_lk+F8↑j
                sub     [esp+18h+varOffset], esi

loc_5C3E67:                             ; CODE XREF: __ftell_lk+B2↑j
                mov     ecx, dword ptr [esp+18h+varOffset]
                lea     eax, [ecx+edx]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C3E76:                             ; CODE XREF: __ftell_lk+66↑j
                test    al, 80h
                jnz     loc_5C3D8C
                call    __errno
                pop     edi
                pop     esi
                mov     dword ptr [eax], 16h
                pop     ebp
                or      eax, 0FFFFFFFFh
                pop     ebx
                add     esp, 8
                retn
__ftell_lk      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl fflush(FILE *Stream)
_fflush         proc near               ; CODE XREF: ostream::osfx(void)+4E↓p

Stream          = dword ptr  4

                push    esi
                mov     esi, [esp+4+Stream]
                test    esi, esi
                jnz     short loc_5C3EB4
                push    esi
                call    _flsall
                add     esp, 4
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C3EB4:                             ; CODE XREF: _fflush+7↑j
                push    edi
                push    esi             ; Stream
                call    __lock_file
                add     esp, 4
                push    esi
                call    __fflush_lk
                add     esp, 4
                mov     edi, eax
                push    esi             ; Stream
                call    __unlock_file
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
_fflush         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__fflush_lk     proc near               ; CODE XREF: _fflush+1F↑p

arg_0           = dword ptr  4

                push    esi
                mov     esi, [esp+4+arg_0]
                push    esi
                call    __flush
                add     esp, 4
                test    eax, eax
                jz      short loc_5C3EF7
                or      eax, 0FFFFFFFFh
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C3EF7:                             ; CODE XREF: __fflush_lk+10↑j
                mov     eax, dword ptr [esi+0Ch]
                test    ah, 40h
                jz      short loc_5C3F11
                mov     eax, dword ptr [esi+10h]
                push    eax             ; FileHandle
                call    __commit
                add     esp, 4
                neg     eax
                sbb     eax, eax
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C3F11:                             ; CODE XREF: __fflush_lk+1D↑j
                xor     eax, eax
                pop     esi
                retn
__fflush_lk     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__flush         proc near               ; CODE XREF: __fclose_lk+10↑p

arg_0           = dword ptr  4

                push    ebx
                push    esi
                mov     esi, [esp+8+arg_0]
                xor     ebx, ebx
                push    edi
                mov     eax, dword ptr [esi+0Ch]
                mov     ecx, eax
                and     ecx, 3
                cmp     cl, 2
                jnz     short loc_5C3F7C
                test    eax, 108h
                jz      short loc_5C3F7C
                mov     eax, dword ptr [esi+8]
                mov     edi, [esi]
                sub     edi, eax
                test    edi, edi
                jle     short loc_5C3F7C
                mov     edx, dword ptr [esi+10h]
                push    edi             ; MaxCharCount
                push    eax             ; Buf
                push    edx             ; FileHandle
                call    __write
                add     esp, 0Ch
                cmp     eax, edi
                mov     eax, dword ptr [esi+0Ch]
                jnz     short loc_5C3F74
                test    al, 80h
                jz      short loc_5C3F7C
                and     al, 0FDh
                mov     [esi+4], ebx
                mov     [esi+0Ch], eax
                mov     eax, dword ptr [esi+8]
                mov     [esi], eax
                mov     eax, ebx
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C3F74:                             ; CODE XREF: __flush+3B↑j
                or      al, 20h
                or      ebx, 0FFFFFFFFh
                mov     [esi+0Ch], eax

loc_5C3F7C:                             ; CODE XREF: __flush+14↑j
                mov     eax, dword ptr [esi+8]
                mov     dword ptr [esi+4], 0
                mov     [esi], eax
                pop     edi
                mov     eax, ebx
                pop     esi
                pop     ebx
                retn
__flush         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _flushall()
__flushall      proc near               ; CODE XREF: ___endstdio↓p
                push    1
                call    _flsall
                add     esp, 4
                retn
__flushall      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_flsall         proc near               ; CODE XREF: _fflush+A↑p

var_4           = dword ptr -4
arg_0           = dword ptr  4

                push    ecx
                push    ebx
                push    ebp
                push    esi
                push    edi
                xor     esi, esi
                push    2
                mov     [esp+18h+var_4], esi
                xor     ebp, ebp
                call    __lock
                mov     eax, Count
                mov     edi, [esp+18h+arg_0]
                add     esp, 4
                cmp     eax, esi
                jle     short loc_5C4040
                mov     bl, 83h

loc_5C3FC6:                             ; CODE XREF: _flsall+9E↓j
                mov     eax, dword_70D838
                mov     eax, dword ptr [eax+esi*4]
                test    eax, eax
                jz      short loc_5C4036
                test    [eax+0Ch], bl
                jz      short loc_5C4036
                push    eax
                push    esi
                call    __lock_file2
                mov     ecx, dword_70D838
                add     esp, 8
                mov     eax, dword ptr [ecx+esi*4]
                mov     ecx, dword ptr [eax+0Ch]
                test    bl, cl
                jz      short loc_5C4023
                cmp     edi, 1
                jnz     short loc_5C400A
                push    eax
                call    __fflush_lk
                add     esp, 4
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5C4023
                inc     [esp+14h+var_4]
                jmp     short loc_5C4023
; ---------------------------------------------------------------------------

loc_5C400A:                             ; CODE XREF: _flsall+54↑j
                test    edi, edi
                jnz     short loc_5C4023
                test    cl, 2
                jz      short loc_5C4023
                push    eax
                call    __fflush_lk
                add     esp, 4
                cmp     eax, 0FFFFFFFFh
                jnz     short loc_5C4023
                or      ebp, eax

loc_5C4023:                             ; CODE XREF: _flsall+4F↑j
                mov     edx, dword_70D838
                mov     eax, dword ptr [edx+esi*4]
                push    eax
                push    esi
                call    __unlock_file2
                add     esp, 8

loc_5C4036:                             ; CODE XREF: _flsall+30↑j
                mov     eax, Count
                inc     esi
                cmp     esi, eax
                jl      short loc_5C3FC6

loc_5C4040:                             ; CODE XREF: _flsall+22↑j
                push    2
                call    __unlock
                mov     eax, dword ptr [esp+18h+var_4]
                add     esp, 4
                cmp     edi, 1
                jz      short loc_5C4055
                mov     eax, ebp

loc_5C4055:                             ; CODE XREF: _flsall+B1↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
_flsall         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; __time32_t __cdecl mktime(struct tm *const Tm)
_mktime         proc near               ; CODE XREF: CTime::CTime(int,int,int,int,int,int,int)+3D↓p

Tm              = dword ptr  4

                mov     eax, dword ptr [esp+Tm]
                push    1               ; int
                push    eax             ; Time
                call    __make_time_t
                add     esp, 8
                retn
_mktime         endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; __time32_t __cdecl _mkgmtime(struct tm *const Tm)
__mkgmtime      proc near

Tm              = dword ptr  4

                mov     eax, dword ptr [esp+Tm]
                push    0               ; int
                push    eax             ; Time
                call    __make_time_t
                add     esp, 8
                retn
__mkgmtime      endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl _make_time_t(__time32_t Time, int)
__make_time_t   proc near               ; CODE XREF: _mktime+7↑p

Time            = dword ptr  4
arg_4           = dword ptr  8

                push    ebx
                push    esi
                push    edi
                mov     edi, [esp+0Ch+Time]
                mov     ecx, dword ptr [edi+14h]
                cmp     ecx, 45h ; 'E'
                jl      loc_5C42B5
                cmp     ecx, 8Bh
                jg      loc_5C42B5
                mov     esi, [edi+10h]
                test    esi, esi
                jl      short loc_5C40AB
                cmp     esi, 0Bh
                jle     short loc_5C40E9

loc_5C40AB:                             ; CODE XREF: __make_time_t+24↑j
                mov     eax, 2AAAAAABh
                imul    esi
                sar     edx, 1
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                mov     eax, esi
                add     ecx, edx
                mov     esi, 0Ch
                cdq
                idiv    esi
                test    edx, edx
                mov     [edi+10h], edx
                jge     short loc_5C40D4
                add     edx, esi
                dec     ecx
                mov     [edi+10h], edx

loc_5C40D4:                             ; CODE XREF: __make_time_t+4C↑j
                cmp     ecx, 45h ; 'E'
                jl      loc_5C42B5
                cmp     ecx, 8Bh
                jg      loc_5C42B5

loc_5C40E9:                             ; CODE XREF: __make_time_t+29↑j
                mov     edx, dword ptr [edi+10h]
                test    cl, 3
                mov     eax, dword_641C70[edx*4]
                jnz     short loc_5C40FE
                cmp     edx, 1
                jle     short loc_5C40FE
                inc     eax

loc_5C40FE:                             ; CODE XREF: __make_time_t+76↑j
                lea     esi, [ecx+ecx*8]
                lea     edx, [ecx-1]
                sar     edx, 2
                lea     ecx, [ecx+esi*8]
                add     eax, edx
                mov     edx, dword ptr [edi+0Ch]
                lea     ecx, [ecx+ecx*4]
                lea     eax, [ecx+eax-63DFh]
                test    eax, eax
                lea     ecx, [eax+edx]
                jl      short loc_5C4130
                test    edx, edx
                jl      short loc_5C412C
                test    ecx, ecx
                jl      loc_5C42B5

loc_5C412C:                             ; CODE XREF: __make_time_t+A2↑j
                test    eax, eax
                jge     short loc_5C413C

loc_5C4130:                             ; CODE XREF: __make_time_t+9E↑j
                test    edx, edx
                jge     short loc_5C413C
                test    ecx, ecx
                jge     loc_5C42B5

loc_5C413C:                             ; CODE XREF: __make_time_t+AE↑j
                lea     ebx, [ecx+ecx*2]
                shl     ebx, 3
                test    ecx, ecx
                jz      short loc_5C4157
                mov     eax, ebx
                cdq
                idiv    ecx
                xor     edx, edx
                cmp     eax, 18h
                setnz   dl
                mov     eax, edx
                jmp     short loc_5C4159
; ---------------------------------------------------------------------------

loc_5C4157:                             ; CODE XREF: __make_time_t+C4↑j
                xor     eax, eax

loc_5C4159:                             ; CODE XREF: __make_time_t+D5↑j
                test    eax, eax
                jnz     loc_5C42B5
                mov     eax, dword ptr [edi+8]
                test    ebx, ebx
                lea     esi, [eax+ebx]
                jl      short loc_5C417B
                test    eax, eax
                jl      short loc_5C4177
                test    esi, esi
                jl      loc_5C42B5

loc_5C4177:                             ; CODE XREF: __make_time_t+ED↑j
                test    ebx, ebx
                jge     short loc_5C4187

loc_5C417B:                             ; CODE XREF: __make_time_t+E9↑j
                test    eax, eax
                jge     short loc_5C4187
                test    esi, esi
                jge     loc_5C42B5

loc_5C4187:                             ; CODE XREF: __make_time_t+F9↑j
                mov     ecx, esi
                shl     ecx, 4
                sub     ecx, esi
                shl     ecx, 2
                test    esi, esi
                jz      short loc_5C41A6
                mov     eax, ecx
                cdq
                idiv    esi
                xor     edx, edx
                cmp     eax, 3Ch ; '<'
                setnz   dl
                mov     eax, edx
                jmp     short loc_5C41A8
; ---------------------------------------------------------------------------

loc_5C41A6:                             ; CODE XREF: __make_time_t+113↑j
                xor     eax, eax

loc_5C41A8:                             ; CODE XREF: __make_time_t+124↑j
                test    eax, eax
                jnz     loc_5C42B5
                mov     eax, dword ptr [edi+4]
                test    ecx, ecx
                lea     esi, [eax+ecx]
                jl      short loc_5C41CA
                test    eax, eax
                jl      short loc_5C41C6
                test    esi, esi
                jl      loc_5C42B5

loc_5C41C6:                             ; CODE XREF: __make_time_t+13C↑j
                test    ecx, ecx
                jge     short loc_5C41D6

loc_5C41CA:                             ; CODE XREF: __make_time_t+138↑j
                test    eax, eax
                jge     short loc_5C41D6
                test    esi, esi
                jge     loc_5C42B5

loc_5C41D6:                             ; CODE XREF: __make_time_t+148↑j
                mov     ecx, esi
                shl     ecx, 4
                sub     ecx, esi
                shl     ecx, 2
                test    esi, esi
                jz      short loc_5C41F5
                mov     eax, ecx
                cdq
                idiv    esi
                xor     edx, edx
                cmp     eax, 3Ch ; '<'
                setnz   dl
                mov     eax, edx
                jmp     short loc_5C41F7
; ---------------------------------------------------------------------------

loc_5C41F5:                             ; CODE XREF: __make_time_t+162↑j
                xor     eax, eax

loc_5C41F7:                             ; CODE XREF: __make_time_t+173↑j
                test    eax, eax
                jnz     loc_5C42B5
                mov     eax, dword ptr [edi]
                test    ecx, ecx
                lea     edx, [eax+ecx]
                mov     [esp+0Ch+Time], edx
                jl      short loc_5C421C
                test    eax, eax
                jl      short loc_5C4218
                test    edx, edx
                jl      loc_5C42B5

loc_5C4218:                             ; CODE XREF: __make_time_t+18E↑j
                test    ecx, ecx
                jge     short loc_5C4228

loc_5C421C:                             ; CODE XREF: __make_time_t+18A↑j
                test    eax, eax
                jge     short loc_5C4228
                test    edx, edx
                jge     loc_5C42B5

loc_5C4228:                             ; CODE XREF: __make_time_t+19A↑j
                mov     eax, dword ptr [esp+0Ch+arg_4]
                test    eax, eax
                jz      short loc_5C4293
                call    ___tzset
                mov     eax, dword_641B80
                mov     ebx, dword ptr [esp+0Ch+Time]
                lea     ecx, [esp+0Ch+Time]
                add     ebx, eax
                push    ecx             ; Time
                mov     [esp+10h+Time], ebx
                call    _localtime
                add     esp, 4
                test    eax, eax
                jz      short loc_5C42B5
                mov     ecx, dword ptr [edi+20h]
                test    ecx, ecx
                jg      short loc_5C4265
                jge     short loc_5C42A4
                mov     ecx, dword ptr [eax+20h]
                test    ecx, ecx
                jle     short loc_5C42A4

loc_5C4265:                             ; CODE XREF: __make_time_t+1DA↑j
                mov     edx, dword_641B88
                mov     esi, [esp+0Ch+Time]
                lea     eax, [esp+0Ch+Time]
                add     esi, edx
                push    eax             ; Time
                mov     [esp+10h+Time], esi
                call    _localtime
                mov     ecx, 9
                mov     esi, eax
                mov     eax, dword ptr [esp+10h+Time]
                add     esp, 4
                rep movsd
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C4293:                             ; CODE XREF: __make_time_t+1AE↑j
                lea     ecx, [esp+0Ch+Time]
                push    ecx             ; Time
                call    _gmtime
                add     esp, 4
                test    eax, eax
                jz      short loc_5C42B5

loc_5C42A4:                             ; CODE XREF: __make_time_t+1DC↑j
                mov     ecx, 9
                mov     esi, eax
                mov     eax, dword ptr [esp+0Ch+Time]
                rep movsd
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C42B5:                             ; CODE XREF: __make_time_t+D↑j
                pop     edi
                pop     esi
                or      eax, 0FFFFFFFFh
                pop     ebx
                retn
__make_time_t   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; struct tm *__cdecl gmtime(const __time32_t *const Time)
_gmtime         proc near               ; CODE XREF: __make_time_t+218↑p

Time            = dword ptr  4

                push    ebx
                push    ebp
                mov     ebp, [esp+8+Time]
                push    esi
                push    edi
                xor     ebx, ebx
                mov     esi, [ebp+0]
                call    __getptd
                test    esi, esi
                mov     edi, eax
                jge     short loc_5C42DF
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C42DF:                             ; CODE XREF: _gmtime+16↑j
                mov     eax, dword ptr [edi+40h]
                test    eax, eax
                jnz     short loc_5C42FC
                push    24h ; '$'       ; varSize
                call    _malloc
                add     esp, 4
                mov     [edi+40h], eax
                test    eax, eax
                mov     ecx, offset unk_70D390
                jz      short loc_5C42FF

loc_5C42FC:                             ; CODE XREF: _gmtime+24↑j
                mov     ecx, dword ptr [edi+40h]

loc_5C42FF:                             ; CODE XREF: _gmtime+3A↑j
                mov     eax, 11032D79h
                imul    esi
                sar     edx, 17h
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                mov     eax, edx
                imul    eax, -7861F80h
                add     esi, eax
                lea     eax, ds:46h[edx*4]
                cmp     esi, 1E13380h
                jl      short loc_5C4355
                sub     esi, 1E13380h
                inc     eax
                cmp     esi, 1E13380h
                jl      short loc_5C4355
                sub     esi, 1E13380h
                inc     eax
                cmp     esi, 1E28500h
                jl      short loc_5C4350
                inc     eax
                sub     esi, 1E28500h
                jmp     short loc_5C4355
; ---------------------------------------------------------------------------

loc_5C4350:                             ; CODE XREF: _gmtime+85↑j
                mov     ebx, 1

loc_5C4355:                             ; CODE XREF: _gmtime+67↑j
                mov     [ecx+14h], eax
                mov     eax, 0C22E4507h
                imul    esi
                add     edx, esi
                sar     edx, 10h
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                mov     eax, edx
                mov     [ecx+1Ch], edx
                shl     eax, 4
                sub     eax, edx
                neg     eax
                lea     eax, [eax+eax*4]
                lea     edx, [eax+eax*8]
                shl     edx, 7
                add     esi, edx
                test    ebx, ebx
                mov     ebx, offset dword_641C38
                jnz     short loc_5C4390
                mov     ebx, offset dword_641C70

loc_5C4390:                             ; CODE XREF: _gmtime+C9↑j
                mov     edi, [ecx+1Ch]
                lea     edx, [ebx+4]
                mov     eax, 1
                cmp     [edx], edi
                jge     short loc_5C43A7

loc_5C439F:                             ; CODE XREF: _gmtime+E5↓j
                add     edx, 4
                inc     eax
                cmp     [edx], edi
                jl      short loc_5C439F

loc_5C43A7:                             ; CODE XREF: _gmtime+DD↑j
                mov     edx, dword ptr [ecx+1Ch]
                dec     eax
                mov     [ecx+10h], eax
                mov     edi, [ebx+eax*4]
                mov     eax, 0C22E4507h
                sub     edx, edi
                mov     [ecx+0Ch], edx
                mov     edi, [ebp+0]
                imul    edi
                add     edx, edi
                mov     edi, 7
                sar     edx, 10h
                mov     eax, edx
                mov     dword ptr [ecx+20h], 0
                shr     eax, 1Fh
                lea     eax, [edx+eax+4]
                cdq
                idiv    edi
                mov     eax, 91A2B3C5h
                pop     edi
                mov     [ecx+18h], edx
                imul    esi
                add     edx, esi
                sar     edx, 0Bh
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                mov     eax, 88888889h
                mov     [ecx+8], edx
                imul    edx, -0E10h
                add     esi, edx
                imul    esi
                add     edx, esi
                sar     edx, 5
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                mov     [ecx+4], edx
                lea     eax, [edx+edx*2]
                lea     edx, [eax+eax*4]
                mov     eax, ecx
                shl     edx, 2
                sub     esi, edx
                mov     [ecx], esi
                pop     esi
                pop     ebp
                pop     ebx
                retn
_gmtime         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; struct tm *__cdecl localtime(const __time32_t *const Time)
_localtime      proc near               ; CODE XREF: __make_time_t+1C9↑p

Time            = dword ptr  4

                push    esi
                mov     esi, [esp+4+Time]
                cmp     dword ptr [esi], 0
                jge     short loc_5C443E
                xor     eax, eax
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C443E:                             ; CODE XREF: _localtime+8↑j
                call    ___tzset
                mov     eax, dword ptr [esi]
                cmp     eax, 3F480h
                jle     short loc_5C44B2
                cmp     eax, 7FFC0B7Fh
                jge     short loc_5C44B2
                sub     eax, dword_641B80
                mov     [esp+4+Time], eax
                lea     eax, [esp+4+Time]
                push    eax             ; Time
                call    _gmtime
                mov     esi, eax
                mov     eax, dword_641B84
                add     esp, 4
                test    eax, eax
                jz      loc_5C4612
                push    esi
                call    __isindst
                add     esp, 4
                test    eax, eax
                jz      loc_5C4612
                mov     ecx, dword_641B88
                mov     eax, dword ptr [esp+4+Time]
                lea     edx, [esp+4+Time]
                sub     eax, ecx
                push    edx             ; Time
                mov     [esp+8+Time], eax
                call    _gmtime
                mov     esi, eax
                add     esp, 4
                mov     dword ptr [esi+20h], 1
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C44B2:                             ; CODE XREF: _localtime+1A↑j
                push    esi             ; Time
                call    _gmtime
                add     esp, 4
                mov     esi, eax
                push    esi
                call    __isindst
                add     esp, 4
                test    eax, eax
                mov     eax, dword ptr [esi]
                jz      short loc_5C44D2
                sub     eax, dword_641B88

loc_5C44D2:                             ; CODE XREF: _localtime+9A↑j
                mov     ecx, dword_641B80
                sub     eax, ecx
                mov     ecx, 3Ch ; '<'
                mov     [esp+4+Time], eax
                cdq
                idiv    ecx
                test    edx, edx
                mov     [esi], edx
                jge     short loc_5C44FA
                add     edx, ecx
                mov     [esi], edx
                mov     eax, dword ptr [esp+4+Time]
                sub     eax, ecx
                mov     [esp+4+Time], eax

loc_5C44FA:                             ; CODE XREF: _localtime+BA↑j
                mov     ecx, dword ptr [esp+4+Time]
                mov     eax, 88888889h
                imul    ecx
                add     edx, ecx
                mov     ecx, dword ptr [esi+4]
                sar     edx, 5
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                add     edx, ecx
                mov     ecx, 3Ch ; '<'
                mov     eax, edx
                mov     [esp+4+Time], eax
                cdq
                idiv    ecx
                test    edx, edx
                mov     [esi+4], edx
                jge     short loc_5C453A
                add     edx, ecx
                mov     [esi+4], edx
                mov     eax, dword ptr [esp+4+Time]
                sub     eax, ecx
                mov     [esp+4+Time], eax

loc_5C453A:                             ; CODE XREF: _localtime+F9↑j
                mov     ecx, dword ptr [esp+4+Time]
                mov     eax, 88888889h
                imul    ecx
                add     edx, ecx
                mov     ecx, dword ptr [esi+8]
                sar     edx, 5
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                add     edx, ecx
                mov     ecx, 18h
                mov     eax, edx
                mov     [esp+4+Time], eax
                cdq
                idiv    ecx
                test    edx, edx
                mov     [esi+8], edx
                jge     short loc_5C457A
                add     edx, ecx
                mov     [esi+8], edx
                mov     eax, dword ptr [esp+4+Time]
                sub     eax, ecx
                mov     [esp+4+Time], eax

loc_5C457A:                             ; CODE XREF: _localtime+139↑j
                mov     eax, 2AAAAAABh
                imul    [esp+4+Time]
                sar     edx, 2
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                mov     eax, edx
                test    eax, eax
                mov     [esp+4+Time], eax
                jle     short loc_5C45C3
                mov     ecx, dword ptr [esi+18h]
                add     eax, ecx
                mov     ecx, 7
                cdq
                idiv    ecx
                mov     eax, dword ptr [esi+0Ch]
                mov     ecx, dword ptr [esi+1Ch]
                mov     [esi+18h], edx
                mov     edx, dword ptr [esp+4+Time]
                add     eax, edx
                mov     [esi+0Ch], eax
                mov     eax, dword ptr [esp+4+Time]
                add     ecx, eax
                mov     eax, esi
                mov     [esi+1Ch], ecx
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C45C3:                             ; CODE XREF: _localtime+165↑j
                jge     short loc_5C4612
                mov     ecx, dword ptr [esi+18h]
                lea     eax, [eax+ecx+7]
                mov     ecx, 7
                cdq
                idiv    ecx
                mov     eax, dword ptr [esi+0Ch]
                mov     [esi+18h], edx
                mov     edx, dword ptr [esp+4+Time]
                add     eax, edx
                test    eax, eax
                mov     [esi+0Ch], eax
                jg      short loc_5C4606
                add     eax, 1Fh
                mov     dword ptr [esi+1Ch], 16Ch
                mov     [esi+0Ch], eax
                mov     eax, dword ptr [esi+14h]
                dec     eax
                mov     dword ptr [esi+10h], 0Bh
                mov     [esi+14h], eax
                mov     eax, esi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C4606:                             ; CODE XREF: _localtime+1B5↑j
                mov     eax, dword ptr [esp+4+Time]
                mov     ecx, dword ptr [esi+1Ch]
                add     ecx, eax
                mov     [esi+1Ch], ecx

loc_5C4612:                             ; CODE XREF: _localtime+43↑j
                mov     eax, esi
                pop     esi
                retn
_localtime      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _setmbcp(int CodePage)
__setmbcp       proc near               ; CODE XREF: ___initmbctable+2↓p

CPInfo          = _cpinfo ptr -14h
CodePage        = dword ptr  4

                sub     esp, 14h
                push    ebx
                push    ebp
                push    esi
                push    edi
                push    19h
                call    __lock
                mov     eax, dword ptr [esp+28h+CodePage]
                add     esp, 4
                push    eax
                call    _getSystemCP
                mov     ebp, eax
                mov     eax, dword_70D4BC
                add     esp, 4
                cmp     ebp, eax
                mov     [esp+24h+CodePage], ebp
                jnz     short loc_5C4661
                push    19h
                call    __unlock
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
; ---------------------------------------------------------------------------

loc_5C4661:                             ; CODE XREF: __setmbcp+2B↑j
                xor     esi, esi
                cmp     ebp, esi
                jz      loc_5C475D
                xor     edx, edx
                mov     eax, offset unk_63EF70

loc_5C4672:                             ; CODE XREF: __setmbcp+63↓j
                cmp     [eax], ebp
                jz      loc_5C478B
                add     eax, 30h ; '0'
                inc     edx
                cmp     eax, offset off_63F060
                jb      short loc_5C4672
                lea     ecx, [esp+24h+CPInfo]
                push    ecx             ; lpCPInfo
                push    ebp             ; CodePage
                call    GetCPInfo
                cmp     eax, 1
                jnz     loc_5C4755
                mov     ecx, 40h ; '@'
                xor     eax, eax
                mov     edi, offset __mbctype
                rep stosd
                stosb
                cmp     [esp+24h+CPInfo.MaxCharSize], 1
                jbe     short loc_5C4721
                mov     al, [esp+24h+CPInfo.LeadByte]
                test    al, al
                jz      short loc_5C46EF
                lea     edx, [esp+24h+CPInfo.LeadByte+1]

loc_5C46BC:                             ; CODE XREF: __setmbcp+CD↓j
                mov     cl, [edx]
                test    cl, cl
                jz      short loc_5C46EF
                xor     eax, eax
                and     ecx, 0FFh
                mov     al, [edx-1]
                cmp     eax, ecx
                ja      short loc_5C46E5

loc_5C46D1:                             ; CODE XREF: __setmbcp+C3↓j
                mov     bl, __mbctype+1h[eax]
                or      bl, 4
                mov     __mbctype+1h[eax], bl
                inc     eax
                cmp     eax, ecx
                jbe     short loc_5C46D1

loc_5C46E5:                             ; CODE XREF: __setmbcp+AF↑j
                mov     al, [edx+1]
                add     edx, 2
                test    al, al
                jnz     short loc_5C46BC

loc_5C46EF:                             ; CODE XREF: __setmbcp+96↑j
                mov     eax, 1

loc_5C46F4:                             ; CODE XREF: __setmbcp+E9↓j
                mov     bl, __mbctype+1h[eax]
                or      bl, 8
                mov     __mbctype+1h[eax], bl
                inc     eax
                cmp     eax, 0FFh
                jb      short loc_5C46F4
                push    ebp
                mov     dword_70D4BC, ebp
                call    _CPtoLCID
                add     esp, 4
                mov     [g_Locale], eax
                jmp     short loc_5C472D
; ---------------------------------------------------------------------------

loc_5C4721:                             ; CODE XREF: __setmbcp+8E↑j
                mov     dword_70D4BC, esi
                mov     [g_Locale], esi

loc_5C472D:                             ; CODE XREF: __setmbcp+FF↑j
                xor     edx, edx
                push    19h
                mov     dword_70D4C8, edx
                mov     dword_70D4CC, edx
                mov     dword_70D4D0, edx
                call    __unlock
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
; ---------------------------------------------------------------------------

loc_5C4755:                             ; CODE XREF: __setmbcp+74↑j
                cmp     dword_70D4D4, esi
                jz      short loc_5C4776

loc_5C475D:                             ; CODE XREF: __setmbcp+45↑j
                call    _setSBCS
                push    19h
                call    __unlock
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
; ---------------------------------------------------------------------------

loc_5C4776:                             ; CODE XREF: __setmbcp+13B↑j
                push    19h
                call    __unlock
                add     esp, 4
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
; ---------------------------------------------------------------------------

loc_5C478B:                             ; CODE XREF: __setmbcp+54↑j
                mov     ecx, 40h ; '@'
                xor     eax, eax
                mov     edi, offset __mbctype
                lea     ebx, [edx+edx*2]
                rep stosd
                stosb
                xor     edi, edi
                shl     ebx, 4
                lea     ebp, unk_63EF80[ebx]

loc_5C47A8:                             ; CODE XREF: __setmbcp+1C8↓j
                mov     al, [ebp+0]
                mov     esi, ebp
                test    al, al
                jz      short loc_5C47E1

loc_5C47B1:                             ; CODE XREF: __setmbcp+1BF↓j
                mov     cl, [esi+1]
                test    cl, cl
                jz      short loc_5C47E1
                xor     eax, eax
                and     ecx, 0FFh
                mov     al, [esi]
                cmp     eax, ecx
                ja      short loc_5C47D7
                mov     dl, byte_63EF68[edi]

loc_5C47CC:                             ; CODE XREF: __setmbcp+1B5↓j
                or      __mbctype+1h[eax], dl
                inc     eax
                cmp     eax, ecx
                jbe     short loc_5C47CC

loc_5C47D7:                             ; CODE XREF: __setmbcp+1A4↑j
                mov     al, [esi+2]
                add     esi, 2
                test    al, al
                jnz     short loc_5C47B1

loc_5C47E1:                             ; CODE XREF: __setmbcp+18F↑j
                inc     edi
                add     ebp, 8
                cmp     edi, 4
                jb      short loc_5C47A8
                mov     eax, dword ptr [esp+24h+CodePage]
                push    eax
                mov     dword_70D4BC, eax
                call    _CPtoLCID
                mov     ecx, dword_63EF74[ebx]
                mov     edx, dword_63EF78[ebx]
                mov     [g_Locale], eax
                lea     eax, dword_63EF74[ebx]
                add     esp, 4
                mov     dword_70D4C8, ecx
                mov     eax, dword ptr [eax+8]
                mov     dword_70D4CC, edx
                push    19h
                mov     dword_70D4D0, eax
                call    __unlock
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
__setmbcp       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_getSystemCP    proc near               ; CODE XREF: __setmbcp+16↑p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                mov     dword_70D4D4, 0
                cmp     eax, 0FFFFFFFEh
                jnz     short loc_5C4863
                mov     dword_70D4D4, 1
                jmp     ds:GetOEMCP
; ---------------------------------------------------------------------------

loc_5C4863:                             ; CODE XREF: _getSystemCP+11↑j
                cmp     eax, 0FFFFFFFDh
                jnz     short loc_5C4878
                mov     dword_70D4D4, 1
                jmp     ds:GetACP
; ---------------------------------------------------------------------------

loc_5C4878:                             ; CODE XREF: _getSystemCP+26↑j
                cmp     eax, 0FFFFFFFCh
                jnz     short locret_5C488C
                mov     eax, CodePage
                mov     dword_70D4D4, 1

locret_5C488C:                          ; CODE XREF: _getSystemCP+3B↑j
                retn
_getSystemCP    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_CPtoLCID       proc near               ; CODE XREF: __setmbcp+F2↑p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                add     eax, 0FFFFFC5Ch ; switch 19 cases
                cmp     eax, 12h
                ja      short def_5C48A6 ; jumptable 005C48A6 default case, cases 933-935,937-948
                xor     ecx, ecx
                mov     cl, ds:byte_5C48DC[eax]
                jmp     ds:jpt_5C48A6[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5C48AD:                             ; CODE XREF: _CPtoLCID+16↑j
                mov     eax, 411h       ; jumptable 005C48A6 case 932
                retn
; ---------------------------------------------------------------------------

loc_5C48B3:                             ; CODE XREF: _CPtoLCID+16↑j
                mov     eax, 804h       ; jumptable 005C48A6 case 936
                retn
; ---------------------------------------------------------------------------

loc_5C48B9:                             ; CODE XREF: _CPtoLCID+16↑j
                mov     eax, 412h       ; jumptable 005C48A6 case 949
                retn
; ---------------------------------------------------------------------------

loc_5C48BF:                             ; CODE XREF: _CPtoLCID+16↑j
                mov     eax, 404h       ; jumptable 005C48A6 case 950
                retn
; ---------------------------------------------------------------------------

def_5C48A6:                             ; CODE XREF: _CPtoLCID+C↑j
                xor     eax, eax        ; jumptable 005C48A6 default case, cases 933-935,937-948
                retn
_CPtoLCID       endp

; ---------------------------------------------------------------------------
jpt_5C48A6      dd offset loc_5C48AD    ; DATA XREF: _CPtoLCID+16↑r
                dd offset loc_5C48B3    ; jump table for switch statement
                dd offset loc_5C48B9
                dd offset loc_5C48BF
                dd offset def_5C48A6
byte_5C48DC     db      0,     4,     4,     4
                db      1,     4,     4,     4 ; indirect table for switch statement
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     2,     3
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_setSBCS        proc near               ; CODE XREF: __setmbcp:loc_5C475D↑p
                push    edi
                mov     ecx, 40h ; '@'
                xor     eax, eax
                mov     edi, offset __mbctype
                rep stosd
                stosb
                xor     eax, eax
                pop     edi
                mov     dword_70D4BC, eax
                mov     [g_Locale], eax
                mov     dword_70D4C8, eax
                mov     dword_70D4CC, eax
                mov     dword_70D4D0, eax
                retn
_setSBCS        endp

; ---------------------------------------------------------------------------
                align 10h
                mov     eax, dword_70D4BC
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___initmbctable proc near               ; CODE XREF: start+89↑p
                push    0FFFFFFFDh      ; CodePage
                call    __setmbcp
                add     esp, 4
                retn
___initmbctable endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl _Getdays()
__Getdays       proc near

var_8           = dword ptr -8
var_4           = dword ptr -4

                sub     esp, 8
                mov     edx, off_63F10C
                push    ebx
                push    ebp
                push    esi
                push    edi
                mov     [esp+18h+var_8], edx
                xor     esi, esi
                mov     ebp, 7

loc_5C4958:                             ; CODE XREF: __Getdays+3C↓j
                mov     edi, [edx+1Ch]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                add     edx, 4
                repne scasb
                mov     edi, [edx-4]
                not     ecx
                dec     ecx
                mov     ebx, ecx
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                add     ecx, esi
                dec     ebp
                lea     esi, [ecx+ebx+2]
                jnz     short loc_5C4958
                inc     esi
                push    esi             ; varSize
                call    _malloc
                add     esp, 4
                mov     [esp+18h+var_4], eax
                test    eax, eax
                jz      loc_5C4A1C
                mov     ebx, dword ptr [esp+18h+var_8]
                mov     edx, eax
                mov     [esp+18h+var_8], 7

loc_5C49A2:                             ; CODE XREF: __Getdays+D3↓j
                mov     byte ptr [edx], 3Ah ; ':'
                mov     edi, [ebx]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                inc     edx
                add     ebx, 4
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     eax, ecx
                mov     edi, edx
                mov     ebp, edi
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                add     edx, ecx
                or      ecx, 0FFFFFFFFh
                mov     byte ptr [edx], 3Ah ; ':'
                mov     edi, [ebx+18h]
                inc     edx
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     eax, ecx
                mov     edi, edx
                mov     ebp, edi
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     eax, dword ptr [esp+18h+var_8]
                not     ecx
                dec     ecx
                add     edx, ecx
                dec     eax
                mov     [esp+18h+var_8], eax
                jnz     short loc_5C49A2
                mov     eax, dword ptr [esp+18h+var_4]
                mov     byte ptr [edx], 0

loc_5C4A1C:                             ; CODE XREF: __Getdays+4E↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
__Getdays       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl _Getmonths()
__Getmonths     proc near

var_8           = dword ptr -8
var_4           = dword ptr -4

                sub     esp, 8
                mov     edx, off_63F10C
                push    ebx
                push    ebp
                push    esi
                mov     [esp+14h+var_8], edx
                xor     esi, esi
                push    edi
                add     edx, 38h ; '8'
                mov     ebp, 0Ch

loc_5C4A4B:                             ; CODE XREF: __Getmonths+3E↓j
                mov     edi, [edx]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                add     edx, 4
                repne scasb
                mov     edi, [edx+2Ch]
                not     ecx
                dec     ecx
                mov     ebx, ecx
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                add     ecx, esi
                dec     ebp
                lea     esi, [ecx+ebx+2]
                jnz     short loc_5C4A4B
                inc     esi
                push    esi             ; varSize
                call    _malloc
                add     esp, 4
                mov     [esp+18h+var_4], eax
                test    eax, eax
                jz      loc_5C4B12
                mov     edx, eax
                mov     eax, dword ptr [esp+18h+var_8]
                mov     [esp+18h+var_8], 0Ch
                lea     ebx, [eax+68h]

loc_5C4A97:                             ; CODE XREF: __Getmonths+D9↓j
                mov     byte ptr [edx], 3Ah ; ':'
                mov     edi, [ebx-30h]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                inc     edx
                add     ebx, 4
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     eax, ecx
                mov     edi, edx
                mov     ebp, edi
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                add     edx, ecx
                or      ecx, 0FFFFFFFFh
                mov     byte ptr [edx], 3Ah ; ':'
                mov     edi, [ebx-4]
                inc     edx
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     eax, ecx
                mov     edi, edx
                mov     ebp, edi
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     eax, dword ptr [esp+18h+var_8]
                not     ecx
                dec     ecx
                add     edx, ecx
                dec     eax
                mov     [esp+18h+var_8], eax
                jnz     short loc_5C4A97
                mov     eax, dword ptr [esp+18h+var_4]
                mov     byte ptr [edx], 0

loc_5C4B12:                             ; CODE XREF: __Getmonths+50↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
__Getmonths     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void *__cdecl _Gettnames()
__Gettnames     proc near

var_14          = dword ptr -14h
var_10          = dword ptr -10h
var_C           = dword ptr -0Ch
var_8           = dword ptr -8
var_4           = dword ptr -4

                sub     esp, 14h
                push    ebx
                mov     ebx, off_63F10C
                push    ebp
                push    esi
                push    edi
                mov     [esp+24h+var_14], ebx
                xor     edx, edx
                mov     esi, ebx
                mov     [esp+24h+var_10], 7

loc_5C4B3D:                             ; CODE XREF: __Gettnames+48↓j
                mov     edi, [esi]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                add     esi, 4
                repne scasb
                mov     edi, [esi+18h]
                not     ecx
                dec     ecx
                mov     ebp, ecx
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     eax, dword ptr [esp+24h+var_10]
                not     ecx
                dec     ecx
                add     ecx, edx
                dec     eax
                mov     [esp+24h+var_10], eax
                lea     edx, [ecx+ebp+2]
                jnz     short loc_5C4B3D
                lea     esi, [ebx+38h]
                mov     [esp+24h+var_10], 0Ch

loc_5C4B75:                             ; CODE XREF: __Gettnames+81↓j
                mov     edi, [esi+30h]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                add     esi, 4
                repne scasb
                mov     edi, [esi-4]
                not     ecx
                dec     ecx
                mov     ebp, ecx
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     eax, dword ptr [esp+24h+var_10]
                not     ecx
                dec     ecx
                add     ecx, edx
                dec     eax
                mov     [esp+24h+var_10], eax
                lea     edx, [ecx+ebp+2]
                jnz     short loc_5C4B75
                mov     edi, [ebx+9Ch]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                mov     edi, [ebx+98h]
                not     ecx
                dec     ecx
                mov     esi, ecx
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                mov     edi, [ebx+0A0h]
                dec     ecx
                add     ecx, edx
                lea     edx, [ecx+esi+2]
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     edi, [ebx+0A4h]
                not     ecx
                dec     ecx
                lea     edx, [edx+ecx+1]
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     edi, [ebx+0A8h]
                not     ecx
                dec     ecx
                lea     edx, [edx+ecx+1]
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                lea     eax, [edx+ecx+1]
                add     eax, 0ACh
                push    eax             ; varSize
                call    _malloc
                mov     ebp, eax
                add     esp, 4
                test    ebp, ebp
                mov     [esp+24h+var_4], ebp
                jz      loc_5C4E78
                mov     esi, off_63F10C
                mov     ecx, 2Bh ; '+'
                mov     edi, ebp
                add     ebx, 1Ch
                rep movsd
                mov     ecx, dword ptr [esp+24h+var_14]
                lea     edx, [ebp+0ACh]
                sub     eax, ecx
                mov     [esp+24h+var_10], ebp
                mov     [esp+24h+var_8], eax
                mov     [esp+24h+var_C], 7

loc_5C4C49:                             ; CODE XREF: __Gettnames+1AD↓j
                mov     [ebp+0], edx
                mov     edi, [ebx-1Ch]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                add     ebx, 4
                mov     esi, edi
                mov     eax, ecx
                mov     edi, edx
                mov     ebp, edi
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                lea     edx, [edx+ecx+1]
                mov     ecx, dword ptr [esp+24h+var_8]
                mov     [ecx+ebx-4], edx
                mov     edi, [ebx-4]
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     eax, ecx
                mov     edi, edx
                mov     ebp, edi
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     ebp, [esp+24h+var_10]
                mov     eax, dword ptr [esp+24h+var_C]
                not     ecx
                dec     ecx
                add     ebp, 4
                dec     eax
                mov     [esp+24h+var_10], ebp
                lea     edx, [edx+ecx+1]
                mov     [esp+24h+var_C], eax
                jnz     loc_5C4C49
                mov     ecx, dword ptr [esp+24h+var_4]
                mov     eax, dword ptr [esp+24h+var_14]
                add     ecx, 68h ; 'h'
                mov     [esp+24h+var_C], 0Ch
                mov     [esp+24h+var_10], ecx
                lea     ebx, [eax+38h]

loc_5C4CED:                             ; CODE XREF: __Gettnames+252↓j
                mov     ecx, dword ptr [esp+24h+var_8]
                xor     eax, eax
                mov     [ebx+ecx], edx
                mov     edi, [ebx]
                or      ecx, 0FFFFFFFFh
                add     ebx, 4
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     eax, ecx
                mov     edi, edx
                mov     ebp, edi
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                lea     edx, [edx+ecx+1]
                mov     ecx, dword ptr [esp+24h+var_10]
                mov     [ecx], edx
                mov     edi, [ebx+2Ch]
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     eax, ecx
                mov     edi, edx
                mov     ebp, edi
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     eax, dword ptr [esp+24h+var_C]
                not     ecx
                dec     ecx
                lea     edx, [edx+ecx+1]
                mov     ecx, dword ptr [esp+24h+var_10]
                add     ecx, 4
                dec     eax
                mov     [esp+24h+var_10], ecx
                mov     [esp+24h+var_C], eax
                jnz     loc_5C4CED
                mov     ebp, [esp+24h+var_4]
                mov     ecx, dword ptr [esp+24h+var_14]
                xor     eax, eax
                mov     [ebp+98h], edx
                mov     edi, [ecx+98h]
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     eax, ecx
                mov     edi, edx
                shr     ecx, 2
                mov     ebx, edi
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                or      ecx, 0FFFFFFFFh
                mov     edi, ebx
                repne scasb
                not     ecx
                dec     ecx
                lea     edx, [edx+ecx+1]
                mov     ecx, dword ptr [esp+24h+var_14]
                mov     [ebp+9Ch], edx
                mov     edi, [ecx+9Ch]
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     eax, ecx
                mov     edi, edx
                mov     ebx, edi
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                mov     edi, ebx
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                lea     edx, [edx+ecx+1]
                mov     ecx, dword ptr [esp+24h+var_14]
                mov     [ebp+0A0h], edx
                mov     edi, [ecx+0A0h]
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     eax, ecx
                mov     edi, edx
                mov     ebx, edi
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                mov     edi, ebx
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                lea     edx, [edx+ecx+1]
                mov     ecx, dword ptr [esp+24h+var_14]
                mov     [ebp+0A4h], edx
                mov     edi, [ecx+0A4h]
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     eax, ecx
                mov     edi, edx
                mov     ebx, edi
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                mov     edi, ebx
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                lea     edx, [edx+ecx+1]
                mov     [ebp+0A8h], edx

loc_5C4E78:                             ; CODE XREF: __Gettnames+F5↑j
                pop     edi
                mov     eax, ebp
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
__Gettnames     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; size_t __cdecl strftime(char *Buffer, size_t SizeInBytes, const char *Format, const struct tm *Tm)
_strftime       proc near               ; CODE XREF: CTime::Format(char const *)+28↓p

Buffer          = dword ptr  4
SizeInBytes     = dword ptr  8
Format          = dword ptr  0Ch
Tm              = dword ptr  10h

                mov     eax, dword ptr [esp+Tm]
                mov     ecx, dword ptr [esp+Format]
                mov     edx, dword ptr [esp+SizeInBytes]
                push    0               ; Lc_time_arg
                push    eax             ; Timeptr
                mov     eax, dword ptr [esp+8+Buffer]
                push    ecx             ; Format
                push    edx             ; Max_size
                push    eax             ; Buffer
                call    __Strftime
                add     esp, 14h
                retn
_strftime       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; size_t __cdecl _Strftime(char *Buffer, size_t Max_size, const char *Format, const struct tm *Timeptr, void *Lc_time_arg)
__Strftime      proc near               ; CODE XREF: _strftime+16↑p

var_4           = dword ptr -4
Buffer          = dword ptr  4
Max_size        = dword ptr  8
Format          = dword ptr  0Ch
Timeptr         = dword ptr  10h
Lc_time_arg     = dword ptr  14h

                push    ecx
                mov     eax, dword ptr [esp+4+Lc_time_arg]
                push    ebx
                xor     ebx, ebx
                push    ebp
                mov     ebp, off_63F10C
                push    esi
                cmp     eax, ebx
                push    edi
                jz      short loc_5C4EC7
                mov     ebp, eax

loc_5C4EC7:                             ; CODE XREF: __Strftime+13↑j
                mov     eax, dword ptr [esp+14h+Max_size]
                push    offset Addend   ; lpAddend
                mov     [esp+18h+Lc_time_arg], eax
                call    InterlockedIncrement
                cmp     dword_70E964, ebx
                jz      short loc_5C4F01
                push    offset Addend   ; lpAddend
                call    InterlockedDecrement
                push    13h
                call    __lock
                add     esp, 4
                mov     [esp+14h+var_4], 1
                jmp     short loc_5C4F05
; ---------------------------------------------------------------------------

loc_5C4F01:                             ; CODE XREF: __Strftime+30↑j
                mov     [esp+14h+var_4], ebx

loc_5C4F05:                             ; CODE XREF: __Strftime+4F↑j
                cmp     [esp+14h+Lc_time_arg], ebx
                jbe     loc_5C4FB0
                mov     edi, [esp+14h+Timeptr]
                mov     esi, [esp+14h+Format]

loc_5C4F17:                             ; CODE XREF: __Strftime+FA↓j
                mov     al, [esi]
                cmp     al, bl
                jz      loc_5C4FB0
                cmp     al, 25h ; '%'
                jz      short loc_5C4F77
                mov     edx, off_641268
                mov     ecx, eax
                and     ecx, 0FFh
                test    byte ptr [edx+ecx*2+1], 80h
                jz      short loc_5C4F5A
                cmp     [esp+14h+Lc_time_arg], 1
                jbe     short loc_5C4F5A
                mov     ecx, dword ptr [esp+14h+Buffer]
                mov     [ecx], al
                mov     edx, dword ptr [esp+14h+Buffer]
                mov     eax, dword ptr [esp+14h+Lc_time_arg]
                inc     edx
                inc     esi
                dec     eax
                mov     [esp+14h+Buffer], edx
                mov     [esp+14h+Lc_time_arg], eax

loc_5C4F5A:                             ; CODE XREF: __Strftime+88↑j
                mov     eax, dword ptr [esp+14h+Buffer]
                mov     dl, [esi]
                mov     [eax], dl
                mov     edx, dword ptr [esp+14h+Buffer]
                mov     eax, dword ptr [esp+14h+Lc_time_arg]
                inc     edx
                inc     esi
                dec     eax
                mov     [esp+14h+Buffer], edx
                mov     [esp+14h+Lc_time_arg], eax
                jmp     short loc_5C4FA6
; ---------------------------------------------------------------------------

loc_5C4F77:                             ; CODE XREF: __Strftime+73↑j
                inc     esi
                mov     dword_70D4D8, ebx
                cmp     byte ptr [esi], 23h ; '#'
                jnz     short loc_5C4F8E
                mov     dword_70D4D8, 1
                inc     esi

loc_5C4F8E:                             ; CODE XREF: __Strftime+D1↑j
                mov     al, [esi]
                lea     ecx, [esp+14h+Lc_time_arg]
                push    ebp
                lea     edx, [esp+18h+Buffer]
                push    ecx
                push    edx
                push    edi
                push    eax
                call    __expandtime
                add     esp, 14h
                inc     esi

loc_5C4FA6:                             ; CODE XREF: __Strftime+C5↑j
                cmp     [esp+14h+Lc_time_arg], ebx
                ja      loc_5C4F17

loc_5C4FB0:                             ; CODE XREF: __Strftime+59↑j
                cmp     [esp+14h+var_4], ebx
                jz      short loc_5C4FC2
                push    13h
                call    __unlock
                add     esp, 4
                jmp     short loc_5C4FCD
; ---------------------------------------------------------------------------

loc_5C4FC2:                             ; CODE XREF: __Strftime+104↑j
                push    offset Addend   ; lpAddend
                call    InterlockedDecrement

loc_5C4FCD:                             ; CODE XREF: __Strftime+110↑j
                cmp     [esp+14h+Lc_time_arg], ebx
                jbe     short loc_5C4FE9
                mov     ecx, dword ptr [esp+14h+Buffer]
                mov     eax, dword ptr [esp+14h+Max_size]
                mov     [ecx], bl
                mov     ecx, dword ptr [esp+14h+Lc_time_arg]
                sub     eax, ecx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C4FE9:                             ; CODE XREF: __Strftime+121↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                pop     ecx
                retn
__Strftime      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__expandtime    proc near               ; CODE XREF: __Strftime+ED↑p

arg_0           = byte ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h

                movsx   eax, [esp+arg_0]
                push    ebx
                add     eax, 0FFFFFFDBh ; switch 86 cases
                push    ebp
                push    esi
                cmp     eax, 55h
                push    edi
                ja      def_5C501D      ; jumptable 005C501D default case, cases 38-64,67-71,74-76,78-82,84,86,91-96,101-105,107,108,110,111,113-118
                xor     ecx, ecx
                mov     cl, ds:byte_5C5548[eax]
                jmp     ds:jpt_5C501D[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5C5024:                             ; CODE XREF: __expandtime+1D↑j
                mov     edx, dword ptr [esp+10h+arg_C] ; jumptable 005C501D case 97
                mov     eax, dword ptr [esp+10h+arg_8]
                mov     ecx, dword ptr [esp+10h+arg_4]
                push    edx
                push    eax
                mov     eax, dword ptr [esp+18h+arg_10]
                mov     edx, dword ptr [ecx+18h]
                mov     ecx, dword ptr [eax+edx*4]
                push    ecx
                call    __store_str
                add     esp, 0Ch
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C504A:                             ; CODE XREF: __expandtime+1D↑j
                mov     edx, dword ptr [esp+10h+arg_C] ; jumptable 005C501D case 65
                mov     eax, dword ptr [esp+10h+arg_8]
                mov     ecx, dword ptr [esp+10h+arg_4]
                push    edx
                push    eax
                mov     eax, dword ptr [esp+18h+arg_10]
                mov     edx, dword ptr [ecx+18h]
                mov     ecx, dword ptr [eax+edx*4+1Ch]
                push    ecx
                call    __store_str
                add     esp, 0Ch
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5071:                             ; CODE XREF: __expandtime+1D↑j
                mov     edx, dword ptr [esp+10h+arg_C] ; jumptable 005C501D case 98
                mov     eax, dword ptr [esp+10h+arg_8]
                mov     ecx, dword ptr [esp+10h+arg_4]
                push    edx
                push    eax
                mov     eax, dword ptr [esp+18h+arg_10]
                mov     edx, dword ptr [ecx+10h]
                mov     ecx, dword ptr [eax+edx*4+38h]
                push    ecx
                call    __store_str
                add     esp, 0Ch
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5098:                             ; CODE XREF: __expandtime+1D↑j
                mov     edx, dword ptr [esp+10h+arg_C] ; jumptable 005C501D case 66
                mov     eax, dword ptr [esp+10h+arg_8]
                mov     ecx, dword ptr [esp+10h+arg_4]
                push    edx
                push    eax
                mov     eax, dword ptr [esp+18h+arg_10]
                mov     edx, dword ptr [ecx+10h]
                mov     ecx, dword ptr [eax+edx*4+68h]
                push    ecx
                call    __store_str
                add     esp, 0Ch
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C50BF:                             ; CODE XREF: __expandtime+1D↑j
                mov     eax, dword_70D4D8 ; jumptable 005C501D case 99
                test    eax, eax
                jz      short loc_5C50EE
                mov     ebx, dword ptr [esp+10h+arg_10]
                mov     esi, [esp+10h+arg_C]
                mov     edi, [esp+10h+arg_8]
                mov     ebp, [esp+10h+arg_4]
                push    ebx
                push    esi
                mov     dword_70D4D8, 0
                mov     edx, dword ptr [ebx+0A4h]
                push    edi
                push    ebp
                jmp     short loc_5C5108
; ---------------------------------------------------------------------------

loc_5C50EE:                             ; CODE XREF: __expandtime+C6↑j
                mov     ebx, dword ptr [esp+10h+arg_10]
                mov     esi, [esp+10h+arg_C]
                mov     edi, [esp+10h+arg_8]
                mov     ebp, [esp+10h+arg_4]
                mov     edx, dword ptr [ebx+0A0h]
                push    ebx             ; int
                push    esi             ; int
                push    edi             ; int
                push    ebp             ; int

loc_5C5108:                             ; CODE XREF: __expandtime+EC↑j
                push    edx             ; String1
                call    __store_winword
                mov     eax, dword ptr [esi]
                add     esp, 14h
                test    eax, eax
                jz      def_5C501D      ; jumptable 005C501D default case, cases 38-64,67-71,74-76,78-82,84,86,91-96,101-105,107,108,110,111,113-118
                mov     eax, dword ptr [edi]
                push    ebx             ; int
                push    esi             ; int
                push    edi             ; int
                mov     byte ptr [eax], 20h ; ' '
                mov     ecx, dword ptr [edi]
                inc     ecx
                push    ebp             ; int
                mov     [edi], ecx
                mov     eax, dword ptr [esi]
                dec     eax
                mov     [esi], eax
                mov     ecx, dword ptr [ebx+0A8h]
                push    ecx             ; String1
                call    __store_winword
                add     esp, 14h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5142:                             ; CODE XREF: __expandtime+1D↑j
                mov     edx, dword_70D4D8 ; jumptable 005C501D case 100
                mov     eax, dword ptr [esp+10h+arg_C]
                mov     ecx, dword ptr [esp+10h+arg_8]
                mov     dword_70D4DC, edx
                mov     edx, dword ptr [esp+10h+arg_4]
                push    eax
                push    ecx
                push    2
                mov     eax, dword ptr [edx+0Ch]
                push    eax
                call    __store_num
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C516F:                             ; CODE XREF: __expandtime+1D↑j
                mov     ecx, dword_70D4D8 ; jumptable 005C501D case 72
                mov     edx, dword ptr [esp+10h+arg_C]
                mov     eax, dword ptr [esp+10h+arg_8]
                mov     dword_70D4DC, ecx
                mov     ecx, dword ptr [esp+10h+arg_4]
                push    edx
                push    eax
                push    2
                mov     edx, dword ptr [ecx+8]
                push    edx
                call    __store_num
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C519C:                             ; CODE XREF: __expandtime+1D↑j
                mov     eax, dword_70D4D8 ; jumptable 005C501D case 73
                mov     ecx, dword ptr [esp+10h+arg_4]
                mov     dword_70D4DC, eax
                mov     eax, dword ptr [ecx+8]
                mov     ecx, 0Ch
                cdq
                idiv    ecx
                test    edx, edx
                jnz     short loc_5C51BB
                mov     edx, ecx

loc_5C51BB:                             ; CODE XREF: __expandtime+1B7↑j
                mov     eax, dword ptr [esp+10h+arg_C]
                mov     ecx, dword ptr [esp+10h+arg_8]
                push    eax
                push    ecx
                push    2
                push    edx
                call    __store_num
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C51D5:                             ; CODE XREF: __expandtime+1D↑j
                mov     edx, dword_70D4D8 ; jumptable 005C501D case 106
                mov     eax, dword ptr [esp+10h+arg_C]
                mov     ecx, dword ptr [esp+10h+arg_8]
                mov     dword_70D4DC, edx
                mov     edx, dword ptr [esp+10h+arg_4]
                push    eax
                push    ecx
                push    3
                mov     eax, dword ptr [edx+1Ch]
                inc     eax
                push    eax
                call    __store_num
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5203:                             ; CODE XREF: __expandtime+1D↑j
                mov     ecx, dword_70D4D8 ; jumptable 005C501D case 109
                mov     edx, dword ptr [esp+10h+arg_C]
                mov     eax, dword ptr [esp+10h+arg_8]
                mov     dword_70D4DC, ecx
                mov     ecx, dword ptr [esp+10h+arg_4]
                push    edx
                push    eax
                push    2
                mov     edx, dword ptr [ecx+10h]
                inc     edx
                push    edx
                call    __store_num
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5231:                             ; CODE XREF: __expandtime+1D↑j
                mov     eax, dword_70D4D8 ; jumptable 005C501D case 77
                mov     ecx, dword ptr [esp+10h+arg_C]
                mov     edx, dword ptr [esp+10h+arg_8]
                mov     dword_70D4DC, eax
                mov     eax, dword ptr [esp+10h+arg_4]
                push    ecx
                push    edx
                push    2
                mov     ecx, dword ptr [eax+4]
                push    ecx
                call    __store_num
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C525C:                             ; CODE XREF: __expandtime+1D↑j
                mov     edx, dword ptr [esp+10h+arg_4] ; jumptable 005C501D case 112
                cmp     dword ptr [edx+8], 0Bh
                jg      short loc_5C5288
                mov     eax, dword ptr [esp+10h+arg_C]
                mov     edx, dword ptr [esp+10h+arg_10]
                mov     ecx, dword ptr [esp+10h+arg_8]
                push    eax
                mov     eax, dword ptr [edx+98h]
                push    ecx
                push    eax
                call    __store_str
                add     esp, 0Ch
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5288:                             ; CODE XREF: __expandtime+264↑j
                mov     ecx, dword ptr [esp+10h+arg_C]
                mov     eax, dword ptr [esp+10h+arg_10]
                mov     edx, dword ptr [esp+10h+arg_8]
                push    ecx
                mov     ecx, dword ptr [eax+9Ch]
                push    edx
                push    ecx
                call    __store_str
                add     esp, 0Ch
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C52AA:                             ; CODE XREF: __expandtime+1D↑j
                mov     edx, dword_70D4D8 ; jumptable 005C501D case 83
                mov     eax, dword ptr [esp+10h+arg_C]
                mov     ecx, dword ptr [esp+10h+arg_8]
                mov     dword_70D4DC, edx
                mov     edx, dword ptr [esp+10h+arg_4]
                push    eax
                push    ecx
                push    2
                mov     eax, dword ptr [edx]
                push    eax
                call    __store_num
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C52D6:                             ; CODE XREF: __expandtime+1D↑j
                mov     ecx, dword_70D4D8 ; jumptable 005C501D case 85
                mov     eax, dword ptr [esp+10h+arg_4]
                mov     dword_70D4DC, ecx
                mov     esi, [eax+18h]
                jmp     short loc_5C5337
; ---------------------------------------------------------------------------

loc_5C52EB:                             ; CODE XREF: __expandtime+1D↑j
                mov     edx, dword_70D4D8 ; jumptable 005C501D case 119
                mov     eax, dword ptr [esp+10h+arg_C]
                mov     ecx, dword ptr [esp+10h+arg_8]
                mov     dword_70D4DC, edx
                mov     edx, dword ptr [esp+10h+arg_4]
                push    eax
                push    ecx
                push    1
                mov     eax, dword ptr [edx+18h]
                push    eax
                call    __store_num
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5318:                             ; CODE XREF: __expandtime+1D↑j
                mov     ecx, dword_70D4D8 ; jumptable 005C501D case 87
                mov     eax, dword ptr [esp+10h+arg_4]
                mov     dword_70D4DC, ecx
                mov     esi, [eax+18h]
                test    esi, esi
                jnz     short loc_5C5336
                mov     esi, 6
                jmp     short loc_5C5337
; ---------------------------------------------------------------------------

loc_5C5336:                             ; CODE XREF: __expandtime+32D↑j
                dec     esi

loc_5C5337:                             ; CODE XREF: __expandtime+2E9↑j
                mov     ecx, dword ptr [eax+1Ch]
                cmp     ecx, esi
                jge     short loc_5C5342
                xor     edi, edi
                jmp     short loc_5C5366
; ---------------------------------------------------------------------------

loc_5C5342:                             ; CODE XREF: __expandtime+33C↑j
                mov     eax, 92492493h
                imul    ecx
                add     edx, ecx
                sar     edx, 2
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                mov     eax, ecx
                mov     edi, edx
                mov     ecx, 7
                cdq
                idiv    ecx
                cmp     edx, esi
                jl      short loc_5C5366
                inc     edi

loc_5C5366:                             ; CODE XREF: __expandtime+340↑j
                mov     edx, dword ptr [esp+10h+arg_C]
                mov     eax, dword ptr [esp+10h+arg_8]
                push    edx
                push    eax
                push    2
                push    edi
                call    __store_num
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5380:                             ; CODE XREF: __expandtime+1D↑j
                mov     eax, dword_70D4D8 ; jumptable 005C501D case 120
                test    eax, eax
                jz      short loc_5C53BB
                mov     eax, dword ptr [esp+10h+arg_10]
                mov     ecx, dword ptr [esp+10h+arg_C]
                mov     edx, dword ptr [esp+10h+arg_8]
                push    eax             ; int
                push    ecx             ; int
                mov     ecx, dword ptr [esp+18h+arg_4]
                mov     dword_70D4D8, 0
                push    edx             ; int
                mov     edx, dword ptr [eax+0A4h]
                push    ecx             ; int
                push    edx             ; String1
                call    __store_winword
                add     esp, 14h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C53BB:                             ; CODE XREF: __expandtime+387↑j
                mov     eax, dword ptr [esp+10h+arg_10]
                mov     ecx, dword ptr [esp+10h+arg_C]
                mov     edx, dword ptr [esp+10h+arg_8]
                push    eax             ; int
                push    ecx             ; int
                mov     ecx, dword ptr [esp+18h+arg_4]
                push    edx             ; int
                mov     edx, dword ptr [eax+0A0h]
                push    ecx             ; int
                push    edx             ; String1
                call    __store_winword
                add     esp, 14h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C53E3:                             ; CODE XREF: __expandtime+1D↑j
                mov     eax, dword ptr [esp+10h+arg_10] ; jumptable 005C501D case 88
                mov     ecx, dword ptr [esp+10h+arg_C]
                mov     edx, dword ptr [esp+10h+arg_8]
                push    eax             ; int
                push    ecx             ; int
                mov     ecx, dword ptr [esp+18h+arg_4]
                mov     dword_70D4D8, 0
                push    edx             ; int
                mov     edx, dword ptr [eax+0A8h]
                push    ecx             ; int
                push    edx             ; String1
                call    __store_winword
                add     esp, 14h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5415:                             ; CODE XREF: __expandtime+1D↑j
                mov     eax, dword_70D4D8 ; jumptable 005C501D case 121
                mov     ecx, dword ptr [esp+10h+arg_C]
                mov     edx, dword ptr [esp+10h+arg_8]
                mov     dword_70D4DC, eax
                mov     eax, dword ptr [esp+10h+arg_4]
                push    ecx
                push    edx
                mov     ecx, 64h ; 'd'
                mov     eax, dword ptr [eax+14h]
                push    2
                cdq
                idiv    ecx
                push    edx
                call    __store_num
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5448:                             ; CODE XREF: __expandtime+1D↑j
                mov     edx, dword_70D4D8 ; jumptable 005C501D case 89
                mov     eax, dword ptr [esp+10h+arg_4]
                mov     dword_70D4DC, edx
                mov     edx, dword ptr [esp+10h+arg_C]
                mov     ecx, dword ptr [eax+14h]
                mov     eax, dword ptr [esp+10h+arg_8]
                push    edx
                push    eax
                mov     eax, 51EB851Fh
                push    4
                imul    ecx
                sar     edx, 5
                mov     eax, edx
                shr     eax, 1Fh
                lea     eax, [edx+eax+13h]
                lea     eax, [eax+eax*4]
                lea     esi, [eax+eax*4]
                mov     eax, ecx
                cdq
                mov     ecx, 64h ; 'd'
                idiv    ecx
                lea     edx, [edx+esi*4]
                push    edx
                call    __store_num
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C549B:                             ; CODE XREF: __expandtime+1D↑j
                call    ___tzset        ; jumptable 005C501D cases 90,122
                mov     eax, dword ptr [esp+10h+arg_C]
                mov     ecx, dword ptr [esp+10h+arg_8]
                push    eax
                mov     eax, dword ptr [esp+14h+arg_4]
                xor     edx, edx
                push    ecx
                mov     esi, [eax+20h]
                test    esi, esi
                setnz   dl
                mov     ecx, g_Dest[edx*4]
                push    ecx
                call    __store_str
                add     esp, 0Ch
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C54CD:                             ; CODE XREF: __expandtime+1D↑j
                mov     eax, dword ptr [esp+10h+arg_8] ; jumptable 005C501D case 37
                mov     edx, dword ptr [eax]
                mov     byte ptr [edx], 25h ; '%'
                mov     edx, dword ptr [eax]
                inc     edx
                mov     [eax], edx
                mov     eax, dword ptr [esp+10h+arg_C]
                dec     dword ptr [eax]

def_5C501D:                             ; CODE XREF: __expandtime+F↑j
                pop     edi             ; jumptable 005C501D default case, cases 38-64,67-71,74-76,78-82,84,86,91-96,101-105,107,108,110,111,113-118
                pop     esi
                pop     ebp
                pop     ebx
                retn
__expandtime    endp

; ---------------------------------------------------------------------------
                align 4
jpt_5C501D      dd offset loc_5C54CD    ; DATA XREF: __expandtime+1D↑r
                dd offset loc_5C504A    ; jump table for switch statement
                dd offset loc_5C5098
                dd offset loc_5C516F
                dd offset loc_5C519C
                dd offset loc_5C5231
                dd offset loc_5C52AA
                dd offset loc_5C52D6
                dd offset loc_5C5318
                dd offset loc_5C53E3
                dd offset loc_5C5448
                dd offset loc_5C549B
                dd offset loc_5C5024
                dd offset loc_5C5071
                dd offset loc_5C50BF
                dd offset loc_5C5142
                dd offset loc_5C51D5
                dd offset loc_5C5203
                dd offset loc_5C525C
                dd offset loc_5C52EB
                dd offset loc_5C5380
                dd offset loc_5C5415
                dd offset loc_5C549B
                dd offset def_5C501D
byte_5C5548     db      0,   17h,   17h,   17h
                db    17h,   17h,   17h,   17h ; indirect table for switch statement
                db    17h,   17h,   17h,   17h
                db    17h,   17h,   17h,   17h
                db    17h,   17h,   17h,   17h
                db    17h,   17h,   17h,   17h
                db    17h,   17h,   17h,   17h
                db      1,     2,   17h,   17h
                db    17h,   17h,   17h,     3
                db      4,   17h,   17h,   17h
                db      5,   17h,   17h,   17h
                db    17h,   17h,     6,   17h
                db      7,   17h,     8,     9
                db    0Ah,   0Bh,   17h,   17h
                db    17h,   17h,   17h,   17h
                db    0Ch,   0Dh,   0Eh,   0Fh
                db    17h,   17h,   17h,   17h
                db    17h,   10h,   17h,   17h
                db    11h,   17h,   17h,   12h
                db    17h,   17h,   17h,   17h
                db    17h,   17h,   13h,   14h
                db    15h,   16h
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__store_str     proc near               ; CODE XREF: __expandtime+3D↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                push    esi
                mov     esi, [esp+4+arg_8]
                push    edi
                cmp     dword ptr [esi], 0
                jz      short loc_5C55CA
                mov     eax, dword ptr [esp+8+arg_4]
                mov     edx, dword ptr [esp+8+arg_0]

loc_5C55B3:                             ; CODE XREF: __store_str+28↓j
                mov     cl, [edx]
                test    cl, cl
                jz      short loc_5C55CA
                mov     edi, [eax]
                mov     [edi], cl
                mov     ecx, dword ptr [eax]
                inc     ecx
                inc     edx
                mov     [eax], ecx
                mov     ecx, dword ptr [esi]
                dec     ecx
                mov     [esi], ecx
                jnz     short loc_5C55B3

loc_5C55CA:                             ; CODE XREF: __store_str+9↑j
                pop     edi
                pop     esi
                retn
__store_str     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__store_num     proc near               ; CODE XREF: __expandtime+162↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                mov     eax, dword_70D4DC
                push    ebx
                push    ebp
                push    esi
                push    edi
                xor     edi, edi
                test    eax, eax
                jz      short loc_5C55FB
                mov     eax, dword ptr [esp+10h+arg_C]
                mov     ecx, dword ptr [esp+10h+arg_8]
                mov     edx, dword ptr [esp+10h+arg_0]
                push    eax
                push    ecx
                push    edx
                call    __store_number
                add     esp, 0Ch
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C55FB:                             ; CODE XREF: __store_num+D↑j
                mov     eax, dword ptr [esp+10h+arg_C]
                mov     ecx, dword ptr [esp+10h+arg_4]
                cmp     ecx, [eax]
                jnb     short loc_5C5658
                mov     ebx, dword ptr [esp+10h+arg_8]
                dec     ecx
                lea     edx, [ecx+1]
                test    edx, edx
                jz      short loc_5C5647
                mov     esi, [esp+10h+arg_0]

loc_5C5617:                             ; CODE XREF: __store_num+71↓j
                mov     eax, esi
                mov     ebp, 0Ah
                cdq
                idiv    ebp
                mov     eax, dword ptr [ebx]
                add     dl, 30h ; '0'
                mov     [eax+ecx], dl
                mov     eax, 66666667h
                imul    esi
                sar     edx, 2
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                inc     edi
                dec     ecx
                mov     esi, edx
                cmp     ecx, 0FFFFFFFFh
                jnz     short loc_5C5617
                mov     eax, dword ptr [esp+10h+arg_C]

loc_5C5647:                             ; CODE XREF: __store_num+41↑j
                mov     edx, dword ptr [ebx]
                add     edx, edi
                mov     [ebx], edx
                mov     ecx, dword ptr [eax]
                sub     ecx, edi
                mov     [eax], ecx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5658:                             ; CODE XREF: __store_num+35↑j
                pop     edi
                pop     esi
                pop     ebp
                mov     dword ptr [eax], 0
                pop     ebx
                retn
__store_num     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__store_number  proc near               ; CODE XREF: __store_num+1E↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                push    ebx
                push    ebp
                mov     ebp, [esp+8+arg_4]
                push    esi
                push    edi
                mov     edi, [esp+10h+arg_8]
                mov     esi, [ebp+0]
                cmp     dword ptr [edi], 1
                jbe     short loc_5C56BB
                mov     ecx, dword ptr [esp+10h+arg_0]

loc_5C5688:                             ; CODE XREF: __store_number+49↓j
                mov     eax, ecx
                mov     ebx, 0Ah
                cdq
                idiv    ebx
                mov     eax, 66666667h
                add     dl, 30h ; '0'
                mov     [esi], dl
                mov     edx, dword ptr [edi]
                inc     esi
                dec     edx
                mov     [edi], edx
                mov     ebx, edx
                imul    ecx
                sar     edx, 2
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                mov     ecx, edx
                test    ecx, ecx
                jle     short loc_5C56BB
                cmp     ebx, 1
                ja      short loc_5C5688

loc_5C56BB:                             ; CODE XREF: __store_number+12↑j
                mov     eax, dword ptr [ebp+0]
                mov     [ebp+0], esi
                dec     esi

loc_5C56C2:                             ; CODE XREF: __store_number+5E↓j
                mov     dl, [eax]
                mov     cl, [esi]
                mov     [esi], dl
                dec     esi
                mov     [eax], cl
                inc     eax
                cmp     eax, esi
                jb      short loc_5C56C2
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
__store_number  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl _store_winword(char *String1, int, int, int, int)
__store_winword proc near               ; CODE XREF: __expandtime+109↑p

var_4           = dword ptr -4
String1         = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h

                push    ecx
                push    ebx
                push    ebp
                push    esi
                mov     esi, [esp+10h+String1]
                push    edi
                cmp     byte ptr [esi], 0
                jz      loc_5C57D5
                mov     ebx, dword ptr [esp+14h+arg_C]
                mov     edi, [esp+14h+arg_8]

loc_5C56FA:                             ; CODE XREF: __store_winword+EF↓j
                mov     ecx, dword ptr [ebx]
                xor     eax, eax
                cmp     ecx, eax
                jz      loc_5C57D5
                xor     dl, dl
                lea     ebx, [esi+1]
                mov     dword_70D4DC, eax
                mov     cl, [esi]
                mov     byte ptr [esp+14h+String1], dl
                mov     [esp+14h+var_4], ebx
                mov     ebp, ebx

loc_5C571C:                             ; CODE XREF: __store_winword+43↓j
                mov     bl, [ebp+0]
                inc     eax
                inc     ebp
                cmp     bl, cl
                jz      short loc_5C571C
                dec     ebp
                mov     [esp+14h+arg_8], ebp
                movsx   ebp, cl
                add     ebp, 0FFFFFFD9h
                cmp     ebp, 52h ; 'R'
                ja      short def_5C574A ; jumptable 005C573D case 10
                xor     ecx, ecx
                mov     cl, ss:byte_5C59B8[ebp]
                jmp     ds:jpt_5C573D[ecx*4] ; switch 11 cases
; ---------------------------------------------------------------------------

loc_5C5744:                             ; CODE XREF: __store_winword+5D↑j
                dec     eax             ; jumptable 005C573D case 3
                cmp     eax, 3
                ja      short def_5C574A ; jumptable 005C573D case 10
                jmp     ds:jpt_5C574A[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5C5751:                             ; CODE XREF: __store_winword+6A↑j
                mov     dword_70D4DC, 1 ; jumptable 005C574A case 1

loc_5C575B:                             ; CODE XREF: __store_winword+6A↑j
                mov     dl, 6Dh ; 'm'   ; jumptable 005C574A case 2
                mov     byte ptr [esp+14h+String1], dl

def_5C574A:                             ; CODE XREF: __store_winword+53↑j
                test    dl, dl          ; jumptable 005C573D case 10
                jz      short loc_5C5788
                mov     ecx, dword ptr [esp+14h+arg_10]
                mov     ebx, dword ptr [esp+14h+arg_C]
                mov     edx, dword ptr [esp+14h+arg_4]
                mov     eax, dword ptr [esp+14h+String1]
                push    ecx
                push    ebx
                push    edi
                push    edx
                push    eax
                call    __expandtime
                mov     esi, [esp+28h+arg_8]
                add     esp, 14h
                jmp     short loc_5C57CC
; ---------------------------------------------------------------------------

loc_5C5788:                             ; CODE XREF: __store_winword+83↑j
                mov     al, [esi]
                mov     edx, off_641268
                mov     ecx, eax
                and     ecx, 0FFh
                test    byte ptr [edx+ecx*2+1], 80h
                jz      short loc_5C57B7
                mov     ecx, dword ptr [edi]
                mov     ebx, dword ptr [esp+14h+arg_C]
                mov     esi, [esp+14h+var_4]
                mov     [ecx], al
                mov     ecx, dword ptr [edi]
                inc     ecx
                mov     [edi], ecx
                mov     eax, dword ptr [ebx]
                dec     eax
                mov     [ebx], eax
                jmp     short loc_5C57BB
; ---------------------------------------------------------------------------

loc_5C57B7:                             ; CODE XREF: __store_winword+BD↑j
                mov     ebx, dword ptr [esp+14h+arg_C]

loc_5C57BB:                             ; CODE XREF: __store_winword+D5↑j
                mov     edx, dword ptr [edi]
                mov     al, [esi]
                mov     [edx], al
                mov     edx, dword ptr [edi]
                inc     edx
                inc     esi
                mov     [edi], edx
                mov     eax, dword ptr [ebx]
                dec     eax
                mov     [ebx], eax

loc_5C57CC:                             ; CODE XREF: __store_winword+A6↑j
                cmp     byte ptr [esi], 0
                jnz     loc_5C56FA

loc_5C57D5:                             ; CODE XREF: __store_winword+C↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C57DB:                             ; CODE XREF: __store_winword+6A↑j
                mov     dl, 62h ; 'b'   ; jumptable 005C574A case 3
                mov     byte ptr [esp+14h+String1], dl
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C57E6:                             ; CODE XREF: __store_winword+6A↑j
                mov     dl, 42h ; 'B'   ; jumptable 005C574A case 4
                mov     byte ptr [esp+14h+String1], dl
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C57F1:                             ; CODE XREF: __store_winword+5D↑j
                dec     eax             ; jumptable 005C573D case 5
                cmp     eax, 3
                ja      def_5C574A      ; jumptable 005C573D case 10
                jmp     ds:jpt_5C57FB[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5C5802:                             ; CODE XREF: __store_winword+11B↑j
                mov     dword_70D4DC, 1 ; jumptable 005C57FB case 1

loc_5C580C:                             ; CODE XREF: __store_winword+11B↑j
                mov     dl, 64h ; 'd'   ; jumptable 005C57FB case 2
                mov     byte ptr [esp+14h+String1], dl
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C5817:                             ; CODE XREF: __store_winword+11B↑j
                mov     dl, 61h ; 'a'   ; jumptable 005C57FB case 3
                mov     byte ptr [esp+14h+String1], dl
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C5822:                             ; CODE XREF: __store_winword+11B↑j
                mov     dl, 41h ; 'A'   ; jumptable 005C57FB case 4
                mov     byte ptr [esp+14h+String1], dl
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C582D:                             ; CODE XREF: __store_winword+5D↑j
                sub     eax, 2          ; jumptable 005C573D case 9
                jz      short loc_5C5846
                sub     eax, 2
                jnz     def_5C574A      ; jumptable 005C573D case 10
                mov     dl, 59h ; 'Y'
                mov     byte ptr [esp+14h+String1], dl
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C5846:                             ; CODE XREF: __store_winword+150↑j
                mov     dl, 79h ; 'y'
                mov     byte ptr [esp+14h+String1], dl
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C5851:                             ; CODE XREF: __store_winword+5D↑j
                dec     eax             ; jumptable 005C573D case 6
                jz      short loc_5C585C
                dec     eax
                jz      short loc_5C5866
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C585C:                             ; CODE XREF: __store_winword+172↑j
                mov     dword_70D4DC, 1

loc_5C5866:                             ; CODE XREF: __store_winword+175↑j
                mov     dl, 49h ; 'I'
                mov     byte ptr [esp+14h+String1], dl
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C5871:                             ; CODE XREF: __store_winword+5D↑j
                dec     eax             ; jumptable 005C573D case 2
                jz      short loc_5C587C
                dec     eax
                jz      short loc_5C5886
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C587C:                             ; CODE XREF: __store_winword+192↑j
                mov     dword_70D4DC, 1

loc_5C5886:                             ; CODE XREF: __store_winword+195↑j
                mov     dl, 48h ; 'H'
                mov     byte ptr [esp+14h+String1], dl
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C5891:                             ; CODE XREF: __store_winword+5D↑j
                dec     eax             ; jumptable 005C573D case 7
                jz      short loc_5C589C
                dec     eax
                jz      short loc_5C58A6
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C589C:                             ; CODE XREF: __store_winword+1B2↑j
                mov     dword_70D4DC, 1

loc_5C58A6:                             ; CODE XREF: __store_winword+1B5↑j
                mov     dl, 4Dh ; 'M'
                mov     byte ptr [esp+14h+String1], dl
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C58B1:                             ; CODE XREF: __store_winword+5D↑j
                dec     eax             ; jumptable 005C573D case 8
                jz      short loc_5C58BC
                dec     eax
                jz      short loc_5C58C6
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C58BC:                             ; CODE XREF: __store_winword+1D2↑j
                mov     dword_70D4DC, 1

loc_5C58C6:                             ; CODE XREF: __store_winword+1D5↑j
                mov     dl, 53h ; 'S'
                mov     byte ptr [esp+14h+String1], dl
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C58D1:                             ; CODE XREF: __store_winword+5D↑j
                push    offset aAmPm    ; jumptable 005C573D cases 1,4
                push    esi             ; String1
                call    __strcmpi
                add     esp, 8
                test    eax, eax
                jnz     short loc_5C58F5
                lea     edx, [esi+5]
                mov     [esp+14h+arg_8], edx
                mov     dl, 70h ; 'p'
                mov     byte ptr [esp+14h+String1], dl
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C58F5:                             ; CODE XREF: __store_winword+201↑j
                push    offset aAP ; String2
                push    esi             ; String1
                call    __strcmpi
                add     esp, 8
                test    eax, eax
                jnz     short loc_5C590E
                lea     eax, [esi+3]
                mov     [esp+14h+arg_8], eax

loc_5C590E:                             ; CODE XREF: __store_winword+225↑j
                mov     dl, 70h ; 'p'
                mov     byte ptr [esp+14h+String1], dl
                jmp     def_5C574A      ; jumptable 005C573D case 10
; ---------------------------------------------------------------------------

loc_5C5919:                             ; CODE XREF: __store_winword+5D↑j
                test    al, 1           ; jumptable 005C573D case 0
                jz      short loc_5C5980
                mov     ebx, dword ptr [esp+14h+arg_C]
                add     esi, eax
                mov     al, [esi]
                test    al, al
                jz      loc_5C57CC

loc_5C592D:                             ; CODE XREF: __store_winword+293↓j
                cmp     dword ptr [ebx], 0
                jz      loc_5C57CC
                cmp     al, 27h ; '''
                jz      short loc_5C597A
                mov     edx, off_641268
                mov     ecx, eax
                and     ecx, 0FFh
                test    byte ptr [edx+ecx*2+1], 80h
                jz      short loc_5C595E
                mov     ecx, dword ptr [edi]
                mov     [ecx], al
                mov     edx, dword ptr [edi]
                inc     edx
                inc     esi
                mov     [edi], edx
                mov     eax, dword ptr [ebx]
                dec     eax
                mov     [ebx], eax

loc_5C595E:                             ; CODE XREF: __store_winword+26D↑j
                mov     edx, dword ptr [edi]
                mov     al, [esi]
                mov     [edx], al
                mov     eax, dword ptr [edi]
                inc     eax
                inc     esi
                mov     [edi], eax
                mov     edx, dword ptr [ebx]
                dec     edx
                mov     [ebx], edx
                mov     al, [esi]
                test    al, al
                jnz     short loc_5C592D
                jmp     loc_5C57CC
; ---------------------------------------------------------------------------

loc_5C597A:                             ; CODE XREF: __store_winword+258↑j
                inc     esi
                jmp     loc_5C57CC
; ---------------------------------------------------------------------------

loc_5C5980:                             ; CODE XREF: __store_winword+23B↑j
                mov     ebx, dword ptr [esp+14h+arg_C]
                add     esi, eax
                jmp     loc_5C57CC
__store_winword endp

; ---------------------------------------------------------------------------
                align 4
jpt_5C573D      dd offset loc_5C5919    ; DATA XREF: __store_winword+5D↑r
                dd offset loc_5C58D1    ; jump table for switch statement
                dd offset loc_5C5871
                dd offset loc_5C5744
                dd offset loc_5C58D1
                dd offset loc_5C57F1
                dd offset loc_5C5851
                dd offset loc_5C5891
                dd offset loc_5C58B1
                dd offset loc_5C582D
                dd offset def_5C574A
byte_5C59B8     db 0                    ; DATA XREF: __store_winword+57↑r
                db 3 dup(0Ah)
                dd 5 dup(0A0A0A0Ah), 0A010A0Ah, 0A0A0A0Ah, 0A0A020Ah, 0A030A0Ah
                dd 4 dup(0A0A0A0Ah), 0A040A0Ah, 0A0A050Ah, 0A0A060Ah, 0A070A0Ah
                dd 0A0A0A0Ah, 0A0A0A08h, 90090A0Ah
jpt_5C574A      dd offset loc_5C5751    ; DATA XREF: __store_winword+6A↑r
                dd offset loc_5C575B    ; jump table for switch statement
                dd offset loc_5C57DB
                dd offset loc_5C57E6
jpt_5C57FB      dd offset loc_5C5802    ; DATA XREF: __store_winword+11B↑r
                dd offset loc_5C580C    ; jump table for switch statement
                dd offset loc_5C5817
                dd offset loc_5C5822
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _mbscmp(const unsigned __int8 *Str1, const unsigned __int8 *Str2)
__mbscmp        proc near               ; CODE XREF: sub_5DC9EA+3B↓p

Str1            = dword ptr  4
Str2            = dword ptr  8

                mov     eax, dword_70D4BC
                push    ebx
                push    ebp
                xor     ebp, ebp
                push    esi
                cmp     eax, ebp
                push    edi
                jnz     short loc_5C5A80
                mov     esi, [esp+10h+Str2]
                mov     eax, dword ptr [esp+10h+Str1]

loc_5C5A47:                             ; CODE XREF: __mbscmp+3D↓j
                mov     dl, [eax]
                mov     bl, [esi]
                mov     cl, dl
                cmp     dl, bl
                jnz     short loc_5C5A76
                test    cl, cl
                jz      loc_5C5B20
                mov     dl, [eax+1]
                mov     bl, [esi+1]
                mov     cl, dl
                cmp     dl, bl
                jnz     short loc_5C5A76
                add     eax, 2
                add     esi, 2
                test    cl, cl
                jnz     short loc_5C5A47
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5A76:                             ; CODE XREF: __mbscmp+1F↑j
                sbb     eax, eax
                sbb     eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5A80:                             ; CODE XREF: __mbscmp+D↑j
                push    19h
                call    __lock
                mov     esi, [esp+14h+Str2]
                mov     edi, [esp+14h+Str1]
                add     esp, 4
                mov     dl, 4

loc_5C5A94:                             ; CODE XREF: __mbscmp+CA↓j
                movzx   cx, byte ptr [edi]
                mov     eax, ecx
                inc     edi
                and     eax, 0FFh
                mov     [esp+10h+Str2], ecx
                test    __mbctype+1h[eax], dl
                jz      short loc_5C5AC7
                mov     al, [edi]
                test    al, al
                jnz     short loc_5C5AB8
                mov     [esp+10h+Str2], ebp
                jmp     short loc_5C5AC3
; ---------------------------------------------------------------------------

loc_5C5AB8:                             ; CODE XREF: __mbscmp+80↑j
                xor     ebx, ebx
                inc     edi
                mov     bh, cl
                mov     bl, al
                mov     [esp+10h+Str2], ebx

loc_5C5AC3:                             ; CODE XREF: __mbscmp+86↑j
                mov     ecx, dword ptr [esp+10h+Str2]

loc_5C5AC7:                             ; CODE XREF: __mbscmp+7A↑j
                movzx   bx, byte ptr [esi]
                mov     eax, ebx
                inc     esi
                and     eax, 0FFh
                test    __mbctype+1h[eax], dl
                jz      short loc_5C5AF0
                mov     al, [esi]
                test    al, al
                jnz     short loc_5C5AE5
                xor     ebx, ebx
                jmp     short loc_5C5AF0
; ---------------------------------------------------------------------------

loc_5C5AE5:                             ; CODE XREF: __mbscmp+AF↑j
                xor     edx, edx
                inc     esi
                mov     dh, bl
                mov     dl, al
                mov     ebx, edx
                mov     dl, 4

loc_5C5AF0:                             ; CODE XREF: __mbscmp+A9↑j
                cmp     cx, bx
                jnz     short loc_5C5AFC
                cmp     cx, bp
                jz      short loc_5C5B16
                jmp     short loc_5C5A94
; ---------------------------------------------------------------------------

loc_5C5AFC:                             ; CODE XREF: __mbscmp+C3↑j
                push    19h
                call    __unlock
                add     esp, 4
                cmp     bx, word ptr [esp+10h+Str2]
                sbb     eax, eax
                and     eax, 2
                dec     eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5B16:                             ; CODE XREF: __mbscmp+C8↑j
                push    19h
                call    __unlock
                add     esp, 4

loc_5C5B20:                             ; CODE XREF: __mbscmp+23↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                retn
__mbscmp        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl _strdup(const char *Source)
__strdup        proc near               ; CODE XREF: _copy_environ+50↓p

Source          = dword ptr  4

                push    ebx
                push    esi
                mov     esi, [esp+8+Source]
                push    edi
                test    esi, esi
                jz      short loc_5C5B7A
                mov     edi, esi
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                push    ecx             ; varSize
                call    _malloc
                mov     edx, eax
                add     esp, 4
                test    edx, edx
                jz      short loc_5C5B7A
                mov     edi, esi
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     ebx, ecx
                mov     edi, edx
                mov     eax, edi
                shr     ecx, 2
                rep movsd
                mov     ecx, ebx
                and     ecx, 3
                rep movsb
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5B7A:                             ; CODE XREF: __strdup+9↑j
                pop     edi
                pop     esi
                xor     eax, eax
                pop     ebx
                retn
__strdup        endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl _fullpath(char *Buffer, const char *Path, size_t BufferCount)
__fullpath      proc near               ; CODE XREF: CFileFind::FindFile(char const *,ulong)+71↑p

Buffer          = dword ptr  4
lpFileName      = dword ptr  8
FilePart        = dword ptr  0Ch

                push    ebx
                push    ebp
                mov     ebp, [esp+8+lpFileName]
                push    esi
                test    ebp, ebp
                push    edi
                jz      loc_5C5C33
                cmp     byte ptr [ebp+0], 0
                jz      loc_5C5C33
                mov     ebx, dword ptr [esp+10h+Buffer]
                test    ebx, ebx
                jnz     short loc_5C5BCE
                push    104h            ; varSize
                call    _malloc
                mov     esi, eax
                add     esp, 4
                test    esi, esi
                jnz     short loc_5C5BC7
                call    __errno
                mov     dword ptr [eax], 0Ch
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5BC7:                             ; CODE XREF: __fullpath+33↑j
                mov     edi, 104h
                jmp     short loc_5C5BD4
; ---------------------------------------------------------------------------

loc_5C5BCE:                             ; CODE XREF: __fullpath+20↑j
                mov     edi, [esp+10h+FilePart]
                mov     esi, ebx

loc_5C5BD4:                             ; CODE XREF: __fullpath+4C↑j
                lea     eax, [esp+10h+FilePart]
                push    eax             ; lpFilePart
                push    esi             ; lpBuffer
                push    edi             ; nBufferLength
                push    ebp             ; lpFileName
                call    GetFullPathNameA
                cmp     eax, edi
                jb      short loc_5C5C05
                test    ebx, ebx
                jnz     short loc_5C5BF3
                push    esi             ; Block
                call    _free
                add     esp, 4

loc_5C5BF3:                             ; CODE XREF: __fullpath+68↑j
                call    __errno
                mov     dword ptr [eax], 22h ; '"'
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5C05:                             ; CODE XREF: __fullpath+64↑j
                test    eax, eax
                jnz     short loc_5C5C2C
                test    ebx, ebx
                jnz     short loc_5C5C16
                push    esi             ; Block
                call    _free
                add     esp, 4

loc_5C5C16:                             ; CODE XREF: __fullpath+8B↑j
                call    GetLastError
                push    eax
                call    __dosmaperr
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5C2C:                             ; CODE XREF: __fullpath+87↑j
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C5C33:                             ; CODE XREF: __fullpath+A↑j
                mov     ecx, dword ptr [esp+10h+FilePart]
                mov     edx, dword ptr [esp+10h+Buffer]
                push    ecx             ; SizeInBytes
                push    edx             ; DstBuf
                call    __getcwd
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
__fullpath      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void __cdecl _splitpath(const char *FullPath, char *Drive, char *Dir, char *Filename, char *Ext)
__splitpath     proc near               ; CODE XREF: CFileFind::GetFileTitle(void)+46↑p

Source          = dword ptr -4
FullPath        = dword ptr  4
Drive           = dword ptr  8
Dir             = dword ptr  0Ch
Filename        = dword ptr  10h
Ext             = dword ptr  14h

                push    ecx
                push    ebx
                push    ebp
                mov     ebp, [esp+0Ch+FullPath]
                push    esi
                push    edi
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                dec     ecx
                mov     [esp+14h+Source], 0
                cmp     ecx, 1
                jb      short loc_5C5C95
                cmp     byte ptr [ebp+1], 3Ah ; ':'
                jnz     short loc_5C5C95
                mov     esi, [esp+14h+Drive]
                test    esi, esi
                jz      short loc_5C5C90
                push    2               ; Count
                push    ebp             ; Source
                push    esi             ; Dest
                call    __mbsnbcpy
                add     esp, 0Ch
                mov     byte ptr [esi+2], 0

loc_5C5C90:                             ; CODE XREF: __splitpath+2E↑j
                add     ebp, 2
                jmp     short loc_5C5CA0
; ---------------------------------------------------------------------------

loc_5C5C95:                             ; CODE XREF: __splitpath+20↑j
                mov     eax, dword ptr [esp+14h+Drive]
                test    eax, eax
                jz      short loc_5C5CA0
                mov     byte ptr [eax], 0

loc_5C5CA0:                             ; CODE XREF: __splitpath+43↑j
                mov     cl, [ebp+0]
                xor     eax, eax
                test    cl, cl
                mov     [esp+14h+Drive], eax
                mov     esi, ebp
                jz      short loc_5C5CEB
                mov     cl, 4

loc_5C5CB1:                             ; CODE XREF: __splitpath+95↓j
                mov     al, [esi]
                mov     edx, eax
                and     edx, 0FFh
                test    __mbctype+1h[edx], cl
                jz      short loc_5C5CC6
                inc     esi
                jmp     short loc_5C5CDF
; ---------------------------------------------------------------------------

loc_5C5CC6:                             ; CODE XREF: __splitpath+71↑j
                cmp     al, 2Fh ; '/'
                jz      short loc_5C5CD8
                cmp     al, 5Ch ; '\'
                jz      short loc_5C5CD8
                cmp     al, 2Eh ; '.'
                jnz     short loc_5C5CDF
                mov     [esp+14h+Source], esi
                jmp     short loc_5C5CDF
; ---------------------------------------------------------------------------

loc_5C5CD8:                             ; CODE XREF: __splitpath+78↑j
                lea     eax, [esi+1]
                mov     [esp+14h+Drive], eax

loc_5C5CDF:                             ; CODE XREF: __splitpath+74↑j
                mov     al, [esi+1]
                inc     esi
                test    al, al
                jnz     short loc_5C5CB1
                mov     eax, dword ptr [esp+14h+Drive]

loc_5C5CEB:                             ; CODE XREF: __splitpath+5D↑j
                test    eax, eax
                jz      short loc_5C5D1C
                mov     ebx, dword ptr [esp+14h+Dir]
                test    ebx, ebx
                jz      short loc_5C5D16
                sub     eax, ebp
                cmp     eax, 0FFh
                mov     edi, eax
                jb      short loc_5C5D07
                mov     edi, 0FFh

loc_5C5D07:                             ; CODE XREF: __splitpath+B0↑j
                push    edi             ; Count
                push    ebp             ; Source
                push    ebx             ; Dest
                call    __mbsnbcpy
                add     esp, 0Ch
                mov     byte ptr [edi+ebx], 0

loc_5C5D16:                             ; CODE XREF: __splitpath+A5↑j
                mov     ebp, [esp+14h+Drive]
                jmp     short loc_5C5D27
; ---------------------------------------------------------------------------

loc_5C5D1C:                             ; CODE XREF: __splitpath+9D↑j
                mov     eax, dword ptr [esp+14h+Dir]
                test    eax, eax
                jz      short loc_5C5D27
                mov     byte ptr [eax], 0

loc_5C5D27:                             ; CODE XREF: __splitpath+CA↑j
                mov     eax, dword ptr [esp+14h+Source]
                test    eax, eax
                jz      short loc_5C5D8A
                cmp     eax, ebp
                jb      short loc_5C5D8A
                mov     ebx, dword ptr [esp+14h+Filename]
                test    ebx, ebx
                jz      short loc_5C5D5A
                sub     eax, ebp
                cmp     eax, 0FFh
                mov     edi, eax
                jb      short loc_5C5D4B
                mov     edi, 0FFh

loc_5C5D4B:                             ; CODE XREF: __splitpath+F4↑j
                push    edi             ; Count
                push    ebp             ; Source
                push    ebx             ; Dest
                call    __mbsnbcpy
                add     esp, 0Ch
                mov     byte ptr [edi+ebx], 0

loc_5C5D5A:                             ; CODE XREF: __splitpath+E9↑j
                mov     edi, [esp+14h+Ext]
                test    edi, edi
                jz      short loc_5C5DBB
                mov     eax, dword ptr [esp+14h+Source]
                sub     esi, eax
                cmp     esi, 0FFh
                jb      short loc_5C5D75
                mov     esi, 0FFh

loc_5C5D75:                             ; CODE XREF: __splitpath+11E↑j
                push    esi             ; Count
                push    eax             ; Source
                push    edi             ; Dest
                call    __mbsnbcpy
                add     esp, 0Ch
                mov     byte ptr [esi+edi], 0
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C5D8A:                             ; CODE XREF: __splitpath+DD↑j
                mov     edi, [esp+14h+Filename]
                test    edi, edi
                jz      short loc_5C5DB0
                sub     esi, ebp
                cmp     esi, 0FFh
                jb      short loc_5C5DA1
                mov     esi, 0FFh

loc_5C5DA1:                             ; CODE XREF: __splitpath+14A↑j
                push    esi             ; Count
                push    ebp             ; Source
                push    edi             ; Dest
                call    __mbsnbcpy
                add     esp, 0Ch
                mov     byte ptr [esi+edi], 0

loc_5C5DB0:                             ; CODE XREF: __splitpath+140↑j
                mov     eax, dword ptr [esp+14h+Ext]
                test    eax, eax
                jz      short loc_5C5DBB
                mov     byte ptr [eax], 0

loc_5C5DBB:                             ; CODE XREF: __splitpath+110↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
__splitpath     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl strtol(const char *String, char **EndPtr, int Radix)
_strtol         proc near               ; CODE XREF: AfxSimpleScanf(char const *,char const *,char *)+3E↓p

String          = dword ptr  4
EndPtr          = dword ptr  8
Radix           = dword ptr  0Ch

                mov     eax, dword ptr [esp+Radix]
                mov     ecx, dword ptr [esp+EndPtr]
                mov     edx, dword ptr [esp+String]
                push    0
                push    eax
                push    ecx
                push    edx
                call    _strtoxl
                add     esp, 10h
                retn
_strtol         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_strtoxl        proc near               ; CODE XREF: _strtol+11↑p

var_C           = dword ptr -0Ch
var_8           = dword ptr -8
var_4           = dword ptr -4
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                sub     esp, 0Ch
                push    ebx
                push    ebp
                mov     ebp, [esp+14h+arg_0]
                push    esi
                push    edi
                mov     [esp+1Ch+var_4], 0
                mov     bl, [ebp+0]
                inc     ebp
                mov     byte ptr [esp+1Ch+var_C], bl
                mov     [esp+1Ch+var_8], ebp

loc_5C5E0F:                             ; CODE XREF: _strtoxl+64↓j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5C5E30
                mov     esi, [esp+1Ch+var_C]
                push    8               ; Type
                mov     eax, esi
                and     eax, 0FFh
                push    eax             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5C5E48
; ---------------------------------------------------------------------------

loc_5C5E30:                             ; CODE XREF: _strtoxl+26↑j
                mov     esi, [esp+1Ch+var_C]
                mov     edx, off_641268
                mov     ecx, esi
                and     ecx, 0FFh
                mov     al, [edx+ecx*2]
                and     eax, 8

loc_5C5E48:                             ; CODE XREF: _strtoxl+3E↑j
                test    eax, eax
                jz      short loc_5C5E56
                mov     bl, [ebp+0]
                inc     ebp
                mov     byte ptr [esp+1Ch+var_C], bl
                jmp     short loc_5C5E0F
; ---------------------------------------------------------------------------

loc_5C5E56:                             ; CODE XREF: _strtoxl+5A↑j
                cmp     bl, 2Dh ; '-'
                mov     [esp+1Ch+var_8], ebp
                jnz     short loc_5C5E66
                or      [esp+1Ch+arg_C], 2
                jmp     short loc_5C5E6B
; ---------------------------------------------------------------------------

loc_5C5E66:                             ; CODE XREF: _strtoxl+6D↑j
                cmp     bl, 2Bh ; '+'
                jnz     short loc_5C5E7B

loc_5C5E6B:                             ; CODE XREF: _strtoxl+74↑j
                mov     bl, [ebp+0]
                inc     ebp
                mov     byte ptr [esp+1Ch+var_C], bl
                mov     [esp+1Ch+var_8], ebp
                mov     esi, [esp+1Ch+var_C]

loc_5C5E7B:                             ; CODE XREF: _strtoxl+79↑j
                mov     edi, [esp+1Ch+arg_8]
                test    edi, edi
                jl      loc_5C6059
                cmp     edi, 1
                jz      loc_5C6059
                cmp     edi, 24h ; '$'
                jg      loc_5C6059
                test    edi, edi
                jnz     short loc_5C5EBE
                cmp     bl, 30h ; '0'
                jz      short loc_5C5EA9
                mov     edi, 0Ah
                jmp     short loc_5C5EBE
; ---------------------------------------------------------------------------

loc_5C5EA9:                             ; CODE XREF: _strtoxl+B0↑j
                mov     al, [ebp+0]
                cmp     al, 78h ; 'x'
                jz      short loc_5C5EB9
                cmp     al, 58h ; 'X'
                mov     edi, 8
                jnz     short loc_5C5EBE

loc_5C5EB9:                             ; CODE XREF: _strtoxl+BE↑j
                mov     edi, 10h

loc_5C5EBE:                             ; CODE XREF: _strtoxl+AB↑j
                cmp     edi, 10h
                jnz     short loc_5C5EE4
                cmp     bl, 30h ; '0'
                jnz     short loc_5C5EE4
                mov     al, [ebp+0]
                cmp     al, 78h ; 'x'
                jz      short loc_5C5ED3
                cmp     al, 58h ; 'X'
                jnz     short loc_5C5EE4

loc_5C5ED3:                             ; CODE XREF: _strtoxl+DD↑j
                mov     bl, [ebp+1]
                inc     ebp
                mov     byte ptr [esp+1Ch+var_C], bl
                inc     ebp
                mov     esi, [esp+1Ch+var_C]
                mov     [esp+1Ch+var_8], ebp

loc_5C5EE4:                             ; CODE XREF: _strtoxl+D1↑j
                or      eax, 0FFFFFFFFh
                xor     edx, edx
                div     edi
                mov     ebp, eax

loc_5C5EED:                             ; CODE XREF: _strtoxl+1BF↓j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5C5F09
                and     esi, 0FFh
                push    4               ; Type
                push    esi             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5C5F1A
; ---------------------------------------------------------------------------

loc_5C5F09:                             ; CODE XREF: _strtoxl+104↑j
                mov     eax, off_641268
                and     esi, 0FFh
                mov     al, [eax+esi*2]
                and     eax, 4

loc_5C5F1A:                             ; CODE XREF: _strtoxl+117↑j
                test    eax, eax
                jz      short loc_5C5F26
                movsx   ecx, bl
                sub     ecx, 30h ; '0'
                jmp     short loc_5C5F63
; ---------------------------------------------------------------------------

loc_5C5F26:                             ; CODE XREF: _strtoxl+12C↑j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5C5F3F
                push    103h            ; Type
                push    esi             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5C5F4E
; ---------------------------------------------------------------------------

loc_5C5F3F:                             ; CODE XREF: _strtoxl+13D↑j
                mov     ecx, off_641268
                mov     ax, [ecx+esi*2]
                and     eax, 103h

loc_5C5F4E:                             ; CODE XREF: _strtoxl+14D↑j
                test    eax, eax
                jz      short loc_5C5FB4
                movsx   edx, bl
                push    edx             ; C
                call    _toupper
                mov     ecx, eax
                add     esp, 4
                sub     ecx, 37h ; '7'

loc_5C5F63:                             ; CODE XREF: _strtoxl+134↑j
                cmp     ecx, edi
                jnb     short loc_5C5FB4
                mov     edx, dword ptr [esp+1Ch+arg_C]
                mov     esi, [esp+1Ch+var_4]
                or      edx, 8
                cmp     esi, ebp
                mov     [esp+1Ch+arg_C], edx
                jb      short loc_5C5F93
                jnz     short loc_5C5F87
                or      eax, 0FFFFFFFFh
                xor     edx, edx
                div     edi
                cmp     ecx, edx
                jbe     short loc_5C5F93

loc_5C5F87:                             ; CODE XREF: _strtoxl+18A↑j
                mov     eax, dword ptr [esp+1Ch+arg_C]
                or      al, 4
                mov     [esp+1Ch+arg_C], eax
                jmp     short loc_5C5F9C
; ---------------------------------------------------------------------------

loc_5C5F93:                             ; CODE XREF: _strtoxl+188↑j
                imul    esi, edi
                add     esi, ecx
                mov     [esp+1Ch+var_4], esi

loc_5C5F9C:                             ; CODE XREF: _strtoxl+1A1↑j
                mov     eax, dword ptr [esp+1Ch+var_8]
                mov     bl, [eax]
                inc     eax
                mov     byte ptr [esp+1Ch+var_C], bl
                mov     [esp+1Ch+var_8], eax
                mov     esi, [esp+1Ch+var_C]
                jmp     loc_5C5EED
; ---------------------------------------------------------------------------

loc_5C5FB4:                             ; CODE XREF: _strtoxl+160↑j
                mov     edx, dword ptr [esp+1Ch+var_8]
                mov     eax, dword ptr [esp+1Ch+arg_C]
                mov     esi, [esp+1Ch+arg_4]
                dec     edx
                test    al, 8
                mov     [esp+1Ch+var_8], edx
                jnz     short loc_5C5FDF
                test    esi, esi
                jz      short loc_5C5FD5
                mov     eax, dword ptr [esp+1Ch+arg_0]
                mov     [esp+1Ch+var_8], eax

loc_5C5FD5:                             ; CODE XREF: _strtoxl+1DB↑j
                mov     [esp+1Ch+var_4], 0
                jmp     short loc_5C6032
; ---------------------------------------------------------------------------

loc_5C5FDF:                             ; CODE XREF: _strtoxl+1D7↑j
                test    al, 4
                jnz     short loc_5C6004
                test    al, 1
                jnz     short loc_5C6032
                and     eax, 2
                jz      short loc_5C5FF6
                cmp     [esp+1Ch+var_4], 80000000h
                ja      short loc_5C6004

loc_5C5FF6:                             ; CODE XREF: _strtoxl+1FA↑j
                test    eax, eax
                jnz     short loc_5C6032
                cmp     [esp+1Ch+var_4], 7FFFFFFFh
                jbe     short loc_5C6032

loc_5C6004:                             ; CODE XREF: _strtoxl+1F1↑j
                call    __errno
                mov     dword ptr [eax], 22h ; '"'
                mov     eax, dword ptr [esp+1Ch+arg_C]
                test    al, 1
                jz      short loc_5C6021
                mov     [esp+1Ch+var_4], 0FFFFFFFFh
                jmp     short loc_5C6032
; ---------------------------------------------------------------------------

loc_5C6021:                             ; CODE XREF: _strtoxl+225↑j
                and     al, 2
                neg     al
                sbb     eax, eax
                neg     eax
                add     eax, 7FFFFFFFh
                mov     [esp+1Ch+var_4], eax

loc_5C6032:                             ; CODE XREF: _strtoxl+1ED↑j
                test    esi, esi
                jz      short loc_5C603C
                mov     ecx, dword ptr [esp+1Ch+var_8]
                mov     [esi], ecx

loc_5C603C:                             ; CODE XREF: _strtoxl+244↑j
                test    byte ptr [esp+1Ch+arg_C], 2
                jz      short loc_5C604D
                mov     edx, dword ptr [esp+1Ch+var_4]
                neg     edx
                mov     [esp+1Ch+var_4], edx

loc_5C604D:                             ; CODE XREF: _strtoxl+251↑j
                mov     eax, dword ptr [esp+1Ch+var_4]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 0Ch
                retn
; ---------------------------------------------------------------------------

loc_5C6059:                             ; CODE XREF: _strtoxl+91↑j
                mov     eax, dword ptr [esp+1Ch+arg_4]
                test    eax, eax
                jz      short loc_5C6067
                mov     ecx, dword ptr [esp+1Ch+arg_0]
                mov     [eax], ecx

loc_5C6067:                             ; CODE XREF: _strtoxl+26F↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                add     esp, 0Ch
                retn
_strtoxl        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; unsigned int __cdecl strtoul(const char *String, char **EndPtr, int Radix)
_strtoul        proc near               ; CODE XREF: _AfxGetMouseScrollLines(int)+136↓p

String          = dword ptr  4
EndPtr          = dword ptr  8
Radix           = dword ptr  0Ch

                mov     eax, dword ptr [esp+Radix]
                mov     ecx, dword ptr [esp+EndPtr]
                mov     edx, dword ptr [esp+String]
                push    1
                push    eax
                push    ecx
                push    edx
                call    _strtoxl
                add     esp, 10h
                retn
_strtoul        endp

; ---------------------------------------------------------------------------
                align 10h





; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __InternalCxxFrameHandler(PEXCEPTION_RECORD ExceptionRecord, struct EHRegistrationNode *, struct _CONTEXT *, void *, struct _s_FuncInfo *, int, PVOID TargetFrame, char)
___InternalCxxFrameHandler proc near    ; CODE XREF: ___CxxFrameHandler+27↑p

ExceptionRecord = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h
arg_14          = dword ptr  18h
TargetFrame     = dword ptr  1Ch
arg_1C          = byte ptr  20h

                push    esi
                mov     esi, [esp+4+arg_10]
                cmp     dword ptr [esi], 19930520h
                jz      short loc_5C6282
                call    sub_5C6F90
; ---------------------------------------------------------------------------

loc_5C6282:                             ; CODE XREF: ___InternalCxxFrameHandler+B↑j
                mov     eax, dword ptr [esp+4+ExceptionRecord]
                test    byte ptr [eax+4], 66h
                jz      short loc_5C62BF
                mov     eax, dword ptr [esi+4]
                test    eax, eax
                jz      loc_5C6330
                mov     eax, dword ptr [esp+4+arg_14]
                test    eax, eax
                jnz     loc_5C6330
                mov     eax, dword ptr [esp+4+arg_C]
                mov     ecx, dword ptr [esp+4+arg_4]
                push    0FFFFFFFFh
                push    esi
                push    eax
                push    ecx
                call    ___FrameUnwindToState
                add     esp, 10h
                mov     eax, 1
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C62BF:                             ; CODE XREF: ___InternalCxxFrameHandler+1A↑j
                mov     ecx, dword ptr [esi+0Ch]
                test    ecx, ecx
                jz      short loc_5C6330
                cmp     dword ptr [eax], 0E06D7363h
                jnz     short loc_5C6308
                cmp     dword ptr [eax+14h], 19930520h
                jbe     short loc_5C6308
                mov     edx, dword ptr [eax+1Ch]
                mov     ecx, dword ptr [edx+8]
                test    ecx, ecx
                jz      short loc_5C6308
                mov     edx, dword ptr [esp+4+arg_1C]
                push    edx
                mov     edx, dword ptr [esp+8+TargetFrame]
                push    edx
                mov     edx, dword ptr [esp+0Ch+arg_14]
                push    edx
                mov     edx, dword ptr [esp+10h+arg_C]
                push    esi
                push    edx
                mov     edx, dword ptr [esp+18h+arg_8]
                push    edx
                mov     edx, dword ptr [esp+1Ch+arg_4]
                push    edx
                push    eax
                call    ecx
                add     esp, 20h
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C6308:                             ; CODE XREF: ___InternalCxxFrameHandler+5C↑j
                mov     ecx, dword ptr [esp+4+TargetFrame]
                mov     edx, dword ptr [esp+4+arg_14]
                push    ecx             ; TargetFrame
                mov     ecx, dword ptr [esp+8+arg_1C]
                push    edx             ; int
                mov     edx, dword ptr [esp+0Ch+arg_C]
                push    ecx             ; char
                mov     ecx, dword ptr [esp+10h+arg_8]
                push    esi             ; struct _s_FuncInfo *
                push    edx             ; void *
                mov     edx, dword ptr [esp+18h+arg_4]
                push    ecx             ; struct _CONTEXT *
                push    edx             ; struct EHRegistrationNode *
                push    eax             ; ExceptionRecord
                call    ?FindHandler@@YAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAU_CONTEXT@@PAXPBU_s_FuncInfo@@EH1@Z ; FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)
                add     esp, 20h

loc_5C6330:                             ; CODE XREF: ___InternalCxxFrameHandler+21↑j
                mov     eax, 1
                pop     esi
                retn
___InternalCxxFrameHandler endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; void __cdecl FindHandler(PEXCEPTION_RECORD ExceptionRecord, struct EHRegistrationNode *, struct _CONTEXT *, void *, const struct _s_FuncInfo *, char, int, PVOID TargetFrame)
?FindHandler@@YAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAU_CONTEXT@@PAXPBU_s_FuncInfo@@EH1@Z proc near

var_24          = dword ptr -24h
var_20          = dword ptr -20h
var_1C          = dword ptr -1Ch
var_18          = dword ptr -18h
var_14          = dword ptr -14h
var_10          = dword ptr -10h
var_C           = dword ptr -0Ch
var_8           = dword ptr -8
var_4           = dword ptr -4
ExceptionRecord = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h
arg_14          = byte ptr  18h
arg_18          = dword ptr  1Ch
TargetFrame     = dword ptr  20h

                sub     esp, 24h
                mov     eax, dword ptr [esp+24h+arg_4]
                push    ebx
                push    ebp
                push    esi
                mov     ebp, [eax+8]
                push    edi
                cmp     ebp, 0FFFFFFFFh
                mov     [esp+34h+var_10], ebp
                jl      short loc_5C6360
                mov     ecx, dword ptr [esp+34h+arg_10]
                cmp     ebp, [ecx+4]
                jl      short loc_5C6365

loc_5C6360:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+15↑j
                call    sub_5C6F90
; ---------------------------------------------------------------------------

loc_5C6365:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+1E↑j
                mov     ebx, dword ptr [esp+34h+ExceptionRecord]
                mov     esi, 3
                mov     edi, 19930520h
                cmp     dword ptr [ebx], 0E06D7363h
                jnz     loc_5C65B6
                cmp     [ebx+10h], esi
                jnz     short loc_5C63EE
                cmp     [ebx+14h], edi
                jnz     short loc_5C63EE
                mov     eax, dword ptr [ebx+1Ch]
                test    eax, eax
                jnz     short loc_5C63EE
                call    __getptd
                mov     ecx, dword ptr [eax+6Ch]
                test    ecx, ecx
                jz      loc_5C65F3
                call    __getptd
                mov     ebx, dword ptr [eax+6Ch]
                mov     [esp+34h+ExceptionRecord], ebx
                call    __getptd
                mov     edx, dword ptr [eax+70h]
                push    1               ; ucb
                push    ebx             ; lp
                mov     [esp+3Ch+arg_8], edx
                call    ?_ValidateRead@@YAHPBXI@Z ; _ValidateRead(void const *,uint)
                add     esp, 8
                test    eax, eax
                jnz     short loc_5C63CC
                call    sub_5C6F90
; ---------------------------------------------------------------------------

loc_5C63CC:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+85↑j
                cmp     dword ptr [ebx], 0E06D7363h
                jnz     loc_5C65B6
                cmp     [ebx+10h], esi
                jnz     short loc_5C63EE
                cmp     [ebx+14h], edi
                jnz     short loc_5C63EE
                mov     eax, dword ptr [ebx+1Ch]
                test    eax, eax
                jnz     short loc_5C63EE
                call    sub_5C6F90
; ---------------------------------------------------------------------------

loc_5C63EE:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+42↑j
                cmp     dword ptr [ebx], 0E06D7363h
                jnz     loc_5C65B6
                cmp     [ebx+10h], esi
                jnz     loc_5C65B6
                cmp     [ebx+14h], edi
                jnz     loc_5C65B6
                mov     edx, dword ptr [esp+34h+arg_18]
                lea     eax, [esp+34h+var_C]
                lea     ecx, [esp+34h+var_20]
                push    eax             ; unsigned int *
                mov     eax, dword ptr [esp+38h+arg_10]
                push    ecx             ; unsigned int *
                push    ebp             ; int
                push    edx             ; int
                push    eax             ; struct _s_FuncInfo *
                call    ?_GetRangeOfTrysToCheck@@YAPBU_s_TryBlockMapEntry@@PBU_s_FuncInfo@@HHPAI1@Z ; _GetRangeOfTrysToCheck(_s_FuncInfo const *,int,int,uint *,uint *)
                mov     ecx, dword ptr [esp+48h+var_20]
                mov     edx, dword ptr [esp+48h+var_C]
                add     esp, 14h
                cmp     ecx, edx
                mov     [esp+34h+var_1C], eax
                jnb     loc_5C659B

loc_5C643D:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+255↓j
                cmp     [eax], ebp
                jg      loc_5C657F
                cmp     ebp, [eax+4]
                jg      loc_5C657F
                mov     ecx, dword ptr [eax+0Ch]
                mov     esi, [eax+10h]
                test    ecx, ecx
                mov     [esp+34h+var_24], esi
                mov     [esp+34h+var_14], ecx
                jle     loc_5C657B
                mov     eax, dword ptr [ebx+1Ch]
                mov     eax, dword ptr [eax+0Ch]
                lea     edx, [eax+4]
                mov     eax, dword ptr [eax]
                mov     [esp+34h+var_8], edx
                mov     [esp+34h+var_4], eax

loc_5C6477:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+1FE↓j
                mov     eax, dword ptr [esp+34h+var_4]
                mov     ebp, [esp+34h+var_8]
                test    eax, eax
                mov     [esp+34h+var_18], eax
                jle     loc_5C6530
                mov     edx, dword ptr [esi+4]

loc_5C648E:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+1E6↓j
                mov     edi, [ebp+0]
                test    edx, edx
                jz      short loc_5C650F
                mov     cl, [edx+8]
                lea     eax, [edx+8]
                test    cl, cl
                jz      short loc_5C650F
                mov     ecx, dword ptr [edi+4]
                cmp     edx, ecx
                jz      short loc_5C64EA
                lea     esi, [ecx+8]

loc_5C64A9:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+187↓j
                mov     bl, [eax]
                mov     cl, bl
                cmp     bl, [esi]
                jnz     short loc_5C64CD
                test    cl, cl
                jz      short loc_5C64C9
                mov     bl, [eax+1]
                mov     cl, bl
                cmp     bl, [esi+1]
                jnz     short loc_5C64CD
                add     eax, 2
                add     esi, 2
                test    cl, cl
                jnz     short loc_5C64A9

loc_5C64C9:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+173↑j
                xor     eax, eax
                jmp     short loc_5C64D2
; ---------------------------------------------------------------------------

loc_5C64CD:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+16F↑j
                sbb     eax, eax
                sbb     eax, 0FFFFFFFFh

loc_5C64D2:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+18B↑j
                test    eax, eax
                jz      short loc_5C64E2
                mov     ebx, dword ptr [esp+34h+ExceptionRecord]
                mov     esi, [esp+34h+var_24]
                xor     eax, eax
                jmp     short loc_5C6514
; ---------------------------------------------------------------------------

loc_5C64E2:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+194↑j
                mov     ebx, dword ptr [esp+34h+ExceptionRecord]
                mov     esi, [esp+34h+var_24]

loc_5C64EA:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+164↑j
                test    byte ptr [edi], 2
                jz      short loc_5C64F4
                test    byte ptr [esi], 8
                jz      short loc_5C650B

loc_5C64F4:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+1AD↑j
                mov     eax, dword ptr [ebx+1Ch]
                mov     eax, dword ptr [eax]
                test    al, 1
                jz      short loc_5C6502
                test    byte ptr [esi], 1
                jz      short loc_5C650B

loc_5C6502:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+1BB↑j
                test    al, 2
                jz      short loc_5C650F
                test    byte ptr [esi], 2
                jnz     short loc_5C650F

loc_5C650B:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+1B2↑j
                xor     eax, eax
                jmp     short loc_5C6514
; ---------------------------------------------------------------------------

loc_5C650F:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+153↑j
                mov     eax, 1

loc_5C6514:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+1A0↑j
                test    eax, eax
                jnz     short loc_5C6546
                mov     eax, dword ptr [esp+34h+var_18]
                add     ebp, 4
                dec     eax
                test    eax, eax
                mov     [esp+34h+var_18], eax
                jg      loc_5C648E
                mov     ecx, dword ptr [esp+34h+var_14]

loc_5C6530:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+145↑j
                dec     ecx
                add     esi, 10h
                test    ecx, ecx
                mov     [esp+34h+var_14], ecx
                mov     [esp+34h+var_24], esi
                jg      loc_5C6477
                jmp     short loc_5C6577
; ---------------------------------------------------------------------------

loc_5C6546:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+1D6↑j
                mov     ecx, dword ptr [esp+34h+TargetFrame]
                mov     edx, dword ptr [esp+34h+arg_18]
                mov     eax, dword ptr [esp+34h+var_1C]
                push    ecx             ; TargetFrame
                mov     ecx, dword ptr [ebp+0]
                push    edx             ; int
                mov     edx, dword ptr [esp+3Ch+arg_10]
                push    eax             ; struct _s_TryBlockMapEntry *
                mov     eax, dword ptr [esp+40h+arg_C]
                push    ecx             ; struct _s_CatchableType *
                mov     ecx, dword ptr [esp+44h+arg_8]
                push    esi             ; struct _s_HandlerType *
                push    edx             ; struct _s_FuncInfo *
                mov     edx, dword ptr [esp+4Ch+arg_4]
                push    eax             ; void *
                push    ecx             ; struct _CONTEXT *
                push    edx             ; struct EHRegistrationNode *
                push    ebx             ; ExceptionRecord
                call    ?CatchIt@@YAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAU_CONTEXT@@PAXPBU_s_FuncInfo@@PBU_s_HandlerType@@PBU_s_CatchableType@@PBU_s_TryBlockMapEntry@@H1@Z ; CatchIt(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,_s_HandlerType const *,_s_CatchableType const *,_s_TryBlockMapEntry const *,int,EHRegistrationNode *)
                add     esp, 28h

loc_5C6577:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+204↑j
                mov     ebp, [esp+34h+var_10]

loc_5C657B:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+11E↑j
                mov     eax, dword ptr [esp+34h+var_1C]

loc_5C657F:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+FF↑j
                mov     ecx, dword ptr [esp+34h+var_20]
                mov     edx, dword ptr [esp+34h+var_C]
                inc     ecx
                add     eax, 14h
                cmp     ecx, edx
                mov     [esp+34h+var_20], ecx
                mov     [esp+34h+var_1C], eax
                jb      loc_5C643D

loc_5C659B:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+F7↑j
                mov     al, [esp+34h+arg_14]
                test    al, al
                jz      short loc_5C65F3
                push    1               ; char
                push    ebx             ; struct EHExceptionRecord *
                call    ?_DestructExceptionObject@@YAXPAUEHExceptionRecord@@E@Z ; _DestructExceptionObject(EHExceptionRecord *,uchar)
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 24h
                retn
; ---------------------------------------------------------------------------

loc_5C65B6:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+39↑j
                mov     al, [esp+34h+arg_14]
                test    al, al
                jnz     short loc_5C65EE
                mov     eax, dword ptr [esp+34h+TargetFrame]
                mov     ecx, dword ptr [esp+34h+arg_18]
                mov     edx, dword ptr [esp+34h+arg_10]
                push    eax             ; TargetFrame
                mov     eax, dword ptr [esp+38h+arg_C]
                push    ecx             ; int
                mov     ecx, dword ptr [esp+3Ch+arg_8]
                push    ebp             ; int
                push    edx             ; struct _s_FuncInfo *
                mov     edx, dword ptr [esp+44h+arg_4]
                push    eax             ; void *
                push    ecx             ; struct _CONTEXT *
                push    edx             ; struct EHRegistrationNode *
                push    ebx             ; ExceptionRecord
                call    ?FindHandlerForForeignException@@YAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAU_CONTEXT@@PAXPBU_s_FuncInfo@@HH1@Z ; FindHandlerForForeignException(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,int,int,EHRegistrationNode *)
                add     esp, 20h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 24h
                retn
; ---------------------------------------------------------------------------

loc_5C65EE:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+27C↑j
                call    ?terminate@@YAXXZ ; terminate(void)
; ---------------------------------------------------------------------------

loc_5C65F3:                             ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+5A↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 24h
                retn
?FindHandler@@YAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAU_CONTEXT@@PAXPBU_s_FuncInfo@@EH1@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; void __cdecl FindHandlerForForeignException(PEXCEPTION_RECORD ExceptionRecord, struct EHRegistrationNode *, struct _CONTEXT *, void *, const struct _s_FuncInfo *, int, int, PVOID TargetFrame)
?FindHandlerForForeignException@@YAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAU_CONTEXT@@PAXPBU_s_FuncInfo@@HH1@Z proc near

var_8           = dword ptr -8
var_4           = dword ptr -4
ExceptionRecord = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h
arg_14          = dword ptr  18h
arg_18          = dword ptr  1Ch
TargetFrame     = dword ptr  20h

                sub     esp, 8
                push    ebx
                push    ebp
                push    esi
                push    edi
                call    __getptd
                mov     ecx, dword ptr [eax+68h]
                mov     ebp, [esp+18h+TargetFrame]
                mov     edi, [esp+18h+arg_18]
                mov     ebx, dword ptr [esp+18h+arg_10]
                test    ecx, ecx
                jz      short loc_5C6646
                mov     eax, dword ptr [esp+18h+arg_C]
                mov     ecx, dword ptr [esp+18h+arg_8]
                mov     edx, dword ptr [esp+18h+arg_4]
                push    ebp             ; struct EHRegistrationNode *
                push    edi             ; int
                push    ebx             ; struct _s_FuncInfo *
                push    eax             ; void *
                mov     eax, dword ptr [esp+28h+ExceptionRecord]
                push    ecx             ; void *
                push    edx             ; struct EHRegistrationNode *
                push    eax             ; struct EHExceptionRecord *
                call    ?_CallSETranslator@@YAHPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAX2PBU_s_FuncInfo@@H1@Z ; _CallSETranslator(EHExceptionRecord *,EHRegistrationNode *,void *,void *,_s_FuncInfo const *,int,EHRegistrationNode *)
                add     esp, 1Ch
                test    eax, eax
                jnz     loc_5C66CF

loc_5C6646:                             ; CODE XREF: FindHandlerForForeignException(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,int,int,EHRegistrationNode *)+1D↑j
                mov     eax, dword ptr [esp+18h+arg_14]
                lea     ecx, [esp+18h+var_4]
                lea     edx, [esp+18h+var_8]
                push    ecx             ; unsigned int *
                push    edx             ; unsigned int *
                push    eax             ; int
                push    edi             ; int
                push    ebx             ; struct _s_FuncInfo *
                call    ?_GetRangeOfTrysToCheck@@YAPBU_s_TryBlockMapEntry@@PBU_s_FuncInfo@@HHPAI1@Z ; _GetRangeOfTrysToCheck(_s_FuncInfo const *,int,int,uint *,uint *)
                mov     ecx, dword ptr [esp+2Ch+var_8]
                mov     esi, eax
                mov     eax, dword ptr [esp+2Ch+var_4]
                add     esp, 14h
                cmp     ecx, eax
                jnb     short loc_5C66CF

loc_5C666D:                             ; CODE XREF: FindHandlerForForeignException(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,int,int,EHRegistrationNode *)+CD↓j
                mov     eax, dword ptr [esp+18h+arg_14]
                mov     ecx, dword ptr [esi]
                cmp     eax, ecx
                jl      short loc_5C66BB
                cmp     eax, [esi+4]
                jg      short loc_5C66BB
                mov     edx, dword ptr [esi+0Ch]
                mov     eax, dword ptr [esi+10h]
                shl     edx, 4
                add     eax, edx
                mov     ecx, dword ptr [eax-0Ch]
                test    ecx, ecx
                jz      short loc_5C6695
                mov     dl, [ecx+8]
                test    dl, dl
                jnz     short loc_5C66BB

loc_5C6695:                             ; CODE XREF: FindHandlerForForeignException(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,int,int,EHRegistrationNode *)+8C↑j
                mov     ecx, dword ptr [esp+18h+arg_C]
                mov     edx, dword ptr [esp+18h+arg_8]
                push    ebp             ; TargetFrame
                push    edi             ; int
                push    esi             ; struct _s_TryBlockMapEntry *
                add     eax, 0FFFFFFF0h
                push    0               ; struct _s_CatchableType *
                push    eax             ; struct _s_HandlerType *
                mov     eax, dword ptr [esp+2Ch+arg_4]
                push    ebx             ; struct _s_FuncInfo *
                push    ecx             ; void *
                mov     ecx, dword ptr [esp+34h+ExceptionRecord]
                push    edx             ; struct _CONTEXT *
                push    eax             ; struct EHRegistrationNode *
                push    ecx             ; ExceptionRecord
                call    ?CatchIt@@YAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAU_CONTEXT@@PAXPBU_s_FuncInfo@@PBU_s_HandlerType@@PBU_s_CatchableType@@PBU_s_TryBlockMapEntry@@H1@Z ; CatchIt(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,_s_HandlerType const *,_s_CatchableType const *,_s_TryBlockMapEntry const *,int,EHRegistrationNode *)
                add     esp, 28h

loc_5C66BB:                             ; CODE XREF: FindHandlerForForeignException(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,int,int,EHRegistrationNode *)+75↑j
                mov     eax, dword ptr [esp+18h+var_8]
                mov     ecx, dword ptr [esp+18h+var_4]
                inc     eax
                add     esi, 14h
                cmp     eax, ecx
                mov     [esp+18h+var_8], eax
                jb      short loc_5C666D

loc_5C66CF:                             ; CODE XREF: FindHandlerForForeignException(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,int,int,EHRegistrationNode *)+40↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
?FindHandlerForForeignException@@YAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAU_CONTEXT@@PAXPBU_s_FuncInfo@@HH1@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

___FrameUnwindToState proc near         ; CODE XREF: __CxxLongjmpUnwind(x)+12↑p

var_1C          = dword ptr -1Ch
ms_exc          = CPPEH_RECORD ptr -18h
arg_0           = dword ptr  8
arg_8           = dword ptr  10h
arg_C           = dword ptr  14h

; __unwind { // __except_handler3
                push    ebp
                mov     ebp, esp
                push    0FFFFFFFFh
                push    offset stru_6145B8
                push    offset __except_handler3
                mov     eax, fs:0
                push    eax
                mov     fs:0, esp
                add     esp, 0FFFFFFF4h
                push    ebx
                push    esi
                push    edi
                mov     [ebp+ms_exc.old_esp], esp
                mov     ebx, dword ptr [ebp+arg_0]
                mov     esi, [ebx+8]
                mov     [ebp+var_1C], esi
                mov     edi, [ebp+arg_8]

loc_5C6712:                             ; CODE XREF: ___FrameUnwindToState+74↓j
                cmp     esi, [ebp+arg_C]
                jz      short loc_5C6781
                cmp     esi, 0FFFFFFFFh
                jle     short loc_5C6721
                cmp     esi, [edi+4]
                jl      short loc_5C6726

loc_5C6721:                             ; CODE XREF: ___FrameUnwindToState+3A↑j
                call    sub_5C6F90
; ---------------------------------------------------------------------------

loc_5C6726:                             ; CODE XREF: ___FrameUnwindToState+3F↑j
;   __try { // __except at loc_5C6763
                mov     [ebp+ms_exc.registration.TryLevel], 0
                mov     eax, dword ptr [edi+8]
                mov     eax, dword ptr [eax+esi*8+4]
                test    eax, eax
                jz      short loc_5C6744
                push    103h
                push    ebx
                push    eax
                call    __CallSettingFrame@12 ; _CallSettingFrame(x,x,x)
;   } // starts at 5C6726

loc_5C6744:                             ; CODE XREF: ___FrameUnwindToState+56↑j
                mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh
                mov     edx, dword ptr [edi+8]
                mov     esi, [edx+esi*8]
                mov     [ebp+var_1C], esi
                jmp     short loc_5C6712
; ---------------------------------------------------------------------------

loc_5C6756:                             ; DATA XREF: .rdata:stru_6145B8↓o
;   __except filter // owned by 5C6726
                mov     ecx, dword ptr [ebp+ms_exc.exc_ptr]
                push    ecx
                call    sub_5C67A0      ; ?FrameUnwindFilter@@YAHPAU_EXCEPTION_POINTERS@@@Z
                add     esp, 4
                retn
; ---------------------------------------------------------------------------

loc_5C6763:                             ; DATA XREF: .rdata:stru_6145B8↓o
;   __except(loc_5C6756) // owned by 5C6726
                mov     esp, [ebp+ms_exc.old_esp]
                mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh
                mov     edi, [ebp+arg_8]
                mov     ebx, dword ptr [ebp+arg_0]
                mov     esi, [ebp+var_1C]
                mov     edx, dword ptr [edi+8]
                mov     esi, [edx+esi*8]
                mov     [ebp+var_1C], esi
                jmp     short loc_5C6712
; ---------------------------------------------------------------------------

loc_5C6781:                             ; CODE XREF: ___FrameUnwindToState+35↑j
                mov     [ebx+8], esi
                mov     ecx, dword ptr [ebp+ms_exc.registration.Next]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn
; } // starts at 5C66E0
___FrameUnwindToState endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; ?FrameUnwindFilter@@YAHPAU_EXCEPTION_POINTERS@@@Z
; doubtful name
; Attributes: library function static

sub_5C67A0      proc near               ; CODE XREF: ___FrameUnwindToState+7A↑p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                mov     ecx, dword ptr [eax]
                cmp     dword ptr [ecx], 0E06D7363h
                jnz     short loc_5C67B3
                call    ?terminate@@YAXXZ ; terminate(void)
; ---------------------------------------------------------------------------

loc_5C67B3:                             ; CODE XREF: sub_5C67A0+C↑j
                xor     eax, eax
                retn
sub_5C67A0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; void __cdecl CatchIt(PEXCEPTION_RECORD ExceptionRecord, struct EHRegistrationNode *, struct _CONTEXT *, void *, const struct _s_FuncInfo *, const struct _s_HandlerType *, const struct _s_CatchableType *, const struct _s_TryBlockMapEntry *, int, PVOID TargetFrame)
?CatchIt@@YAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAU_CONTEXT@@PAXPBU_s_FuncInfo@@PBU_s_HandlerType@@PBU_s_CatchableType@@PBU_s_TryBlockMapEntry@@H1@Z proc near

ExceptionRecord = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h
arg_14          = dword ptr  18h
arg_18          = dword ptr  1Ch
arg_1C          = dword ptr  20h
arg_20          = dword ptr  24h
TargetFrame     = dword ptr  28h

                mov     eax, dword ptr [esp+arg_18]
                push    ebx
                push    ebp
                mov     ebp, [esp+8+ExceptionRecord]
                push    esi
                mov     esi, [esp+0Ch+arg_4]
                test    eax, eax
                push    edi
                jz      short loc_5C67E4
                push    eax             ; struct _s_CatchableType *
                mov     eax, dword ptr [esp+14h+arg_14]
                push    eax             ; struct _s_HandlerType *
                push    esi             ; struct EHRegistrationNode *
                push    ebp             ; struct EHExceptionRecord *
                call    ?BuildCatchObject@@YAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PBU_s_HandlerType@@PBU_s_CatchableType@@@Z ; BuildCatchObject(EHExceptionRecord *,EHRegistrationNode *,_s_HandlerType const *,_s_CatchableType const *)
                add     esp, 10h

loc_5C67E4:                             ; CODE XREF: CatchIt(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,_s_HandlerType const *,_s_CatchableType const *,_s_TryBlockMapEntry const *,int,EHRegistrationNode *)+12↑j
                mov     eax, dword ptr [esp+10h+TargetFrame]
                push    ebp             ; ExceptionRecord
                test    eax, eax
                jnz     short loc_5C67F0
                push    esi
                jmp     short loc_5C67F1
; ---------------------------------------------------------------------------

loc_5C67F0:                             ; CODE XREF: CatchIt(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,_s_HandlerType const *,_s_CatchableType const *,_s_TryBlockMapEntry const *,int,EHRegistrationNode *)+2B↑j
                push    eax             ; TargetFrame

loc_5C67F1:                             ; CODE XREF: CatchIt(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,_s_HandlerType const *,_s_CatchableType const *,_s_TryBlockMapEntry const *,int,EHRegistrationNode *)+2E↑j
                call    ?_UnwindNestedFrames@@YGXPAUEHRegistrationNode@@PAUEHExceptionRecord@@@Z ; _UnwindNestedFrames(EHRegistrationNode *,EHExceptionRecord *)
                mov     edi, [esp+10h+arg_1C]
                mov     ebx, dword ptr [esp+10h+arg_10]
                mov     edx, dword ptr [esp+10h+arg_C]
                mov     ecx, dword ptr [edi]
                push    ecx
                push    ebx
                push    edx
                push    esi
                call    ___FrameUnwindToState
                mov     eax, dword ptr [edi+4]
                mov     edx, dword ptr [esp+20h+arg_14]
                mov     ecx, dword ptr [esp+20h+arg_20]
                add     esp, 10h
                inc     eax
                mov     [esi+8], eax
                mov     eax, dword ptr [edx+0Ch]
                push    100h            ; unsigned int
                push    ecx             ; int
                mov     ecx, dword ptr [esp+18h+arg_8]
                push    eax             ; void *
                push    ebx             ; struct _s_FuncInfo *
                push    ecx             ; struct _CONTEXT *
                push    esi             ; struct EHRegistrationNode *
                push    ebp             ; struct EHExceptionRecord *
                call    ?CallCatchBlock@@YAPAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAU_CONTEXT@@PBU_s_FuncInfo@@PAXHK@Z ; CallCatchBlock(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,_s_FuncInfo const *,void *,int,ulong)
                add     esp, 1Ch
                test    eax, eax
                jz      short loc_5C6844
                push    esi             ; struct EHRegistrationNode *
                push    eax             ; void *
                call    ?_JumpToContinuation@@YGXPAXPAUEHRegistrationNode@@@Z ; _JumpToContinuation(void *,EHRegistrationNode *)

loc_5C6844:                             ; CODE XREF: CatchIt(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,_s_HandlerType const *,_s_CatchableType const *,_s_TryBlockMapEntry const *,int,EHRegistrationNode *)+7B↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
?CatchIt@@YAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAU_CONTEXT@@PAXPBU_s_FuncInfo@@PBU_s_HandlerType@@PBU_s_CatchableType@@PBU_s_TryBlockMapEntry@@H1@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static bp-based frame

; void *__cdecl CallCatchBlock(struct EHExceptionRecord *, struct EHRegistrationNode *, struct _CONTEXT *, const struct _s_FuncInfo *, void *, int, unsigned int)
?CallCatchBlock@@YAPAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAU_CONTEXT@@PBU_s_FuncInfo@@PAXHK@Z proc near

var_2C          = dword ptr -2Ch
var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = dword ptr -20h
var_1C          = dword ptr -1Ch
ms_exc          = CPPEH_RECORD ptr -18h
arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch
arg_8           = dword ptr  10h
arg_C           = dword ptr  14h
arg_10          = dword ptr  18h
arg_14          = dword ptr  1Ch
arg_18          = dword ptr  20h

; __unwind { // __except_handler3
                push    ebp
                mov     ebp, esp
                push    0FFFFFFFFh
                push    offset stru_6145C8
                push    offset __except_handler3
                mov     eax, fs:0
                push    eax
                mov     fs:0, esp
                add     esp, 0FFFFFFE4h
                push    ebx
                push    esi
                push    edi
                mov     [ebp+ms_exc.old_esp], esp
                mov     ebx, dword ptr [ebp+arg_10]
                mov     [ebp+var_2C], ebx
                mov     [ebp+var_24], 0
                mov     esi, [ebp+arg_4]
                mov     eax, dword ptr [esi-4]
                mov     [ebp+var_28], eax
                call    __getptd
                mov     ecx, dword ptr [eax+6Ch]
                mov     [ebp+var_1C], ecx
                call    __getptd
                mov     edx, dword ptr [eax+70h]
                mov     [ebp+var_20], edx
                call    __getptd
                mov     edi, [ebp+arg_0]
                mov     [eax+6Ch], edi
                call    __getptd
                mov     ecx, dword ptr [ebp+arg_8]
                mov     [eax+70h], ecx
;   __try { // __finally(loc_5C693F)
                mov     [ebp+ms_exc.registration.TryLevel], 0
;   } // starts at 5C68B8
;     __try { // __finally(loc_5C693F)
;   __try { // __except at loc_5C6914
                mov     [ebp+ms_exc.registration.TryLevel], 1
                mov     edx, dword ptr [ebp+arg_18]
                push    edx             ; unsigned int
                mov     eax, dword ptr [ebp+arg_14]
                push    eax             ; int
                push    ebx             ; void *
                mov     ecx, dword ptr [ebp+arg_C]
                push    ecx             ; struct _s_FuncInfo *
                push    esi             ; struct EHRegistrationNode *
                call    ?_CallCatchBlock2@@YAPAXPAUEHRegistrationNode@@PBU_s_FuncInfo@@PAXHK@Z ; _CallCatchBlock2(EHRegistrationNode *,_s_FuncInfo const *,void *,int,ulong)
                add     esp, 14h
                mov     ebx, eax
                mov     [ebp+var_2C], ebx
;   } // starts at 5C68BF
;     } // starts at 5C68BF
;   __try { // __finally(loc_5C693F)
                mov     [ebp+ms_exc.registration.TryLevel], 0
;   } // starts at 5C68E1
                mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh
                call    loc_5C6948
; ---------------------------------------------------------------------------

loc_5C68F4:                             ; CODE XREF: CallCatchBlock(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,_s_FuncInfo const *,void *,int,ulong):loc_5C6995↓j
                mov     eax, ebx
                mov     ecx, dword ptr [ebp+ms_exc.registration.Next]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_5C6907:                             ; DATA XREF: .rdata:stru_6145C8↓o
;   __except filter // owned by 5C68BF
                mov     edx, dword ptr [ebp+ms_exc.exc_ptr]
                push    edx             ; struct _EXCEPTION_POINTERS *
                call    ?ExFilterRethrow@@YAHPAU_EXCEPTION_POINTERS@@@Z ; ExFilterRethrow(_EXCEPTION_POINTERS *)
                add     esp, 4
                retn
; ---------------------------------------------------------------------------

loc_5C6914:                             ; DATA XREF: .rdata:stru_6145C8↓o
;   __except(loc_5C6907) // owned by 5C68BF
                mov     esp, [ebp+ms_exc.old_esp]
                mov     [ebp+var_2C], 0
                push    0FFFFFFFFh
                lea     eax, [ebp+ms_exc.registration]
                push    eax
                call    __local_unwind2
                add     esp, 8
                xor     eax, eax
                mov     ecx, dword ptr [ebp+ms_exc.registration.Next]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_5C693F:                             ; DATA XREF: .rdata:stru_6145C8↓o
;   __finally // owned by 5C68B8
;   __finally // owned by 5C68BF
;   __finally // owned by 5C68E1
                mov     esi, [ebp+arg_4]
                mov     edi, [ebp+arg_0]
                mov     ebx, dword ptr [ebp+var_2C]

loc_5C6948:                             ; CODE XREF: CallCatchBlock(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,_s_FuncInfo const *,void *,int,ulong)+9F↑j
                mov     ecx, dword ptr [ebp+var_28]
                mov     [esi-4], ecx
                call    __getptd
                mov     edx, dword ptr [ebp+var_1C]
                mov     [eax+6Ch], edx
                call    __getptd
                mov     ecx, dword ptr [ebp+var_20]
                mov     [eax+70h], ecx
                cmp     dword ptr [edi], 0E06D7363h
                jnz     short loc_5C6995
                cmp     dword ptr [edi+10h], 3
                jnz     short loc_5C6995
                cmp     dword ptr [edi+14h], 19930520h
                jnz     short loc_5C6995
                mov     eax, dword ptr [ebp+var_24]
                test    eax, eax
                jnz     short loc_5C6995
                test    ebx, ebx
                jz      short loc_5C6995
                call    __abnormal_termination
                push    eax             ; char
                push    edi             ; struct EHExceptionRecord *
                call    ?_DestructExceptionObject@@YAXPAUEHExceptionRecord@@E@Z ; _DestructExceptionObject(EHExceptionRecord *,uchar)
                add     esp, 8

loc_5C6995:                             ; CODE XREF: CallCatchBlock(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,_s_FuncInfo const *,void *,int,ulong)+11A↑j
                retn
; } // starts at 5C6850
?CallCatchBlock@@YAPAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PAU_CONTEXT@@PBU_s_FuncInfo@@PAXHK@Z endp

; ---------------------------------------------------------------------------
                mov     eax, ebx
                mov     ecx, dword ptr [ebp-10h]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl ExFilterRethrow(struct _EXCEPTION_POINTERS *)
?ExFilterRethrow@@YAHPAU_EXCEPTION_POINTERS@@@Z proc near

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                mov     eax, dword ptr [eax]
                cmp     dword ptr [eax], 0E06D7363h
                jnz     short loc_5C69DA
                cmp     dword ptr [eax+10h], 3
                jnz     short loc_5C69DA
                cmp     dword ptr [eax+14h], 19930520h
                jnz     short loc_5C69DA
                mov     ecx, dword ptr [eax+1Ch]
                test    ecx, ecx
                jnz     short loc_5C69DA
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5C69DA:                             ; CODE XREF: ExFilterRethrow(_EXCEPTION_POINTERS *)+C↑j
                xor     eax, eax
                retn
?ExFilterRethrow@@YAHPAU_EXCEPTION_POINTERS@@@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static bp-based frame

; void __cdecl BuildCatchObject(struct EHExceptionRecord *, struct EHRegistrationNode *, const struct _s_HandlerType *, const struct _s_CatchableType *)
?BuildCatchObject@@YAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PBU_s_HandlerType@@PBU_s_CatchableType@@@Z proc near

ms_exc          = CPPEH_RECORD ptr -18h
arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch
arg_8           = dword ptr  10h
arg_C           = dword ptr  14h

; __unwind { // __except_handler3
                push    ebp
                mov     ebp, esp
                push    0FFFFFFFFh
                push    offset stru_6145E0
                push    offset __except_handler3
                mov     eax, fs:0
                push    eax
                mov     fs:0, esp
                add     esp, 0FFFFFFF4h
                push    ebx
                push    esi
                push    edi
                mov     [ebp+ms_exc.old_esp], esp
                mov     ecx, dword ptr [ebp+arg_8]
                mov     eax, dword ptr [ecx+4]
                test    eax, eax
                jz      loc_5C6BD0
                mov     dl, [eax+8]
                test    dl, dl
                jz      loc_5C6BD0
                mov     eax, dword ptr [ecx+8]
                test    eax, eax
                jz      loc_5C6BD0
                mov     edx, dword ptr [ebp+arg_4]
                lea     esi, [edx+eax+0Ch]
;   __try { // __except at loc_5C6BC1
                mov     [ebp+ms_exc.registration.TryLevel], 0
                test    byte ptr [ecx], 8
                jz      short loc_5C6A85
                mov     edi, [ebp+arg_0]
                push    1               ; ucb
                mov     eax, dword ptr [edi+18h]
                push    eax             ; lp
                call    ?_ValidateRead@@YAHPBXI@Z ; _ValidateRead(void const *,uint)
                add     esp, 8
                test    eax, eax
                jz      loc_5C6BB4
                push    1               ; ucb
                push    esi             ; lp
                call    ?_ValidateWrite@@YAHPAXI@Z ; _ValidateWrite(void *,uint)
                add     esp, 8
                test    eax, eax
                jz      loc_5C6BB4
                mov     eax, dword ptr [edi+18h]
                mov     [esi], eax
                mov     ecx, dword ptr [ebp+arg_C]
                add     ecx, 8
                push    ecx             ; struct PMD *
                push    eax             ; void *
                call    ?AdjustPointer@@YAPAXPAXABUPMD@@@Z ; AdjustPointer(void *,PMD const &)
                add     esp, 8
                mov     [esi], eax
                jmp     loc_5C6BC9
; ---------------------------------------------------------------------------

loc_5C6A85:                             ; CODE XREF: BuildCatchObject(EHExceptionRecord *,EHRegistrationNode *,_s_HandlerType const *,_s_CatchableType const *)+5B↑j
                mov     edi, [ebp+arg_C]
                test    byte ptr [edi], 1
                jz      short loc_5C6AF2
                mov     ebx, dword ptr [ebp+arg_0]
                push    1               ; ucb
                mov     edx, dword ptr [ebx+18h]
                push    edx             ; lp
                call    ?_ValidateRead@@YAHPBXI@Z ; _ValidateRead(void const *,uint)
                add     esp, 8
                test    eax, eax
                jz      loc_5C6BB4
                push    1               ; ucb
                push    esi             ; lp
                call    ?_ValidateWrite@@YAHPAXI@Z ; _ValidateWrite(void *,uint)
                add     esp, 8
                test    eax, eax
                jz      loc_5C6BB4
                mov     eax, dword ptr [edi+14h]
                push    eax             ; varSize
                mov     ecx, dword ptr [ebx+18h]
                push    ecx             ; Src
                push    esi             ; void *
                call    _memcpy_0
                add     esp, 0Ch
                cmp     dword ptr [edi+14h], 4
                jnz     loc_5C6BC9
                mov     eax, dword ptr [esi]
                test    eax, eax
                jz      loc_5C6BC9
                add     edi, 8
                push    edi             ; struct PMD *
                push    eax             ; void *
                call    ?AdjustPointer@@YAPAXPAXABUPMD@@@Z ; AdjustPointer(void *,PMD const &)
                add     esp, 8
                mov     [esi], eax
                jmp     loc_5C6BC9
; ---------------------------------------------------------------------------

loc_5C6AF2:                             ; CODE XREF: BuildCatchObject(EHExceptionRecord *,EHRegistrationNode *,_s_HandlerType const *,_s_CatchableType const *)+AB↑j
                mov     eax, dword ptr [edi+18h]
                test    eax, eax
                mov     ebx, dword ptr [ebp+arg_0]
                push    1               ; ucb
                mov     edx, dword ptr [ebx+18h]
                push    edx             ; lp
                jnz     short loc_5C6B48
                call    ?_ValidateRead@@YAHPBXI@Z ; _ValidateRead(void const *,uint)
                add     esp, 8
                test    eax, eax
                jz      loc_5C6BB4
                push    1               ; ucb
                push    esi             ; lp
                call    ?_ValidateWrite@@YAHPAXI@Z ; _ValidateWrite(void *,uint)
                add     esp, 8
                test    eax, eax
                jz      loc_5C6BB4
                mov     eax, dword ptr [edi+14h]
                push    eax             ; varSize
                add     edi, 8
                push    edi             ; struct PMD *
                mov     ecx, dword ptr [ebx+18h]
                push    ecx             ; void *
                call    ?AdjustPointer@@YAPAXPAXABUPMD@@@Z ; AdjustPointer(void *,PMD const &)
                add     esp, 8
                push    eax             ; Src
                push    esi             ; void *
                call    _memcpy_0
                add     esp, 0Ch
                jmp     loc_5C6BC9
; ---------------------------------------------------------------------------

loc_5C6B48:                             ; CODE XREF: BuildCatchObject(EHExceptionRecord *,EHRegistrationNode *,_s_HandlerType const *,_s_CatchableType const *)+120↑j
                call    ?_ValidateRead@@YAHPBXI@Z ; _ValidateRead(void const *,uint)
                add     esp, 8
                test    eax, eax
                jz      short loc_5C6BB4
                push    1               ; ucb
                push    esi             ; lp
                call    ?_ValidateWrite@@YAHPAXI@Z ; _ValidateWrite(void *,uint)
                add     esp, 8
                test    eax, eax
                jz      short loc_5C6BB4
                mov     eax, dword ptr [edi+18h]
                push    eax             ; lpfn
                call    ?_ValidateExecute@@YAHP6GHXZ@Z ; _ValidateExecute(int (*)(void))
                add     esp, 4
                test    eax, eax
                jz      short loc_5C6BB4
                test    byte ptr [edi], 4
                jz      short loc_5C6B97
                push    1
                lea     ecx, [edi+8]
                push    ecx             ; struct PMD *
                mov     edx, dword ptr [ebx+18h]
                push    edx             ; void *
                call    ?AdjustPointer@@YAPAXPAXABUPMD@@@Z ; AdjustPointer(void *,PMD const &)
                add     esp, 8
                push    eax
                mov     eax, dword ptr [edi+18h]
                push    eax
                push    esi
                call    sub_5BE5E0      ; ?_CallMemberFunction0@@YGXPAX0@Z
                jmp     short loc_5C6BC9
; ---------------------------------------------------------------------------

loc_5C6B97:                             ; CODE XREF: BuildCatchObject(EHExceptionRecord *,EHRegistrationNode *,_s_HandlerType const *,_s_CatchableType const *)+196↑j
                lea     ecx, [edi+8]
                push    ecx             ; struct PMD *
                mov     edx, dword ptr [ebx+18h]
                push    edx             ; void *
                call    ?AdjustPointer@@YAPAXPAXABUPMD@@@Z ; AdjustPointer(void *,PMD const &)
                add     esp, 8
                push    eax
                mov     eax, dword ptr [edi+18h]
                push    eax
                push    esi
                call    sub_5BE5D0      ; ?_CallMemberFunction0@@YGXPAX0@Z
                jmp     short loc_5C6BC9
; ---------------------------------------------------------------------------

loc_5C6BB4:                             ; CODE XREF: BuildCatchObject(EHExceptionRecord *,EHRegistrationNode *,_s_HandlerType const *,_s_CatchableType const *)+70↑j
                call    sub_5C6F90
; ---------------------------------------------------------------------------
                jmp     short loc_5C6BC9
; ---------------------------------------------------------------------------

loc_5C6BBB:                             ; DATA XREF: .rdata:stru_6145E0↓o
;   __except filter // owned by 5C6A31
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5C6BC1:                             ; DATA XREF: .rdata:stru_6145E0↓o
;   __except(loc_5C6BBB) // owned by 5C6A31
                mov     esp, [ebp+ms_exc.old_esp]
                call    ?terminate@@YAXXZ ; terminate(void)
;   } // starts at 5C6A31
; ---------------------------------------------------------------------------

loc_5C6BC9:                             ; CODE XREF: BuildCatchObject(EHExceptionRecord *,EHRegistrationNode *,_s_HandlerType const *,_s_CatchableType const *)+A0↑j
                mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh

loc_5C6BD0:                             ; CODE XREF: BuildCatchObject(EHExceptionRecord *,EHRegistrationNode *,_s_HandlerType const *,_s_CatchableType const *)+2E↑j
                mov     ecx, dword ptr [ebp+ms_exc.registration.Next]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn
; } // starts at 5C69E0
?BuildCatchObject@@YAXPAUEHExceptionRecord@@PAUEHRegistrationNode@@PBU_s_HandlerType@@PBU_s_CatchableType@@@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; void __cdecl _DestructExceptionObject(struct EHExceptionRecord *, char)
?_DestructExceptionObject@@YAXPAUEHExceptionRecord@@E@Z proc near

ms_exc          = CPPEH_RECORD ptr -18h
arg_0           = dword ptr  8
arg_4           = byte ptr  0Ch

; __unwind { // __except_handler3
                push    ebp
                mov     ebp, esp
                push    0FFFFFFFFh
                push    offset stru_6145F0
                push    offset __except_handler3
                mov     eax, fs:0
                push    eax
                mov     fs:0, esp
                sub     esp, 8
                push    ebx
                push    esi
                push    edi
                mov     [ebp+ms_exc.old_esp], esp
                mov     ecx, dword ptr [ebp+arg_0]
                test    ecx, ecx
                jz      short loc_5C6C54
                mov     eax, dword ptr [ecx+1Ch]
                mov     eax, dword ptr [eax+4]
                test    eax, eax
                jz      short loc_5C6C54
;   __try { // __except at loc_5C6C45
                mov     [ebp+ms_exc.registration.TryLevel], 0
                push    eax
                mov     ecx, dword ptr [ecx+18h]
                push    ecx
                call    sub_5BE5C0      ; ?_CallMemberFunction0@@YGXPAX0@Z
                jmp     short loc_5C6C4D
; ---------------------------------------------------------------------------

loc_5C6C3A:                             ; DATA XREF: .rdata:stru_6145F0↓o
;   __except filter // owned by 5C6C27
                xor     eax, eax
                mov     cl, [ebp+arg_4]
                test    cl, cl
                setnz   al
                retn
; ---------------------------------------------------------------------------

loc_5C6C45:                             ; DATA XREF: .rdata:stru_6145F0↓o
;   __except(loc_5C6C3A) // owned by 5C6C27
                mov     esp, [ebp+ms_exc.old_esp]
                call    ?terminate@@YAXXZ ; terminate(void)
;   } // starts at 5C6C27
; ---------------------------------------------------------------------------

loc_5C6C4D:                             ; CODE XREF: _DestructExceptionObject(EHExceptionRecord *,uchar)+48↑j
                mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh

loc_5C6C54:                             ; CODE XREF: _DestructExceptionObject(EHExceptionRecord *,uchar)+2B↑j
                mov     ecx, dword ptr [ebp+ms_exc.registration.Next]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn
; } // starts at 5C6BF0
?_DestructExceptionObject@@YAXPAUEHExceptionRecord@@E@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; void *__cdecl AdjustPointer(void *, const struct PMD *)
?AdjustPointer@@YAPAXPAXABUPMD@@@Z proc near

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     edx, dword ptr [esp+arg_4]
                push    esi
                mov     esi, [esp+4+arg_0]
                mov     ecx, dword ptr [edx]
                mov     eax, esi
                add     eax, ecx
                mov     ecx, dword ptr [edx+4]
                test    ecx, ecx
                jl      short loc_5C6C93
                mov     esi, [esi+ecx]
                mov     edx, dword ptr [edx+8]
                mov     edx, dword ptr [esi+edx]
                add     edx, ecx
                add     eax, edx

loc_5C6C93:                             ; CODE XREF: AdjustPointer(void *,PMD const &)+14↑j
                pop     esi
                retn
?AdjustPointer@@YAPAXPAXABUPMD@@@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; __stdcall _CallSettingFrame(x, x, x)
__CallSettingFrame@12 proc near         ; CODE XREF: _CallCatchBlock2(EHRegistrationNode *,_s_FuncInfo const *,void *,int,ulong)+45↑p

var_4           = dword ptr -4
arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch
arg_8           = dword ptr  10h

                push    ebp
                mov     ebp, esp
                sub     esp, 4
                push    ebx
                push    ecx
                mov     eax, dword ptr [ebp+arg_4]
                add     eax, 0Ch
                mov     [ebp+var_4], eax
                mov     eax, dword ptr [ebp+arg_0]
                push    ebp
                push    [ebp+arg_8]
                mov     ecx, dword ptr [ebp+arg_8]
                mov     ebp, [ebp+var_4]
                call    __NLG_Notify1
                push    esi
                push    edi
                call    eax

__NLG_Return:
                pop     edi
                pop     esi
                mov     ebx, ebp
                pop     ebp
                mov     ecx, dword ptr [ebp+arg_8]
                push    ebp
                mov     ebp, ebx
                cmp     ecx, 100h
                jnz     short _NLG_Continue
                mov     ecx, 2

_NLG_Continue:                          ; CODE XREF: _CallSettingFrame(x,x,x)+38↑j
                push    ecx
                call    __NLG_Notify1
                pop     ebp
                pop     ecx
                pop     ebx
                leave
                retn    0Ch
__CallSettingFrame@12 endp

; ---------------------------------------------------------------------------
                align 10h





; ---------------------------------------------------------------------------
                align 10h
                jmp     ds:GetCurrentThreadId
; ---------------------------------------------------------------------------
                align 10h
                jmp     ds:GetCurrentThread
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn bp-based frame

; void __cdecl __noreturn terminate()
?terminate@@YAXXZ proc near             ; CODE XREF: sub_5C01C0+E↑p

ms_exc          = CPPEH_RECORD ptr -18h

; __unwind { // __except_handler3
                push    ebp
                mov     ebp, esp
                push    0FFFFFFFFh
                push    offset stru_614600
                push    offset __except_handler3
                mov     eax, fs:0
                push    eax
                mov     fs:0, esp
                sub     esp, 8
                push    ebx
                push    esi
                push    edi
                mov     [ebp+ms_exc.old_esp], esp
;   __try { // __finally(loc_5C6F57)
                mov     [ebp+ms_exc.registration.TryLevel], 0
                call    __getptd
                mov     ecx, dword ptr [eax+60h]
                test    ecx, ecx
                jz      short loc_5C6F3A
;   } // starts at 5C6F06
;     __try { // __finally(loc_5C6F57)
;   __try { // __except at loc_5C6F30
                mov     [ebp+ms_exc.registration.TryLevel], 1
                call    __getptd
                call    dword ptr [eax+60h]
                jmp     short loc_5C6F33
; ---------------------------------------------------------------------------

loc_5C6F2A:                             ; DATA XREF: .rdata:stru_614600↓o
;   __except filter // owned by 5C6F19
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5C6F30:                             ; DATA XREF: .rdata:stru_614600↓o
;   __except(loc_5C6F2A) // owned by 5C6F19
                mov     esp, [ebp+ms_exc.old_esp]
;   } // starts at 5C6F19
;     } // starts at 5C6F19

loc_5C6F33:                             ; CODE XREF: terminate(void)+48↑j
;   __try { // __finally(loc_5C6F57)
                mov     [ebp+ms_exc.registration.TryLevel], 0
;   } // starts at 5C6F33

loc_5C6F3A:                             ; CODE XREF: terminate(void)+37↑j
                mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh
                call    loc_5C6F57
; ---------------------------------------------------------------------------

loc_5C6F46:                             ; CODE XREF: terminate(void)+7C↓j
                mov     ecx, dword ptr [ebp+ms_exc.registration.Next]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_5C6F57:                             ; CODE XREF: terminate(void)+61↑j
;   __finally // owned by 5C6F06
;   __finally // owned by 5C6F19
;   __finally // owned by 5C6F33
                call    _abort
; ---------------------------------------------------------------------------
                retn
; } // starts at 5C6EE0
?terminate@@YAXXZ endp

; ---------------------------------------------------------------------------
                mov     ecx, dword ptr [ebp-10h]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn

; void __cdecl __noreturn unexpected()
?unexpected@@YAXXZ proc near
                call    __getptd
                mov     ecx, dword ptr [eax+64h]
                test    ecx, ecx
                jz      short loc_5C6F84
                call    __getptd
                call    dword ptr [eax+64h]

loc_5C6F84:                             ; CODE XREF: unexpected(void)+A↑j
                jmp     ?terminate@@YAXXZ ; terminate(void)
?unexpected@@YAXXZ endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: noreturn bp-based frame

sub_5C6F90      proc near               ; CODE XREF: _GetRangeOfTrysToCheck(_s_FuncInfo const *,int,int,uint *,uint *)+24↑p

ms_exc          = CPPEH_RECORD ptr -18h

; __unwind { // __except_handler3
                push    ebp
                mov     ebp, esp
                push    0FFFFFFFFh
                push    offset stru_614618
                push    offset __except_handler3
                mov     eax, fs:0
                push    eax
                mov     fs:0, esp
                sub     esp, 8
                push    ebx
                push    esi
                push    edi
                mov     [ebp+ms_exc.old_esp], esp
;   __try { // __finally(loc_5C6FFE)
                mov     [ebp+ms_exc.registration.TryLevel], 0
                mov     eax, off_63F124
                test    eax, eax
                jz      short loc_5C6FE1
;   } // starts at 5C6FB6
;     __try { // __finally(loc_5C6FFE)
;   __try { // __except at loc_5C6FD7
                mov     [ebp+ms_exc.registration.TryLevel], 1
                call    eax ; terminate(void) ; terminate(void)
; ---------------------------------------------------------------------------
                db 0EBh
                db    9
; ---------------------------------------------------------------------------

loc_5C6FD1:                             ; DATA XREF: .rdata:stru_614618↓o
;   __except filter // owned by 5C6FC6
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5C6FD7:                             ; DATA XREF: .rdata:stru_614618↓o
;   __except(loc_5C6FD1) // owned by 5C6FC6
                mov     esp, [ebp+ms_exc.old_esp]
;   } // starts at 5C6FC6
;     } // starts at 5C6FC6
;   __try { // __finally(loc_5C6FFE)
                mov     [ebp+ms_exc.registration.TryLevel], 0
;   } // starts at 5C6FDA

loc_5C6FE1:                             ; CODE XREF: sub_5C6F90+34↑j
                mov     [ebp+ms_exc.registration.TryLevel], 0FFFFFFFFh
                call    loc_5C6FFE
; ---------------------------------------------------------------------------
                db  8Bh
                db  4Dh ; M
                db 0F0h
                db  64h ; d
                db  89h
                db  0Dh
                db    0
                db    0
                db    0
                db    0
                db  5Fh ; _
                db  5Eh ; ^
                db  5Bh ; [
                db  8Bh
                db 0E5h
                db  5Dh ; ]
                db 0C3h
; ---------------------------------------------------------------------------

loc_5C6FFE:                             ; CODE XREF: sub_5C6F90+58↑j
;   __finally // owned by 5C6FB6
;   __finally // owned by 5C6FC6
;   __finally // owned by 5C6FDA
                call    ?terminate@@YAXXZ ; terminate(void)
; ---------------------------------------------------------------------------
                db 0C3h
; } // starts at 5C6F90
sub_5C6F90      endp

; ---------------------------------------------------------------------------
                mov     ecx, dword ptr [ebp-10h]
                mov     fs:0, ecx
                pop     edi
                pop     esi
                pop     ebx
                mov     esp, ebp
                pop     ebp
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__setdefaultprecision proc near         ; CODE XREF: __fpmath+F↑p
                push    30000h          ; Mask
                push    10000h          ; NewValue
                call    __controlfp
                add     esp, 8
                retn
__setdefaultprecision endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

__ms_p5_test_fdiv proc near             ; CODE XREF: __ms_p5_mp_test_fdiv:loc_5C70B4↓j

var_18          = qword ptr -18h
var_10          = qword ptr -10h
var_8           = qword ptr -8

                push    ebp
                mov     ebp, esp
                sub     esp, 18h
                mov     dword ptr [ebp+var_8], 80000000h
                mov     dword ptr [ebp+var_8+4], 4147FFFFh
                mov     dword ptr [ebp+var_10], 0C0000000h
                mov     dword ptr [ebp+var_10+4], 4150017Eh
                fld     [ebp+var_10]
                fdiv    [ebp+var_8]
                fmul    [ebp+var_8]
                fsubr   [ebp+var_10]
                fstp    [ebp+var_18]
                fld     [ebp+var_18]
                fcomp   qword ptr [dbl_614630]
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5C708A
                mov     eax, 1
                mov     esp, ebp
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_5C708A:                             ; CODE XREF: __ms_p5_test_fdiv+3F↑j
                xor     eax, eax
                mov     esp, ebp
                pop     ebp
                retn
__ms_p5_test_fdiv endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__ms_p5_mp_test_fdiv proc near          ; CODE XREF: __fpmath+5↑p
                push    offset ModuleName ; "KERNEL32"
                call    GetModuleHandleA
                test    eax, eax
                jz      short loc_5C70B4
                push    offset ProcName ; "IsProcessorFeaturePresent"
                push    eax             ; hModule
                call    GetProcAddress
                test    eax, eax
                jz      short loc_5C70B4
                push    0
                call    eax
                retn
; ---------------------------------------------------------------------------

loc_5C70B4:                             ; CODE XREF: __ms_p5_mp_test_fdiv+D↑j
                jmp     __ms_p5_test_fdiv
__ms_p5_mp_test_fdiv endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__forcdecpt     proc near               ; DATA XREF: __cfltcvt_init_0+1E↑o

arg_0           = dword ptr  4

                push    esi
                mov     esi, [esp+4+arg_0]
                movsx   eax, byte ptr [esi]
                push    eax             ; C
                call    _tolower
                add     esp, 4
                cmp     eax, 65h ; 'e'
                jz      short loc_5C7103

loc_5C70D6:                             ; CODE XREF: __forcdecpt+41↓j
                mov     eax, [g_SrcSizeInBytes]
                inc     esi
                cmp     eax, 1
                jle     short loc_5C70F1
                movsx   ecx, byte ptr [esi]
                push    4               ; Type
                push    ecx             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5C70FF
; ---------------------------------------------------------------------------

loc_5C70F1:                             ; CODE XREF: __forcdecpt+1F↑j
                movsx   edx, byte ptr [esi]
                mov     eax, off_641268
                mov     al, [eax+edx*2]
                and     eax, 4

loc_5C70FF:                             ; CODE XREF: __forcdecpt+2F↑j
                test    eax, eax
                jnz     short loc_5C70D6

loc_5C7103:                             ; CODE XREF: __forcdecpt+14↑j
                mov     cl, byte_641478
                mov     al, [esi]
                mov     [esi], cl
                inc     esi

loc_5C710E:                             ; CODE XREF: __forcdecpt+59↓j
                mov     cl, [esi]
                mov     [esi], al
                mov     dl, [esi]
                inc     esi
                test    dl, dl
                mov     al, cl
                jnz     short loc_5C710E
                pop     esi
                retn
__forcdecpt     endp

; ---------------------------------------------------------------------------
                align 10h

__cropzeros:                            ; DATA XREF: __cfltcvt_init_0+5↑o
                mov     eax, dword ptr [esp+4]
                push    ebx
                mov     bl, byte_641478
                mov     cl, [eax]
                test    cl, cl
                jz      short loc_5C713D

loc_5C7131:                             ; CODE XREF: .text:005C713B↓j
                cmp     cl, bl
                jz      short loc_5C713D
                mov     cl, [eax+1]
                inc     eax
                test    cl, cl
                jnz     short loc_5C7131

loc_5C713D:                             ; CODE XREF: .text:005C712F↑j
                mov     cl, [eax]
                inc     eax
                test    cl, cl
                jz      short loc_5C7189
                mov     cl, [eax]
                test    cl, cl
                jz      short loc_5C715C

loc_5C714A:                             ; CODE XREF: .text:005C715A↓j
                cmp     cl, 65h ; 'e'
                jz      short loc_5C715C
                cmp     cl, 45h ; 'E'
                jz      short loc_5C715C
                mov     cl, [eax+1]
                inc     eax
                test    cl, cl
                jnz     short loc_5C714A

loc_5C715C:                             ; CODE XREF: .text:005C7148↑j
                mov     cl, [eax-1]
                mov     edx, eax
                dec     eax
                cmp     cl, 30h ; '0'
                jnz     short loc_5C7170

loc_5C7167:                             ; CODE XREF: .text:005C716E↓j
                mov     cl, [eax-1]
                dec     eax
                cmp     cl, 30h ; '0'
                jz      short loc_5C7167

loc_5C7170:                             ; CODE XREF: .text:005C7165↑j
                cmp     [eax], bl
                jnz     short loc_5C7175
                dec     eax

loc_5C7175:                             ; CODE XREF: .text:005C7172↑j
                mov     cl, [edx]
                inc     eax
                inc     edx
                test    cl, cl
                mov     [eax], cl
                jz      short loc_5C7189

loc_5C717F:                             ; CODE XREF: .text:005C7187↓j
                mov     cl, [edx]
                inc     eax
                inc     edx
                test    cl, cl
                mov     [eax], cl
                jnz     short loc_5C717F

loc_5C7189:                             ; CODE XREF: .text:005C7142↑j
                pop     ebx
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__positive      proc near               ; DATA XREF: __cfltcvt_init_0+28↑o

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                fld     qword ptr [eax]
                fcomp   qword ptr [dbl_614660]
                fnstsw  ax
                test    ah, 1
                jnz     short loc_5C71A9
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5C71A9:                             ; CODE XREF: __positive+11↑j
                xor     eax, eax
                retn
__positive      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__fassign       proc near               ; DATA XREF: __cfltcvt_init_0+14↑o

var_8           = dword ptr -8
var_4           = dword ptr -4
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                mov     eax, dword ptr [esp+arg_0]
                sub     esp, 8
                test    eax, eax
                jz      short loc_5C71E2
                mov     eax, dword ptr [esp+8+arg_8]
                lea     ecx, [esp+8+var_8]
                push    eax
                push    ecx
                call    sub_5CFFC0
                mov     eax, dword ptr [esp+10h+arg_4]
                mov     edx, dword ptr [esp+10h+var_8]
                mov     ecx, dword ptr [esp+10h+var_4]
                add     esp, 8
                mov     [eax], edx
                mov     [eax+4], ecx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5C71E2:                             ; CODE XREF: __fassign+9↑j
                mov     edx, dword ptr [esp+8+arg_8]
                lea     eax, [esp+8+arg_8]
                push    edx
                push    eax
                call    sub_5D0040
                mov     ecx, dword ptr [esp+10h+arg_4]
                mov     edx, dword ptr [esp+10h+arg_8]
                add     esp, 8
                mov     [ecx], edx
                add     esp, 8
                retn
__fassign       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__cftoe         proc near               ; CODE XREF: __cfltcvt+5C↓p

var_28          = dword ptr -28h
var_18          = byte ptr -18h
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                sub     esp, 28h
                lea     eax, [esp+28h+var_18]
                lea     ecx, [esp+28h+var_28]
                push    esi
                push    edi
                push    eax
                mov     eax, dword ptr [esp+34h+arg_0]
                push    ecx
                mov     edx, dword ptr [eax+4]
                mov     eax, dword ptr [eax]
                push    edx
                push    eax
                call    __fltout2
                mov     esi, [esp+40h+arg_8]
                mov     edi, [esp+40h+arg_4]
                add     esp, 10h
                lea     ecx, [esp+30h+var_28]
                lea     edx, [esi+1]
                xor     eax, eax
                push    ecx
                push    edx
                mov     edx, dword ptr [esp+38h+var_28]
                test    esi, esi
                setnle  al
                xor     ecx, ecx
                cmp     edx, 2Dh ; '-'
                mov     edx, edi
                setz    cl
                add     edx, eax
                add     ecx, edx
                push    ecx
                call    __fptostr
                mov     ecx, dword ptr [esp+3Ch+arg_C]
                add     esp, 0Ch
                lea     eax, [esp+30h+var_28]
                push    0
                push    eax
                push    ecx
                push    esi
                push    edi
                call    __cftoe2
                add     esp, 14h
                mov     eax, edi
                pop     edi
                pop     esi
                add     esp, 28h
                retn
__cftoe         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__cftoe2        proc near               ; CODE XREF: __cftoe+63↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = byte ptr  14h

                push    ebx
                mov     bl, [esp+4+arg_10]
                push    ebp
                mov     ebp, [esp+8+arg_0]
                push    esi
                mov     esi, [esp+0Ch+arg_4]
                push    edi
                mov     edi, [esp+10h+arg_C]
                test    bl, bl
                jz      short loc_5C72C5
                mov     edx, dword ptr [edi]
                xor     eax, eax
                cmp     edx, 2Dh ; '-'
                setz    al
                add     eax, ebp
                xor     ecx, ecx
                test    esi, esi
                setnle  cl
                push    ecx             ; int
                push    eax             ; Src
                call    __shift
                add     esp, 8

loc_5C72C5:                             ; CODE XREF: __cftoe2+16↑j
                mov     ecx, dword ptr [edi]
                mov     eax, ebp
                cmp     ecx, 2Dh ; '-'
                jnz     short loc_5C72D5
                mov     byte ptr [ebp+0], 2Dh ; '-'
                lea     eax, [ebp+1]

loc_5C72D5:                             ; CODE XREF: __cftoe2+3C↑j
                test    esi, esi
                jle     short loc_5C72E7
                mov     dl, [eax+1]
                mov     [eax], dl
                mov     cl, byte_641478
                inc     eax
                mov     [eax], cl

loc_5C72E7:                             ; CODE XREF: __cftoe2+47↑j
                xor     edx, edx
                mov     ecx, ds:dword_614668
                test    bl, bl
                setz    dl
                add     edx, eax
                add     esi, edx
                mov     eax, esi
                mov     [eax], ecx
                mov     dx, ds:word_61466C
                mov     [eax+4], dx
                mov     eax, dword ptr [esp+10h+arg_8]
                test    eax, eax
                jz      short loc_5C7312
                mov     byte ptr [esi], 45h ; 'E'

loc_5C7312:                             ; CODE XREF: __cftoe2+7D↑j
                mov     eax, dword ptr [edi+0Ch]
                inc     esi
                cmp     byte ptr [eax], 30h ; '0'
                jz      short loc_5C737B
                mov     ecx, dword ptr [edi+4]
                dec     ecx
                jns     short loc_5C7326
                neg     ecx
                mov     byte ptr [esi], 2Dh ; '-'

loc_5C7326:                             ; CODE XREF: __cftoe2+8F↑j
                inc     esi
                cmp     ecx, 64h ; 'd'
                jl      short loc_5C734F
                mov     eax, 51EB851Fh
                imul    ecx
                sar     edx, 5
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                mov     al, [esi]
                add     al, dl
                mov     [esi], al
                mov     eax, ecx
                cdq
                mov     ecx, 64h ; 'd'
                idiv    ecx
                mov     ecx, edx

loc_5C734F:                             ; CODE XREF: __cftoe2+9A↑j
                inc     esi
                cmp     ecx, 0Ah
                jl      short loc_5C7378
                mov     eax, 66666667h
                imul    ecx
                sar     edx, 2
                mov     eax, edx
                shr     eax, 1Fh
                add     edx, eax
                mov     al, [esi]
                add     al, dl
                mov     [esi], al
                mov     eax, ecx
                cdq
                mov     ecx, 0Ah
                idiv    ecx
                mov     ecx, edx

loc_5C7378:                             ; CODE XREF: __cftoe2+C3↑j
                add     [esi+1], cl

loc_5C737B:                             ; CODE XREF: __cftoe2+89↑j
                pop     edi
                mov     eax, ebp
                pop     esi
                pop     ebp
                pop     ebx
                retn
__cftoe2        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _cftof(int, void *Src, int)
__cftof         proc near               ; CODE XREF: __cfltcvt+22↓p

var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_18          = byte ptr -18h
arg_0           = dword ptr  4
Src             = dword ptr  8
arg_8           = dword ptr  0Ch

                sub     esp, 28h
                lea     eax, [esp+28h+var_18]
                lea     ecx, [esp+28h+var_28]
                push    esi
                push    edi
                push    eax
                mov     eax, dword ptr [esp+34h+arg_0]
                push    ecx
                mov     edx, dword ptr [eax+4]
                mov     eax, dword ptr [eax]
                push    edx
                push    eax
                call    __fltout2
                mov     edi, [esp+40h+arg_8]
                mov     edx, dword ptr [esp+40h+var_24]
                mov     esi, [esp+40h+var_28]
                add     esp, 10h
                add     edx, edi
                xor     eax, eax
                cmp     esi, 2Dh ; '-'
                mov     esi, [esp+30h+Src]
                lea     ecx, [esp+30h+var_28]
                setz    al
                push    ecx
                add     eax, esi
                push    edx
                push    eax
                call    __fptostr
                add     esp, 0Ch
                lea     ecx, [esp+30h+var_28]
                push    0               ; char
                push    ecx             ; int
                push    edi             ; int
                push    esi             ; Src
                call    __cftof2
                add     esp, 10h
                mov     eax, esi
                pop     edi
                pop     esi
                add     esp, 28h
                retn
__cftof         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl _cftof2(void *Src, int, int, char)
__cftof2        proc near               ; CODE XREF: __cftof+56↑p

Src             = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = byte ptr  10h

                mov     cl, [esp+arg_C]
                push    ebx
                push    ebp
                push    esi
                mov     esi, [esp+0Ch+arg_8]
                mov     ebp, [esp+0Ch+arg_4]
                mov     ebx, dword ptr [esp+0Ch+Src]
                push    edi
                mov     eax, dword ptr [esi+4]
                dec     eax
                test    cl, cl
                jz      short loc_5C7435
                mov     edx, dword ptr [esi]
                xor     ecx, ecx
                cmp     edx, 2Dh ; '-'
                setz    cl
                add     ecx, ebx
                cmp     eax, ebp
                jnz     short loc_5C7435
                mov     byte ptr [eax+ecx], 30h ; '0'
                mov     byte ptr [eax+ecx+1], 0

loc_5C7435:                             ; CODE XREF: __cftof2+1A↑j
                mov     eax, dword ptr [esi]
                mov     edi, ebx
                cmp     eax, 2Dh ; '-'
                jnz     short loc_5C7444
                mov     byte ptr [ebx], 2Dh ; '-'
                lea     edi, [ebx+1]

loc_5C7444:                             ; CODE XREF: __cftof2+3C↑j
                mov     eax, dword ptr [esi+4]
                test    eax, eax
                jg      short loc_5C745C
                push    1               ; int
                push    edi             ; Src
                call    __shift
                add     esp, 8
                mov     byte ptr [edi], 30h ; '0'
                inc     edi
                jmp     short loc_5C745E
; ---------------------------------------------------------------------------

loc_5C745C:                             ; CODE XREF: __cftof2+49↑j
                add     edi, eax

loc_5C745E:                             ; CODE XREF: __cftof2+5A↑j
                test    ebp, ebp
                jle     short loc_5C74AF
                push    1               ; int
                push    edi             ; Src
                call    __shift
                mov     al, byte_641478
                add     esp, 8
                mov     [edi], al
                mov     esi, [esi+4]
                inc     edi
                test    esi, esi
                jge     short loc_5C74AF
                mov     al, [esp+10h+arg_C]
                test    al, al
                jz      short loc_5C7488
                neg     esi
                jmp     short loc_5C748E
; ---------------------------------------------------------------------------

loc_5C7488:                             ; CODE XREF: __cftof2+82↑j
                neg     esi
                cmp     ebp, esi
                jl      short loc_5C7490

loc_5C748E:                             ; CODE XREF: __cftof2+86↑j
                mov     ebp, esi

loc_5C7490:                             ; CODE XREF: __cftof2+8C↑j
                push    ebp             ; int
                push    edi             ; Src
                call    __shift
                mov     ecx, ebp
                mov     eax, 30303030h
                mov     edx, ecx
                add     esp, 8
                shr     ecx, 2
                rep stosd
                mov     ecx, edx
                and     ecx, 3
                rep stosb

loc_5C74AF:                             ; CODE XREF: __cftof2+60↑j
                pop     edi
                pop     esi
                mov     eax, ebx
                pop     ebp
                pop     ebx
                retn
__cftof2        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _cftog(int, void *Src, int, int)
__cftog         proc near               ; CODE XREF: __cfltcvt+3F↓p

var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_18          = byte ptr -18h
arg_0           = dword ptr  4
Src             = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                sub     esp, 28h
                lea     eax, [esp+28h+var_18]
                lea     ecx, [esp+28h+var_28]
                push    ebx
                push    ebp
                push    esi
                push    edi
                push    eax
                mov     eax, dword ptr [esp+3Ch+arg_0]
                push    ecx
                mov     edx, dword ptr [eax+4]
                mov     eax, dword ptr [eax]
                push    edx
                push    eax
                call    __fltout2
                mov     ecx, dword ptr [esp+48h+var_24]
                mov     ebp, [esp+48h+Src]
                mov     ebx, dword ptr [esp+48h+arg_8]
                add     esp, 10h
                lea     edi, [ecx-1]
                mov     ecx, dword ptr [esp+38h+var_28]
                xor     edx, edx
                cmp     ecx, 2Dh ; '-'
                setz    dl
                add     edx, ebp
                lea     eax, [esp+38h+var_28]
                mov     esi, edx
                push    eax
                push    ebx
                push    esi
                call    __fptostr
                mov     ecx, dword ptr [esp+44h+var_24]
                add     esp, 0Ch
                lea     eax, [ecx-1]
                xor     ecx, ecx
                cmp     edi, eax
                setl    cl
                cmp     eax, 0FFFFFFFCh
                jl      short loc_5C7558
                cmp     eax, ebx
                jge     short loc_5C7558
                test    cl, cl
                jz      short loc_5C753F
                mov     dl, [esi]
                inc     esi
                test    dl, dl
                jz      short loc_5C753B

loc_5C7534:                             ; CODE XREF: __cftog+79↓j
                mov     al, [esi]
                inc     esi
                test    al, al
                jnz     short loc_5C7534

loc_5C753B:                             ; CODE XREF: __cftog+72↑j
                mov     byte ptr [esi-2], 0

loc_5C753F:                             ; CODE XREF: __cftog+6B↑j
                lea     ecx, [esp+38h+var_28]
                push    1               ; char
                push    ecx             ; int
                push    ebx             ; int
                push    ebp             ; Src
                call    __cftof2
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 28h
                retn
; ---------------------------------------------------------------------------

loc_5C7558:                             ; CODE XREF: __cftog+63↑j
                mov     eax, dword ptr [esp+38h+arg_C]
                lea     edx, [esp+38h+var_28]
                push    1
                push    edx
                push    eax
                push    ebx
                push    ebp
                call    __cftoe2
                add     esp, 14h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 28h
                retn
__cftog         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _cfltcvt(int, void *Src, int, int, int)
__cfltcvt       proc near               ; DATA XREF: __cfltcvt_init_0↑o

arg_0           = dword ptr  4
Src             = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h

                mov     eax, dword ptr [esp+arg_8]
                cmp     eax, 65h ; 'e'
                jz      short loc_5C75C8
                cmp     eax, 45h ; 'E'
                jz      short loc_5C75C8
                cmp     eax, 66h ; 'f'
                jnz     short loc_5C75AB
                mov     eax, dword ptr [esp+arg_C]
                mov     ecx, dword ptr [esp+Src]
                mov     edx, dword ptr [esp+arg_0]
                push    eax             ; int
                push    ecx             ; Src
                push    edx             ; int
                call    __cftof
                add     esp, 0Ch
                retn
; ---------------------------------------------------------------------------

loc_5C75AB:                             ; CODE XREF: __cfltcvt+11↑j
                mov     eax, dword ptr [esp+arg_10]
                mov     ecx, dword ptr [esp+arg_C]
                mov     edx, dword ptr [esp+Src]
                push    eax             ; int
                mov     eax, dword ptr [esp+4+arg_0]
                push    ecx             ; int
                push    edx             ; Src
                push    eax             ; int
                call    __cftog
                add     esp, 10h
                retn
; ---------------------------------------------------------------------------

loc_5C75C8:                             ; CODE XREF: __cfltcvt+7↑j
                mov     ecx, dword ptr [esp+arg_10]
                mov     edx, dword ptr [esp+arg_C]
                mov     eax, dword ptr [esp+Src]
                push    ecx
                mov     ecx, dword ptr [esp+4+arg_0]
                push    edx
                push    eax
                push    ecx
                call    __cftoe
                add     esp, 10h
                retn
__cfltcvt       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl _shift(void *Src, int)
__shift         proc near               ; CODE XREF: __cftoe2+2D↑p

Src             = dword ptr  4
arg_4           = dword ptr  8

                push    esi
                mov     esi, [esp+4+arg_4]
                test    esi, esi
                jz      short loc_5C7617
                mov     edx, dword ptr [esp+4+Src]
                push    edi
                mov     edi, edx
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                add     esi, edx
                repne scasb
                not     ecx
                push    ecx             ; varSize
                push    edx             ; Src
                push    esi             ; void *
                call    _memcpy_0
                add     esp, 0Ch
                pop     edi

loc_5C7617:                             ; CODE XREF: __shift+7↑j
                pop     esi
                retn
__shift         endp

; ---------------------------------------------------------------------------
                align 10h






; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame


; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; void __cdecl _lock_file(FILE *Stream)
__lock_file     proc near               ; CODE XREF: _fclose+1C↑p

Stream          = dword ptr  8

                push    ebp
                mov     ebp, esp
                mov     eax, dword ptr [ebp+Stream]
                cmp     eax, offset off_641900
                jb      short loc_5C787A
                cmp     eax, offset unk_641B60
                ja      short loc_5C787A
                sub     eax, offset off_641900
                sar     eax, 5
                add     eax, 1Ch
                push    eax
                call    __lock
                add     esp, 4
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_5C787A:                             ; CODE XREF: __lock_file+B↑j
                add     eax, 20h ; ' '
                push    eax             ; lpCriticalSection
                call    EnterCriticalSection
                pop     ebp
                retn
__lock_file     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

__lock_file2    proc near               ; CODE XREF: _printf+9↑p

arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch

                push    ebp
                mov     ebp, esp
                mov     eax, dword ptr [ebp+arg_0]
                cmp     eax, 14h
                jge     short loc_5C78A9
                add     eax, 1Ch
                push    eax
                call    __lock
                add     esp, 4
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_5C78A9:                             ; CODE XREF: __lock_file2+9↑j
                mov     eax, dword ptr [ebp+arg_4]
                add     eax, 20h ; ' '
                push    eax             ; lpCriticalSection
                call    EnterCriticalSection
                pop     ebp
                retn
__lock_file2    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; void __cdecl _unlock_file(FILE *Stream)
__unlock_file   proc near               ; CODE XREF: _fclose+30↑p

Stream          = dword ptr  8

                push    ebp
                mov     ebp, esp
                mov     eax, dword ptr [ebp+Stream]
                cmp     eax, offset off_641900
                jb      short loc_5C78EA
                cmp     eax, offset unk_641B60
                ja      short loc_5C78EA
                sub     eax, offset off_641900
                sar     eax, 5
                add     eax, 1Ch
                push    eax
                call    __unlock
                add     esp, 4
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_5C78EA:                             ; CODE XREF: __unlock_file+B↑j
                add     eax, 20h ; ' '
                push    eax             ; lpCriticalSection
                call    LeaveCriticalSection
                pop     ebp
                retn
__unlock_file   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

__unlock_file2  proc near               ; CODE XREF: _printf+4E↑p

arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch

                push    ebp
                mov     ebp, esp
                mov     eax, dword ptr [ebp+arg_0]
                cmp     eax, 14h
                jge     short loc_5C7919
                add     eax, 1Ch
                push    eax
                call    __unlock
                add     esp, 4
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_5C7919:                             ; CODE XREF: __unlock_file2+9↑j
                mov     eax, dword ptr [ebp+arg_4]
                add     eax, 20h ; ' '
                push    eax             ; lpCriticalSection
                call    LeaveCriticalSection
                pop     ebp
                retn
__unlock_file2  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn

; void __cdecl __noreturn _lockerr_exit(LPCSTR lpMessageText)
__lockerr_exit  proc near

lpMessageText   = dword ptr  4

                mov     eax, dword ptr [esp+lpMessageText]
                push    eax             ; lpMessageText
                push    0               ; uAction
                call    FatalAppExitA
__lockerr_exit  endp






; =============== S U B R O U T I N E =======================================

; Attributes: library function

__trandisp1     proc near               ; CODE XREF: __cintrindisp1:resume1↓p
                cmp     byte ptr [edx+0Eh], 5
                jnz     short loc_5C8357
                mov     bx, [ebp-0A4h]
                or      bh, 2
                and     bh, 0FEh
                mov     bl, 3Fh ; '?'
                jmp     short loc_5C835B
; ---------------------------------------------------------------------------

loc_5C8357:                             ; CODE XREF: __trandisp1+4↑j
                mov     bx, 133Fh

loc_5C835B:                             ; CODE XREF: __trandisp1+15↑j
                mov     [ebp-0A2h], bx
                fldcw   word ptr [ebp-0A2h]
                mov     ebx, offset unk_64124C
                fxam
                mov     [ebp-94h], edx
                fstsw   word ptr [ebp-0A0h]
                mov     byte ptr [ebp-90h], 0
                wait
                mov     cl, [ebp-9Fh]
                shl     cl, 1
                sar     cl, 1
                rol     cl, 1
                mov     al, cl
                and     al, 0Fh
                xlat
                movsx   eax, al
                and     ecx, 404h
                mov     ebx, edx
                add     ebx, eax
                add     ebx, 10h
                jmp     dword ptr [ebx]
__trandisp1     endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__trandisp2     proc near               ; CODE XREF: __cintrindisp2:resume2↓p
                cmp     byte ptr [edx+0Eh], 5
                jnz     short cwdefault
                mov     bx, [ebp-0A4h]
                or      bh, 2
                and     bh, 0FEh
                mov     bl, 3Fh ; '?'
                jmp     short setcw
; ---------------------------------------------------------------------------

cwdefault:                              ; CODE XREF: __trandisp2+4↑j
                mov     bx, 133Fh

setcw:                                  ; CODE XREF: __trandisp2+15↑j
                mov     [ebp-0A2h], bx
                fldcw   word ptr [ebp-0A2h]
                mov     ebx, offset unk_64124C
                fxam
                mov     [ebp-94h], edx
                fstsw   word ptr [ebp-0A0h]
                mov     byte ptr [ebp-90h], 0
                fxch    st(1)
                mov     cl, [ebp-9Fh]
                fxam
                fstsw   word ptr [ebp-0A0h]
                fxch    st(1)
                mov     ch, [ebp-9Fh]
                shl     ch, 1
                sar     ch, 1
                rol     ch, 1
                mov     al, ch
                and     al, 0Fh
                xlat
                mov     ah, al
                shl     cl, 1
                sar     cl, 1
                rol     cl, 1
                mov     al, cl
                and     al, 0Fh
                xlat
                shl     ah, 1
                shl     ah, 1
                or      al, ah
                movsx   eax, al
                and     ecx, 404h
                mov     ebx, edx
                add     ebx, eax
                add     ebx, 10h
                jmp     dword ptr [ebx]
__trandisp2     endp

; ---------------------------------------------------------------------------

__rttospopde:
                call    __rttosnpopde
; START OF FUNCTION CHUNK FOR fFYTOX

__rttospop:                             ; CODE XREF: fFYTOX:expret↓j
                fxch    st(1)

__rtnospop:                             ; CODE XREF: .text:005C8442↓j
                fstp    st
; END OF FUNCTION CHUNK FOR fFYTOX

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__rttosnpop     proc near
                retn
__rttosnpop     endp

; ---------------------------------------------------------------------------

__rtnospopde:
                call    __rttosnpopde
                jmp     short __rtnospop
; ---------------------------------------------------------------------------

__rtzeropop:
                fstp    st
; START OF FUNCTION CHUNK FOR __ffexpm1

__rtzeronpop:                           ; CODE XREF: .text:tranzeronpop↓j
                fstp    st
                fldz
                retn
; END OF FUNCTION CHUNK FOR __ffexpm1
; ---------------------------------------------------------------------------
; START OF FUNCTION CHUNK FOR fFYTOX

__rtonepop:                             ; CODE XREF: fFYTOX:_rtfor0to0↓j
                fstp    st

__rtonenpop:
                fstp    st
                fld1
                retn
; END OF FUNCTION CHUNK FOR fFYTOX
; ---------------------------------------------------------------------------

__tosnan1:
                fstp    tbyte ptr [ebp-9Eh]
                fld     tbyte ptr [ebp-9Eh]
                test    byte ptr [ebp-97h], 40h
                jz      short _tossnan1
                mov     byte ptr [ebp-90h], 7
                retn
; ---------------------------------------------------------------------------

_tossnan1:                              ; CODE XREF: .text:005C8465↑j
                mov     byte ptr [ebp-90h], 1
                fadd    dbl_641244
                retn
; ---------------------------------------------------------------------------

__nosnan2:
                fxch    st(1)

__tosnan2:
                fstp    tbyte ptr [ebp-9Eh]
                fld     tbyte ptr [ebp-9Eh]
                test    byte ptr [ebp-97h], 40h
                jz      short _tossnan2
                mov     byte ptr [ebp-90h], 7
                jmp     short _tosnan2ret
; ---------------------------------------------------------------------------

_tossnan2:                              ; CODE XREF: .text:005C8492↑j
                mov     byte ptr [ebp-90h], 1

_tosnan2ret:                            ; CODE XREF: .text:005C849B↑j
                faddp   st(1), st
                retn
; ---------------------------------------------------------------------------

__nan2:
                fstp    tbyte ptr [ebp-9Eh]
                fld     tbyte ptr [ebp-9Eh]
                test    byte ptr [ebp-97h], 40h
                jz      short _snan2
                fxch    st(1)
                fstp    tbyte ptr [ebp-9Eh]
                fld     tbyte ptr [ebp-9Eh]
                test    byte ptr [ebp-97h], 40h
                jz      short _snan2
                mov     byte ptr [ebp-90h], 7
                jmp     short _nan2ret
; ---------------------------------------------------------------------------

_snan2:                                 ; CODE XREF: .text:005C84BA↑j
                mov     byte ptr [ebp-90h], 1

_nan2ret:                               ; CODE XREF: .text:005C84DA↑j
                faddp   st(1), st
                retn
; ---------------------------------------------------------------------------
; START OF FUNCTION CHUNK FOR fFYTOX
;   ADDITIONAL PARENT FUNCTION AugmentSinCos

__rtindfpop:                            ; CODE XREF: fFYTOX:negYTOXerror↓j
                fstp    st

__rtindfnpop:                           ; CODE XREF: .text:tranindfnpop↓j
                fstp    st
                fld     tbyte ptr [tbyte_641230]
                cmp     byte ptr [ebp-90h], 0
                jg      short retj
; END OF FUNCTION CHUNK FOR fFYTOX

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__rttosnpopde   proc near               ; CODE XREF: .text:__rttospopde↑p
                mov     byte ptr [ebp-90h], 1

retj:                                   ; CODE XREF: fFYTOX-E99↑j
                or      cl, cl
                retn
__rttosnpopde   endp

; ---------------------------------------------------------------------------

__rtchsifneg:
                or      cl, cl
                jz      short chsifnegret
                fchs

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

chsifnegret     proc near               ; CODE XREF: .text:005C8505↑j
                retn
chsifnegret     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

__startTwoArgErrorHandling proc near    ; CODE XREF: _pow+99↑p

var_20          = dword ptr -20h
var_10          = dword ptr -10h
var_C           = dword ptr -0Ch
arg_10          = dword ptr  18h
arg_14          = dword ptr  1Ch

                push    ebp
                mov     ebp, esp
                add     esp, 0FFFFFFE0h
                mov     [ebp+var_20], eax
                mov     eax, dword ptr [ebp+arg_10]
                mov     [ebp+var_10], eax
                mov     eax, dword ptr [ebp+arg_14]
                mov     [ebp+var_C], eax
                jmp     short _ContinueErrorHandling
__startTwoArgErrorHandling endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

__startOneArgErrorHandling proc near    ; CODE XREF: _sqrt+9F↑p

var_20          = dword ptr -20h
var_1C          = dword ptr -1Ch
var_18          = dword ptr -18h
var_14          = dword ptr -14h
var_8           = qword ptr -8
arg_0           = word ptr  8
arg_8           = dword ptr  10h
arg_C           = dword ptr  14h

                push    ebp
                mov     ebp, esp
                add     esp, 0FFFFFFE0h
                mov     [ebp+var_20], eax

_ContinueErrorHandling:                 ; CODE XREF: __startTwoArgErrorHandling+15↑j
                fstp    [ebp+var_8]
                mov     [ebp+var_1C], ecx
                mov     eax, dword ptr [ebp+arg_8]
                mov     ecx, dword ptr [ebp+arg_C]
                mov     [ebp+var_18], eax
                mov     [ebp+var_14], ecx
                lea     eax, [ebp+arg_0]
                lea     ecx, [ebp+var_20]
                push    eax
                push    ecx
                push    edx
                call    __87except
                add     esp, 0Ch
                fld     [ebp+var_8]
                cmp     [ebp+arg_0], 27Fh
                jz      short CW_is_restored
                fldcw   [ebp+arg_0]

CW_is_restored:                         ; CODE XREF: __startOneArgErrorHandling+35↑j
                leave
                retn
__startOneArgErrorHandling endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__twoToTOS      proc near               ; CODE XREF: _pow+58↑p
                fld     st
                frndint
                fsubr   st(1), st
                fxch    st(1)
                fchs
                f2xm1
                fld1
                faddp   st(1), st
                fscale
                fstp    st(1)
                retn
__twoToTOS      endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__load_CW       proc near               ; CODE XREF: _sqrt+1C↑p

arg_0           = dword ptr  4

                mov     edx, dword ptr [esp+arg_0]
                and     edx, 300h
                or      edx, 7Fh
                mov     word ptr [esp+arg_0+2], dx
                fldcw   word ptr [esp+arg_0+2]
                retn
__load_CW       endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__convertTOStoQNaN proc near            ; CODE XREF: _sqrt:loc_5BF162↑p
                test    eax, 80000h
                jz      short tosIsSNaN
                mov     eax, 7
                retn
; ---------------------------------------------------------------------------

tosIsSNaN:                              ; CODE XREF: __convertTOStoQNaN+5↑j
                fadd    qword ptr [dbl_614670]
                mov     eax, 1
                retn
__convertTOStoQNaN endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__fload_withFB  proc near               ; CODE XREF: _sqrt+4↑p

var_A           = tbyte ptr -0Ah

                mov     eax, dword ptr [edx+4]
                and     eax, 7FF00000h
                cmp     eax, 7FF00000h
                jz      short fpload_special
                fld     qword ptr [edx]
                retn
; ---------------------------------------------------------------------------

fpload_special:                         ; CODE XREF: __fload_withFB+D↑j
                mov     eax, dword ptr [edx+4]
                sub     esp, 0Ah
                or      eax, 7FFF0000h
                mov     dword ptr [esp+0Ah+var_A+6], eax
                mov     eax, dword ptr [edx+4]
                mov     ecx, dword ptr [edx]
                shld    eax, ecx, 0Bh
                shl     ecx, 0Bh
                mov     [esp+4], eax
                mov     dword ptr [esp+0Ah+var_A], ecx
                fld     [esp+0Ah+var_A]
                add     esp, 0Ah
                test    eax, 0
                mov     eax, dword ptr [edx+4]
                retn
__fload_withFB  endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__checkTOS_withFB proc near             ; CODE XREF: __CIsqrt+6↑p

arg_4           = dword ptr  8

                mov     eax, dword ptr [esp+arg_4]
                and     eax, 7FF00000h
                cmp     eax, 7FF00000h
                jz      short special_exp
                retn
; ---------------------------------------------------------------------------

special_exp:                            ; CODE XREF: __checkTOS_withFB+E↑j
                mov     eax, dword ptr [esp+arg_4]
                retn
__checkTOS_withFB endp

; ---------------------------------------------------------------------------
; START OF FUNCTION CHUNK FOR _sqrt
;   ADDITIONAL PARENT FUNCTION _tan
;   ADDITIONAL PARENT FUNCTION _pow
;   ADDITIONAL PARENT FUNCTION _sin
;   ADDITIONAL PARENT FUNCTION _cos
;   ADDITIONAL PARENT FUNCTION _atan
;   ADDITIONAL PARENT FUNCTION _log10
;   ADDITIONAL PARENT FUNCTION _acos
;   ADDITIONAL PARENT FUNCTION _log

__fast_exit:                            ; CODE XREF: _sqrt+31↑j
                cmp     [esp+4+var_4], 27Fh
                jz      short fast_exit_CW_is_restored
                fldcw   word ptr [esp+4+var_4]

fast_exit_CW_is_restored:               ; CODE XREF: _sqrt+9510↑j
                pop     edx
                retn
; ---------------------------------------------------------------------------

__math_exit:                            ; CODE XREF: _sqrt+42↑j
                mov     ax, word ptr [esp+4+var_4]
                cmp     ax, 27Fh
                jz      short CW_is_restored_0
                and     ax, 20h
                jz      short restore_CW
                fstsw   ax
                and     ax, 20h
                jz      short restore_CW
                mov     eax, 8
                call    __startOneArgErrorHandling
                pop     edx
                retn
; ---------------------------------------------------------------------------

restore_CW:                             ; CODE XREF: _sqrt+9525↑j
                fldcw   word ptr [esp+4+var_4]

CW_is_restored_0:                       ; CODE XREF: _sqrt+951F↑j
                pop     edx
                retn
; END OF FUNCTION CHUNK FOR _sqrt

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__check_overflow_exit proc near

var_8           = qword ptr -8

                sub     esp, 8
                fst     [esp+8+var_8]
                mov     eax, dword ptr [esp+8+var_8+4]
                add     esp, 8
                and     eax, 7FF00000h
                jmp     short _check_overflow_start
__check_overflow_exit endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__check_range_exit proc near            ; CODE XREF: _pow+7C↑j

var_8           = qword ptr -8

                sub     esp, 8
                fst     [esp+8+var_8]
                mov     eax, dword ptr [esp+8+var_8+4]
                add     esp, 8
                and     eax, 7FF00000h
                jz      short haveunderflow

_check_overflow_start:                  ; CODE XREF: __check_overflow_exit+12↑j
                cmp     eax, 7FF00000h
                jz      short haveoverflow
                mov     ax, [esp+0]
                cmp     ax, 27Fh
                jz      short loc_5C86A8
                and     ax, 20h
                jnz     short loc_5C86A5
                fstsw   ax
                and     ax, 20h
                jz      short loc_5C86A5
                mov     eax, 8

have_error:                             ; CODE XREF: __check_range_exit+70↓j
                cmp     edx, 1Dh
                jz      short have_error_in_pow
                call    __startOneArgErrorHandling
                pop     edx
                retn
; ---------------------------------------------------------------------------

have_error_in_pow:                      ; CODE XREF: __check_range_exit+3C↑j
                call    __startTwoArgErrorHandling
                pop     edx
                retn
; ---------------------------------------------------------------------------

loc_5C86A5:                             ; CODE XREF: __check_range_exit+29↑j
                fldcw   word ptr [esp+0]

loc_5C86A8:                             ; CODE XREF: __check_range_exit+23↑j
                pop     edx
                retn
; ---------------------------------------------------------------------------

haveunderflow:                          ; CODE XREF: __check_range_exit+12↑j
                fld     qword ptr [dbl_61469C]
                fxch    st(1)
                fscale
                fstp    st(1)
                fld     st
                fabs
                fcomp   qword ptr [dbl_61468C]
                fstsw   ax
                sahf
                mov     eax, 4
                jnb     short have_error
                fmul    qword ptr [dbl_6146AC]
                jmp     short have_error
; ---------------------------------------------------------------------------

haveoverflow:                           ; CODE XREF: __check_range_exit+19↑j
                fld     qword ptr [dbl_614694]
                fxch    st(1)
                fscale
                fstp    st(1)
                fld     st
                fabs
                fcomp   qword ptr [dbl_614684]
                fstsw   ax
                sahf
                mov     eax, 3
                jbe     short have_error
                fmul    qword ptr [dbl_6146A4]
                jmp     short have_error
__check_range_exit endp ; sp-analysis failed

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _flsbuf(int Ch, FILE *File)
__flsbuf        proc near               ; CODE XREF: _sprintf+59↑p

Buf             = dword ptr  4
File            = dword ptr  8

                push    ebx
                push    ebp
                push    esi
                mov     esi, [esp+0Ch+File]
                push    edi
                mov     eax, dword ptr [esi+0Ch]
                mov     ebp, [esi+10h]
                test    al, 82h
                jz      loc_5C8823
                test    al, 40h
                jnz     loc_5C8823
                xor     ebx, ebx
                test    al, 1
                jz      short loc_5C8739
                test    al, 10h
                mov     [esi+4], ebx
                jz      loc_5C8823
                mov     ecx, dword ptr [esi+8]
                and     al, 0FEh
                mov     [esi], ecx
                mov     [esi+0Ch], eax

loc_5C8739:                             ; CODE XREF: __flsbuf+22↑j
                mov     eax, dword ptr [esi+0Ch]
                mov     [esi+4], ebx
                and     al, 0EFh
                or      al, 2
                test    eax, 10Ch
                mov     [esi+0Ch], eax
                jnz     short loc_5C8773
                cmp     esi, offset _stdout
                jz      short loc_5C875D
                cmp     esi, offset _stderr
                jnz     short loc_5C876A

loc_5C875D:                             ; CODE XREF: __flsbuf+53↑j
                push    ebp             ; FileHandle
                call    __isatty
                add     esp, 4
                test    eax, eax
                jnz     short loc_5C8773

loc_5C876A:                             ; CODE XREF: __flsbuf+5B↑j
                push    esi
                call    __getbuf
                add     esp, 4

loc_5C8773:                             ; CODE XREF: __flsbuf+4B↑j
                test    dword ptr [esi+0Ch], 108h
                jz      short loc_5C87EB
                mov     eax, dword ptr [esi+8]
                mov     edi, [esi]
                mov     ecx, dword ptr [esi+18h]
                sub     edi, eax
                lea     edx, [eax+1]
                dec     ecx
                cmp     edi, ebx
                mov     [esi], edx
                mov     [esi+4], ecx
                jle     short loc_5C87AB
                push    edi             ; MaxCharCount
                push    eax             ; Buf
                push    ebp             ; FileHandle
                call    __write
                mov     edx, dword ptr [esi+8]
                mov     ebx, eax
                mov     al, byte ptr [esp+1Ch+Buf]
                add     esp, 0Ch
                mov     [edx], al
                jmp     short loc_5C8801
; ---------------------------------------------------------------------------

loc_5C87AB:                             ; CODE XREF: __flsbuf+91↑j
                cmp     ebp, 0FFFFFFFFh
                jz      short loc_5C87C9
                mov     edx, ebp
                mov     eax, ebp
                sar     edx, 5
                and     eax, 1Fh
                mov     ecx, __pioinfo[edx*4]
                lea     eax, [eax+eax*8]
                lea     eax, [ecx+eax*4]
                jmp     short loc_5C87CE
; ---------------------------------------------------------------------------

loc_5C87C9:                             ; CODE XREF: __flsbuf+AE↑j
                mov     eax, offset unk_6418D8

loc_5C87CE:                             ; CODE XREF: __flsbuf+C7↑j
                test    byte ptr [eax+4], 20h
                jz      short loc_5C87E0
                push    2               ; Origin
                push    ebx             ; varOffset
                push    ebp             ; FileHandle
                call    __lseek
                add     esp, 0Ch

loc_5C87E0:                             ; CODE XREF: __flsbuf+D2↑j
                mov     edx, dword ptr [esi+8]
                mov     al, byte ptr [esp+10h+Buf]
                mov     [edx], al
                jmp     short loc_5C8801
; ---------------------------------------------------------------------------

loc_5C87EB:                             ; CODE XREF: __flsbuf+7A↑j
                mov     edi, 1
                lea     ecx, [esp+10h+Buf]
                push    edi             ; MaxCharCount
                push    ecx             ; Buf
                push    ebp             ; FileHandle
                call    __write
                add     esp, 0Ch
                mov     ebx, eax

loc_5C8801:                             ; CODE XREF: __flsbuf+A9↑j
                cmp     ebx, edi
                jz      short loc_5C8815
                mov     eax, dword ptr [esi+0Ch]
                or      al, 20h
                mov     [esi+0Ch], eax
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C8815:                             ; CODE XREF: __flsbuf+103↑j
                mov     eax, dword ptr [esp+10h+Buf]
                and     eax, 0FFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C8823:                             ; CODE XREF: __flsbuf+10↑j
                or      al, 20h
                pop     edi
                mov     [esi+0Ch], eax
                pop     esi
                pop     ebp
                or      eax, 0FFFFFFFFh
                pop     ebx
                retn
__flsbuf        endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _output(FILE *File, int, int)
__output        proc near               ; CODE XREF: _sprintf+2F↑p

var_24C         = dword ptr -24Ch
var_248         = dword ptr -248h
var_244         = dword ptr -244h
var_240         = dword ptr -240h
var_23A         = dword ptr -23Ah
var_234         = dword ptr -234h
var_230         = dword ptr -230h
var_22C         = dword ptr -22Ch
var_228         = dword ptr -228h
var_224         = dword ptr -224h
var_220         = dword ptr -220h
var_21C         = dword ptr -21Ch
var_218         = dword ptr -218h
var_214         = byte ptr -214h
var_210         = dword ptr -210h
var_20C         = dword ptr -20Ch
var_204         = dword ptr -204h
MbCh            = byte ptr -200h
var_1FF         = byte ptr -1FFh
var_1           = byte ptr -1
File            = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                sub     esp, 24Ch
                push    ebx
                push    ebp
                push    esi
                push    edi
                mov     edi, [esp+25Ch+arg_4]
                xor     ecx, ecx
                xor     ebp, ebp
                mov     [esp+25Ch+var_240], ecx
                mov     bl, [edi]
                inc     edi
                test    bl, bl
                mov     byte ptr [esp+25Ch+var_21C], bl
                mov     [esp+25Ch+arg_4], edi
                jz      loc_5C9087
                mov     esi, [esp+25Ch+var_234]
                jmp     short loc_5C886D
; ---------------------------------------------------------------------------

loc_5C8865:                             ; CODE XREF: __output+851↓j
                mov     esi, [esp+25Ch+var_234]
                mov     ecx, dword ptr [esp+25Ch+var_220]

loc_5C886D:                             ; CODE XREF: __output+33↑j
                mov     eax, dword ptr [esp+25Ch+var_240]
                xor     edx, edx
                cmp     eax, edx
                jl      loc_5C9087
                cmp     bl, 20h ; ' '
                jl      short loc_5C8893
                cmp     bl, 78h ; 'x'
                jg      short loc_5C8893
                movsx   eax, bl
                sub     eax, 20h                        ;fix for use label
                mov     al, byte_6146B8[eax]            ;mov     al, [eax+614698h]
                and     eax, 0Fh
                jmp     short loc_5C8895
; ---------------------------------------------------------------------------

loc_5C8893:                             ; CODE XREF: __output+4E↑j
                xor     eax, eax

loc_5C8895:                             ; CODE XREF: __output+61↑j
                movsx   eax, byte_6146B8[ecx+eax*8]
                sar     eax, 4
                cmp     eax, 7          ; switch 8 casesп
                mov     [esp+25Ch+var_220], eax
                ja      def_5C88AD      ; jumptable 005C88AD default case
                jmp     ds:jpt_5C88AD[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5C88B4:                             ; CODE XREF: __output+7D↑j
                mov     [esp+25Ch+var_218], edx ; jumptable 005C88AD case 1
                mov     [esp+25Ch+var_228], edx
                mov     [esp+25Ch+var_234], edx
                mov     [esp+25Ch+var_23A+2], edx
                mov     [esp+25Ch+var_24C], edx
                mov     [esp+25Ch+var_244], 0FFFFFFFFh
                mov     [esp+25Ch+var_230], edx
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C88D9:                             ; CODE XREF: __output+7D↑j
                movsx   eax, bl         ; jumptable 005C88AD case 2
                add     eax, 0FFFFFFE0h ; switch 17 cases
                cmp     eax, 10h
                ja      def_5C88AD      ; jumptable 005C88AD default case
                xor     ecx, ecx
                mov     cl, ds:byte_5C90E4[eax]
                jmp     ds:jpt_5C88F0[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5C88F7:                             ; CODE XREF: __output+C0↑j
                mov     eax, dword ptr [esp+25Ch+var_24C] ; jumptable 005C88F0 case 45
                or      al, 4
                mov     [esp+25Ch+var_24C], eax
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C8906:                             ; CODE XREF: __output+C0↑j
                mov     eax, dword ptr [esp+25Ch+var_24C] ; jumptable 005C88F0 case 43
                or      al, 1
                mov     [esp+25Ch+var_24C], eax
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C8915:                             ; CODE XREF: __output+C0↑j
                mov     eax, dword ptr [esp+25Ch+var_24C] ; jumptable 005C88F0 case 32
                or      al, 2
                mov     [esp+25Ch+var_24C], eax
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C8924:                             ; CODE XREF: __output+C0↑j
                mov     eax, dword ptr [esp+25Ch+var_24C] ; jumptable 005C88F0 case 35
                or      al, 80h
                mov     [esp+25Ch+var_24C], eax
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C8933:                             ; CODE XREF: __output+C0↑j
                mov     eax, dword ptr [esp+25Ch+var_24C] ; jumptable 005C88F0 case 48
                or      al, 8
                mov     [esp+25Ch+var_24C], eax
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C8942:                             ; CODE XREF: __output+7D↑j
                cmp     bl, 2Ah ; '*'   ; jumptable 005C88AD case 3
                jnz     short loc_5C8979
                lea     edx, [esp+25Ch+arg_8]
                push    edx
                call    _get_int_arg
                add     esp, 4
                mov     [esp+25Ch+var_234], eax
                test    eax, eax
                jge     def_5C88AD      ; jumptable 005C88AD default case
                mov     edx, dword ptr [esp+25Ch+var_24C]
                or      edx, 4
                neg     eax
                mov     [esp+25Ch+var_24C], edx
                mov     [esp+25Ch+var_234], eax
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C8979:                             ; CODE XREF: __output+115↑j
                movsx   ecx, bl
                lea     eax, [esi+esi*4]
                lea     edx, [ecx+eax*2-30h]
                mov     [esp+25Ch+var_234], edx
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C898C:                             ; CODE XREF: __output+7D↑j
                mov     [esp+25Ch+var_244], edx ; jumptable 005C88AD case 4
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C8995:                             ; CODE XREF: __output+7D↑j
                cmp     bl, 2Ah ; '*'   ; jumptable 005C88AD case 5
                jnz     short loc_5C89C3
                lea     eax, [esp+25Ch+arg_8]
                push    eax
                call    _get_int_arg
                add     esp, 4
                mov     [esp+25Ch+var_244], eax
                test    eax, eax
                jge     def_5C88AD      ; jumptable 005C88AD default case
                mov     [esp+25Ch+var_244], 0FFFFFFFFh
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C89C3:                             ; CODE XREF: __output+168↑j
                mov     eax, dword ptr [esp+25Ch+var_244]
                movsx   edx, bl
                lea     ecx, [eax+eax*4]
                lea     eax, [edx+ecx*2-30h]
                mov     [esp+25Ch+var_244], eax
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C89DA:                             ; CODE XREF: __output+7D↑j
                movsx   eax, bl         ; jumptable 005C88AD case 6
                add     eax, 0FFFFFFB7h ; switch 47 cases
                cmp     eax, 2Eh
                ja      def_5C88AD      ; jumptable 005C88AD default case
                xor     ecx, ecx
                mov     cl, ds:byte_5C910C[eax]
                jmp     ds:jpt_5C89F1[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5C89F8:                             ; CODE XREF: __output+1C1↑j
                mov     eax, dword ptr [esp+25Ch+var_24C] ; jumptable 005C89F1 case 108
                or      al, 10h
                mov     [esp+25Ch+var_24C], eax
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C8A07:                             ; CODE XREF: __output+1C1↑j
                cmp     byte ptr [edi], 36h ; '6' ; jumptable 005C89F1 case 73
                jnz     short loc_5C8A2C
                cmp     byte ptr [edi+1], 34h ; '4'
                jnz     short loc_5C8A2C
                mov     eax, dword ptr [esp+25Ch+var_24C]
                add     edi, 2
                or      ah, 80h
                mov     [esp+25Ch+arg_4], edi
                mov     [esp+25Ch+var_24C], eax
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C8A2C:                             ; CODE XREF: __output+1DA↑j
                mov     [esp+25Ch+var_220], edx

$NORMAL_STATE$8072:                     ; CODE XREF: __output+7D↑j
                mov     eax, off_641268 ; jumptable 005C88AD case 0
                mov     [esp+25Ch+var_230], edx
                mov     edx, dword ptr [esp+25Ch+var_21C]
                and     edx, 0FFh
                test    byte ptr [eax+edx*2+1], 80h
                jz      short loc_5C8A6D
                mov     edx, dword ptr [esp+25Ch+File]
                lea     ecx, [esp+25Ch+var_240]
                movsx   eax, bl
                push    ecx             ; int
                push    edx             ; File
                push    eax             ; int
                call    _write_char
                mov     bl, [edi]
                add     esp, 0Ch
                inc     edi
                mov     [esp+25Ch+arg_4], edi

loc_5C8A6D:                             ; CODE XREF: __output+218↑j
                mov     edx, dword ptr [esp+25Ch+File]
                lea     ecx, [esp+25Ch+var_240]
                movsx   eax, bl
                push    ecx             ; int
                push    edx             ; File
                push    eax             ; int
                call    _write_char
                add     esp, 0Ch
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C8A8B:                             ; CODE XREF: __output+1C1↑j
                mov     eax, dword ptr [esp+25Ch+var_24C] ; jumptable 005C89F1 case 104
                or      al, 20h
                mov     [esp+25Ch+var_24C], eax
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C8A9A:                             ; CODE XREF: __output+1C1↑j
                mov     eax, dword ptr [esp+25Ch+var_24C] ; jumptable 005C89F1 case 119
                or      ah, 8
                mov     [esp+25Ch+var_24C], eax
                jmp     def_5C88AD      ; jumptable 005C88AD default case
; ---------------------------------------------------------------------------

loc_5C8AAA:                             ; CODE XREF: __output+7D↑j
                movsx   eax, bl         ; jumptable 005C88AD case 7
                add     eax, 0FFFFFFBDh ; switch 54 cases
                cmp     eax, 35h
                ja      def_5C8AC1      ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119
                xor     ecx, ecx
                mov     cl, ds:byte_5C9180[eax]
                jmp     ds:jpt_5C8AC1[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5C8AC8:                             ; CODE XREF: __output+291↑j
                mov     eax, dword ptr [esp+25Ch+var_24C] ; jumptable 005C8AC1 case 67
                test    eax, 830h
                jnz     short loc_5C8ADA ; jumptable 005C8AC1 case 99
                or      ah, 8
                mov     [esp+25Ch+var_24C], eax

loc_5C8ADA:                             ; CODE XREF: __output+291↑j
                test    [esp+25Ch+var_24C], 810h ; jumptable 005C8AC1 case 99
                jz      short loc_5C8B1D
                lea     edx, [esp+25Ch+arg_8]
                push    edx
                call    _get_short_arg
                add     esp, 4
                push    eax             ; WCh
                lea     eax, [esp+260h+MbCh]
                push    eax             ; MbCh
                call    _wctomb
                mov     ebp, eax
                add     esp, 8
                test    ebp, ebp
                jge     short loc_5C8B36
                lea     edx, [esp+25Ch+MbCh]
                mov     [esp+25Ch+var_228], 1
                mov     [esp+25Ch+var_248], edx
                jmp     def_5C8AC1      ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119
; ---------------------------------------------------------------------------

loc_5C8B1D:                             ; CODE XREF: __output+2B2↑j
                lea     ecx, [esp+25Ch+arg_8]
                push    ecx
                call    _get_int_arg
                add     esp, 4
                mov     [esp+25Ch+MbCh], al
                mov     ebp, 1

loc_5C8B36:                             ; CODE XREF: __output+2D6↑j
                lea     edx, [esp+25Ch+MbCh]
                mov     [esp+25Ch+var_248], edx
                jmp     def_5C8AC1      ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119
; ---------------------------------------------------------------------------

loc_5C8B43:                             ; CODE XREF: __output+291↑j
                lea     eax, [esp+25Ch+arg_8] ; jumptable 005C8AC1 case 90
                push    eax
                call    _get_int_arg
                add     esp, 4
                test    eax, eax
                jz      short loc_5C8B91
                mov     ecx, dword ptr [eax+4]
                test    ecx, ecx
                jz      short loc_5C8B91
                mov     edx, dword ptr [esp+25Ch+var_24C]
                test    dh, 8
                jz      short loc_5C8B7D
                movsx   ebp, word ptr [eax]
                mov     [esp+25Ch+var_248], ecx
                mov     [esp+25Ch+var_230], 1
                shr     ebp, 1
                jmp     def_5C8AC1      ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119
; ---------------------------------------------------------------------------

loc_5C8B7D:                             ; CODE XREF: __output+335↑j
                movsx   ebp, word ptr [eax]
                mov     [esp+25Ch+var_230], 0
                mov     [esp+25Ch+var_248], ecx
                jmp     def_5C8AC1      ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119
; ---------------------------------------------------------------------------

loc_5C8B91:                             ; CODE XREF: __output+325↑j
                mov     edi, off_641260 ; "(null)"
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                mov     [esp+25Ch+var_248], edi
                repne scasb
                not     ecx
                dec     ecx
                mov     ebp, ecx
                jmp     def_5C8AC1      ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119
; ---------------------------------------------------------------------------

loc_5C8BAC:                             ; CODE XREF: __output+291↑j
                mov     eax, dword ptr [esp+25Ch+var_24C] ; jumptable 005C8AC1 case 83
                test    eax, 830h
                jnz     short loc_5C8BBE ; jumptable 005C8AC1 case 115
                or      ah, 8
                mov     [esp+25Ch+var_24C], eax

loc_5C8BBE:                             ; CODE XREF: __output+291↑j
                mov     eax, dword ptr [esp+25Ch+var_244] ; jumptable 005C8AC1 case 115
                mov     esi, 7FFFFFFFh
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5C8BCE
                mov     esi, eax

loc_5C8BCE:                             ; CODE XREF: __output+39A↑j
                lea     ecx, [esp+25Ch+arg_8]
                push    ecx
                call    _get_int_arg
                mov     ecx, eax
                mov     eax, dword ptr [esp+260h+var_24C]
                add     esp, 4
                mov     [esp+25Ch+var_248], ecx
                test    eax, 810h
                jz      short loc_5C8C29
                test    ecx, ecx
                jnz     short loc_5C8BFD
                mov     ecx, off_641264
                mov     [esp+25Ch+var_248], ecx

loc_5C8BFD:                             ; CODE XREF: __output+3C1↑j
                mov     edx, esi
                dec     esi
                test    edx, edx
                mov     [esp+25Ch+var_230], 1
                mov     eax, ecx
                jz      short loc_5C8C1E

loc_5C8C0E:                             ; CODE XREF: __output+3EC↓j
                cmp     word ptr [eax], 0
                jz      short loc_5C8C1E
                add     eax, 2
                mov     edx, esi
                dec     esi
                test    edx, edx
                jnz     short loc_5C8C0E

loc_5C8C1E:                             ; CODE XREF: __output+3DC↑j
                sub     eax, ecx
                sar     eax, 1
                mov     ebp, eax
                jmp     def_5C8AC1      ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119
; ---------------------------------------------------------------------------

loc_5C8C29:                             ; CODE XREF: __output+3BD↑j
                test    ecx, ecx
                jnz     short loc_5C8C37
                mov     ecx, off_641260 ; "(null)"
                mov     [esp+25Ch+var_248], ecx

loc_5C8C37:                             ; CODE XREF: __output+3FB↑j
                mov     edx, esi
                dec     esi
                test    edx, edx
                mov     eax, ecx
                jz      short loc_5C8C4D

loc_5C8C40:                             ; CODE XREF: __output+41B↓j
                cmp     byte ptr [eax], 0
                jz      short loc_5C8C4D
                inc     eax
                mov     edx, esi
                dec     esi
                test    edx, edx
                jnz     short loc_5C8C40

loc_5C8C4D:                             ; CODE XREF: __output+40E↑j
                sub     eax, ecx
                mov     ebp, eax
                jmp     def_5C8AC1      ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119
; ---------------------------------------------------------------------------

loc_5C8C56:                             ; CODE XREF: __output+291↑j
                lea     eax, [esp+25Ch+arg_8] ; jumptable 005C8AC1 case 110
                push    eax
                call    _get_int_arg
                mov     cl, byte ptr [esp+260h+var_24C]
                add     esp, 4
                test    cl, 20h
                jz      short loc_5C8C84
                mov     cx, word ptr [esp+25Ch+var_240]
                mov     [esp+25Ch+var_228], 1
                mov     [eax], cx
                jmp     def_5C8AC1      ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119
; ---------------------------------------------------------------------------

loc_5C8C84:                             ; CODE XREF: __output+43D↑j
                mov     edx, dword ptr [esp+25Ch+var_240]
                mov     [esp+25Ch+var_228], 1
                mov     [eax], edx
                jmp     def_5C8AC1      ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119
; ---------------------------------------------------------------------------

loc_5C8C97:                             ; CODE XREF: __output+291↑j
                mov     [esp+25Ch+var_218], 1 ; jumptable 005C8AC1 cases 69,71
                add     bl, 20h ; ' '

loc_5C8CA2:                             ; CODE XREF: __output+291↑j
                mov     edx, dword ptr [esp+25Ch+var_24C] ; jumptable 005C8AC1 cases 101-103
                lea     eax, [esp+25Ch+MbCh]
                mov     [esp+25Ch+var_248], eax
                mov     eax, dword ptr [esp+25Ch+var_244]
                or      edx, 40h
                test    eax, eax
                mov     [esp+25Ch+var_24C], edx
                jge     short loc_5C8CC7
                mov     [esp+25Ch+var_244], 6
                jmp     short loc_5C8CD6
; ---------------------------------------------------------------------------

loc_5C8CC7:                             ; CODE XREF: __output+48B↑j
                jnz     short loc_5C8CD6
                cmp     bl, 67h ; 'g'
                jnz     short loc_5C8CD6
                mov     [esp+25Ch+var_244], 1

loc_5C8CD6:                             ; CODE XREF: __output+495↑j
                mov     eax, dword ptr [esp+25Ch+arg_8]
                mov     edi, [esp+25Ch+var_244]
                add     eax, 8
                mov     [esp+25Ch+arg_8], eax
                mov     ecx, dword ptr [eax-8]
                mov     [esp+25Ch+var_210], ecx
                mov     edx, dword ptr [eax-4]
                mov     eax, dword ptr [esp+25Ch+var_218]
                mov     [esp+25Ch+var_20C], edx
                movsx   ecx, bl
                push    eax
                push    edi
                lea     edx, [esp+264h+MbCh]
                push    ecx
                lea     eax, [esp+268h+var_210]
                push    edx
                push    eax
                call    off_63F128
; ---------------------------------------------------------------------------
                mov     esi, [esp+270h+var_24C]
                add     esp, 14h
                and     esi, 80h
                jz      short loc_5C8D34
                test    edi, edi
                jnz     short loc_5C8D34
                lea     ecx, [esp+25Ch+MbCh]
                push    ecx
                call    off_63F134
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5C8D34:                             ; CODE XREF: __output+4F0↑j
                cmp     bl, 67h ; 'g'
                jnz     short loc_5C8D4B
                test    esi, esi
                jnz     short loc_5C8D4B
                lea     edx, [esp+25Ch+MbCh]
                push    edx
                call    off_63F12C
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5C8D4B:                             ; CODE XREF: __output+507↑j
                cmp     [esp+25Ch+MbCh], 2Dh ; '-'
                jnz     short loc_5C8D65
                mov     eax, dword ptr [esp+25Ch+var_24C]
                or      ah, 1
                mov     [esp+25Ch+var_24C], eax
                lea     eax, [esp+25Ch+var_1FF]
                mov     [esp+25Ch+var_248], eax

loc_5C8D65:                             ; CODE XREF: __output+520↑j
                mov     edi, [esp+25Ch+var_248]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                dec     ecx
                mov     ebp, ecx
                jmp     def_5C8AC1      ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119
; ---------------------------------------------------------------------------

loc_5C8D7A:                             ; CODE XREF: __output+291↑j
                mov     eax, dword ptr [esp+25Ch+var_24C] ; jumptable 005C8AC1 cases 100,105
                mov     [esp+25Ch+var_22C], 0Ah
                or      al, 40h
                mov     [esp+25Ch+var_24C], eax
                jmp     short loc_5C8DF7
; ---------------------------------------------------------------------------

loc_5C8D8E:                             ; CODE XREF: __output+291↑j
                mov     [esp+25Ch+var_22C], 0Ah ; jumptable 005C8AC1 case 117
                jmp     short loc_5C8DF7
; ---------------------------------------------------------------------------

loc_5C8D98:                             ; CODE XREF: __output+291↑j
                mov     [esp+25Ch+var_244], 8 ; jumptable 005C8AC1 case 112

loc_5C8DA0:                             ; CODE XREF: __output+291↑j
                mov     [esp+25Ch+var_224], 7 ; jumptable 005C8AC1 case 88
                jmp     short loc_5C8DB2
; ---------------------------------------------------------------------------

loc_5C8DAA:                             ; CODE XREF: __output+291↑j
                mov     [esp+25Ch+var_224], 27h ; ''' ; jumptable 005C8AC1 case 120

loc_5C8DB2:                             ; CODE XREF: __output+578↑j
                mov     al, byte ptr [esp+25Ch+var_24C]
                mov     [esp+25Ch+var_22C], 10h
                test    al, 80h
                jz      short loc_5C8DF7
                mov     cl, byte ptr [esp+25Ch+var_224]
                mov     byte ptr [esp+25Ch+var_23A], 30h ; '0'
                add     cl, 51h ; 'Q'
                mov     [esp+25Ch+var_23A+2], 2
                mov     byte ptr [esp+25Ch+var_23A+1], cl
                jmp     short loc_5C8DF7
; ---------------------------------------------------------------------------

loc_5C8DDC:                             ; CODE XREF: __output+291↑j
                mov     al, byte ptr [esp+25Ch+var_24C] ; jumptable 005C8AC1 case 111
                mov     [esp+25Ch+var_22C], 8
                test    al, 80h
                jz      short loc_5C8DF7
                mov     eax, dword ptr [esp+25Ch+var_24C]
                or      ah, 2
                mov     [esp+25Ch+var_24C], eax

loc_5C8DF7:                             ; CODE XREF: __output+55C↑j
                mov     ebx, dword ptr [esp+25Ch+var_24C]
                test    bh, 80h
                jz      short loc_5C8E12
                lea     edx, [esp+25Ch+arg_8]
                push    edx
                call    _get_int64_arg
                add     esp, 4
                jmp     short loc_5C8E74
; ---------------------------------------------------------------------------

loc_5C8E12:                             ; CODE XREF: __output+5CE↑j
                test    bl, 20h
                jz      short loc_5C8E4A
                test    bl, 40h
                jz      short loc_5C8E32
                lea     eax, [esp+25Ch+arg_8]
                push    eax
                call    _get_int_arg
                movsx   eax, ax
                add     esp, 4
                cdq
                jmp     short loc_5C8E74
; ---------------------------------------------------------------------------

loc_5C8E32:                             ; CODE XREF: __output+5EA↑j
                lea     ecx, [esp+25Ch+arg_8]
                push    ecx
                call    _get_int_arg
                add     esp, 4
                and     eax, 0FFFFh
                cdq
                jmp     short loc_5C8E74
; ---------------------------------------------------------------------------

loc_5C8E4A:                             ; CODE XREF: __output+5E5↑j
                test    bl, 40h
                jz      short loc_5C8E62
                lea     edx, [esp+25Ch+arg_8]
                push    edx
                call    _get_int_arg
                add     esp, 4
                cdq
                jmp     short loc_5C8E74
; ---------------------------------------------------------------------------

loc_5C8E62:                             ; CODE XREF: __output+61D↑j
                lea     eax, [esp+25Ch+arg_8]
                push    eax
                call    _get_int_arg
                add     esp, 4
                xor     edx, edx

loc_5C8E74:                             ; CODE XREF: __output+5E0↑j
                test    bl, 40h
                jz      short loc_5C8E97
                test    edx, edx
                jg      short loc_5C8E97
                jl      short loc_5C8E83
                test    eax, eax
                jnb     short loc_5C8E97

loc_5C8E83:                             ; CODE XREF: __output+64D↑j
                neg     eax
                adc     edx, 0
                mov     esi, eax
                neg     edx
                or      bh, 1
                mov     edi, edx
                mov     [esp+25Ch+var_24C], ebx
                jmp     short loc_5C8E9B
; ---------------------------------------------------------------------------

loc_5C8E97:                             ; CODE XREF: __output+647↑j
                mov     esi, eax
                mov     edi, edx

loc_5C8E9B:                             ; CODE XREF: __output+665↑j
                test    bh, 80h
                jnz     short loc_5C8EA3
                and     edi, 0

loc_5C8EA3:                             ; CODE XREF: __output+66E↑j
                mov     ecx, dword ptr [esp+25Ch+var_244]
                test    ecx, ecx
                jge     short loc_5C8EB2
                mov     ecx, 1
                jmp     short loc_5C8EB9
; ---------------------------------------------------------------------------

loc_5C8EB2:                             ; CODE XREF: __output+679↑j
                and     ebx, 0FFFFFFF7h
                mov     [esp+25Ch+var_24C], ebx

loc_5C8EB9:                             ; CODE XREF: __output+680↑j
                mov     edx, esi
                or      edx, edi
                jnz     short loc_5C8EC7
                mov     [esp+25Ch+var_23A+2], 0

loc_5C8EC7:                             ; CODE XREF: __output+68D↑j
                lea     eax, [esp+25Ch+var_1]
                mov     [esp+25Ch+var_248], eax

loc_5C8ED2:                             ; CODE XREF: __output+6F5↓j
                mov     edx, ecx
                dec     ecx
                test    edx, edx
                mov     [esp+25Ch+var_244], ecx
                jg      short loc_5C8EE3
                mov     ecx, esi
                or      ecx, edi
                jz      short loc_5C8F27

loc_5C8EE3:                             ; CODE XREF: __output+6AB↑j
                mov     eax, dword ptr [esp+25Ch+var_22C]
                cdq
                mov     ebp, eax
                push    edx
                push    ebp
                push    edi
                push    esi
                mov     [esp+26Ch+var_204], edx
                call    __aullrem
                mov     edx, dword ptr [esp+25Ch+var_204]
                mov     ebx, eax
                push    edx
                push    ebp
                push    edi
                push    esi
                add     ebx, 30h ; '0'
                call    __aulldiv
                cmp     ebx, 39h ; '9'
                mov     esi, eax
                mov     edi, edx
                jle     short loc_5C8F16
                add     ebx, [esp+25Ch+var_224]

loc_5C8F16:                             ; CODE XREF: __output+6E0↑j
                mov     eax, dword ptr [esp+25Ch+var_248]
                mov     ecx, dword ptr [esp+25Ch+var_244]
                mov     [eax], bl
                dec     eax
                mov     [esp+25Ch+var_248], eax
                jmp     short loc_5C8ED2
; ---------------------------------------------------------------------------

loc_5C8F27:                             ; CODE XREF: __output+6B1↑j
                mov     ecx, dword ptr [esp+25Ch+var_24C]
                lea     ebp, [esp+25Ch+var_1]
                sub     ebp, eax
                inc     eax
                test    ch, 2
                mov     [esp+25Ch+var_248], eax
                jz      short def_5C8AC1 ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119
                cmp     byte ptr [eax], 30h ; '0'
                jnz     short loc_5C8F47
                test    ebp, ebp
                jnz     short def_5C8AC1 ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119

loc_5C8F47:                             ; CODE XREF: __output+711↑j
                dec     eax
                inc     ebp
                mov     [esp+25Ch+var_248], eax
                mov     byte ptr [eax], 30h ; '0'

def_5C8AC1:                             ; CODE XREF: __output+283↑j
                mov     eax, dword ptr [esp+25Ch+var_228] ; jumptable 005C8AC1 default case, cases 68,70,72-82,84-87,89,91-98,104,106-109,113,114,116,118,119
                test    eax, eax
                jnz     def_5C88AD      ; jumptable 005C88AD default case
                mov     ebx, dword ptr [esp+25Ch+var_24C]
                test    bl, 40h
                jz      short loc_5C8F8F
                test    bh, 1
                jz      short loc_5C8F71
                mov     byte ptr [esp+25Ch+var_23A], 2Dh ; '-'
                jmp     short loc_5C8F87
; ---------------------------------------------------------------------------

loc_5C8F71:                             ; CODE XREF: __output+738↑j
                test    bl, 1
                jz      short loc_5C8F7D
                mov     byte ptr [esp+25Ch+var_23A], 2Bh ; '+'
                jmp     short loc_5C8F87
; ---------------------------------------------------------------------------

loc_5C8F7D:                             ; CODE XREF: __output+744↑j
                test    bl, 2
                jz      short loc_5C8F8F
                mov     byte ptr [esp+25Ch+var_23A], 20h ; ' '

loc_5C8F87:                             ; CODE XREF: __output+73F↑j
                mov     [esp+25Ch+var_23A+2], 1

loc_5C8F8F:                             ; CODE XREF: __output+733↑j
                mov     edi, [esp+25Ch+var_234]
                mov     ecx, dword ptr [esp+25Ch+var_23A+2]
                sub     edi, ebp
                sub     edi, ecx
                test    bl, 0Ch
                jnz     short loc_5C8FBA
                mov     esi, [esp+25Ch+File]
                lea     eax, [esp+25Ch+var_240]
                push    eax             ; int
                push    esi             ; File
                push    edi             ; int
                push    20h ; ' '       ; int
                call    _write_multi_char
                add     esp, 10h
                jmp     short loc_5C8FC1
; ---------------------------------------------------------------------------

loc_5C8FBA:                             ; CODE XREF: __output+76E↑j
                mov     esi, [esp+25Ch+File]

loc_5C8FC1:                             ; CODE XREF: __output+788↑j
                mov     edx, dword ptr [esp+25Ch+var_23A+2]
                lea     ecx, [esp+25Ch+var_240]
                push    ecx             ; int
                push    esi             ; File
                lea     eax, [esp+264h+var_23A]
                push    edx             ; int
                push    eax             ; int
                call    _write_string
                add     esp, 10h
                test    bl, 8
                jz      short loc_5C8FF4
                test    bl, 4
                jnz     short loc_5C8FF4
                lea     ecx, [esp+25Ch+var_240]
                push    ecx             ; int
                push    esi             ; File
                push    edi             ; int
                push    30h ; '0'       ; int
                call    _write_multi_char
                add     esp, 10h

loc_5C8FF4:                             ; CODE XREF: __output+7AC↑j
                mov     eax, dword ptr [esp+25Ch+var_230]
                test    eax, eax
                jz      loc_5C9096
                test    ebp, ebp
                jle     loc_5C9096
                mov     esi, [esp+25Ch+var_248]
                lea     ebx, [ebp-1]

loc_5C900F:                             ; CODE XREF: __output+817↓j
                mov     ax, [esi]
                lea     edx, [esp+25Ch+var_214]
                push    eax             ; WCh
                push    edx             ; MbCh
                add     esi, 2
                call    _wctomb
                add     esp, 8
                test    eax, eax
                jle     short loc_5C9049
                mov     edx, dword ptr [esp+25Ch+File]
                lea     ecx, [esp+25Ch+var_240]
                push    ecx             ; int
                push    edx             ; File
                push    eax             ; int
                lea     eax, [esp+268h+var_214]
                push    eax             ; int
                call    _write_string
                add     esp, 10h
                mov     ecx, ebx
                dec     ebx
                test    ecx, ecx
                jnz     short loc_5C900F

loc_5C9049:                             ; CODE XREF: __output+7F5↑j
                mov     ebx, dword ptr [esp+25Ch+var_24C]

loc_5C904D:                             ; CODE XREF: __output+87A↓j
                test    bl, 4
                jz      short def_5C88AD ; jumptable 005C88AD default case
                mov     edx, dword ptr [esp+25Ch+File]
                lea     ecx, [esp+25Ch+var_240]
                push    ecx             ; int
                push    edx             ; File
                push    edi             ; int
                push    20h ; ' '       ; int
                call    _write_multi_char
                add     esp, 10h

def_5C88AD:                             ; CODE XREF: __output+77↑j
                mov     edi, [esp+25Ch+arg_4] ; jumptable 005C88AD default case
                mov     bl, [edi]
                inc     edi
                test    bl, bl
                mov     byte ptr [esp+25Ch+var_21C], bl
                mov     [esp+25Ch+arg_4], edi
                jnz     loc_5C8865

loc_5C9087:                             ; CODE XREF: __output+29↑j
                mov     eax, dword ptr [esp+25Ch+var_240]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 24Ch
                retn
; ---------------------------------------------------------------------------

loc_5C9096:                             ; CODE XREF: __output+7CA↑j
                mov     eax, dword ptr [esp+25Ch+var_248]
                lea     edx, [esp+25Ch+var_240]
                push    edx             ; int
                push    esi             ; File
                push    ebp             ; int
                push    eax             ; int
                call    _write_string
                add     esp, 10h
                jmp     short loc_5C904D
__output        endp

; ---------------------------------------------------------------------------
jpt_5C88AD      dd offset $NORMAL_STATE$8072 ; DATA XREF: __output+7D↑r
                dd offset loc_5C88B4    ; jump table for switch statement
                dd offset loc_5C88D9
                dd offset loc_5C8942
                dd offset loc_5C898C
                dd offset loc_5C8995
                dd offset loc_5C89DA
                dd offset loc_5C8AAA
jpt_5C88F0      dd offset loc_5C8915    ; DATA XREF: __output+C0↑r
                dd offset loc_5C8924    ; jump table for switch statement
                dd offset loc_5C8906
                dd offset loc_5C88F7
                dd offset loc_5C8933
                dd offset def_5C88AD
byte_5C90E4     db      0,     5,     5,     1
                db      5,     5,     5,     5 ; indirect table for switch statement
                db      5,     5,     5,     2
                db      5,     3,     5,     5
                db      4
                align 4
jpt_5C89F1      dd offset loc_5C8A07    ; DATA XREF: __output+1C1↑r
                dd offset loc_5C8A8B    ; jump table for switch statement
                dd offset loc_5C89F8
                dd offset loc_5C8A9A
                dd offset def_5C88AD
byte_5C910C     db      0,     4,     4,     4
                db      4,     4,     4,     4 ; indirect table for switch statement
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     1
                db      4,     4,     4,     2
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     3
                align 4
jpt_5C8AC1      dd offset loc_5C8AC8    ; DATA XREF: __output+291↑r
                dd offset loc_5C8C97    ; jump table for switch statement
                dd offset loc_5C8C97
                dd offset loc_5C8BAC
                dd offset loc_5C8DA0
                dd offset loc_5C8B43
                dd offset loc_5C8ADA
                dd offset loc_5C8D7A
                dd offset loc_5C8CA2
                dd offset loc_5C8D7A
                dd offset loc_5C8C56
                dd offset loc_5C8DDC
                dd offset loc_5C8D98
                dd offset loc_5C8BBE
                dd offset loc_5C8D8E
                dd offset loc_5C8DAA
                dd offset def_5C8AC1
byte_5C9180     db      0,   10h,     1,   10h
                db      2,   10h,   10h,   10h ; indirect table for switch statement
                db    10h,   10h,   10h,   10h
                db    10h,   10h,   10h,   10h
                db      3,   10h,   10h,   10h
                db    10h,     4,   10h,     5
                db    10h,   10h,   10h,   10h
                db    10h,   10h,   10h,   10h
                db      6,     7,     8,     8
                db      8,   10h,     9,   10h
                db    10h,   10h,   10h,   0Ah
                db    0Bh,   0Ch,   10h,   10h
                db    0Dh,   10h,   0Eh,   10h
                db    10h,   0Fh
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl write_char(int, FILE *File, int)
_write_char     proc near               ; CODE XREF: __output+22B↑p

arg_0           = dword ptr  4
File            = dword ptr  8
arg_8           = dword ptr  0Ch

                mov     ecx, dword ptr [esp+File]
                mov     eax, dword ptr [ecx+4]
                dec     eax
                mov     [ecx+4], eax
                js      short loc_5C91E1
                mov     edx, dword ptr [ecx]
                mov     eax, dword ptr [esp+arg_0]
                mov     [edx], al
                mov     edx, dword ptr [ecx]
                and     eax, 0FFh
                inc     edx
                mov     [ecx], edx
                jmp     short loc_5C91EF
; ---------------------------------------------------------------------------

loc_5C91E1:                             ; CODE XREF: _write_char+B↑j
                mov     eax, dword ptr [esp+arg_0]
                push    ecx             ; File
                push    eax             ; Ch
                call    __flsbuf
                add     esp, 8

loc_5C91EF:                             ; CODE XREF: _write_char+1F↑j
                cmp     eax, 0FFFFFFFFh
                jnz     short loc_5C91FB
                mov     ecx, dword ptr [esp+arg_8]
                mov     [ecx], eax
                retn
; ---------------------------------------------------------------------------

loc_5C91FB:                             ; CODE XREF: _write_char+32↑j
                mov     eax, dword ptr [esp+arg_8]
                inc     dword ptr [eax]
                retn
_write_char     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl write_multi_char(int, int, FILE *File, int)
_write_multi_char proc near             ; CODE XREF: __output+780↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
File            = dword ptr  0Ch
arg_C           = dword ptr  10h

                push    ebx
                push    ebp
                mov     ebp, [esp+8+arg_4]
                push    esi
                mov     eax, ebp
                dec     ebp
                test    eax, eax
                push    edi
                jle     short loc_5C9244
                mov     esi, [esp+10h+arg_C]
                mov     edi, [esp+10h+File]
                mov     ebx, dword ptr [esp+10h+arg_0]

loc_5C922B:                             ; CODE XREF: _write_multi_char+32↓j
                push    esi             ; int
                push    edi             ; File
                push    ebx             ; int
                call    _write_char
                mov     eax, dword ptr [esi]
                add     esp, 0Ch
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5C9244
                mov     ecx, ebp
                dec     ebp
                test    ecx, ecx
                jg      short loc_5C922B

loc_5C9244:                             ; CODE XREF: _write_multi_char+D↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
_write_multi_char endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl write_string(int, int, FILE *File, int)
_write_string   proc near               ; CODE XREF: __output+7A1↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
File            = dword ptr  0Ch
arg_C           = dword ptr  10h

                push    ebx
                push    ebp
                mov     ebp, [esp+8+arg_4]
                push    esi
                mov     eax, ebp
                dec     ebp
                test    eax, eax
                push    edi
                jle     short loc_5C9288
                mov     edi, [esp+10h+arg_C]
                mov     ebx, dword ptr [esp+10h+File]
                mov     esi, [esp+10h+arg_0]

loc_5C926B:                             ; CODE XREF: _write_string+36↓j
                movsx   eax, byte ptr [esi]
                push    edi             ; int
                push    ebx             ; File
                push    eax             ; int
                inc     esi
                call    _write_char
                mov     eax, dword ptr [edi]
                add     esp, 0Ch
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5C9288
                mov     ecx, ebp
                dec     ebp
                test    ecx, ecx
                jg      short loc_5C926B

loc_5C9288:                             ; CODE XREF: _write_string+D↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
_write_string   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_get_int_arg    proc near               ; CODE XREF: __output+11F↑p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                mov     ecx, dword ptr [eax]
                add     ecx, 4
                mov     [eax], ecx
                mov     eax, ecx
                mov     eax, dword ptr [eax-4]
                retn
_get_int_arg    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_get_int64_arg  proc near               ; CODE XREF: __output+5D8↑p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                mov     ecx, dword ptr [eax]
                add     ecx, 8
                mov     [eax], ecx
                mov     eax, dword ptr [ecx-8]
                mov     edx, dword ptr [ecx-4]
                retn
_get_int64_arg  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_get_short_arg  proc near               ; CODE XREF: __output+2BC↑p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                mov     ecx, dword ptr [eax]
                add     ecx, 4
                mov     [eax], ecx
                mov     eax, ecx
                mov     ax, [eax-4]
                retn
_get_short_arg  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _isctype(int C, int Type)
__isctype       proc near               ; CODE XREF: _isalpha+13↑p

CharType        = word ptr -4
varC               = dword ptr  4
varType            = dword ptr  8

                push    ecx
                mov     ecx, dword ptr [esp+4+varC]
                push    esi
                lea     eax, [ecx+1]
                cmp     eax, 100h
                ja      short loc_5C9315
                mov     edx, off_641268
                xor     eax, eax
                mov     ax, [edx+ecx*2]
                mov     ecx, dword ptr [esp+8+varType]
                and     eax, ecx
                pop     esi
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C9315:                             ; CODE XREF: __isctype+E↑j
                mov     esi, off_641268
                mov     eax, ecx
                sar     eax, 8
                mov     edx, eax
                and     edx, 0FFh
                test    byte ptr [esi+edx*2+1], 80h
                jz      short loc_5C9343
                mov     byte ptr [esp+8+varC], al
                mov     byte ptr [esp+8+varC+1], cl
                mov     byte ptr [esp+8+varC+2], 0
                mov     eax, 2
                jmp     short loc_5C9351
; ---------------------------------------------------------------------------

loc_5C9343:                             ; CODE XREF: __isctype+3D↑j
                mov     byte ptr [esp+8+varC], cl
                mov     byte ptr [esp+8+varC+1], 0
                mov     eax, 1

loc_5C9351:                             ; CODE XREF: __isctype+51↑j
                push    0               ; Locale
                lea     ecx, [esp+0Ch+CharType]
                push    0               ; CodePage
                push    ecx             ; lpCharType
                lea     edx, [esp+14h+varC]
                push    eax             ; cchSrc
                push    edx             ; lpSrcStr
                push    1               ; dwInfoType
                call    ___crtGetStringTypeA
                add     esp, 18h
                test    eax, eax
                jnz     short loc_5C9371
                pop     esi
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5C9371:                             ; CODE XREF: __isctype+7C↑j
                mov     eax, dword ptr [esp+8+CharType]
                mov     ecx, dword ptr [esp+8+varType]
                and     eax, 0FFFFh
                pop     esi
                and     eax, ecx
                pop     ecx
                retn
__isctype       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

fFYTOX          proc near

; FUNCTION CHUNK AT 005C8438 SIZE 00000004 BYTES
; FUNCTION CHUNK AT 005C844B SIZE 00000007 BYTES
; FUNCTION CHUNK AT 005C84E6 SIZE 00000013 BYTES

                mov     byte ptr [ebp-90h], 0FEh
                or      ch, ch
                jnz     short negYTOX
                fxch    st(1)

fFXTOY:                                 ; CODE XREF: fFYTOX+6C↓j
                fyl2x
                jmp     short fF2X
; ---------------------------------------------------------------------------

__fFEXP:
                mov     byte ptr [ebp-90h], 0FEh
                xor     ch, ch
                fldl2e
                fmulp   st(1), st

fF2X:                                   ; CODE XREF: fFYTOX+F↑j
                call    __ffexpm1
                fld1
                faddp   st(1), st
                test    byte ptr [ebp-9Fh], 1
                jz      short fdivr_done
                fld1
                cmp     dword_70D324, 1
                jz      short badP5_fdivr
                fdivrp  st(1), st
                jmp     short fdivr_done
; ---------------------------------------------------------------------------

badP5_fdivr:                            ; CODE XREF: fFYTOX+39↑j
                call    unknown_libname_332 ; Microsoft VisualC 2-14/net runtime

fdivr_done:                             ; CODE XREF: fFYTOX+2E↑j
                test    dl, 40h
                jnz     short ExpScaled
                fscale

ExpScaled:                              ; CODE XREF: fFYTOX+47↑j
                or      ch, ch
                jz      short expret
                fchs

expret:                                 ; CODE XREF: fFYTOX+4D↑j
                jmp     __rttospop
; ---------------------------------------------------------------------------

negYTOX:                                ; CODE XREF: fFYTOX+9↑j
                call    _isintTOS
                or      eax, eax
                jz      short negYTOXerror
                xor     ch, ch
                cmp     eax, 2
                jz      short evenexp
                not     ch

evenexp:                                ; CODE XREF: fFYTOX+64↑j
                fxch    st(1)
                fabs
                jmp     short fFXTOY
; ---------------------------------------------------------------------------

_rtfor0to0:
                jmp     __rtonepop
; ---------------------------------------------------------------------------

negYTOXerror:                           ; CODE XREF: fFYTOX+5D↑j
                jmp     __rtindfpop
fFYTOX          endp

; ---------------------------------------------------------------------------

__rtinfpopse:
                fstp    st

__rtinfnpopse:
                fstp    st
                fld     tbyte ptr [tbyte_641480]
                mov     byte ptr [ebp-90h], 2
                retn
; ---------------------------------------------------------------------------

__fFLN:
                fldln2
                fxch    st(1)
                ftst
                fstsw   word ptr [ebp-0A0h]
                wait
                test    byte ptr [ebp-9Fh], 41h
                jnz     short negYTOXerror
                fyl2x
                retn
; ---------------------------------------------------------------------------

_rtforln0:
                mov     byte ptr [ebp-90h], 2
                fstp    st
                fld     tbyte ptr [tbyte_64148A]
                retn
; ---------------------------------------------------------------------------

_rtforloginf:
                or      cl, cl
                jnz     short tranindfnpop
                retn
; ---------------------------------------------------------------------------

fFLOGm:
                fldlg2
                jmp     short fFYL2Xm
; ---------------------------------------------------------------------------

fFLNm:
                fldln2

fFYL2Xm:                                ; CODE XREF: .text:005C944B↑j
                fxch    st(1)
                or      cl, cl
                jnz     short negYTOXerror
                fyl2x
                retn
; ---------------------------------------------------------------------------

_rtforyto0:
                jmp     __rtonepop
; ---------------------------------------------------------------------------

_rtfor0tox:
                call    _isintTOS
                fstp    st
                fstp    st
                or      cl, cl
                jnz     short _rtfor0toneg
                fldz
                cmp     eax, 1
                jnz     short zerotoxdone
                or      ch, ch
                jz      short zerotoxdone
                fchs

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

zerotoxdone     proc near               ; CODE XREF: .text:005C946F↑j
                retn
zerotoxdone     endp

; ---------------------------------------------------------------------------

_rtfor0toneg:                           ; CODE XREF: .text:005C9468↑j
                mov     byte ptr [ebp-90h], 2
                fld     tbyte ptr [tbyte_641480]
                cmp     eax, 1
                jnz     short zerotoxdone
                or      ch, ch
                jz      short zerotoxdone
                fchs
                jmp     short zerotoxdone
; ---------------------------------------------------------------------------

tranzeropop:
                fstp    st

tranzeronpop:                           ; CODE XREF: .text:005C94E3↓j
                jmp     __rtzeronpop
; ---------------------------------------------------------------------------

tranindfpop:
                fstp    st

tranindfnpop:                           ; CODE XREF: .text:005C9446↑j
                jmp     __rtindfnpop
; ---------------------------------------------------------------------------
; START OF FUNCTION CHUNK FOR __ffexpm1

ExpArgOutOfRange:                       ; CODE XREF: __ffexpm1+1B↓j
                pop     eax
                ftst
                fstsw   word ptr [ebp-0A0h]
                wait
                test    byte ptr [ebp-9Fh], 1
                jnz     short zeronpopue
                fstp    st
                fld     tbyte ptr [tbyte_641480]
                or      ch, ch
                jz      short _expbigret
                fchs
; END OF FUNCTION CHUNK FOR __ffexpm1

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_expbigret      proc near               ; CODE XREF: __ffexpm1-30↑j
                retn
_expbigret      endp

; ---------------------------------------------------------------------------
; START OF FUNCTION CHUNK FOR __ffexpm1

zeronpopue:                             ; CODE XREF: __ffexpm1-3C↑j
                mov     byte ptr [ebp-90h], 4
                jmp     __rtzeronpop
; END OF FUNCTION CHUNK FOR __ffexpm1
; ---------------------------------------------------------------------------

__rtinfpop:
                fstp    st

__rtinfnpop:
                fstp    st
                fld     tbyte ptr [tbyte_641480]

setOVERFLOW:
                mov     byte ptr [ebp-90h], 3
                retn
; ---------------------------------------------------------------------------

_rtforexpinf:
                or      cl, cl
                jnz     short tranzeronpop
                fstp    st
                fld     tbyte ptr [tbyte_641480]
                retn

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__ffexpm1       proc near               ; CODE XREF: fFYTOX:fF2X↑p

; FUNCTION CHUNK AT 005C8446 SIZE 00000005 BYTES
; FUNCTION CHUNK AT 005C94A0 SIZE 00000022 BYTES
; FUNCTION CHUNK AT 005C94C3 SIZE 0000000C BYTES

                fld     st
                fabs
                fld     tbyte_64149E
                fcompp
                fstsw   word ptr [ebp-0A0h]
                wait
                test    byte ptr [ebp-9Fh], 41h
                jnz     short ExpArgOutOfRange
                fld     st
                frndint
                ftst
                fstsw   word ptr [ebp-0A0h]
                wait
                mov     dl, [ebp-9Fh]
                fxch    st(1)
                fsub    st, st(1)
                ftst
                fstsw   word ptr [ebp-0A0h]
                fabs
                f2xm1
                retn
__ffexpm1       endp ; sp-analysis failed


; =============== S U B R O U T I N E =======================================

; Attributes: library function

_isintTOS       proc near               ; CODE XREF: fFYTOX:negYTOX↑p

; FUNCTION CHUNK AT 005C9557 SIZE 0000000E BYTES

                fld     st
                frndint
                fcomp   st(1)
                fstsw   ax
                sahf
                jnz     short notanint
                fld     st
                fmul    dbl_6414B2
                fld     st
                frndint
                fcompp
                fstsw   ax
                sahf
                jz      short evenint
                mov     eax, 1
_isintTOS       endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_isintTOSret    proc near               ; CODE XREF: _isintTOS+2B↓j
                retn
_isintTOSret    endp

; ---------------------------------------------------------------------------
; START OF FUNCTION CHUNK FOR _isintTOS

notanint:                               ; CODE XREF: _isintTOS+A↑j
                mov     eax, 0
                jmp     short _isintTOSret
; ---------------------------------------------------------------------------

evenint:                                ; CODE XREF: _isintTOS+1E↑j
                mov     eax, 2
                jmp     short _isintTOSret
; END OF FUNCTION CHUNK FOR _isintTOS
; ---------------------------------------------------------------------------

_usepowhlp:
                push    esi
                sub     esp, 74h
                mov     esi, esp
                push    esi
                sub     esp, 8
                fstp    qword ptr [esp]
                sub     esp, 8
                fstp    qword ptr [esp]
                fsave   byte ptr [esi+8]
                call    __powhlp
                add     esp, 14h
                frstor  byte ptr [esi+8]
                fld     qword ptr [esi]
                add     esp, 74h
                pop     esi
                test    eax, eax
                jz      short noerror
                jmp     __rttosnpopde

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

noerror         proc near               ; CODE XREF: .text:005C958F↑j
                retn
noerror         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

__cintrindisp2  proc near               ; CODE XREF: .text:005C13BF↑j

var_2C8         = byte ptr -2C8h
var_A4          = word ptr -0A4h
var_86          = qword ptr -86h
var_7E          = qword ptr -7Eh

                push    ebp
                mov     ebp, esp
                add     esp, 0FFFFFD30h
                push    ebx
                fstcw   [ebp+var_A4]
                wait
                cmp     dword_642634, 0
                jz      short save2arg

resume2:                                ; CODE XREF: __cintrindisp2+3C↓j
                call    __trandisp2
                or      [ebp+var_2C8], 3
                call    cintrinexit
                pop     ebx
                leave
                retn
; ---------------------------------------------------------------------------

save2arg:                               ; CODE XREF: __cintrindisp2+19↑j
                fxch    st(1)
                fst     [ebp+var_86]
                fxch    st(1)
                fst     [ebp+var_7E]
                jmp     short resume2
__cintrindisp2  endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

__cintrindisp1  proc near               ; CODE XREF: .text:005BFC8F↑j

var_2C8         = byte ptr -2C8h
var_A4          = word ptr -0A4h
var_86          = qword ptr -86h

                push    ebp
                mov     ebp, esp
                add     esp, 0FFFFFD30h
                push    ebx
                fstcw   [ebp+var_A4]
                cmp     dword_642634, 0
                jz      short save1arg

resume1:                                ; CODE XREF: __cintrindisp1+3B↓j
                call    __trandisp1
                or      [ebp+var_2C8], 1
                and     [ebp+var_2C8], 0FDh
                call    cintrinexit
                pop     ebx
                leave
                retn
; ---------------------------------------------------------------------------

save1arg:                               ; CODE XREF: __cintrindisp1+18↑j
                fst     [ebp+var_86]
                jmp     short resume1
__cintrindisp1  endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; int __cdecl _ctrandisp2(double, double)
__ctrandisp2    proc near               ; CODE XREF: _atan2+5↑j

var_2C8         = byte ptr -2C8h
var_A4          = word ptr -0A4h
var_8F          = byte ptr -8Fh
arg_0           = qword ptr  8
arg_8           = qword ptr  10h

                push    ebp
                mov     ebp, esp
                add     esp, 0FFFFFD30h
                push    ebx
                push    dword ptr [ebp+arg_0+4]
                push    dword ptr [ebp+arg_0] ; double
                call    __fload
                add     esp, 8
                push    dword ptr [ebp+arg_8+4]
                push    dword ptr [ebp+arg_8] ; double
                call    __fload
                add     esp, 8
                fstcw   [ebp+var_A4]
                or      [ebp+var_2C8], 2
                mov     [ebp+var_8F], 1
                call    __trandisp2
                call    ctranexit
                pop     ebx
                leave
                retn
__ctrandisp2    endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function static

ctranexit       proc near               ; CODE XREF: __ctrandisp2+40↑p
                and     byte ptr [ebp-2C8h], 0FEh
ctranexit       endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function static

cintrinexit     proc near               ; CODE XREF: __cintrindisp2+27↑p
                cmp     dword_70D320, 0
                jnz     short restoreCW
                fst     qword ptr [ebp-2D0h]
                mov     al, [ebp-90h]
                or      al, al
                jz      short checkinexact
                cmp     al, 0FFh
                jz      short checkrng
                cmp     al, 0FEh
                jz      short checkrng
                or      al, al
                jz      short restoreCW
                movsx   eax, al
                mov     [ebp-8Eh], eax
                jmp     haveerror
; ---------------------------------------------------------------------------

checkinexact:                           ; CODE XREF: cintrinexit+17↑j
                mov     ax, [ebp-0A4h]
                and     ax, 20h
                jnz     short restoreCW
                fstsw   ax
                and     ax, 20h
                jz      short restoreCW
                mov     dword ptr [ebp-8Eh], 8
                jmp     short haveerror
; ---------------------------------------------------------------------------

restoreCW:                              ; CODE XREF: cintrinexit+7↑j
                fldcw   word ptr [ebp-0A4h]
                wait
                retn
; ---------------------------------------------------------------------------

checkrng:                               ; CODE XREF: cintrinexit+1B↑j
                mov     ax, [ebp-2CAh]
                and     ax, 7FF0h
                or      ax, ax
                jz      short haveunderflow_0
                cmp     ax, 7FF0h
                jz      short haveoverflow_0
                jmp     short checkinexact
; ---------------------------------------------------------------------------

haveunderflow_0:                        ; CODE XREF: cintrinexit+6B↑j
                mov     dword ptr [ebp-8Eh], 4
                fld     qword ptr [dbl_614748]
                fxch    st(1)
                fscale
                fstp    st(1)
                fld     st
                fabs
                fcomp   qword ptr [dbl_614738]
                fstsw   ax
                sahf
                jnb     short haveerror
                fmul    qword ptr [dbl_614758]
                jmp     short haveerror
; ---------------------------------------------------------------------------

haveoverflow_0:                         ; CODE XREF: cintrinexit+71↑j
                mov     dword ptr [ebp-8Eh], 3
                fld     qword ptr [dbl_614740]
                fxch    st(1)
                fscale
                fstp    st(1)
                fld     st
                fabs
                fcomp   qword ptr [dbl_614730]
                fstsw   ax
                sahf
                jbe     short haveerror
                fmul    qword ptr [dbl_614750]

haveerror:                              ; CODE XREF: cintrinexit+2E↑j
                push    esi
                push    edi
                mov     ebx, dword ptr [ebp-94h]
                inc     ebx
                mov     [ebp-8Ah], ebx
                test    byte ptr [ebp-2C8h], 1
                jnz     short aftercopy
                cld
                lea     esi, [ebp+8]
                lea     edi, [ebp-86h]
                movsd
                movsd
                cmp     byte ptr [ebx+0Ch], 1
                jz      short aftercopy
                lea     esi, [ebp+10h]
                lea     edi, [ebp-7Eh]
                movsd
                movsd

aftercopy:                              ; CODE XREF: cintrinexit+E5↑j
                fstp    qword ptr [ebp-76h]
                lea     eax, [ebp-8Eh]
                lea     ebx, [ebp-0A4h]
                push    ebx
                push    eax
                mov     ebx, dword ptr [ebp-94h]
                mov     al, [ebx+0Eh]
                movsx   eax, al
                push    eax
                call    __87except
                add     esp, 0Ch

movretval:
                pop     edi
                pop     esi
                fld     qword ptr [ebp-76h]
                jmp     restoreCW
cintrinexit     endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; int __cdecl _ctrandisp1(double)
__ctrandisp1    proc near               ; CODE XREF: sub_5BFC80+5↑j

var_2C8         = byte ptr -2C8h
var_A4          = word ptr -0A4h
arg_0           = qword ptr  8

                push    ebp
                mov     ebp, esp
                add     esp, 0FFFFFD30h
                push    ebx
                push    dword ptr [ebp+arg_0+4]
                push    dword ptr [ebp+arg_0] ; double
                call    __fload
                add     esp, 8
                fstcw   [ebp+var_A4]
                and     [ebp+var_2C8], 0FDh
                call    __trandisp1
                call    ctranexit
                pop     ebx
                leave
                retn
__ctrandisp1    endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; int __cdecl _fload(double)
__fload         proc near               ; CODE XREF: __ctrandisp2+10↑p

var_A           = tbyte ptr -0Ah
arg_0           = qword ptr  8

                push    ebp
                mov     ebp, esp
                add     esp, 0FFFFFFF4h
                push    ebx
                mov     ax, word ptr [ebp+arg_0+6]
                mov     bx, ax
                and     ax, 7FF0h
                cmp     ax, 7FF0h
                jnz     short fpload
                or      bx, 7FFFh
                mov     word ptr [ebp+var_A+8], bx
                mov     eax, dword ptr [ebp+0Ch]
                mov     ebx, dword ptr [ebp+arg_0]
                shld    eax, ebx, 0Bh
                mov     dword ptr [ebp+var_A+4], eax
                mov     dword ptr [ebp+var_A], ebx
                fld     [ebp+var_A]
                jmp     short return
; ---------------------------------------------------------------------------

fpload:                                 ; CODE XREF: __fload+16↑j
                fld     [ebp+arg_0]

return:                                 ; CODE XREF: __fload+34↑j
                pop     ebx
                leave
                retn
__fload         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__aulldiv       proc near               ; CODE XREF: x64toa(x,x,x,x,x)+3B↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                push    ebx
                push    esi
                mov     eax, dword ptr [esp+8+arg_C]
                or      eax, eax
                jnz     short loc_5C9832
                mov     ecx, dword ptr [esp+8+arg_8]
                mov     eax, dword ptr [esp+8+arg_4]
                xor     edx, edx
                div     ecx
                mov     ebx, eax
                mov     eax, dword ptr [esp+8+arg_0]
                div     ecx
                mov     edx, ebx
                jmp     short loc_5C9873
; ---------------------------------------------------------------------------

loc_5C9832:                             ; CODE XREF: __aulldiv+8↑j
                mov     ecx, eax
                mov     ebx, dword ptr [esp+8+arg_8]
                mov     edx, dword ptr [esp+8+arg_4]
                mov     eax, dword ptr [esp+8+arg_0]

loc_5C9840:                             ; CODE XREF: __aulldiv+3A↓j
                shr     ecx, 1
                rcr     ebx, 1
                shr     edx, 1
                rcr     eax, 1
                or      ecx, ecx
                jnz     short loc_5C9840
                div     ebx
                mov     esi, eax
                mul     [esp+8+arg_C]
                mov     ecx, eax
                mov     eax, dword ptr [esp+8+arg_8]
                mul     esi
                add     edx, ecx
                jb      short loc_5C986E
                cmp     edx, [esp+8+arg_4]
                ja      short loc_5C986E
                jb      short loc_5C986F
                cmp     eax, [esp+8+arg_0]
                jbe     short loc_5C986F

loc_5C986E:                             ; CODE XREF: __aulldiv+4E↑j
                dec     esi

loc_5C986F:                             ; CODE XREF: __aulldiv+56↑j
                xor     edx, edx
                mov     eax, esi

loc_5C9873:                             ; CODE XREF: __aulldiv+20↑j
                pop     esi
                pop     ebx
                retn    10h
__aulldiv       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__aullrem       proc near               ; CODE XREF: x64toa(x,x,x,x,x)+2A↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                push    ebx
                mov     eax, dword ptr [esp+4+arg_C]
                or      eax, eax
                jnz     short loc_5C98A1
                mov     ecx, dword ptr [esp+4+arg_8]
                mov     eax, dword ptr [esp+4+arg_4]
                xor     edx, edx
                div     ecx
                mov     eax, dword ptr [esp+4+arg_0]
                div     ecx
                mov     eax, edx
                xor     edx, edx
                jmp     short loc_5C98F1
; ---------------------------------------------------------------------------

loc_5C98A1:                             ; CODE XREF: __aullrem+7↑j
                mov     ecx, eax
                mov     ebx, dword ptr [esp+4+arg_8]
                mov     edx, dword ptr [esp+4+arg_4]
                mov     eax, dword ptr [esp+4+arg_0]

loc_5C98AF:                             ; CODE XREF: __aullrem+39↓j
                shr     ecx, 1
                rcr     ebx, 1
                shr     edx, 1
                rcr     eax, 1
                or      ecx, ecx
                jnz     short loc_5C98AF
                div     ebx
                mov     ecx, eax
                mul     [esp+4+arg_C]
                xchg    eax, ecx
                mul     [esp+4+arg_8]
                add     edx, ecx
                jb      short loc_5C98DA
                cmp     edx, [esp+4+arg_4]
                ja      short loc_5C98DA
                jb      short loc_5C98E2
                cmp     eax, [esp+4+arg_0]
                jbe     short loc_5C98E2

loc_5C98DA:                             ; CODE XREF: __aullrem+4A↑j
                sub     eax, [esp+4+arg_8]
                sbb     edx, [esp+4+arg_C]

loc_5C98E2:                             ; CODE XREF: __aullrem+52↑j
                sub     eax, [esp+4+arg_0]
                sbb     edx, [esp+4+arg_4]
                neg     edx
                neg     eax
                sbb     edx, 0

loc_5C98F1:                             ; CODE XREF: __aullrem+1F↑j
                pop     ebx
                retn    10h
__aullrem       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _close(int FileHandle)
__close         proc near               ; CODE XREF: __fclose_lk+27↑p

FileHandle      = dword ptr  4

                mov     eax, uNumber
                push    esi
                mov     esi, [esp+4+FileHandle]
                push    edi
                cmp     esi, eax
                jnb     short loc_5C994C
                mov     eax, esi
                mov     ecx, esi
                and     eax, 1Fh
                sar     ecx, 5
                lea     edx, [eax+eax*8]
                mov     eax, __pioinfo[ecx*4]
                test    byte ptr [eax+edx*4+4], 1
                jz      short loc_5C994C
                push    esi
                call    __lock_fhandle
                add     esp, 4
                push    esi             ; FileHandle
                call    __close_lk
                add     esp, 4
                mov     edi, eax
                push    esi
                call    __unlock_fhandle
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C994C:                             ; CODE XREF: __close+D↑j
                call    __errno
                mov     dword ptr [eax], 9
                call    ___doserrno
                mov     dword ptr [eax], 0
                pop     edi
                or      eax, 0FFFFFFFFh
                pop     esi
                retn
__close         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _close_lk(int FileHandle)
__close_lk      proc near               ; CODE XREF: __close+34↑p

FileHandle      = dword ptr  4

                push    esi
                mov     esi, [esp+4+FileHandle]
                push    edi
                push    esi             ; FileHandle
                call    __get_osfhandle
                add     esp, 4
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5C99C6
                cmp     esi, 1
                jz      short loc_5C998E
                cmp     esi, 2
                jnz     short loc_5C99A8

loc_5C998E:                             ; CODE XREF: __close_lk+17↑j
                push    1               ; FileHandle
                call    __get_osfhandle
                add     esp, 4
                mov     edi, eax
                push    2               ; FileHandle
                call    __get_osfhandle
                add     esp, 4
                cmp     edi, eax
                jz      short loc_5C99C6

loc_5C99A8:                             ; CODE XREF: __close_lk+1C↑j
                push    esi             ; FileHandle
                call    __get_osfhandle
                add     esp, 4
                push    eax             ; hObject
                call    CloseHandle
                test    eax, eax
                jnz     short loc_5C99C6
                call    GetLastError
                mov     edi, eax
                jmp     short loc_5C99C8
; ---------------------------------------------------------------------------

loc_5C99C6:                             ; CODE XREF: __close_lk+12↑j
                xor     edi, edi

loc_5C99C8:                             ; CODE XREF: __close_lk+54↑j
                push    esi
                call    __free_osfhnd
                mov     eax, esi
                and     esi, 1Fh
                sar     eax, 5
                lea     ecx, [esi+esi*8]
                add     esp, 4
                mov     edx, __pioinfo[eax*4]
                test    edi, edi
                mov     byte ptr [edx+ecx*4+4], 0
                jz      short loc_5C99FB
                push    edi
                call    __dosmaperr
                add     esp, 4
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C99FB:                             ; CODE XREF: __close_lk+7A↑j
                pop     edi
                xor     eax, eax
                pop     esi
                retn
__close_lk      endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__freebuf       proc near               ; CODE XREF: __fclose_lk+1B↑p

arg_0           = dword ptr  4

                push    esi
                mov     esi, [esp+4+arg_0]
                mov     eax, dword ptr [esi+0Ch]
                test    al, 83h
                jz      short loc_5C9A31
                test    al, 8
                jz      short loc_5C9A31
                mov     eax, dword ptr [esi+8]
                push    eax             ; Block
                call    _free
                mov     eax, dword ptr [esi+0Ch]
                add     esp, 4
                and     eax, 0FFFFFBF7h
                mov     [esi+0Ch], eax
                xor     eax, eax
                mov     [esi], eax
                mov     [esi+8], eax
                mov     [esi+4], eax

loc_5C9A31:                             ; CODE XREF: __freebuf+A↑j
                pop     esi
                retn
__freebuf       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _lseek(int FileHandle, int varOffset, int Origin)
__lseek         proc near               ; CODE XREF: __fseek_lk+73↑p

FileHandle      = dword ptr  4
varOffset          = dword ptr  8
Origin          = dword ptr  0Ch

                mov     eax, uNumber
                push    esi
                mov     esi, [esp+4+FileHandle]
                push    edi
                cmp     esi, eax
                jnb     short loc_5C9A96
                mov     eax, esi
                mov     ecx, esi
                and     eax, 1Fh
                sar     ecx, 5
                lea     edx, [eax+eax*8]
                mov     eax, __pioinfo[ecx*4]
                test    byte ptr [eax+edx*4+4], 1
                jz      short loc_5C9A96
                push    esi
                call    __lock_fhandle
                mov     ecx, dword ptr [esp+0Ch+Origin]
                mov     edx, dword ptr [esp+0Ch+varOffset]
                add     esp, 4
                push    ecx             ; dwMoveMethod
                push    edx             ; lDistanceToMove
                push    esi             ; FileHandle
                call    __lseek_lk
                add     esp, 0Ch
                mov     edi, eax
                push    esi
                call    __unlock_fhandle
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C9A96:                             ; CODE XREF: __lseek+D↑j
                call    __errno
                mov     dword ptr [eax], 9
                call    ___doserrno
                mov     dword ptr [eax], 0
                pop     edi
                or      eax, 0FFFFFFFFh
                pop     esi
                retn
__lseek         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _lseek_lk(int FileHandle, LONG lDistanceToMove, DWORD dwMoveMethod)
__lseek_lk      proc near               ; CODE XREF: __lseek+3E↑p

FileHandle      = dword ptr  4
lDistanceToMove = dword ptr  8
dwMoveMethod    = dword ptr  0Ch

                push    esi
                mov     esi, [esp+4+FileHandle]
                push    edi
                push    esi             ; FileHandle
                call    __get_osfhandle
                add     esp, 4
                cmp     eax, 0FFFFFFFFh
                jnz     short loc_5C9AE5
                call    __errno
                mov     dword ptr [eax], 9
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C9AE5:                             ; CODE XREF: __lseek_lk+12↑j
                mov     ecx, dword ptr [esp+8+dwMoveMethod]
                mov     edx, dword ptr [esp+8+lDistanceToMove]
                push    ecx             ; dwMoveMethod
                push    0               ; lpDistanceToMoveHigh
                push    edx             ; lDistanceToMove
                push    eax             ; hFile
                call    SetFilePointer
                mov     edi, eax
                cmp     edi, 0FFFFFFFFh
                jnz     short loc_5C9B07
                call    GetLastError
                jmp     short loc_5C9B09
; ---------------------------------------------------------------------------

loc_5C9B07:                             ; CODE XREF: __lseek_lk+3D↑j
                xor     eax, eax

loc_5C9B09:                             ; CODE XREF: __lseek_lk+45↑j
                test    eax, eax
                jz      short loc_5C9B1C
                push    eax
                call    __dosmaperr
                add     esp, 4
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C9B1C:                             ; CODE XREF: __lseek_lk+4B↑j
                mov     eax, esi
                and     esi, 1Fh
                sar     eax, 5
                lea     ecx, [esi+esi*8]
                mov     edx, __pioinfo[eax*4]
                lea     eax, [edx+ecx*4+4]
                mov     cl, [edx+ecx*4+4]
                and     cl, 0FDh
                mov     [eax], cl
                mov     eax, edi
                pop     edi
                pop     esi
                retn
__lseek_lk      endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _filbuf(FILE *File)
__filbuf        proc near               ; CODE XREF: _fread_lk+C2↑p

File            = dword ptr  4

                push    esi
                mov     esi, [esp+4+File]
                push    edi
                mov     eax, dword ptr [esi+0Ch]
                test    al, 83h
                jz      loc_5C9C29
                test    al, 40h
                jnz     loc_5C9C29
                test    al, 2
                jz      short loc_5C9B68
                or      al, 20h
                mov     [esi+0Ch], eax
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C9B68:                             ; CODE XREF: __filbuf+1B↑j
                or      al, 1
                test    eax, 10Ch
                mov     [esi+0Ch], eax
                jnz     short loc_5C9B7F
                push    esi
                call    __getbuf
                add     esp, 4
                jmp     short loc_5C9B84
; ---------------------------------------------------------------------------

loc_5C9B7F:                             ; CODE XREF: __filbuf+32↑j
                mov     eax, dword ptr [esi+8]
                mov     [esi], eax

loc_5C9B84:                             ; CODE XREF: __filbuf+3D↑j
                mov     ecx, dword ptr [esi+18h]
                mov     edx, dword ptr [esi+8]
                mov     eax, dword ptr [esi+10h]
                push    ecx             ; MaxCharCount
                push    edx             ; DstBuf
                push    eax             ; FileHandle
                call    __read
                add     esp, 0Ch
                mov     [esi+4], eax
                test    eax, eax
                jz      short loc_5C9C10
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5C9C10
                mov     edx, dword ptr [esi+0Ch]
                test    dl, 82h
                jnz     short loc_5C9BE1
                mov     ecx, dword ptr [esi+10h]
                cmp     ecx, 0FFFFFFFFh
                jz      short loc_5C9BCB
                mov     edi, ecx
                sar     edi, 5
                and     ecx, 1Fh
                mov     edi, __pioinfo[edi*4]
                lea     ecx, [ecx+ecx*8]
                lea     ecx, [edi+ecx*4]
                jmp     short loc_5C9BD0
; ---------------------------------------------------------------------------

loc_5C9BCB:                             ; CODE XREF: __filbuf+72↑j
                mov     ecx, offset unk_6418D8

loc_5C9BD0:                             ; CODE XREF: __filbuf+89↑j
                mov     cl, [ecx+4]
                and     cl, 82h
                cmp     cl, 82h
                jnz     short loc_5C9BE1
                or      dh, 20h
                mov     [esi+0Ch], edx

loc_5C9BE1:                             ; CODE XREF: __filbuf+6A↑j
                cmp     dword ptr [esi+18h], 200h
                jnz     short loc_5C9BFE
                mov     ecx, dword ptr [esi+0Ch]
                test    cl, 8
                jz      short loc_5C9BFE
                test    ch, 4
                jnz     short loc_5C9BFE
                mov     dword ptr [esi+18h], 1000h

loc_5C9BFE:                             ; CODE XREF: __filbuf+A8↑j
                dec     eax
                xor     edx, edx
                mov     [esi+4], eax
                mov     eax, dword ptr [esi]
                mov     dl, [eax]
                inc     eax
                mov     [esi], eax
                mov     eax, edx
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C9C10:                             ; CODE XREF: __filbuf+5D↑j
                mov     ecx, dword ptr [esi+0Ch]
                mov     dword ptr [esi+4], 0
                neg     eax
                sbb     eax, eax
                and     eax, 10h
                add     eax, 10h
                or      ecx, eax
                mov     [esi+0Ch], ecx

loc_5C9C29:                             ; CODE XREF: __filbuf+B↑j
                pop     edi
                or      eax, 0FFFFFFFFh
                pop     esi
                retn
__filbuf        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _read(int FileHandle, void *DstBuf, unsigned int MaxCharCount)
__read          proc near               ; CODE XREF: _fread_lk+A6↑p

FileHandle      = dword ptr  4
DstBuf          = dword ptr  8
MaxCharCount    = dword ptr  0Ch

                mov     eax, uNumber
                push    esi
                mov     esi, [esp+4+FileHandle]
                push    edi
                cmp     esi, eax
                jnb     short loc_5C9C86
                mov     eax, esi
                mov     ecx, esi
                and     eax, 1Fh
                sar     ecx, 5
                lea     edx, [eax+eax*8]
                mov     eax, __pioinfo[ecx*4]
                test    byte ptr [eax+edx*4+4], 1
                jz      short loc_5C9C86
                push    esi
                call    __lock_fhandle
                mov     ecx, dword ptr [esp+0Ch+MaxCharCount]
                mov     edx, dword ptr [esp+0Ch+DstBuf]
                add     esp, 4
                push    ecx             ; nNumberOfBytesToRead
                push    edx             ; lpBuffer
                push    esi             ; FileHandle
                call    __read_lk
                add     esp, 0Ch
                mov     edi, eax
                push    esi
                call    __unlock_fhandle
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5C9C86:                             ; CODE XREF: __read+D↑j
                call    __errno
                mov     dword ptr [eax], 9
                call    ___doserrno
                mov     dword ptr [eax], 0
                pop     edi
                or      eax, 0FFFFFFFFh
                pop     esi
                retn
__read          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _read_lk(int FileHandle, LPVOID lpBuffer, DWORD nNumberOfBytesToRead)
__read_lk       proc near               ; CODE XREF: __read+3E↑p

Buffer          = byte ptr -9
NumberOfBytesRead= dword ptr -8
var_4           = dword ptr -4
FileHandle      = dword ptr  4
lpBuffer        = dword ptr  8
nNumberOfBytesToRead= dword ptr  0Ch

                mov     eax, dword ptr [esp+nNumberOfBytesToRead]
                sub     esp, 0Ch
                push    ebx
                push    ebp
                push    esi
                push    edi
                mov     edi, [esp+1Ch+lpBuffer]
                xor     ebp, ebp
                test    eax, eax
                mov     edx, edi
                jz      loc_5C9ECB
                mov     eax, dword ptr [esp+1Ch+FileHandle]
                mov     ecx, eax
                and     eax, 1Fh
                sar     ecx, 5
                lea     ebx, [eax+eax*8]
                mov     eax, __pioinfo[ecx*4]
                lea     esi, __pioinfo[ecx*4]
                shl     ebx, 2
                mov     [esp+1Ch+var_4], esi
                lea     ecx, [ebx+eax]
                mov     al, [ebx+eax+4]
                test    al, 2
                jnz     loc_5C9ECB
                test    al, 48h
                jz      short loc_5C9D23
                mov     al, [ecx+5]
                cmp     al, 0Ah
                jz      short loc_5C9D23
                mov     [edi], al
                mov     eax, dword ptr [esp+1Ch+nNumberOfBytesToRead]
                mov     ecx, dword ptr [esi]
                dec     eax
                lea     edx, [edi+1]
                mov     ebp, 1
                mov     [esp+1Ch+nNumberOfBytesToRead], eax
                mov     byte ptr [ebx+ecx+5], 0Ah

loc_5C9D23:                             ; CODE XREF: __read_lk+50↑j
                mov     ecx, dword ptr [esp+1Ch+nNumberOfBytesToRead]
                lea     eax, [esp+1Ch+NumberOfBytesRead]
                push    0               ; lpOverlapped
                push    eax             ; lpNumberOfBytesRead
                push    ecx             ; nNumberOfBytesToRead
                push    edx             ; lpBuffer
                mov     edx, dword ptr [esi]
                mov     eax, dword ptr [ebx+edx]
                push    eax             ; hFile
                call    ReadFile
                test    eax, eax
                jnz     short loc_5C9D89
                call    GetLastError
                cmp     eax, 5
                jnz     short loc_5C9D6C
                call    __errno
                mov     dword ptr [eax], 9
                call    ___doserrno
                mov     dword ptr [eax], 5
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 0Ch
                retn
; ---------------------------------------------------------------------------

loc_5C9D6C:                             ; CODE XREF: __read_lk+99↑j
                cmp     eax, 6Dh ; 'm'
                jz      loc_5C9ECB
                push    eax
                call    __dosmaperr
                add     esp, 4
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 0Ch
                retn
; ---------------------------------------------------------------------------

loc_5C9D89:                             ; CODE XREF: __read_lk+8E↑j
                mov     ecx, dword ptr [esi]
                mov     edx, dword ptr [esp+1Ch+NumberOfBytesRead]
                add     ebp, edx
                mov     al, [ebx+ecx+4]
                lea     ecx, [ebx+ecx+4]
                test    al, 80h
                jz      loc_5C9EC1
                test    edx, edx
                jz      short loc_5C9DAE
                cmp     byte ptr [edi], 0Ah
                jnz     short loc_5C9DAE
                or      al, 4
                jmp     short loc_5C9DB0
; ---------------------------------------------------------------------------

loc_5C9DAE:                             ; CODE XREF: __read_lk+F3↑j
                and     al, 0FBh

loc_5C9DB0:                             ; CODE XREF: __read_lk+FC↑j
                mov     [ecx], al
                mov     eax, dword ptr [esp+1Ch+lpBuffer]
                add     ebp, eax
                mov     esi, edi
                cmp     eax, ebp
                mov     [esp+1Ch+nNumberOfBytesToRead], ebp
                jnb     loc_5C9EBB

loc_5C9DC6:                             ; CODE XREF: __read_lk+1DF↓j
                mov     al, [edi]
                cmp     al, 1Ah
                jz      loc_5C9EA5
                cmp     al, 0Dh
                jz      short loc_5C9DDD
                mov     [esi], al
                inc     esi
                inc     edi
                jmp     loc_5C9E89
; ---------------------------------------------------------------------------

loc_5C9DDD:                             ; CODE XREF: __read_lk+122↑j
                dec     ebp
                cmp     edi, ebp
                jnb     short loc_5C9DFD
                cmp     byte ptr [edi+1], 0Ah
                jnz     short loc_5C9DF3
                add     edi, 2
                mov     byte ptr [esi], 0Ah
                jmp     loc_5C9E88
; ---------------------------------------------------------------------------

loc_5C9DF3:                             ; CODE XREF: __read_lk+136↑j
                mov     byte ptr [esi], 0Dh
                inc     esi
                inc     edi
                jmp     loc_5C9E89
; ---------------------------------------------------------------------------

loc_5C9DFD:                             ; CODE XREF: __read_lk+130↑j
                mov     ecx, dword ptr [esp+1Ch+var_4]
                xor     ebp, ebp
                lea     edx, [esp+1Ch+NumberOfBytesRead]
                push    ebp             ; lpOverlapped
                push    edx             ; lpNumberOfBytesRead
                mov     edx, dword ptr [ecx]
                lea     eax, [esp+24h+Buffer]
                push    1               ; nNumberOfBytesToRead
                push    eax             ; lpBuffer
                mov     eax, dword ptr [ebx+edx]
                push    eax             ; hFile
                inc     edi
                call    ReadFile
                test    eax, eax
                jnz     short loc_5C9E29
                call    GetLastError
                mov     ebp, eax

loc_5C9E29:                             ; CODE XREF: __read_lk+16F↑j
                test    ebp, ebp
                jnz     short loc_5C9E85
                mov     eax, dword ptr [esp+1Ch+NumberOfBytesRead]
                test    eax, eax
                jz      short loc_5C9E85
                mov     ecx, dword ptr [esp+1Ch+var_4]
                mov     edx, dword ptr [ecx]
                test    byte ptr [ebx+edx+4], 48h
                jz      short loc_5C9E5A
                mov     al, [esp+1Ch+Buffer]
                cmp     al, 0Ah
                jnz     short loc_5C9E4E
                mov     [esi], al
                jmp     short loc_5C9E88
; ---------------------------------------------------------------------------

loc_5C9E4E:                             ; CODE XREF: __read_lk+198↑j
                mov     byte ptr [esi], 0Dh
                mov     ecx, dword ptr [ecx]
                inc     esi
                mov     [ebx+ecx+5], al
                jmp     short loc_5C9E89
; ---------------------------------------------------------------------------

loc_5C9E5A:                             ; CODE XREF: __read_lk+190↑j
                cmp     esi, [esp+1Ch+lpBuffer]
                jnz     short loc_5C9E6C
                cmp     [esp+1Ch+Buffer], 0Ah
                jnz     short loc_5C9E6C
                mov     byte ptr [esi], 0Ah
                jmp     short loc_5C9E88
; ---------------------------------------------------------------------------

loc_5C9E6C:                             ; CODE XREF: __read_lk+1AE↑j
                mov     edx, dword ptr [esp+1Ch+FileHandle]
                push    1               ; dwMoveMethod
                push    0FFFFFFFFh      ; lDistanceToMove
                push    edx             ; FileHandle
                call    __lseek_lk
                mov     al, [esp+28h+Buffer]
                add     esp, 0Ch
                cmp     al, 0Ah
                jz      short loc_5C9E89

loc_5C9E85:                             ; CODE XREF: __read_lk+17B↑j
                mov     byte ptr [esi], 0Dh

loc_5C9E88:                             ; CODE XREF: __read_lk+13E↑j
                inc     esi

loc_5C9E89:                             ; CODE XREF: __read_lk+128↑j
                mov     ebp, [esp+1Ch+nNumberOfBytesToRead]
                cmp     edi, ebp
                jb      loc_5C9DC6
                sub     esi, [esp+1Ch+lpBuffer]
                mov     ebp, esi
                mov     eax, ebp
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 0Ch
                retn
; ---------------------------------------------------------------------------

loc_5C9EA5:                             ; CODE XREF: __read_lk+11A↑j
                mov     eax, dword ptr [esp+1Ch+var_4]
                mov     ecx, dword ptr [eax]
                mov     al, [ebx+ecx+4]
                test    al, 40h
                lea     ebx, [ebx+ecx+4]
                jnz     short loc_5C9EBB
                or      al, 2
                mov     [ebx], al

loc_5C9EBB:                             ; CODE XREF: __read_lk+110↑j
                sub     esi, [esp+1Ch+lpBuffer]
                mov     ebp, esi

loc_5C9EC1:                             ; CODE XREF: __read_lk+EB↑j
                mov     eax, ebp
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 0Ch
                retn
; ---------------------------------------------------------------------------

loc_5C9ECB:                             ; CODE XREF: __read_lk+15↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                add     esp, 0Ch
                retn
__read_lk       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _openfile(char *FileName, int, int ShareFlag, int)
__openfile      proc near               ; CODE XREF: __fsopen+1F↑p

FileName        = dword ptr  4
arg_4           = dword ptr  8
ShareFlag       = dword ptr  0Ch
arg_C           = dword ptr  10h

                mov     ecx, dword ptr [esp+arg_4]
                push    ebx
                push    ebp
                push    esi
                mov     al, [ecx]
                xor     edx, edx
                xor     ebp, ebp
                push    edi
                mov     edi, dword_70D6C4
                cmp     al, 61h ; 'a'
                jz      short loc_5C9F15
                cmp     al, 72h ; 'r'
                jz      short loc_5C9F0E
                cmp     al, 77h ; 'w'
                jz      short loc_5C9F07
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5C9F07:                             ; CODE XREF: __openfile+1E↑j
                mov     eax, 301h
                jmp     short loc_5C9F1A
; ---------------------------------------------------------------------------

loc_5C9F0E:                             ; CODE XREF: __openfile+1A↑j
                xor     eax, eax
                or      edi, 1
                jmp     short loc_5C9F1D
; ---------------------------------------------------------------------------

loc_5C9F15:                             ; CODE XREF: __openfile+16↑j
                mov     eax, 109h

loc_5C9F1A:                             ; CODE XREF: __openfile+2C↑j
                or      edi, 2

loc_5C9F1D:                             ; CODE XREF: __openfile+33↑j
                inc     ecx
                mov     esi, 1
                mov     [esp+10h+arg_4], ecx
                mov     cl, [ecx]
                test    cl, cl
                jz      loc_5C9FE1

loc_5C9F31:                             ; CODE XREF: __openfile+FB↓j
                test    esi, esi
                jz      loc_5C9FE1
                movsx   ecx, cl
                add     ecx, 0FFFFFFD5h ; switch 74 cases
                cmp     ecx, 49h
                ja      def_5C9F50      ; jumptable 005C9F50 default case, cases 44-67,69-81,85-97,100-109,111-115
                xor     ebx, ebx
                mov     bl, ds:byte_5CA064[ecx]
                jmp     ds:jpt_5C9F50[ebx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5C9F57:                             ; CODE XREF: __openfile+70↑j
                test    al, 2           ; jumptable 005C9F50 case 43
                jnz     short def_5C9F50 ; jumptable 005C9F50 default case, cases 44-67,69-81,85-97,100-109,111-115
                and     al, 0FEh
                and     edi, 0FFFFFFFCh
                or      al, 2
                or      edi, 80h
                jmp     short loc_5C9FCE
; ---------------------------------------------------------------------------

loc_5C9F6A:                             ; CODE XREF: __openfile+70↑j
                test    ah, 0C0h        ; jumptable 005C9F50 case 98
                jnz     short def_5C9F50 ; jumptable 005C9F50 default case, cases 44-67,69-81,85-97,100-109,111-115
                or      ah, 80h
                jmp     short loc_5C9FCE
; ---------------------------------------------------------------------------

loc_5C9F74:                             ; CODE XREF: __openfile+70↑j
                test    ah, 0C0h        ; jumptable 005C9F50 case 116
                jnz     short def_5C9F50 ; jumptable 005C9F50 default case, cases 44-67,69-81,85-97,100-109,111-115
                or      ah, 40h
                jmp     short loc_5C9FCE
; ---------------------------------------------------------------------------

loc_5C9F7E:                             ; CODE XREF: __openfile+70↑j
                test    edx, edx        ; jumptable 005C9F50 case 99
                jnz     short def_5C9F50 ; jumptable 005C9F50 default case, cases 44-67,69-81,85-97,100-109,111-115
                mov     edx, 1
                or      edi, 4000h
                jmp     short loc_5C9FCE
; ---------------------------------------------------------------------------

loc_5C9F8F:                             ; CODE XREF: __openfile+70↑j
                test    edx, edx        ; jumptable 005C9F50 case 110
                jnz     short def_5C9F50 ; jumptable 005C9F50 default case, cases 44-67,69-81,85-97,100-109,111-115
                mov     edx, 1
                and     edi, 0FFFFBFFFh
                jmp     short loc_5C9FCE
; ---------------------------------------------------------------------------

loc_5C9FA0:                             ; CODE XREF: __openfile+70↑j
                test    ebp, ebp        ; jumptable 005C9F50 case 83
                jnz     short def_5C9F50 ; jumptable 005C9F50 default case, cases 44-67,69-81,85-97,100-109,111-115
                mov     ebp, 1
                or      al, 20h
                jmp     short loc_5C9FCE
; ---------------------------------------------------------------------------

loc_5C9FAD:                             ; CODE XREF: __openfile+70↑j
                test    ebp, ebp        ; jumptable 005C9F50 case 82
                jnz     short def_5C9F50 ; jumptable 005C9F50 default case, cases 44-67,69-81,85-97,100-109,111-115
                mov     ebp, 1
                or      al, 10h
                jmp     short loc_5C9FCE
; ---------------------------------------------------------------------------

loc_5C9FBA:                             ; CODE XREF: __openfile+70↑j
                test    ah, 10h         ; jumptable 005C9F50 case 84
                jnz     short def_5C9F50 ; jumptable 005C9F50 default case, cases 44-67,69-81,85-97,100-109,111-115
                or      ah, 10h
                jmp     short loc_5C9FCE
; ---------------------------------------------------------------------------

loc_5C9FC4:                             ; CODE XREF: __openfile+70↑j
                test    al, 40h         ; jumptable 005C9F50 case 68
                jnz     short def_5C9F50 ; jumptable 005C9F50 default case, cases 44-67,69-81,85-97,100-109,111-115
                or      al, 40h
                jmp     short loc_5C9FCE
; ---------------------------------------------------------------------------

def_5C9F50:                             ; CODE XREF: __openfile+62↑j
                xor     esi, esi        ; jumptable 005C9F50 default case, cases 44-67,69-81,85-97,100-109,111-115

loc_5C9FCE:                             ; CODE XREF: __openfile+88↑j
                mov     ecx, dword ptr [esp+10h+arg_4]
                inc     ecx
                mov     [esp+10h+arg_4], ecx
                mov     cl, [ecx]
                test    cl, cl
                jnz     loc_5C9F31

loc_5C9FE1:                             ; CODE XREF: __openfile+4B↑j
                mov     ecx, dword ptr [esp+10h+ShareFlag]
                mov     edx, dword ptr [esp+10h+FileName]
                push    1A4h
                push    ecx             ; ShareFlag
                push    eax             ; OpenFlag
                push    edx             ; FileName
                call    __sopen
                mov     ecx, eax
                add     esp, 10h
                test    ecx, ecx
                jge     short loc_5CA006
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CA006:                             ; CODE XREF: __openfile+11D↑j
                mov     eax, dword_70D6B8
                inc     eax
                mov     dword_70D6B8, eax
                mov     eax, dword ptr [esp+10h+arg_C]
                mov     [eax+0Ch], edi
                pop     edi
                pop     esi
                pop     ebp
                mov     dword ptr [eax+4], 0
                mov     dword ptr [eax], 0
                mov     dword ptr [eax+8], 0
                mov     dword ptr [eax+1Ch], 0
                mov     [eax+10h], ecx
                pop     ebx
                retn
__openfile      endp

; ---------------------------------------------------------------------------
                align 4
jpt_5C9F50      dd offset loc_5C9F57    ; DATA XREF: __openfile+70↑r
                dd offset loc_5C9FC4    ; jump table for switch statement
                dd offset loc_5C9FAD
                dd offset loc_5C9FA0
                dd offset loc_5C9FBA
                dd offset loc_5C9F6A
                dd offset loc_5C9F7E
                dd offset loc_5C9F8F
                dd offset loc_5C9F74
                dd offset def_5C9F50
byte_5CA064     db      0,     9,     9,     9
                db      9,     9,     9,     9 ; indirect table for switch statement
                db      9,     9,     9,     9
                db      9,     9,     9,     9
                db      9,     9,     9,     9
                db      9,     9,     9,     9
                db      9,     1,     9,     9
                db      9,     9,     9,     9
                db      9,     9,     9,     9
                db      9,     9,     9,     2
                db      3,     4,     9,     9
                db      9,     9,     9,     9
                db      9,     9,     9,     9
                db      9,     9,     9,     5
                db      6,     9,     9,     9
                db      9,     9,     9,     9
                db      9,     9,     9,     7
                db      9,     9,     9,     9
                db      9,     8
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__getstream     proc near               ; CODE XREF: __fsopen+1↑p
                push    ebx
                push    ebp
                push    esi
                push    edi
                push    2
                xor     ebp, ebp
                xor     edi, edi
                call    __lock
                mov     eax, Count
                add     esp, 4
                xor     esi, esi
                cmp     eax, ebp
                jle     loc_5CA15F
                mov     bl, 83h

loc_5CA0D3:                             ; CODE XREF: __getstream+5E↓j
                mov     eax, dword_70D838
                mov     eax, dword ptr [eax+esi*4]
                cmp     eax, ebp
                jz      short loc_5CA117
                test    [eax+0Ch], bl
                jnz     short loc_5CA106
                push    eax
                push    esi
                call    __lock_file2
                mov     ecx, dword_70D838
                add     esp, 8
                mov     eax, dword ptr [ecx+esi*4]
                test    [eax+0Ch], bl
                jz      short loc_5CA112
                push    eax
                push    esi
                call    __unlock_file2
                add     esp, 8

loc_5CA106:                             ; CODE XREF: __getstream+32↑j
                mov     eax, Count
                inc     esi
                cmp     esi, eax
                jl      short loc_5CA0D3
                jmp     short loc_5CA15F
; ---------------------------------------------------------------------------

loc_5CA112:                             ; CODE XREF: __getstream+4A↑j
                mov     edi, [ecx+esi*4]
                jmp     short loc_5CA15F
; ---------------------------------------------------------------------------

loc_5CA117:                             ; CODE XREF: __getstream+2D↑j
                push    38h ; '8'       ; varSize
                shl     esi, 2
                call    _malloc
                mov     ecx, dword_70D838
                add     esp, 4
                mov     [ecx+esi], eax
                mov     edx, dword_70D838
                mov     eax, dword ptr [edx+esi]
                cmp     eax, ebp
                jz      short loc_5CA15F
                add     eax, 20h ; ' '
                push    eax             ; lpCriticalSection
                call    InitializeCriticalSection
                mov     eax, dword_70D838
                mov     ecx, dword ptr [eax+esi]
                add     ecx, 20h ; ' '
                push    ecx             ; lpCriticalSection
                call    EnterCriticalSection
                mov     edx, dword_70D838
                mov     edi, [edx+esi]

loc_5CA15F:                             ; CODE XREF: __getstream+1B↑j
                cmp     edi, ebp
                jz      short loc_5CA178
                mov     [edi+4], ebp
                mov     [edi+0Ch], ebp
                mov     [edi+8], ebp
                mov     [edi], ebp
                mov     [edi+1Ch], ebp
                mov     dword ptr [edi+10h], 0FFFFFFFFh

loc_5CA178:                             ; CODE XREF: __getstream+B1↑j
                push    2
                call    __unlock
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
__getstream     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _input(FILE *Stream, int, int)
__input         proc near               ; CODE XREF: _sscanf+35↑p

var_1CD         = byte ptr -1CDh
var_1CC         = dword ptr -1CCh
var_1C7         = byte ptr -1C7h
var_1C6         = byte ptr -1C6h
var_1C5         = byte ptr -1C5h
var_1C4         = dword ptr -1C4h
var_1C0         = byte ptr -1C0h
var_1BF         = byte ptr -1BFh
var_1BE         = byte ptr -1BEh
var_1BD         = byte ptr -1BDh
var_1BC         = dword ptr -1BCh
var_1B8         = dword ptr -1B8h
var_1B4         = dword ptr -1B4h
var_1B0         = dword ptr -1B0h
var_1AC         = dword ptr -1ACh
var_1A8         = dword ptr -1A8h
var_1A4         = dword ptr -1A4h
SrcCh           = byte ptr -19Eh
var_19D         = byte ptr -19Dh
var_19C         = dword ptr -19Ch
var_198         = dword ptr -198h
var_194         = dword ptr -194h
DstCh           = word ptr -18Eh
varC               = dword ptr -18Ch
var_188         = dword ptr -188h
var_184         = dword ptr -184h
var_180         = byte ptr -180h
var_175         = byte ptr -175h
var_160         = byte ptr -160h
var_15F         = byte ptr -15Fh
Stream          = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                sub     esp, 1D0h
                xor     eax, eax
                push    ebx
                mov     [esp+1D4h+var_1BF], al
                mov     [esp+1D4h+var_1CC], eax
                mov     [esp+1D4h+var_1AC], eax
                mov     eax, dword ptr [esp+1D4h+arg_4]
                push    ebp
                push    esi
                mov     al, [eax]
                push    edi
                test    al, al
                jz      loc_5CADE2
                mov     ebp, [esp+1E0h+Stream]
                mov     ebx, dword ptr [esp+1E0h+varC]
                mov     esi, [esp+1E0h+arg_4]
                xor     edi, edi

loc_5CA1CD:                             ; CODE XREF: __input+C22↓j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5CA1E8
                and     eax, 0FFh
                push    8               ; Type
                push    eax             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5CA1F9
; ---------------------------------------------------------------------------

loc_5CA1E8:                             ; CODE XREF: __input+44↑j
                mov     ecx, off_641268
                and     eax, 0FFh
                mov     al, [ecx+eax*2]
                and     eax, 8

loc_5CA1F9:                             ; CODE XREF: __input+56↑j
                cmp     eax, edi
                jz      short loc_5CA250
                mov     eax, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                lea     edx, [esp+1E4h+var_1CC]
                dec     eax
                push    ebp             ; Stream
                push    edx             ; int
                mov     [esp+1ECh+var_1CC], eax
                call    __whiteout
                add     esp, 8
                push    eax             ; Character
                call    __un_inc
                add     esp, 8
                inc     esi
                xor     eax, eax
                mov     [esp+1E0h+arg_4], esi
                mov     al, [esi]
                push    eax             ; C
                call    _isspace
                add     esp, 4
                test    eax, eax
                jz      short loc_5CA250

loc_5CA237:                             ; CODE XREF: __input+BE↓j
                inc     esi
                xor     ecx, ecx
                mov     [esp+1E0h+arg_4], esi
                mov     cl, [esi]
                push    ecx             ; C
                call    _isspace
                add     esp, 4
                test    eax, eax
                jnz     short loc_5CA237

loc_5CA250:                             ; CODE XREF: __input+6B↑j
                cmp     byte ptr [esi], 25h ; '%'
                jnz     loc_5CAD37
                mov     ecx, dword ptr [esp+1E0h+arg_4]
                mov     [esp+1E0h+var_1A4], edi
                mov     byte ptr [esp+1E0h+var_1B4], 0
                mov     [esp+1E0h+var_1A8], edi
                mov     [esp+1E0h+var_1B0], edi
                mov     [esp+1E0h+var_1C4], edi
                mov     [esp+1E0h+var_1BD], 0
                mov     [esp+1E0h+var_1BE], 0
                mov     [esp+1E0h+var_1C5], 0
                mov     [esp+1E0h+var_1CD], 0
                mov     [esp+1E0h+var_1C0], 0
                mov     [esp+1E0h+var_1C7], 0
                mov     [esp+1E0h+var_1C6], 1
                mov     [esp+1E0h+var_188], edi

loc_5CA29C:                             ; CODE XREF: __input+1E0↓j
                mov     eax, [g_SrcSizeInBytes]
                inc     ecx
                xor     edx, edx
                cmp     eax, 1
                mov     dl, [ecx]
                mov     [esp+1E0h+arg_4], ecx
                mov     esi, edx
                jle     short loc_5CA2CF
                mov     eax, esi
                push    4               ; Type
                and     eax, 0FFh
                push    eax             ; C
                call    __isctype
                mov     ecx, dword ptr [esp+1E8h+arg_4]
                add     esp, 8
                jmp     short loc_5CA2E2
; ---------------------------------------------------------------------------

loc_5CA2CF:                             ; CODE XREF: __input+122↑j
                mov     eax, off_641268
                mov     edx, esi
                and     edx, 0FFh
                mov     al, [eax+edx*2]
                and     eax, 4

loc_5CA2E2:                             ; CODE XREF: __input+13D↑j
                test    eax, eax
                jz      short loc_5CA300
                mov     eax, dword ptr [esp+1E0h+var_1B0]
                inc     eax
                mov     [esp+1E0h+var_1B0], eax
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                lea     edx, [eax+eax*4]
                lea     eax, [esi+edx*2-30h]
                mov     [esp+1E0h+var_1C4], eax
                jmp     short loc_5CA36A ; jumptable 005CA310 cases 70,78
; ---------------------------------------------------------------------------

loc_5CA300:                             ; CODE XREF: __input+154↑j
                lea     eax, [esi-2Ah]  ; switch 78 cases
                cmp     eax, 4Dh
                ja      short def_5CA310 ; jumptable 005CA310 default case, cases 43-69,71,72,74,75,77,79-103,105-107,109-118
                xor     edx, edx
                mov     dl, ds:byte_5CAE30[eax]
                jmp     ds:jpt_5CA310[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5CA317:                             ; CODE XREF: __input+180↑j
                mov     dl, [esp+1E0h+var_1C6] ; jumptable 005CA310 case 104
                mov     al, [esp+1E0h+var_1C7]
                dec     dl
                dec     al
                mov     [esp+1E0h+var_1C6], dl
                mov     [esp+1E0h+var_1C7], al
                jmp     short loc_5CA36A ; jumptable 005CA310 cases 70,78
; ---------------------------------------------------------------------------

loc_5CA32D:                             ; CODE XREF: __input+180↑j
                cmp     byte ptr [ecx+1], 36h ; '6' ; jumptable 005CA310 case 73
                jnz     short def_5CA310 ; jumptable 005CA310 default case, cases 43-69,71,72,74,75,77,79-103,105-107,109-118
                cmp     byte ptr [ecx+2], 34h ; '4'
                jnz     short def_5CA310 ; jumptable 005CA310 default case, cases 43-69,71,72,74,75,77,79-103,105-107,109-118
                add     ecx, 2
                inc     edi
                xor     eax, eax
                mov     [esp+1E0h+arg_4], ecx
                mov     [esp+1E0h+var_19C], eax
                mov     [esp+1E0h+var_198], eax
                jmp     short loc_5CA36A ; jumptable 005CA310 cases 70,78
; ---------------------------------------------------------------------------

loc_5CA350:                             ; CODE XREF: __input+180↑j
                inc     [esp+1E0h+var_1C6] ; jumptable 005CA310 case 76
                jmp     short loc_5CA36A ; jumptable 005CA310 cases 70,78
; ---------------------------------------------------------------------------

loc_5CA356:                             ; CODE XREF: __input+180↑j
                inc     [esp+1E0h+var_1C6] ; jumptable 005CA310 case 108

loc_5CA35A:                             ; CODE XREF: __input+180↑j
                inc     [esp+1E0h+var_1C7] ; jumptable 005CA310 case 119
                jmp     short loc_5CA36A ; jumptable 005CA310 cases 70,78
; ---------------------------------------------------------------------------

loc_5CA360:                             ; CODE XREF: __input+180↑j
                inc     [esp+1E0h+var_1C5] ; jumptable 005CA310 case 42
                jmp     short loc_5CA36A ; jumptable 005CA310 cases 70,78
; ---------------------------------------------------------------------------

def_5CA310:                             ; CODE XREF: __input+176↑j
                inc     [esp+1E0h+var_1CD] ; jumptable 005CA310 default case, cases 43-69,71,72,74,75,77,79-103,105-107,109-118

loc_5CA36A:                             ; CODE XREF: __input+16E↑j
                mov     al, [esp+1E0h+var_1CD] ; jumptable 005CA310 cases 70,78
                test    al, al
                jz      loc_5CA29C
                mov     al, [esp+1E0h+var_1C5]
                mov     [esp+1E0h+var_188], edi
                test    al, al
                jnz     short loc_5CA39E
                mov     eax, dword ptr [esp+1E0h+arg_8]
                mov     [esp+1E0h+varC], eax
                add     eax, 4
                mov     [esp+1E0h+arg_8], eax
                mov     eax, dword ptr [eax-4]
                mov     [esp+1E0h+var_1B8], eax

loc_5CA39E:                             ; CODE XREF: __input+1F0↑j
                mov     al, [esp+1E0h+var_1C7]
                mov     [esp+1E0h+var_1CD], 0
                test    al, al
                jnz     short loc_5CA3BF
                mov     al, [ecx]
                cmp     al, 53h ; 'S'
                jz      short loc_5CA3BA
                cmp     al, 43h ; 'C'
                mov     [esp+1E0h+var_1C7], 0FFh
                jnz     short loc_5CA3BF

loc_5CA3BA:                             ; CODE XREF: __input+21F↑j
                mov     [esp+1E0h+var_1C7], 1

loc_5CA3BF:                             ; CODE XREF: __input+219↑j
                xor     eax, eax
                mov     al, [ecx]
                or      al, 20h
                cmp     eax, 6Eh ; 'n'
                mov     [esp+1E0h+var_1BC], eax
                jz      short loc_5CA3FC
                cmp     eax, 63h ; 'c'
                jz      short loc_5CA3E8
                cmp     eax, 7Bh ; '{'
                jz      short loc_5CA3E8
                lea     ecx, [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                push    ecx             ; int
                call    __whiteout
                add     esp, 8
                jmp     short loc_5CA3FA
; ---------------------------------------------------------------------------

loc_5CA3E8:                             ; CODE XREF: __input+241↑j
                mov     esi, [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                inc     esi
                mov     [esp+1E4h+var_1CC], esi
                call    _fgetc
                add     esp, 4

loc_5CA3FA:                             ; CODE XREF: __input+256↑j
                mov     ebx, eax

loc_5CA3FC:                             ; CODE XREF: __input+23C↑j
                mov     ecx, dword ptr [esp+1E0h+var_1B0]
                test    ecx, ecx
                jz      short loc_5CA410
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                test    eax, eax
                jz      loc_5CADCD

loc_5CA410:                             ; CODE XREF: __input+272↑j
                mov     esi, [esp+1E0h+var_1BC]
                lea     eax, [esi-63h]  ; switch 25 cases
                cmp     eax, 18h
                ja      def_5CA428      ; jumptable 005CA428 default case, cases 104,106-109,113,114,116,118,119,121,122
                xor     edx, edx
                mov     dl, ds:byte_5CAEB0[eax]
                jmp     ds:jpt_5CA428[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5CA42F:                             ; CODE XREF: __input+298↑j
                test    ecx, ecx        ; jumptable 005CA428 case 99
                jnz     short loc_5CA444
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                mov     [esp+1E0h+var_1B0], 1
                inc     eax
                mov     [esp+1E0h+var_1C4], eax

loc_5CA444:                             ; CODE XREF: __input+2A1↑j
                mov     al, [esp+1E0h+var_1C7]
                test    al, al
                jle     short loc_5CA451
                mov     [esp+1E0h+var_1C0], 1

loc_5CA451:                             ; CODE XREF: __input+2BA↑j
                mov     edx, offset asc_6414E8 ; "]"
                jmp     short loc_5CA48E
; ---------------------------------------------------------------------------

loc_5CA458:                             ; CODE XREF: __input+298↑j
                mov     al, [esp+1E0h+var_1C7] ; jumptable 005CA428 case 115
                test    al, al
                jle     short loc_5CA465
                mov     [esp+1E0h+var_1C0], 1

loc_5CA465:                             ; CODE XREF: __input+2CE↑j
                mov     edx, offset asc_6414E0 ; " \t-\r]"
                jmp     short loc_5CA48E
; ---------------------------------------------------------------------------

loc_5CA46C:                             ; CODE XREF: __input+298↑j
                mov     al, [esp+1E0h+var_1C7] ; jumptable 005CA428 case 123
                test    al, al
                jle     short loc_5CA479
                mov     [esp+1E0h+var_1C0], 1

loc_5CA479:                             ; CODE XREF: __input+2E2↑j
                mov     edx, dword ptr [esp+1E0h+arg_4]
                inc     edx
                mov     [esp+1E0h+arg_4], edx
                cmp     byte ptr [edx], 5Eh ; '^'
                jnz     short loc_5CA493
                inc     edx

loc_5CA48E:                             ; CODE XREF: __input+2C6↑j
                mov     [esp+1E0h+var_1BD], 0FFh

loc_5CA493:                             ; CODE XREF: __input+2FB↑j
                mov     ecx, 8
                xor     eax, eax
                lea     edi, [esp+1E0h+var_180]
                cmp     esi, 7Bh ; '{'
                rep stosd
                jnz     short loc_5CA4B5
                cmp     byte ptr [edx], 5Dh ; ']'
                jnz     short loc_5CA4B5
                mov     byte ptr [esp+1E0h+var_1B4], 5Dh ; ']'
                inc     edx
                mov     [esp+1E0h+var_175], 20h ; ' '

loc_5CA4B5:                             ; CODE XREF: __input+313↑j
                mov     al, [edx]
                cmp     al, 5Dh ; ']'
                jz      loc_5CA563

loc_5CA4BF:                             ; CODE XREF: __input+3CD↓j
                mov     cl, al
                inc     edx
                cmp     cl, 2Dh ; '-'
                mov     byte ptr [esp+1E0h+var_184], cl
                jnz     short loc_5CA539
                mov     al, byte ptr [esp+1E0h+var_1B4]
                test    al, al
                jz      short loc_5CA539
                mov     al, [edx]
                cmp     al, 5Dh ; ']'
                jz      short loc_5CA539
                mov     cl, byte ptr [esp+1E0h+var_1B4]
                inc     edx
                cmp     cl, al
                jnb     short loc_5CA4E8
                mov     byte ptr [esp+1E0h+var_194], al
                jmp     short loc_5CA4F2
; ---------------------------------------------------------------------------

loc_5CA4E8:                             ; CODE XREF: __input+350↑j
                mov     byte ptr [esp+1E0h+var_194], cl
                mov     byte ptr [esp+1E0h+var_1B4], al
                mov     cl, al

loc_5CA4F2:                             ; CODE XREF: __input+356↑j
                cmp     cl, byte ptr [esp+1E0h+var_194]
                ja      short loc_5CA52B
                mov     esi, [esp+1E0h+var_1B4]
                mov     ebp, [esp+1E0h+var_194]
                and     esi, 0FFh
                and     ebp, 0FFh
                sub     ebp, esi
                inc     ebp

loc_5CA50F:                             ; CODE XREF: __input+399↓j
                mov     eax, esi
                mov     ecx, esi
                shr     eax, 3
                and     ecx, 7
                lea     edi, [esp+eax+1E0h+var_180]
                mov     al, 1
                shl     al, cl
                mov     cl, [edi]
                or      cl, al
                inc     esi
                dec     ebp
                mov     [edi], cl
                jnz     short loc_5CA50F

loc_5CA52B:                             ; CODE XREF: __input+366↑j
                mov     ebp, [esp+1E0h+Stream]
                mov     byte ptr [esp+1E0h+var_1B4], 0
                jmp     short loc_5CA559
; ---------------------------------------------------------------------------

loc_5CA539:                             ; CODE XREF: __input+339↑j
                mov     byte ptr [esp+1E0h+var_1B4], cl
                mov     ecx, dword ptr [esp+1E0h+var_184]
                and     ecx, 0FFh
                mov     eax, ecx
                and     ecx, 7
                shr     eax, 3
                lea     esi, [esp+eax+1E0h+var_180]
                mov     al, 1
                shl     al, cl
                or      [esi], al

loc_5CA559:                             ; CODE XREF: __input+3A7↑j
                mov     al, [edx]
                cmp     al, 5Dh ; ']'
                jnz     loc_5CA4BF

loc_5CA563:                             ; CODE XREF: __input+329↑j
                cmp     byte ptr [edx], 0
                jz      loc_5CADE6
                cmp     [esp+1E0h+var_1BC], 7Bh ; '{'
                jnz     short loc_5CA57A
                mov     [esp+1E0h+arg_4], edx

loc_5CA57A:                             ; CODE XREF: __input+3E1↑j
                mov     eax, dword ptr [esp+1E0h+var_1CC]
                mov     edi, [esp+1E0h+var_1B8]
                dec     eax
                push    ebp             ; Stream
                push    ebx             ; Character
                mov     esi, edi
                mov     [esp+1E8h+var_1CC], eax
                call    __un_inc
                add     esp, 8

loc_5CA593:                             ; CODE XREF: __input+4BC↓j
                mov     eax, dword ptr [esp+1E0h+var_1B0]
                test    eax, eax
                jz      short loc_5CA5AE
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                mov     ecx, eax
                dec     eax
                test    ecx, ecx
                mov     [esp+1E0h+var_1C4], eax
                jz      loc_5CA678

loc_5CA5AE:                             ; CODE XREF: __input+409↑j
                mov     ebx, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                inc     ebx
                mov     [esp+1E4h+var_1CC], ebx
                call    _fgetc
                mov     ebx, eax
                add     esp, 4
                cmp     ebx, 0FFFFFFFFh
                jz      loc_5CA65F
                mov     ecx, ebx
                mov     edx, 1
                and     ecx, 7
                sar     eax, 3
                shl     edx, cl
                movsx   ecx, [esp+eax+1E0h+var_180]
                movsx   eax, [esp+1E0h+var_1BD]
                xor     ecx, eax
                test    ecx, edx
                jz      short loc_5CA65F
                mov     al, [esp+1E0h+var_1C5]
                test    al, al
                jnz     short loc_5CA659
                mov     al, [esp+1E0h+var_1C0]
                test    al, al
                jz      short loc_5CA651
                mov     edx, off_641268
                mov     ecx, ebx
                and     ecx, 0FFh
                mov     [esp+1E0h+SrcCh], bl
                test    byte ptr [edx+ecx*2+1], 80h
                jz      short loc_5CA629
                mov     eax, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                inc     eax
                mov     [esp+1E4h+var_1CC], eax
                call    _fgetc
                add     esp, 4
                mov     [esp+1E0h+var_19D], al

loc_5CA629:                             ; CODE XREF: __input+481↑j
                mov     eax, [g_SrcSizeInBytes]
                lea     ecx, [esp+1E0h+SrcCh]
                push    eax             ; SrcSizeInBytes
                lea     edx, [esp+1E4h+DstCh]
                push    ecx             ; SrcCh
                push    edx             ; DstCh
                call    _mbtowc
                mov     ax, [esp+1ECh+DstCh]
                add     esp, 0Ch
                mov     [edi], ax
                add     edi, 2
                jmp     loc_5CA593
; ---------------------------------------------------------------------------

loc_5CA651:                             ; CODE XREF: __input+468↑j
                mov     [edi], bl
                inc     edi
                jmp     loc_5CA593
; ---------------------------------------------------------------------------

loc_5CA659:                             ; CODE XREF: __input+460↑j
                inc     esi
                jmp     loc_5CA593
; ---------------------------------------------------------------------------

loc_5CA65F:                             ; CODE XREF: __input+435↑j
                mov     eax, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                dec     eax
                push    ebx             ; Character
                mov     [esp+1E8h+var_1B8], edi
                mov     [esp+1E8h+var_1CC], eax
                call    __un_inc
                add     esp, 8
                jmp     short loc_5CA67C
; ---------------------------------------------------------------------------

loc_5CA678:                             ; CODE XREF: __input+418↑j
                mov     [esp+1E0h+var_1B8], edi

loc_5CA67C:                             ; CODE XREF: __input+4E6↑j
                cmp     esi, edi
                jz      loc_5CADE6
                mov     al, [esp+1E0h+var_1C5]
                test    al, al
                jnz     loc_5CAD18
                mov     ecx, dword ptr [esp+1E0h+var_1AC]
                mov     eax, dword ptr [esp+1E0h+var_1BC]
                inc     ecx
                cmp     eax, 63h ; 'c'
                mov     [esp+1E0h+var_1AC], ecx
                jz      loc_5CAD18
                mov     al, [esp+1E0h+var_1C0]
                test    al, al
                jz      short loc_5CA6BC
                mov     ecx, dword ptr [esp+1E0h+var_1B8]
                mov     word ptr [ecx], 0
                jmp     loc_5CAD18
; ---------------------------------------------------------------------------

loc_5CA6BC:                             ; CODE XREF: __input+51C↑j
                mov     edx, dword ptr [esp+1E0h+var_1B8]
                mov     byte ptr [edx], 0
                jmp     loc_5CAD18
; ---------------------------------------------------------------------------

loc_5CA6C8:                             ; CODE XREF: __input+298↑j
                mov     esi, 64h ; 'd'  ; jumptable 005CA428 case 105
                mov     [esp+1E0h+var_1BC], esi

loc_5CA6D1:                             ; CODE XREF: __input+298↑j
                cmp     ebx, 2Dh ; '-'  ; jumptable 005CA428 case 120
                jnz     short loc_5CA6DD
                mov     [esp+1E0h+var_1BE], 1
                jmp     short loc_5CA6E2
; ---------------------------------------------------------------------------

loc_5CA6DD:                             ; CODE XREF: __input+544↑j
                cmp     ebx, 2Bh ; '+'
                jnz     short loc_5CA70C

loc_5CA6E2:                             ; CODE XREF: __input+54B↑j
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                dec     eax
                mov     [esp+1E0h+var_1C4], eax
                jnz     short loc_5CA6F8
                test    ecx, ecx
                jz      short loc_5CA6F8
                mov     [esp+1E0h+var_1CD], 1
                jmp     short loc_5CA70C
; ---------------------------------------------------------------------------

loc_5CA6F8:                             ; CODE XREF: __input+55B↑j
                mov     ebx, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                inc     ebx
                mov     [esp+1E4h+var_1CC], ebx
                call    _fgetc
                add     esp, 4
                mov     ebx, eax

loc_5CA70C:                             ; CODE XREF: __input+550↑j
                cmp     ebx, 30h ; '0'
                jnz     loc_5CA7C4
                mov     ebx, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                inc     ebx
                mov     [esp+1E4h+var_1CC], ebx
                call    _fgetc
                mov     ebx, eax
                add     esp, 4
                cmp     bl, 78h ; 'x'
                jz      short loc_5CA765
                cmp     bl, 58h ; 'X'
                jz      short loc_5CA765
                cmp     esi, 78h ; 'x'
                mov     [esp+1E0h+var_1A8], 1
                jz      short loc_5CA74B
                mov     esi, 6Fh ; 'o'
                mov     [esp+1E0h+var_1BC], esi
                jmp     short loc_5CA7C4
; ---------------------------------------------------------------------------

loc_5CA74B:                             ; CODE XREF: __input+5AE↑j
                mov     eax, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                dec     eax
                push    ebx             ; Character
                mov     [esp+1E8h+var_1CC], eax
                call    __un_inc
                add     esp, 8
                mov     ebx, 30h ; '0'
                jmp     short loc_5CA7C4
; ---------------------------------------------------------------------------

loc_5CA765:                             ; CODE XREF: __input+59C↑j
                mov     esi, [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                inc     esi
                mov     [esp+1E4h+var_1CC], esi
                call    _fgetc
                mov     esi, 78h ; 'x'
                add     esp, 4
                mov     ebx, eax
                mov     [esp+1E0h+var_1BC], esi
                jmp     short loc_5CA7C4
; ---------------------------------------------------------------------------

loc_5CA784:                             ; CODE XREF: __input+298↑j
                mov     [esp+1E0h+var_1C6], 1 ; jumptable 005CA428 case 112

loc_5CA789:                             ; CODE XREF: __input+298↑j
                cmp     ebx, 2Dh ; '-'  ; jumptable 005CA428 cases 100,111,117
                jnz     short loc_5CA795
                mov     [esp+1E0h+var_1BE], 1
                jmp     short loc_5CA79A
; ---------------------------------------------------------------------------

loc_5CA795:                             ; CODE XREF: __input+5FC↑j
                cmp     ebx, 2Bh ; '+'
                jnz     short loc_5CA7C4

loc_5CA79A:                             ; CODE XREF: __input+603↑j
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                dec     eax
                mov     [esp+1E0h+var_1C4], eax
                jnz     short loc_5CA7B0
                test    ecx, ecx
                jz      short loc_5CA7B0
                mov     [esp+1E0h+var_1CD], 1
                jmp     short loc_5CA7C4
; ---------------------------------------------------------------------------

loc_5CA7B0:                             ; CODE XREF: __input+613↑j
                mov     ebx, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                inc     ebx
                mov     [esp+1E4h+var_1CC], ebx
                call    _fgetc
                add     esp, 4
                mov     ebx, eax

loc_5CA7C4:                             ; CODE XREF: __input+57F↑j
                mov     al, [esp+1E0h+var_1CD]
                test    edi, edi
                jz      loc_5CA929
                test    al, al
                jnz     loc_5CA901
                mov     ebp, [esp+1E0h+Stream]
                mov     esi, [esp+1E0h+var_19C]
                mov     edi, [esp+1E0h+var_198]

loc_5CA7E7:                             ; CODE XREF: __input+763↓j
                mov     eax, dword ptr [esp+1E0h+var_1BC]
                cmp     eax, 78h ; 'x'
                mov     eax, [g_SrcSizeInBytes]
                jnz     short loc_5CA83A
                cmp     eax, 1
                jle     short loc_5CA80A
                push    80h             ; Type
                push    ebx             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5CA817
; ---------------------------------------------------------------------------

loc_5CA80A:                             ; CODE XREF: __input+668↑j
                mov     eax, off_641268
                mov     al, [eax+ebx*2]
                and     eax, 80h

loc_5CA817:                             ; CODE XREF: __input+678↑j
                test    eax, eax
                jz      short loc_5CA88D
                mov     ecx, 4
                mov     eax, esi
                mov     edx, edi
                call    __allshl
                push    ebx             ; C
                mov     esi, eax
                mov     edi, edx
                call    __hextodec
                add     esp, 4
                mov     ebx, eax
                jmp     short loc_5CA891
; ---------------------------------------------------------------------------

loc_5CA83A:                             ; CODE XREF: __input+663↑j
                cmp     eax, 1
                jle     short loc_5CA84C
                push    4               ; Type
                push    ebx             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5CA858
; ---------------------------------------------------------------------------

loc_5CA84C:                             ; CODE XREF: __input+6AD↑j
                mov     ecx, off_641268
                mov     al, [ecx+ebx*2]
                and     eax, 4

loc_5CA858:                             ; CODE XREF: __input+6BA↑j
                test    eax, eax
                jz      short loc_5CA88D
                cmp     [esp+1E0h+var_1BC], 6Fh ; 'o'
                jnz     short loc_5CA87C
                cmp     ebx, 38h ; '8'
                jge     short loc_5CA88D
                mov     ecx, 3
                mov     eax, esi
                mov     edx, edi
                call    __allshl
                mov     esi, eax
                mov     edi, edx
                jmp     short loc_5CA891
; ---------------------------------------------------------------------------

loc_5CA87C:                             ; CODE XREF: __input+6D1↑j
                push    0
                push    0Ah
                push    edi
                push    esi
                call    __allmul
                mov     esi, eax
                mov     edi, edx
                jmp     short loc_5CA891
; ---------------------------------------------------------------------------

loc_5CA88D:                             ; CODE XREF: __input+689↑j
                inc     [esp+1E0h+var_1CD]

loc_5CA891:                             ; CODE XREF: __input+6A8↑j
                mov     al, [esp+1E0h+var_1CD]
                test    al, al
                jnz     short loc_5CA8DA
                mov     edx, dword ptr [esp+1E0h+var_1A8]
                lea     eax, [ebx-30h]
                inc     edx
                mov     [esp+1E0h+var_1A8], edx
                cdq
                add     esi, eax
                mov     eax, dword ptr [esp+1E0h+var_1B0]
                adc     edi, edx
                test    eax, eax
                jz      short loc_5CA8C4
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                dec     eax
                mov     [esp+1E0h+var_1C4], eax
                jnz     short loc_5CA8C4
                mov     [esp+1E0h+var_1CD], 1
                jmp     short loc_5CA8ED
; ---------------------------------------------------------------------------

loc_5CA8C4:                             ; CODE XREF: __input+720↑j
                mov     ebx, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                inc     ebx
                mov     [esp+1E4h+var_1CC], ebx
                call    _fgetc
                add     esp, 4
                mov     ebx, eax
                jmp     short loc_5CA8ED
; ---------------------------------------------------------------------------

loc_5CA8DA:                             ; CODE XREF: __input+707↑j
                mov     eax, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                dec     eax
                push    ebx             ; Character
                mov     [esp+1E8h+var_1CC], eax
                call    __un_inc
                add     esp, 8

loc_5CA8ED:                             ; CODE XREF: __input+732↑j
                mov     al, [esp+1E0h+var_1CD]
                test    al, al
                jz      loc_5CA7E7
                mov     [esp+1E0h+var_198], edi
                mov     [esp+1E0h+var_19C], esi

loc_5CA901:                             ; CODE XREF: __input+642↑j
                mov     al, [esp+1E0h+var_1BE]
                test    al, al
                jz      loc_5CAA30
                mov     edx, dword ptr [esp+1E0h+var_19C]
                mov     eax, dword ptr [esp+1E0h+var_198]
                neg     edx
                adc     eax, 0
                mov     [esp+1E0h+var_19C], edx
                neg     eax
                mov     [esp+1E0h+var_198], eax
                jmp     loc_5CAA30
; ---------------------------------------------------------------------------

loc_5CA929:                             ; CODE XREF: __input+63A↑j
                mov     edi, [esp+1E0h+var_1A4]
                test    al, al
                jnz     loc_5CAA22

loc_5CA935:                             ; CODE XREF: __input+888↓j
                cmp     esi, 78h ; 'x'
                jz      short loc_5CA97B
                cmp     esi, 70h ; 'p'
                jz      short loc_5CA97B
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5CA955
                push    4               ; Type
                push    ebx             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5CA961
; ---------------------------------------------------------------------------

loc_5CA955:                             ; CODE XREF: __input+7B6↑j
                mov     ecx, off_641268
                mov     al, [ecx+ebx*2]
                and     eax, 4

loc_5CA961:                             ; CODE XREF: __input+7C3↑j
                test    eax, eax
                jz      short loc_5CA9B6
                cmp     esi, 6Fh ; 'o'
                jnz     short loc_5CA974
                cmp     ebx, 38h ; '8'
                jge     short loc_5CA9B6
                shl     edi, 3
                jmp     short loc_5CA9BA
; ---------------------------------------------------------------------------

loc_5CA974:                             ; CODE XREF: __input+7D8↑j
                lea     edi, [edi+edi*4]
                shl     edi, 1
                jmp     short loc_5CA9BA
; ---------------------------------------------------------------------------

loc_5CA97B:                             ; CODE XREF: __input+7A8↑j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5CA994
                push    80h             ; Type
                push    ebx             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5CA9A2
; ---------------------------------------------------------------------------

loc_5CA994:                             ; CODE XREF: __input+7F2↑j
                mov     edx, off_641268
                mov     al, [edx+ebx*2]
                and     eax, 80h

loc_5CA9A2:                             ; CODE XREF: __input+802↑j
                test    eax, eax
                jz      short loc_5CA9B6
                push    ebx             ; C
                shl     edi, 4
                call    __hextodec
                add     esp, 4
                mov     ebx, eax
                jmp     short loc_5CA9BA
; ---------------------------------------------------------------------------

loc_5CA9B6:                             ; CODE XREF: __input+7D3↑j
                inc     [esp+1E0h+var_1CD]

loc_5CA9BA:                             ; CODE XREF: __input+7E2↑j
                mov     al, [esp+1E0h+var_1CD]
                test    al, al
                jnz     short loc_5CA9FF
                mov     ecx, dword ptr [esp+1E0h+var_1A8]
                mov     eax, dword ptr [esp+1E0h+var_1B0]
                inc     ecx
                lea     edi, [edi+ebx-30h]
                test    eax, eax
                mov     [esp+1E0h+var_1A8], ecx
                jz      short loc_5CA9E9
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                dec     eax
                mov     [esp+1E0h+var_1C4], eax
                jnz     short loc_5CA9E9
                mov     [esp+1E0h+var_1CD], 1
                jmp     short loc_5CAA12
; ---------------------------------------------------------------------------

loc_5CA9E9:                             ; CODE XREF: __input+845↑j
                mov     ebx, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                inc     ebx
                mov     [esp+1E4h+var_1CC], ebx
                call    _fgetc
                add     esp, 4
                mov     ebx, eax
                jmp     short loc_5CAA12
; ---------------------------------------------------------------------------

loc_5CA9FF:                             ; CODE XREF: __input+830↑j
                mov     eax, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                dec     eax
                push    ebx             ; Character
                mov     [esp+1E8h+var_1CC], eax
                call    __un_inc
                add     esp, 8

loc_5CAA12:                             ; CODE XREF: __input+857↑j
                mov     al, [esp+1E0h+var_1CD]
                test    al, al
                jz      loc_5CA935
                mov     [esp+1E0h+var_1A4], edi

loc_5CAA22:                             ; CODE XREF: __input+79F↑j
                mov     al, [esp+1E0h+var_1BE]
                test    al, al
                jz      short loc_5CAA30
                neg     edi
                mov     [esp+1E0h+var_1A4], edi

loc_5CAA30:                             ; CODE XREF: __input+777↑j
                cmp     [esp+1E0h+var_1BC], 46h ; 'F'
                jnz     short loc_5CAA3B
                xor     eax, eax
                jmp     short loc_5CAA3F
; ---------------------------------------------------------------------------

loc_5CAA3B:                             ; CODE XREF: __input+8A5↑j
                mov     eax, dword ptr [esp+1E0h+var_1A8]

loc_5CAA3F:                             ; CODE XREF: __input+8A9↑j
                test    eax, eax
                jz      loc_5CADE6
                mov     al, [esp+1E0h+var_1C5]
                test    al, al
                jnz     loc_5CAD11
                mov     eax, dword ptr [esp+1E0h+var_1AC]
                mov     ebp, [esp+1E0h+Stream]
                mov     ecx, dword ptr [esp+1E0h+var_1B8]
                mov     edi, [esp+1E0h+var_188]
                inc     eax
                mov     [esp+1E0h+var_1AC], eax
                mov     eax, dword ptr [esp+1E0h+var_1A4]
                jmp     short loc_5CAA85
; ---------------------------------------------------------------------------

loc_5CAA71:                             ; CODE XREF: __input+298↑j
                mov     cl, [esp+1E0h+var_1C5] ; jumptable 005CA428 case 110
                mov     eax, dword ptr [esp+1E0h+var_1CC]
                test    cl, cl
                jnz     loc_5CAD18
                mov     ecx, dword ptr [esp+1E0h+var_1B8]

loc_5CAA85:                             ; CODE XREF: __input+8DF↑j
                test    edi, edi
                jz      short loc_5CAA9B
                mov     eax, dword ptr [esp+1E0h+var_19C]
                mov     edx, dword ptr [esp+1E0h+var_198]
                mov     [ecx], eax
                mov     [ecx+4], edx
                jmp     loc_5CAD18
; ---------------------------------------------------------------------------

loc_5CAA9B:                             ; CODE XREF: __input+8F7↑j
                mov     dl, [esp+1E0h+var_1C6]
                test    dl, dl
                jz      short loc_5CAAAA
                mov     [ecx], eax
                jmp     loc_5CAD18
; ---------------------------------------------------------------------------

loc_5CAAAA:                             ; CODE XREF: __input+911↑j
                mov     [ecx], ax
                jmp     loc_5CAD18
; ---------------------------------------------------------------------------

loc_5CAAB2:                             ; CODE XREF: __input+298↑j
                cmp     ebx, 2Dh ; '-'  ; jumptable 005CA428 cases 101-103
                lea     esi, [esp+1E0h+var_160]
                jnz     short loc_5CAACE
                mov     [esp+1E0h+var_160], bl
                lea     esi, [esp+1E0h+var_15F]
                jmp     short loc_5CAAD3
; ---------------------------------------------------------------------------

loc_5CAACE:                             ; CODE XREF: __input+92C↑j
                cmp     ebx, 2Bh ; '+'
                jnz     short loc_5CAAF0

loc_5CAAD3:                             ; CODE XREF: __input+93C↑j
                mov     ebx, dword ptr [esp+1E0h+var_1C4]
                mov     edi, [esp+1E0h+var_1CC]
                dec     ebx
                inc     edi
                push    ebp             ; Stream
                mov     [esp+1E4h+var_1C4], ebx
                mov     [esp+1E4h+var_1CC], edi
                call    _fgetc
                add     esp, 4
                mov     ebx, eax

loc_5CAAF0:                             ; CODE XREF: __input+941↑j
                mov     eax, dword ptr [esp+1E0h+var_1B0]
                test    eax, eax
                jz      short loc_5CAB02
                cmp     [esp+1E0h+var_1C4], 15Dh
                jle     short loc_5CAB0A

loc_5CAB02:                             ; CODE XREF: __input+966↑j
                mov     [esp+1E0h+var_1C4], 15Dh

loc_5CAB0A:                             ; CODE XREF: __input+970↑j
                mov     edi, [esp+1E0h+var_1A8]

loc_5CAB0E:                             ; CODE XREF: __input+9CA↓j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5CAB24
                push    4               ; Type
                push    ebx             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5CAB2F
; ---------------------------------------------------------------------------

loc_5CAB24:                             ; CODE XREF: __input+985↑j
                mov     eax, off_641268
                mov     al, [eax+ebx*2]
                and     eax, 4

loc_5CAB2F:                             ; CODE XREF: __input+992↑j
                test    eax, eax
                jz      short loc_5CAB5C
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                mov     ecx, eax
                dec     eax
                test    ecx, ecx
                mov     [esp+1E0h+var_1C4], eax
                jz      short loc_5CAB5C
                mov     [esi], bl
                mov     ebx, dword ptr [esp+1E0h+var_1CC]
                inc     edi
                inc     esi
                inc     ebx
                push    ebp             ; Stream
                mov     [esp+1E4h+var_1CC], ebx
                call    _fgetc
                add     esp, 4
                mov     ebx, eax
                jmp     short loc_5CAB0E
; ---------------------------------------------------------------------------

loc_5CAB5C:                             ; CODE XREF: __input+9A1↑j
                cmp     byte_641478, bl
                jnz     short loc_5CABDE
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                mov     edx, eax
                dec     eax
                test    edx, edx
                mov     [esp+1E0h+var_1C4], eax
                jz      short loc_5CABDE
                mov     ebx, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                inc     ebx
                mov     [esp+1E4h+var_1CC], ebx
                call    _fgetc
                mov     ebx, eax
                mov     al, byte_641478
                add     esp, 4
                mov     [esi], al
                inc     esi

loc_5CAB8F:                             ; CODE XREF: __input+A4C↓j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5CABA5
                push    4               ; Type
                push    ebx             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5CABB1
; ---------------------------------------------------------------------------

loc_5CABA5:                             ; CODE XREF: __input+A06↑j
                mov     ecx, off_641268
                mov     al, [ecx+ebx*2]
                and     eax, 4

loc_5CABB1:                             ; CODE XREF: __input+A13↑j
                test    eax, eax
                jz      short loc_5CABDE
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                mov     edx, eax
                dec     eax
                test    edx, edx
                mov     [esp+1E0h+var_1C4], eax
                jz      short loc_5CABDE
                mov     [esi], bl
                mov     ebx, dword ptr [esp+1E0h+var_1CC]
                inc     edi
                inc     esi
                inc     ebx
                push    ebp             ; Stream
                mov     [esp+1E4h+var_1CC], ebx
                call    _fgetc
                add     esp, 4
                mov     ebx, eax
                jmp     short loc_5CAB8F
; ---------------------------------------------------------------------------

loc_5CABDE:                             ; CODE XREF: __input+9D2↑j
                test    edi, edi
                jz      loc_5CAC91
                cmp     ebx, 65h ; 'e'
                jz      short loc_5CABF4
                cmp     ebx, 45h ; 'E'
                jnz     loc_5CAC91

loc_5CABF4:                             ; CODE XREF: __input+A59↑j
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                mov     ecx, eax
                dec     eax
                test    ecx, ecx
                mov     [esp+1E0h+var_1C4], eax
                jz      loc_5CAC91
                mov     ebx, dword ptr [esp+1E0h+var_1CC]
                mov     byte ptr [esi], 65h ; 'e'
                inc     esi
                inc     ebx
                push    ebp             ; Stream
                mov     [esp+1E4h+var_1CC], ebx
                call    _fgetc
                mov     ebx, eax
                add     esp, 4
                cmp     ebx, 2Dh ; '-'
                jnz     short loc_5CAC29
                mov     [esi], al
                inc     esi
                jmp     short loc_5CAC2E
; ---------------------------------------------------------------------------

loc_5CAC29:                             ; CODE XREF: __input+A92↑j
                cmp     ebx, 2Bh ; '+'
                jnz     short loc_5CAC57

loc_5CAC2E:                             ; CODE XREF: __input+A97↑j
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                mov     edx, eax
                dec     eax
                test    edx, edx
                mov     [esp+1E0h+var_1C4], eax
                jnz     short loc_5CAC43
                mov     [esp+1E0h+var_1C4], edx
                jmp     short loc_5CAC57
; ---------------------------------------------------------------------------

loc_5CAC43:                             ; CODE XREF: __input+AAB↑j
                mov     ebx, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                inc     ebx
                mov     [esp+1E4h+var_1CC], ebx
                call    _fgetc
                add     esp, 4
                mov     ebx, eax

loc_5CAC57:                             ; CODE XREF: __input+A9C↑j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5CAC6D
                push    4               ; Type
                push    ebx             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5CAC78
; ---------------------------------------------------------------------------

loc_5CAC6D:                             ; CODE XREF: __input+ACE↑j
                mov     eax, off_641268
                mov     al, [eax+ebx*2]
                and     eax, 4

loc_5CAC78:                             ; CODE XREF: __input+ADB↑j
                test    eax, eax
                jz      short loc_5CAC91
                mov     eax, dword ptr [esp+1E0h+var_1C4]
                mov     ecx, eax
                dec     eax
                test    ecx, ecx
                mov     [esp+1E0h+var_1C4], eax
                jz      short loc_5CAC91
                inc     edi
                mov     [esi], bl
                inc     esi
                jmp     short loc_5CAC43
; ---------------------------------------------------------------------------

loc_5CAC91:                             ; CODE XREF: __input+A50↑j
                mov     ecx, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                dec     ecx
                push    ebx             ; Character
                mov     [esp+1E8h+var_1CC], ecx
                call    __un_inc
                add     esp, 8
                test    edi, edi
                jz      loc_5CADE6
                mov     al, [esp+1E0h+var_1C5]
                test    al, al
                jnz     short loc_5CAD18
                mov     ecx, dword ptr [esp+1E0h+var_1AC]
                mov     eax, dword ptr [esp+1E0h+var_1B8]
                inc     ecx
                lea     edx, [esp+1E0h+var_160]
                mov     [esp+1E0h+var_1AC], ecx
                push    edx
                movsx   ecx, [esp+1E4h+var_1C6]
                dec     ecx
                push    eax
                push    ecx
                mov     byte ptr [esi], 0
                call    off_63F130
; ---------------------------------------------------------------------------
                add     esp, 0Ch
                jmp     short loc_5CAD18
; ---------------------------------------------------------------------------

def_5CA428:                             ; CODE XREF: __input+28A↑j
                mov     eax, dword ptr [esp+1E0h+arg_4] ; jumptable 005CA428 default case, cases 104,106-109,113,114,116,118,119,121,122
                xor     edx, edx
                mov     dl, [eax]
                cmp     edx, ebx
                jnz     loc_5CADCD
                mov     cl, [esp+1E0h+var_1BF]
                mov     al, [esp+1E0h+var_1C5]
                dec     cl
                test    al, al
                mov     [esp+1E0h+var_1BF], cl
                jnz     short loc_5CAD18
                mov     ecx, dword ptr [esp+1E0h+varC]
                mov     [esp+1E0h+arg_8], ecx
                jmp     short loc_5CAD18
; ---------------------------------------------------------------------------

loc_5CAD11:                             ; CODE XREF: __input+8BD↑j
                mov     ebp, [esp+1E0h+Stream]

loc_5CAD18:                             ; CODE XREF: __input+4FA↑j
                mov     cl, [esp+1E0h+var_1BF]
                mov     eax, dword ptr [esp+1E0h+arg_4]
                inc     cl
                inc     eax
                mov     [esp+1E0h+var_1BF], cl
                mov     [esp+1E0h+arg_4], eax
                xor     edi, edi
                mov     esi, eax
                jmp     short loc_5CAD93
; ---------------------------------------------------------------------------

loc_5CAD37:                             ; CODE XREF: __input+C3↑j
                mov     eax, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                inc     eax
                mov     [esp+1E4h+var_1CC], eax
                call    _fgetc
                xor     edx, edx
                add     esp, 4
                mov     dl, [esi]
                mov     ebx, eax
                inc     esi
                cmp     edx, ebx
                mov     [esp+1E0h+arg_4], esi
                jnz     short loc_5CADCD
                mov     ecx, off_641268
                and     eax, 0FFh
                test    byte ptr [ecx+eax*2+1], 80h
                jz      short loc_5CAD93
                mov     ecx, dword ptr [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                inc     ecx
                mov     [esp+1E4h+var_1CC], ecx
                call    _fgetc
                xor     edx, edx
                add     esp, 4
                mov     dl, [esi]
                inc     esi
                cmp     edx, eax
                mov     [esp+1E0h+arg_4], esi
                jnz     short loc_5CADBA
                dec     [esp+1E0h+var_1CC]

loc_5CAD93:                             ; CODE XREF: __input+BA5↑j
                cmp     ebx, 0FFFFFFFFh
                jnz     short loc_5CADAE
                cmp     byte ptr [esi], 25h ; '%'
                jnz     short loc_5CADE6
                mov     eax, dword ptr [esp+1E0h+arg_4]
                cmp     byte ptr [eax+1], 6Eh ; 'n'
                jnz     short loc_5CADE6
                xor     edi, edi
                mov     esi, eax

loc_5CADAE:                             ; CODE XREF: __input+C06↑j
                mov     al, [esi]
                test    al, al
                jnz     loc_5CA1CD
                jmp     short loc_5CADE6
; ---------------------------------------------------------------------------

loc_5CADBA:                             ; CODE XREF: __input+BFD↑j
                mov     esi, [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                dec     esi
                push    eax             ; Character
                mov     [esp+1E8h+var_1CC], esi
                call    __un_inc
                add     esp, 8

loc_5CADCD:                             ; CODE XREF: __input+27A↑j
                mov     esi, [esp+1E0h+var_1CC]
                push    ebp             ; Stream
                dec     esi
                push    ebx             ; Character
                mov     [esp+1E8h+var_1CC], esi
                call    __un_inc
                add     esp, 8
                jmp     short loc_5CADE6
; ---------------------------------------------------------------------------

loc_5CADE2:                             ; CODE XREF: __input+23↑j
                mov     ebx, dword ptr [esp+1E0h+varC]

loc_5CADE6:                             ; CODE XREF: __input+3D6↑j
                mov     eax, dword ptr [esp+1E0h+var_1AC]
                cmp     ebx, 0FFFFFFFFh
                jnz     short loc_5CADFE
                test    eax, eax
                jnz     short loc_5CADFE
                mov     cl, [esp+1E0h+var_1BF]
                test    cl, cl
                jnz     short loc_5CADFE
                or      eax, 0FFFFFFFFh

loc_5CADFE:                             ; CODE XREF: __input+C5D↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 1D0h
                retn
__input         endp

; ---------------------------------------------------------------------------
                align 4
jpt_5CA310      dd offset loc_5CA360    ; DATA XREF: __input+180↑r
                dd offset loc_5CA36A    ; jump table for switch statement
                dd offset loc_5CA32D
                dd offset loc_5CA350
                dd offset loc_5CA36A
                dd offset loc_5CA317
                dd offset loc_5CA356
                dd offset loc_5CA35A
                dd offset def_5CA310
byte_5CAE30     db      0,     8,     8,     8
                db      8,     8,     8,     8 ; indirect table for switch statement
                db      8,     8,     8,     8
                db      8,     8,     8,     8
                db      8,     8,     8,     8
                db      8,     8,     8,     8
                db      8,     8,     8,     8
                db      1,     8,     8,     2
                db      8,     8,     3,     8
                db      4,     8,     8,     8
                db      8,     8,     8,     8
                db      8,     8,     8,     8
                db      8,     8,     8,     8
                db      8,     8,     8,     8
                db      8,     8,     8,     8
                db      8,     8,     5,     8
                db      8,     8,     6,     8
                db      8,     8,     8,     8
                db      8,     8,     8,     8
                db      8,     7
                align 10h
jpt_5CA428      dd offset loc_5CA42F    ; DATA XREF: __input+298↑r
                dd offset loc_5CA789    ; jump table for switch statement
                dd offset loc_5CAAB2
                dd offset loc_5CA6C8
                dd offset loc_5CAA71
                dd offset loc_5CA789
                dd offset loc_5CA784
                dd offset loc_5CA458
                dd offset loc_5CA789
                dd offset loc_5CA6D1
                dd offset loc_5CA46C
                dd offset def_5CA428
byte_5CAEB0     db      0,     1,     2,     2
                db      2,   0Bh,     3,   0Bh ; indirect table for switch statement
                db    0Bh,   0Bh,   0Bh,     4
                db      5,     6,   0Bh,   0Bh
                db      7,   0Bh,     8,   0Bh
                db    0Bh,     9,   0Bh,   0Bh
                db    0Ah
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl _hextodec(int C)
__hextodec      proc near               ; CODE XREF: __input+69E↑p

varC               = dword ptr  4

                mov     eax, [g_SrcSizeInBytes]
                push    esi
                cmp     eax, 1
                jle     short loc_5CAEEC
                mov     esi, [esp+4+varC]
                push    4               ; Type
                push    esi             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5CAEFB
; ---------------------------------------------------------------------------

loc_5CAEEC:                             ; CODE XREF: __hextodec+9↑j
                mov     esi, [esp+4+varC]
                mov     eax, off_641268
                mov     al, [eax+esi*2]
                and     eax, 4

loc_5CAEFB:                             ; CODE XREF: __hextodec+1A↑j
                test    eax, eax
                jnz     short loc_5CAF05
                and     esi, 0FFFFFFDFh
                sub     esi, 7

loc_5CAF05:                             ; CODE XREF: __hextodec+2D↑j
                mov     eax, esi
                pop     esi
                retn
__hextodec      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl fgetc(FILE *Stream)
_fgetc          proc near               ; CODE XREF: __input+262↑p

File            = dword ptr  4

                mov     ecx, dword ptr [esp+File]
                mov     eax, dword ptr [ecx+4]
                dec     eax
                mov     [ecx+4], eax
                js      short loc_5CAF27
                mov     edx, dword ptr [ecx]
                xor     eax, eax
                mov     al, [edx]
                inc     edx
                mov     [ecx], edx
                retn
; ---------------------------------------------------------------------------

loc_5CAF27:                             ; CODE XREF: _fgetc+B↑j
                push    ecx             ; File
                call    __filbuf
                add     esp, 4
                retn
_fgetc          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl _un_inc(int Character, FILE *Stream)
__un_inc        proc near               ; CODE XREF: __input+86↑p

Character       = dword ptr  4
Stream          = dword ptr  8

                mov     eax, dword ptr [esp+Character]
                cmp     eax, 0FFFFFFFFh
                jz      short locret_5CAF57
                mov     ecx, dword ptr [esp+Stream]
                push    ecx             ; Stream
                push    eax             ; Character
                call    _ungetc_0
                add     esp, 8

locret_5CAF57:                          ; CODE XREF: __un_inc+7↑j
                retn
__un_inc        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl _whiteout(int, FILE *Stream)
__whiteout      proc near               ; CODE XREF: __input+7D↑p

arg_0           = dword ptr  4
Stream          = dword ptr  8

                push    ebx
                mov     ebx, dword ptr [esp+4+Stream]
                push    esi
                push    edi
                mov     edi, [esp+0Ch+arg_0]
                push    ebx             ; Stream
                inc     dword ptr [edi]
                call    _fgetc
                add     esp, 4
                mov     esi, eax
                push    esi             ; C
                call    _isspace
                add     esp, 4
                test    eax, eax
                jz      short loc_5CAFA2

loc_5CAF85:                             ; CODE XREF: __whiteout+40↓j
                mov     esi, [edi]
                push    ebx             ; Stream
                inc     esi
                mov     [edi], esi
                call    _fgetc
                add     esp, 4
                mov     esi, eax
                push    esi             ; C
                call    _isspace
                add     esp, 4
                test    eax, eax
                jnz     short loc_5CAF85

loc_5CAFA2:                             ; CODE XREF: __whiteout+23↑j
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebx
                retn
__whiteout      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl setlocale(int Category, const char *Locale)
_setlocale      proc near

var_90          = dword ptr -90h
var_8C          = dword ptr -8Ch
var_88          = dword ptr -88h
Destination     = byte ptr -84h
Category        = dword ptr  4
Locale          = dword ptr  8

                sub     esp, 90h
                push    ebx
                push    ebp
                push    esi
                push    edi
                mov     edi, [esp+0A0h+Category]
                xor     ebp, ebp
                cmp     edi, ebp
                jl      loc_5CB26B
                cmp     edi, 5
                jg      loc_5CB26B
                push    13h
                call    __lock
                mov     ecx, dword_70E964
                mov     eax, Addend
                add     esp, 4
                inc     ecx
                cmp     eax, ebp
                mov     dword_70E964, ecx
                jz      short loc_5CB006
                mov     esi, ds:Sleep

loc_5CAFFA:                             ; CODE XREF: _setlocale+54↓j
                push    1               ; dwMilliseconds
                call    esi ; Sleep
                cmp     Addend, ebp
                jnz     short loc_5CAFFA

loc_5CB006:                             ; CODE XREF: _setlocale+42↑j
                cmp     edi, ebp
                jz      short loc_5CB033
                mov     eax, dword ptr [esp+0A0h+Locale]
                cmp     eax, ebp
                jz      short loc_5CB024
                push    eax             ; Source
                push    edi             ; int
                call    __setlocale_set_cat
                add     esp, 8
                jmp     loc_5CB247
; ---------------------------------------------------------------------------

loc_5CB024:                             ; CODE XREF: _setlocale+63↑j
                lea     eax, [edi+edi*2]
                mov     esi, dword_6414FC[eax*4]
                jmp     loc_5CB249
; ---------------------------------------------------------------------------

loc_5CB033:                             ; CODE XREF: _setlocale+58↑j
                mov     ebx, dword ptr [esp+0A0h+Locale]
                mov     [esp+0A0h+var_8C], 1
                cmp     ebx, ebp
                mov     [esp+0A0h+var_90], ebp
                jz      loc_5CB242
                cmp     byte ptr [ebx], 4Ch ; 'L'
                jnz     loc_5CB185
                cmp     byte ptr [ebx+1], 43h ; 'C'
                jnz     loc_5CB185
                cmp     byte ptr [ebx+2], 5Fh ; '_'
                jnz     loc_5CB185
                push    offset Control  ; "=;"
                push    ebx             ; varStr
                call    _strpbrk
                mov     ebp, eax
                add     esp, 8
                test    ebp, ebp
                jz      loc_5CB163

loc_5CB083:                             ; CODE XREF: _setlocale+1AD↓j
                mov     edi, ebp
                sub     edi, ebx
                mov     [esp+0A0h+var_8C], edi
                jz      loc_5CB163
                cmp     byte ptr [ebp+0], 3Bh ; ';'
                jz      loc_5CB163
                mov     [esp+0A0h+var_88], 1
                mov     esi, offset off_641504 ; "LC_COLLATE"

loc_5CB0A8:                             ; CODE XREF: _setlocale+12F↓j
                mov     ecx, dword ptr [esi]
                push    edi             ; MaxCount
                push    ebx             ; Str2
                push    ecx             ; Str1
                call    _strncmp
                add     esp, 0Ch
                test    eax, eax
                jnz     short loc_5CB0CD
                mov     edi, [esi]
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     eax, dword ptr [esp+0A0h+var_8C]
                not     ecx
                dec     ecx
                cmp     eax, ecx
                jz      short loc_5CB0E1
                mov     edi, eax

loc_5CB0CD:                             ; CODE XREF: _setlocale+107↑j
                mov     edx, dword ptr [esp+0A0h+var_88]
                add     esi, 0Ch
                inc     edx
                cmp     esi, offset off_641534 ; "LC_TIME"
                mov     [esp+0A0h+var_88], edx
                jle     short loc_5CB0A8

loc_5CB0E1:                             ; CODE XREF: _setlocale+119↑j
                inc     ebp
                push    offset asc_6147A0 ; ";"
                push    ebp             ; varStr
                call    _strcspn
                mov     esi, eax
                add     esp, 8
                test    esi, esi
                jnz     short loc_5CB0FC
                cmp     byte ptr [ebp+0], 3Bh ; ';'
                jnz     short loc_5CB163

loc_5CB0FC:                             ; CODE XREF: _setlocale+144↑j
                mov     edi, [esp+0A0h+var_88]
                cmp     edi, 5
                jg      short loc_5CB12F
                push    esi             ; Count
                lea     edx, [esp+0A4h+Destination]
                push    ebp             ; Source
                push    edx             ; Destination
                call    _strncpy
                add     esp, 0Ch
                lea     eax, [esp+0A0h+Destination]
                mov     [esp+esi+0A0h+Destination], 0
                push    eax             ; Source
                push    edi             ; int
                call    __setlocale_set_cat
                add     esp, 8
                test    eax, eax
                jz      short loc_5CB12F
                inc     [esp+0A0h+var_90]

loc_5CB12F:                             ; CODE XREF: _setlocale+153↑j
                mov     al, [ebp+esi+0]
                lea     ebx, [ebp+esi+0]
                test    al, al
                jz      loc_5CB236
                mov     al, [ebx+1]
                inc     ebx
                test    al, al
                jz      loc_5CB236
                push    offset aControl  ; "=;"
                push    ebx             ; varStr
                call    _strpbrk
                mov     ebp, eax
                add     esp, 8
                test    ebp, ebp
                jnz     loc_5CB083

loc_5CB163:                             ; CODE XREF: _setlocale+CD↑j
                push    13h
                call    __unlock
                mov     eax, dword_70E964
                add     esp, 4
                dec     eax
                mov     dword_70E964, eax
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 90h
                retn
; ---------------------------------------------------------------------------

loc_5CB185:                             ; CODE XREF: _setlocale+A1↑j
                push    ebp
                push    ebp             ; int
                lea     ecx, [esp+0A8h+Destination]
                push    ebp             ; int
                push    ecx             ; int
                push    ebx             ; Source
                call    __expandlocale
                mov     esi, eax
                add     esp, 14h
                cmp     esi, ebp
                jz      loc_5CB249
                mov     edi, offset dword_6414FC

loc_5CB1A5:                             ; CODE XREF: _setlocale+25A↓j
                cmp     edi, offset dword_6414FC
                jz      short loc_5CB200
                mov     esi, [edi]
                lea     eax, [esp+0A0h+Destination]

loc_5CB1B3:                             ; CODE XREF: _setlocale+225↓j
                mov     dl, [eax]
                mov     bl, [esi]
                mov     cl, dl
                cmp     dl, bl
                jnz     short loc_5CB1DB
                test    cl, cl
                jz      short loc_5CB1D7
                mov     dl, [eax+1]
                mov     bl, [esi+1]
                mov     cl, dl
                cmp     dl, bl
                jnz     short loc_5CB1DB
                add     eax, 2
                add     esi, 2
                test    cl, cl
                jnz     short loc_5CB1B3

loc_5CB1D7:                             ; CODE XREF: _setlocale+20F↑j
                xor     eax, eax
                jmp     short loc_5CB1E0
; ---------------------------------------------------------------------------

loc_5CB1DB:                             ; CODE XREF: _setlocale+20B↑j
                sbb     eax, eax
                sbb     eax, 0FFFFFFFFh

loc_5CB1E0:                             ; CODE XREF: _setlocale+229↑j
                test    eax, eax
                jz      short loc_5CB1FC
                lea     eax, [esp+0A0h+Destination]
                push    eax             ; Source
                push    ebp             ; int
                call    __setlocale_set_cat
                add     esp, 8
                test    eax, eax
                jnz     short loc_5CB1FC
                mov     [esp+0A0h+var_8C], eax
                jmp     short loc_5CB200
; ---------------------------------------------------------------------------

loc_5CB1FC:                             ; CODE XREF: _setlocale+232↑j
                inc     [esp+0A0h+var_90]

loc_5CB200:                             ; CODE XREF: _setlocale+1FB↑j
                add     edi, 0Ch
                inc     ebp
                cmp     edi, offset off_641538 ; "C"
                jle     short loc_5CB1A5
                mov     eax, dword ptr [esp+0A0h+var_8C]
                test    eax, eax
                jz      short loc_5CB236
                call    __setlocale_get_all
                mov     ecx, dword_6414FC
                mov     esi, eax
                push    ecx             ; Block
                call    _free
                add     esp, 4
                mov     dword_6414FC, 0
                jmp     short loc_5CB249
; ---------------------------------------------------------------------------

loc_5CB236:                             ; CODE XREF: _setlocale+189↑j
                mov     eax, dword ptr [esp+0A0h+var_90]
                test    eax, eax
                jnz     short loc_5CB242
                xor     esi, esi
                jmp     short loc_5CB249
; ---------------------------------------------------------------------------

loc_5CB242:                             ; CODE XREF: _setlocale+98↑j
                call    __setlocale_get_all

loc_5CB247:                             ; CODE XREF: _setlocale+6F↑j
                mov     esi, eax

loc_5CB249:                             ; CODE XREF: _setlocale+7E↑j
                push    13h
                call    __unlock
                mov     eax, dword_70E964
                add     esp, 4
                dec     eax
                mov     dword_70E964, eax
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 90h
                retn
; ---------------------------------------------------------------------------

loc_5CB26B:                             ; CODE XREF: _setlocale+15↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                add     esp, 90h
                retn
_setlocale      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl _setlocale_set_cat(int, char *Source)
__setlocale_set_cat proc near           ; CODE XREF: _setlocale+67↑p

var_A0          = dword ptr -0A0h
var_9C          = dword ptr -9Ch
var_98          = dword ptr -98h
Block           = dword ptr -94h
var_90          = dword ptr -90h
var_8C          = word ptr -8Ch
var_88          = dword ptr -88h
var_84          = dword ptr -84h
arg_0           = dword ptr  4
Source          = dword ptr  8

                sub     esp, 0A0h
                lea     eax, [esp+0A0h+var_88]
                lea     ecx, [esp+0A0h+var_90]
                lea     edx, [esp+0A0h+var_84]
                push    ebx
                mov     ebx, dword ptr [esp+0A4h+arg_0]
                push    ebp
                push    esi
                push    edi
                push    ebx
                push    eax             ; int
                mov     eax, dword ptr [esp+0B8h+Source]
                push    ecx             ; int
                push    edx             ; int
                push    eax             ; Source
                call    __expandlocale
                add     esp, 14h
                test    eax, eax
                jnz     short loc_5CB2C0
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 0A0h
                retn
; ---------------------------------------------------------------------------

loc_5CB2C0:                             ; CODE XREF: __setlocale_set_cat+33↑j
                lea     edi, [esp+0B0h+var_84]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                push    ecx             ; varSize
                call    _malloc
                mov     edx, eax
                add     esp, 4
                test    edx, edx
                mov     [esp+0B0h+Block], edx
                jnz     short loc_5CB2EB
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 0A0h
                retn
; ---------------------------------------------------------------------------

loc_5CB2EB:                             ; CODE XREF: __setlocale_set_cat+5E↑j
                lea     ebp, [ebx+ebx*2]
                mov     eax, dword_70D550[ebx*4]
                shl     ebp, 2
                mov     [esp+0B0h+var_9C], eax
                lea     edi, [esp+0B0h+var_84]
                mov     ecx, ss:dword_6414FC[ebp]
                xor     eax, eax
                mov     [esp+0B0h+var_A0], ecx
                mov     ecx, CodePage
                mov     [esp+0B0h+var_98], ecx
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     eax, ecx
                mov     esi, edi
                mov     edi, edx
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                and     ecx, 3
                rep movsb
                mov     eax, dword ptr [esp+0B0h+var_90]
                mov     ss:dword_6414FC[ebp], edx
                mov     ecx, eax
                lea     edx, [ebx+ebx*2]
                and     ecx, 0FFFFh
                cmp     ebx, 2
                mov     dword_70D550[ebx*4], ecx
                lea     ecx, unk_70D7A0[edx*2]
                mov     dx, [esp+0B0h+var_8C]
                mov     [ecx], eax
                mov     [ecx+4], dx
                jnz     short loc_5CB36D
                mov     eax, dword ptr [esp+0B0h+var_88]
                mov     [g_CodePage], eax

loc_5CB36D:                             ; CODE XREF: __setlocale_set_cat+E2↑j
                call    ss:off_641500[ebp]
                test    eax, eax
                jz      short loc_5CB3B0
                mov     edx, dword ptr [esp+0B0h+Block]
                mov     ecx, dword ptr [esp+0B0h+var_A0]
                push    edx             ; Block
                mov     ss:dword_6414FC[ebp], ecx
                call    _free
                mov     eax, dword ptr [esp+0B4h+var_9C]
                mov     ecx, dword ptr [esp+0B4h+var_98]
                add     esp, 4
                mov     dword_70D550[ebx*4], eax
                mov     [g_CodePage], ecx
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 0A0h
                retn
; ---------------------------------------------------------------------------

loc_5CB3B0:                             ; CODE XREF: __setlocale_set_cat+F5↑j
                mov     eax, dword ptr [esp+0B0h+var_A0]
                cmp     eax, offset aC  ; "C"
                jz      short loc_5CB3C4
                push    eax             ; Block
                call    _free
                add     esp, 4

loc_5CB3C4:                             ; CODE XREF: __setlocale_set_cat+139↑j
                mov     eax, ss:dword_6414FC[ebp]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 0A0h
                retn
__setlocale_set_cat endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__setlocale_get_all proc near           ; CODE XREF: _setlocale+264↑p

var_4           = dword ptr -4

                push    ecx
                mov     eax, dword_6414FC
                push    ebx
                push    ebp
                push    esi
                test    eax, eax
                push    edi
                mov     [esp+14h+var_4], 1
                jnz     short loc_5CB408
                push    351h            ; varSize
                call    _malloc
                add     esp, 4
                mov     dword_6414FC, eax

loc_5CB408:                             ; CODE XREF: __setlocale_get_all+14↑j
                mov     byte ptr [eax], 0
                mov     eax, off_641508 ; "C"
                mov     ecx, off_641504 ; "LC_COLLATE"
                mov     edx, dword_6414FC
                push    eax
                push    offset asc_6147A8 ; "="
                push    ecx
                push    3
                push    edx
                call    __strcats
                mov     ebx, offset off_641508 ; "C"
                add     esp, 14h
                mov     ebp, ebx

loc_5CB435:                             ; CODE XREF: __setlocale_get_all+EA↓j
                mov     edi, offset asc_6147A0 ; ";"
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     edi, dword_6414FC
                mov     edx, ecx
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     ecx, edx
                dec     edi
                shr     ecx, 2
                rep movsd
                mov     ecx, edx
                and     ecx, 3
                rep movsb
                mov     esi, [ebp+0Ch]
                mov     eax, dword ptr [ebx]

loc_5CB468:                             ; CODE XREF: __setlocale_get_all+AA↓j
                mov     dl, [eax]
                mov     bl, [esi]
                mov     cl, dl
                cmp     dl, bl
                jnz     short loc_5CB490
                test    cl, cl
                jz      short loc_5CB48C
                mov     dl, [eax+1]
                mov     bl, [esi+1]
                mov     cl, dl
                cmp     dl, bl
                jnz     short loc_5CB490
                add     eax, 2
                add     esi, 2
                test    cl, cl
                jnz     short loc_5CB468

loc_5CB48C:                             ; CODE XREF: __setlocale_get_all+94↑j
                xor     eax, eax
                jmp     short loc_5CB495
; ---------------------------------------------------------------------------

loc_5CB490:                             ; CODE XREF: __setlocale_get_all+90↑j
                sbb     eax, eax
                sbb     eax, 0FFFFFFFFh

loc_5CB495:                             ; CODE XREF: __setlocale_get_all+AE↑j
                test    eax, eax
                jz      short loc_5CB4A1
                mov     [esp+14h+var_4], 0

loc_5CB4A1:                             ; CODE XREF: __setlocale_get_all+B7↑j
                mov     eax, dword ptr [ebp+0Ch]
                mov     ecx, dword ptr [ebp+8]
                mov     edx, dword_6414FC
                add     ebp, 0Ch
                push    eax
                push    offset asc_6147A8 ; "="
                push    ecx
                push    3
                push    edx
                mov     ebx, ebp
                call    __strcats
                add     esp, 14h
                cmp     ebp, offset off_641538 ; "C"
                jl      loc_5CB435
                mov     eax, dword ptr [esp+14h+var_4]
                test    eax, eax
                mov     eax, dword_6414FC
                jz      short loc_5CB4F5
                push    eax             ; Block
                call    _free
                mov     eax, off_641514 ; "C"
                add     esp, 4
                mov     dword_6414FC, 0

loc_5CB4F5:                             ; CODE XREF: __setlocale_get_all+FB↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
__setlocale_get_all endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _expandlocale(char *Source, int, int, int)
__expandlocale  proc near               ; CODE XREF: _setlocale+1DE↑p

String1         = byte ptr -88h
Source          = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                sub     esp, 88h
                push    esi
                push    edi
                mov     edi, [esp+90h+Source]
                test    edi, edi
                jnz     short loc_5CB51E
                xor     eax, eax
                pop     edi
                pop     esi
                add     esp, 88h
                retn
; ---------------------------------------------------------------------------

loc_5CB51E:                             ; CODE XREF: __expandlocale+11↑j
                cmp     byte ptr [edi], 43h ; 'C'
                jnz     short loc_5CB572
                mov     al, [edi+1]
                test    al, al
                jnz     short loc_5CB572
                mov     eax, dword ptr [esp+90h+arg_4]
                mov     ecx, dword ptr [esp+90h+arg_8]
                test    ecx, ecx
                mov     byte ptr [eax], 43h ; 'C'
                mov     byte ptr [eax+1], 0
                jz      short loc_5CB554
                mov     word ptr [ecx], 0
                mov     word ptr [ecx+2], 0
                mov     word ptr [ecx+4], 0

loc_5CB554:                             ; CODE XREF: __expandlocale+41↑j
                mov     ecx, dword ptr [esp+90h+arg_C]
                test    ecx, ecx
                jz      loc_5CB6E9
                mov     dword ptr [ecx], 0
                pop     edi
                pop     esi
                add     esp, 88h
                retn
; ---------------------------------------------------------------------------

loc_5CB572:                             ; CODE XREF: __expandlocale+21↑j
                mov     esi, edi
                mov     eax, offset unk_6415C8

loc_5CB579:                             ; CODE XREF: __expandlocale+97↓j
                mov     dl, [eax]
                mov     cl, dl
                cmp     dl, [esi]
                jnz     short loc_5CB59D
                test    cl, cl
                jz      short loc_5CB599
                mov     dl, [eax+1]
                mov     cl, dl
                cmp     dl, [esi+1]
                jnz     short loc_5CB59D
                add     eax, 2
                add     esi, 2
                test    cl, cl
                jnz     short loc_5CB579

loc_5CB599:                             ; CODE XREF: __expandlocale+83↑j
                xor     eax, eax
                jmp     short loc_5CB5A2
; ---------------------------------------------------------------------------

loc_5CB59D:                             ; CODE XREF: __expandlocale+7F↑j
                sbb     eax, eax
                sbb     eax, 0FFFFFFFFh

loc_5CB5A2:                             ; CODE XREF: __expandlocale+9B↑j
                test    eax, eax
                jz      loc_5CB68C
                mov     esi, edi
                mov     eax, offset unk_641540

loc_5CB5B1:                             ; CODE XREF: __expandlocale+CF↓j
                mov     dl, [eax]
                mov     cl, dl
                cmp     dl, [esi]
                jnz     short loc_5CB5D5
                test    cl, cl
                jz      short loc_5CB5D1
                mov     dl, [eax+1]
                mov     cl, dl
                cmp     dl, [esi+1]
                jnz     short loc_5CB5D5
                add     eax, 2
                add     esi, 2
                test    cl, cl
                jnz     short loc_5CB5B1

loc_5CB5D1:                             ; CODE XREF: __expandlocale+BB↑j
                xor     eax, eax
                jmp     short loc_5CB5DA
; ---------------------------------------------------------------------------

loc_5CB5D5:                             ; CODE XREF: __expandlocale+B7↑j
                sbb     eax, eax
                sbb     eax, 0FFFFFFFFh

loc_5CB5DA:                             ; CODE XREF: __expandlocale+D3↑j
                test    eax, eax
                jz      loc_5CB68C
                lea     eax, [esp+90h+String1]
                push    edi             ; Source
                push    eax             ; int
                call    ___lc_strtolc
                add     esp, 8
                test    eax, eax
                jz      short loc_5CB5FF
                xor     eax, eax
                pop     edi
                pop     esi
                add     esp, 88h
                retn
; ---------------------------------------------------------------------------

loc_5CB5FF:                             ; CODE XREF: __expandlocale+F2↑j
                lea     ecx, [esp+90h+String1]
                lea     edx, [esp+90h+String1]
                push    ecx             ; lpLCData
                push    offset dword_70D56C ; int
                push    edx             ; String1
                call    ___get_qualified_locale
                add     esp, 0Ch
                test    eax, eax
                jnz     short loc_5CB623
                pop     edi
                pop     esi
                add     esp, 88h
                retn
; ---------------------------------------------------------------------------

loc_5CB623:                             ; CODE XREF: __expandlocale+118↑j
                mov     eax, dword_70D570
                lea     ecx, [esp+90h+String1]
                and     eax, 0FFFFh
                push    ecx
                push    offset unk_6415C8
                mov     dword_70D574, eax
                call    ___lc_lctostr
                mov     al, [edi]
                add     esp, 8
                test    al, al
                jz      short loc_5CB667
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     edx, ecx
                mov     esi, edi
                mov     edi, offset unk_641540
                shr     ecx, 2
                rep movsd
                mov     ecx, edx
                jmp     short loc_5CB687
; ---------------------------------------------------------------------------

loc_5CB667:                             ; CODE XREF: __expandlocale+148↑j
                mov     edi, offset unk_6415C8
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     eax, ecx
                mov     esi, edi
                mov     edi, offset unk_641540
                shr     ecx, 2
                rep movsd
                mov     ecx, eax

loc_5CB687:                             ; CODE XREF: __expandlocale+165↑j
                and     ecx, 3
                rep movsb

loc_5CB68C:                             ; CODE XREF: __expandlocale+A4↑j
                mov     eax, dword ptr [esp+90h+arg_8]
                test    eax, eax
                jz      short loc_5CB6AA
                mov     ecx, dword_70D56C
                mov     [eax], ecx
                mov     dx, word ptr dword_70D570
                mov     [eax+4], dx

loc_5CB6AA:                             ; CODE XREF: __expandlocale+195↑j
                mov     eax, dword ptr [esp+90h+arg_C]
                test    eax, eax
                jz      short loc_5CB6BD
                mov     ecx, dword_70D574
                mov     [eax], ecx

loc_5CB6BD:                             ; CODE XREF: __expandlocale+1B3↑j
                mov     edi, offset unk_6415C8
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     eax, offset unk_6415C8
                mov     edx, ecx
                mov     esi, edi
                mov     edi, [esp+90h+arg_4]
                shr     ecx, 2
                rep movsd
                mov     ecx, edx
                and     ecx, 3
                rep movsb

loc_5CB6E9:                             ; CODE XREF: __expandlocale+5D↑j
                pop     edi
                pop     esi
                add     esp, 88h
                retn
__expandlocale  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_5CB700      proc near               ; CODE XREF: __setlocale_set_cat:loc_5CB36D↑p
                xor     eax, eax
                retn
sub_5CB700      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__strcats       proc near               ; CODE XREF: __setlocale_get_all+46↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = byte ptr  0Ch

                push    ebx
                mov     ebx, dword ptr [esp+4+arg_4]
                test    ebx, ebx
                lea     edx, [esp+4+arg_8]
                jle     short loc_5CB752
                push    edi
                push    esi
                push    ebp

loc_5CB720:                             ; CODE XREF: __strcats+3D↓j
                mov     edi, [edx]
                add     edx, 4
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     edi, [esp+10h+arg_0]
                mov     ebp, ecx
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     ecx, ebp
                dec     edi
                shr     ecx, 2
                rep movsd
                mov     ecx, ebp
                and     ecx, 3
                dec     ebx
                rep movsb
                jnz     short loc_5CB720
                pop     ebp
                pop     esi
                pop     edi

loc_5CB752:                             ; CODE XREF: __strcats+B↑j
                pop     ebx
                retn
__strcats       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __lc_strtolc(int, char *Source)
___lc_strtolc   proc near               ; CODE XREF: __expandlocale+E8↑p

arg_0           = dword ptr  4
Source          = dword ptr  8

                mov     edx, dword ptr [esp+arg_0]
                push    ebx
                push    ebp
                push    esi
                push    edi
                mov     ebp, [esp+10h+Source]
                mov     ecx, 21h ; '!'
                xor     eax, eax
                mov     edi, edx
                rep stosd
                stosb
                mov     al, [ebp+0]
                test    al, al
                jnz     short loc_5CB786
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CB786:                             ; CODE XREF: ___lc_strtolc+1D↑j
                cmp     al, 2Eh ; '.'
                jnz     short loc_5CB7BE
                mov     al, [ebp+1]
                lea     edi, [ebp+1]
                test    al, al
                jz      short loc_5CB7BE
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                add     edx, 80h
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     eax, ecx
                mov     esi, edi
                mov     edi, edx
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                and     ecx, 3
                xor     eax, eax
                rep movsb
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CB7BE:                             ; CODE XREF: ___lc_strtolc+28↑j
                push    offset asc_6147AC ; "_.,"
                push    ebp             ; varStr
                xor     edi, edi
                call    _strcspn
                mov     esi, eax
                add     esp, 8
                test    esi, esi
                jz      loc_5CB860

loc_5CB7D8:                             ; CODE XREF: ___lc_strtolc+EF↓j
                mov     bl, [esi+ebp]
                test    edi, edi
                jnz     short loc_5CB7F2
                cmp     esi, 40h ; '@'
                jge     short loc_5CB7F2
                cmp     bl, 2Eh ; '.'
                jz      short loc_5CB7F2
                mov     ecx, dword ptr [esp+10h+arg_0]
                push    esi
                push    ebp
                push    ecx
                jmp     short loc_5CB827
; ---------------------------------------------------------------------------

loc_5CB7F2:                             ; CODE XREF: ___lc_strtolc+7D↑j
                cmp     edi, 1
                jnz     short loc_5CB80D
                cmp     esi, 40h ; '@'
                jge     short loc_5CB80D
                cmp     bl, 5Fh ; '_'
                jz      short loc_5CB80D
                mov     edx, dword ptr [esp+10h+arg_0]
                push    esi
                add     edx, 40h ; '@'
                push    ebp
                push    edx
                jmp     short loc_5CB827
; ---------------------------------------------------------------------------

loc_5CB80D:                             ; CODE XREF: ___lc_strtolc+95↑j
                cmp     edi, 2
                jnz     short loc_5CB860
                test    bl, bl
                jz      short loc_5CB81B
                cmp     bl, 2Ch ; ','
                jnz     short loc_5CB860

loc_5CB81B:                             ; CODE XREF: ___lc_strtolc+B4↑j
                mov     eax, dword ptr [esp+10h+arg_0]
                push    esi             ; Count
                add     eax, 80h
                push    ebp             ; Source
                push    eax             ; Destination

loc_5CB827:                             ; CODE XREF: ___lc_strtolc+90↑j
                call    _strncpy
                add     esp, 0Ch
                cmp     bl, 2Ch ; ','
                jz      short loc_5CB859
                test    bl, bl
                jz      short loc_5CB859
                lea     ebp, [esi+ebp+1]
                push    offset asc_6147AC ; "_.,"
                push    ebp             ; varStr
                inc     edi
                call    _strcspn
                mov     esi, eax
                add     esp, 8
                test    esi, esi
                jnz     short loc_5CB7D8
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CB859:                             ; CODE XREF: ___lc_strtolc+D2↑j
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CB860:                             ; CODE XREF: ___lc_strtolc+72↑j
                pop     edi
                pop     esi
                pop     ebp
                or      eax, 0FFFFFFFFh
                pop     ebx
                retn
___lc_strtolc   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___lc_lctostr   proc near               ; CODE XREF: __expandlocale+13C↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                push    ebx
                mov     ebx, dword ptr [esp+4+arg_4]
                push    ebp
                push    esi
                push    edi
                mov     edi, ebx
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                mov     ebp, [esp+10h+arg_0]
                not     ecx
                sub     edi, ecx
                mov     eax, ecx
                mov     esi, edi
                mov     edi, ebp
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                lea     eax, [ebx+40h]
                and     ecx, 3
                rep movsb
                cmp     byte ptr [eax], 0
                jz      short loc_5CB8B4
                push    eax
                push    offset unk_6147B4
                push    2
                push    ebp
                call    __strcats
                add     esp, 10h

loc_5CB8B4:                             ; CODE XREF: ___lc_lctostr+31↑j
                mov     cl, [ebx+80h]
                lea     eax, [ebx+80h]
                test    cl, cl
                jz      short loc_5CB8D5
                push    eax
                push    offset word_6147B0
                push    2
                push    ebp
                call    __strcats
                add     esp, 10h

loc_5CB8D5:                             ; CODE XREF: ___lc_lctostr+52↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
___lc_lctostr   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _powhlp(double, double X, int)
__powhlp        proc near               ; CODE XREF: _pow+11C↑p

arg_0           = qword ptr  4
X               = qword ptr  0Ch
arg_10          = dword ptr  14h

                fld     [esp+arg_0]
                fcomp   qword ptr [dbl_6147B8]
                mov     edx, dword ptr [esp+arg_0+4]
                push    esi
                mov     esi, dword ptr [esp+4+arg_0]
                push    edi
                xor     edi, edi
                fnstsw  ax
                test    ah, 1
                jz      short loc_5CB909
                fld     [esp+8+arg_0]
                fchs
                fstp    [esp+8+arg_0]
                jmp     short loc_5CB911
; ---------------------------------------------------------------------------

loc_5CB909:                             ; CODE XREF: __powhlp+1B↑j
                mov     dword ptr [esp+8+arg_0], esi
                mov     dword ptr [esp+8+arg_0+4], edx

loc_5CB911:                             ; CODE XREF: __powhlp+27↑j
                mov     eax, dword ptr [esp+8+X+4]
                mov     ecx, dword ptr [esp+8+X]
                cmp     eax, 7FF00000h
                jnz     short loc_5CB96E
                cmp     ecx, edi
                jnz     short loc_5CB96E
                fld     [esp+8+arg_0]
                fcomp   qword ptr [dbl_6147C0]
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5CB94F
                mov     eax, dword ptr [esp+8+arg_10]
                mov     ecx, dword ptr g_Number
                mov     [eax], ecx
                mov     edx, dword ptr g_Number+4
                mov     [eax+4], edx
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CB94F:                             ; CODE XREF: __powhlp+53↑j
                fld     [esp+8+arg_0]
                fcomp   qword ptr [dbl_6147C0]
                fnstsw  ax
                test    ah, 1
                jz      short loc_5CB9C3
                mov     eax, dword ptr [esp+8+arg_10]
                mov     [eax], edi
                mov     [eax+4], edi
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CB96E:                             ; CODE XREF: __powhlp+3E↑j
                cmp     eax, 0FFF00000h
                jnz     short loc_5CB9E2
                cmp     ecx, edi
                jnz     short loc_5CB9E2
                fld     [esp+8+arg_0]
                fcomp   qword ptr [dbl_6147C0]
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5CB998
                mov     eax, dword ptr [esp+8+arg_10]
                mov     [eax], edi
                mov     [eax+4], edi
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CB998:                             ; CODE XREF: __powhlp+A8↑j
                fld     [esp+8+arg_0]
                fcomp   qword ptr [dbl_6147C0]
                fnstsw  ax
                test    ah, 1
                jz      short loc_5CB9C3
                mov     eax, dword ptr [esp+8+arg_10]
                mov     ecx, dword ptr g_Number
                mov     [eax], ecx
                mov     edx, dword ptr g_Number+4
                mov     [eax+4], edx
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CB9C3:                             ; CODE XREF: __powhlp+7E↑j
                mov     eax, dword ptr [esp+8+arg_10]
                mov     ecx, dword_641810
                mov     edi, 1
                mov     [eax], ecx
                mov     edx, dword_641814
                mov     [eax+4], edx
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CB9E2:                             ; CODE XREF: __powhlp+93↑j
                cmp     edx, 7FF00000h
                jnz     short loc_5CBA3C
                cmp     esi, edi
                jnz     short loc_5CBA3C
                fld     [esp+8+X]
                fcomp   qword ptr [dbl_6147B8]
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5CBA19
                mov     eax, dword ptr [esp+8+arg_10]
                mov     ecx, dword ptr g_Number
                mov     [eax], ecx
                mov     edx, dword ptr g_Number+4
                mov     [eax+4], edx
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CBA19:                             ; CODE XREF: __powhlp+11D↑j
                fld     [esp+8+X]
                fcomp   qword ptr [dbl_6147B8]
                fnstsw  ax
                test    ah, 1
                mov     eax, dword ptr [esp+8+arg_10]
                mov     [eax], edi
                jz      loc_5CBAF5
                mov     [eax+4], edi
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CBA3C:                             ; CODE XREF: __powhlp+108↑j
                cmp     edx, 0FFF00000h
                jnz     loc_5CBAFC
                cmp     esi, edi
                jnz     loc_5CBAFC
                push    eax
                push    ecx             ; X
                call    __d_inttype
                fld     [esp+10h+X]
                fcomp   qword ptr [dbl_6147B8]
                mov     ecx, eax
                add     esp, 8
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5CBAAE
                cmp     ecx, 1
                jnz     short loc_5CBA94
                fld     qword ptr [g_Number]
                mov     eax, dword ptr [esp+8+arg_10]
                fchs
                fstp    [esp+8+X]
                mov     ecx, dword ptr [esp+8+X]
                mov     edx, dword ptr [esp+8+X+4]
                mov     [eax], ecx
                mov     [eax+4], edx
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CBA94:                             ; CODE XREF: __powhlp+190↑j
                mov     eax, dword ptr [esp+8+arg_10]
                mov     ecx, dword ptr g_Number
                mov     edx, dword ptr g_Number+4
                mov     [eax], ecx
                mov     [eax+4], edx
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CBAAE:                             ; CODE XREF: __powhlp+18B↑j
                fld     [esp+8+X]
                fcomp   qword ptr [dbl_6147B8]
                fnstsw  ax
                test    ah, 1
                jz      short loc_5CBAEF
                cmp     ecx, 1
                jnz     short loc_5CBADD
                mov     edx, dword ptr [esp+8+arg_10]
                mov     eax, dword_641828
                mov     ecx, dword_64182C
                mov     [edx], eax
                mov     [edx+4], ecx
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CBADD:                             ; CODE XREF: __powhlp+1E2↑j
                mov     edx, dword ptr [esp+8+arg_10]
                xor     eax, eax
                xor     ecx, ecx
                mov     [edx], eax
                mov     [edx+4], ecx
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CBAEF:                             ; CODE XREF: __powhlp+1DD↑j
                mov     eax, dword ptr [esp+8+arg_10]
                mov     [eax], edi

loc_5CBAF5:                             ; CODE XREF: __powhlp+14E↑j
                mov     dword ptr [eax+4], 3FF00000h

loc_5CBAFC:                             ; CODE XREF: __powhlp+162↑j
                mov     eax, edi
                pop     edi
                pop     esi
                retn
__powhlp        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _d_inttype(double X)
__d_inttype     proc near               ; CODE XREF: __powhlp+172↑p

var_8           = qword ptr -8
X               = qword ptr  4

                sub     esp, 8
                push    esi
                mov     esi, dword ptr [esp+0Ch+X+4]
                push    edi
                mov     edi, dword ptr [esp+10h+X]
                push    esi
                push    edi             ; X
                call    __fpclass
                add     esp, 8
                test    al, 90h
                jnz     short loc_5CBB89
                push    esi
                push    edi             ; double
                call    __frnd
                fstp    [esp+18h+var_8]
                fld     [esp+18h+var_8]
                fcomp   [esp+18h+X]
                add     esp, 8
                fnstsw  ax
                test    ah, 40h
                jz      short loc_5CBB89
                fld     [esp+10h+X]
                fdiv    qword ptr [dbl_6147C8]
                fstp    [esp+10h+X]
                mov     eax, dword ptr [esp+10h+X+4]
                mov     ecx, dword ptr [esp+10h+X]
                push    eax
                push    ecx             ; double
                call    __frnd
                fcomp   [esp+18h+X]
                add     esp, 8
                fnstsw  ax
                test    ah, 40h
                jz      short loc_5CBB7E
                mov     eax, 2
                pop     edi
                pop     esi
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5CBB7E:                             ; CODE XREF: __d_inttype+61↑j
                mov     eax, 1
                pop     edi
                pop     esi
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5CBB89:                             ; CODE XREF: __d_inttype+19↑j
                pop     edi
                xor     eax, eax
                pop     esi
                add     esp, 8
                retn
__d_inttype     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __crtLCMapStringW(LCID Locale, DWORD dwMapFlags, LPCWSTR lpSrcStr, char *Source, LPWSTR lpDestStr, int cchDest, UINT CodePage)
___crtLCMapStringW proc near            ; CODE XREF: _towupper_0+65↓p

Locale          = dword ptr  4
dwMapFlags      = dword ptr  8
lpSrcStr        = dword ptr  0Ch
Source          = dword ptr  10h
lpDestStr       = dword ptr  14h
cchDest         = dword ptr  18h
CodePage        = dword ptr  1Ch

                mov     eax, dword_70D578
                push    ebx
                mov     ebx, ds:LCMapStringW
                push    ebp
                push    esi
                push    edi
                test    eax, eax
                jnz     short loc_5CBBFC
                push    0               ; cchDest
                push    0               ; lpDestStr
                push    1               ; cchSrc
                push    offset aString1  ; lpSrcStr
                push    100h            ; dwMapFlags
                push    0               ; Locale
                call    ebx ; LCMapStringW
                test    eax, eax
                jz      short loc_5CBBD2
                mov     eax, 1
                jmp     short loc_5CBBF7
; ---------------------------------------------------------------------------

loc_5CBBD2:                             ; CODE XREF: ___crtLCMapStringW+29↑j
                push    0               ; cchDest
                push    0               ; lpDestStr
                push    1               ; cchSrc
                push    offset aString2  ; lpSrcStr
                push    100h            ; dwMapFlags
                push    0               ; Locale
                call    LCMapStringA
                test    eax, eax
                jz      loc_5CBDA0
                mov     eax, 2

loc_5CBBF7:                             ; CODE XREF: ___crtLCMapStringW+30↑j
                mov     dword_70D578, eax

loc_5CBBFC:                             ; CODE XREF: ___crtLCMapStringW+11↑j
                mov     esi, [esp+10h+Source]
                test    esi, esi
                jle     short loc_5CBC1B
                mov     edi, [esp+10h+lpSrcStr]
                push    esi
                push    edi
                call    _wcsncnt
                mov     esi, eax
                mov     eax, dword_70D578
                add     esp, 8
                jmp     short loc_5CBC1F
; ---------------------------------------------------------------------------

loc_5CBC1B:                             ; CODE XREF: ___crtLCMapStringW+62↑j
                mov     edi, [esp+10h+lpSrcStr]

loc_5CBC1F:                             ; CODE XREF: ___crtLCMapStringW+79↑j
                cmp     eax, 1
                jnz     short loc_5CBC41
                mov     eax, dword ptr [esp+10h+cchDest]
                mov     ecx, dword ptr [esp+10h+lpDestStr]
                mov     edx, dword ptr [esp+10h+dwMapFlags]
                push    eax             ; cchDest
                mov     eax, dword ptr [esp+14h+Locale]
                push    ecx             ; lpDestStr
                push    esi             ; cchSrc
                push    edi             ; lpSrcStr
                push    edx             ; dwMapFlags
                push    eax             ; Locale
                call    ebx ; LCMapStringW
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CBC41:                             ; CODE XREF: ___crtLCMapStringW+82↑j
                cmp     eax, 2
                jnz     loc_5CBD49
                mov     ebx, dword ptr [esp+10h+CodePage]
                mov     [esp+10h+Source], 0
                test    ebx, ebx
                jnz     short loc_5CBC60
                mov     ebx, CodePage

loc_5CBC60:                             ; CODE XREF: ___crtLCMapStringW+B8↑j
                push    0               ; lpUsedDefaultChar
                push    0               ; lpDefaultChar
                push    0               ; cbMultiByte
                push    0               ; lpMultiByteStr
                push    esi             ; cchWideChar
                push    edi             ; lpWideCharStr
                push    220h            ; dwFlags
                push    ebx             ; CodePage
                call    WideCharToMultiByte
                mov     edi, eax
                test    edi, edi
                jnz     short loc_5CBC81
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CBC81:                             ; CODE XREF: ___crtLCMapStringW+DA↑j
                push    edi             ; varSize
                call    _malloc
                mov     ebp, eax
                add     esp, 4
                test    ebp, ebp
                jnz     short loc_5CBC95
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CBC95:                             ; CODE XREF: ___crtLCMapStringW+EE↑j
                mov     ecx, dword ptr [esp+10h+lpSrcStr]
                push    0               ; lpUsedDefaultChar
                push    0               ; lpDefaultChar
                push    edi             ; cbMultiByte
                push    ebp             ; lpMultiByteStr
                push    esi             ; cchWideChar
                push    ecx             ; lpWideCharStr
                push    220h            ; dwFlags
                push    ebx             ; CodePage
                call    WideCharToMultiByte
                test    eax, eax
                jz      loc_5CBD8A
                mov     edx, dword ptr [esp+10h+dwMapFlags]
                mov     eax, dword ptr [esp+10h+Locale]
                push    0               ; cchDest
                push    0               ; lpDestStr
                push    edi             ; cchSrc
                push    ebp             ; lpSrcStr
                push    edx             ; dwMapFlags
                push    eax             ; Locale
                call    LCMapStringA
                mov     esi, eax
                test    esi, esi
                jz      loc_5CBD8A
                push    esi             ; varSize
                call    _malloc
                add     esp, 4
                mov     [esp+10h+Source], eax
                test    eax, eax
                jz      loc_5CBD8A
                mov     ecx, dword ptr [esp+10h+Locale]
                push    esi             ; cchDest
                push    eax             ; lpDestStr
                push    edi             ; cchSrc
                mov     edi, [esp+1Ch+dwMapFlags]
                push    ebp             ; lpSrcStr
                push    edi             ; dwMapFlags
                push    ecx             ; Locale
                call    LCMapStringA
                test    eax, eax
                jz      loc_5CBD8A
                test    edi, 400h
                jz      short loc_5CBD4E
                mov     eax, dword ptr [esp+10h+cchDest]
                mov     edi, esi
                test    eax, eax
                jz      short loc_5CBD31
                cmp     eax, esi
                jl      short loc_5CBD1E
                mov     eax, esi

loc_5CBD1E:                             ; CODE XREF: ___crtLCMapStringW+17A↑j
                mov     edx, dword ptr [esp+10h+Source]
                push    eax             ; Count
                mov     eax, dword ptr [esp+14h+lpDestStr]
                push    edx             ; Source
                push    eax             ; Destination
                call    _strncpy
                add     esp, 0Ch

loc_5CBD31:                             ; CODE XREF: ___crtLCMapStringW+176↑j
                push    ebp             ; Block
                call    _free
                mov     edx, dword ptr [esp+14h+Source]
                add     esp, 4
                push    edx             ; Block
                call    _free
                add     esp, 4
                mov     eax, edi

loc_5CBD49:                             ; CODE XREF: ___crtLCMapStringW+A4↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CBD4E:                             ; CODE XREF: ___crtLCMapStringW+16C↑j
                mov     eax, dword ptr [esp+10h+cchDest]
                test    eax, eax
                jnz     short loc_5CBD6F
                mov     ecx, dword ptr [esp+10h+Source]
                push    eax             ; cchWideChar
                push    eax             ; lpWideCharStr
                push    esi             ; cbMultiByte
                push    ecx             ; lpMultiByteStr
                push    1               ; dwFlags
                push    ebx             ; CodePage
                call    MultiByteToWideChar
                mov     edi, eax
                test    edi, edi
                jz      short loc_5CBD8A
                jmp     short loc_5CBD31
; ---------------------------------------------------------------------------

loc_5CBD6F:                             ; CODE XREF: ___crtLCMapStringW+1B4↑j
                mov     edx, dword ptr [esp+10h+lpDestStr]
                push    eax             ; cchWideChar
                mov     eax, dword ptr [esp+14h+Source]
                push    edx             ; lpWideCharStr
                push    esi             ; cbMultiByte
                push    eax             ; lpMultiByteStr
                push    1               ; dwFlags
                push    ebx             ; CodePage
                call    MultiByteToWideChar
                mov     edi, eax
                test    edi, edi
                jnz     short loc_5CBD31

loc_5CBD8A:                             ; CODE XREF: ___crtLCMapStringW+10F↑j
                push    ebp             ; Block
                call    _free
                mov     ecx, dword ptr [esp+14h+Source]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                add     esp, 4

loc_5CBDA0:                             ; CODE XREF: ___crtLCMapStringW+4C↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                retn
___crtLCMapStringW endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_wcsncnt        proc near               ; CODE XREF: ___crtLCMapStringW+6A↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     edx, dword ptr [esp+arg_4]
                push    esi
                mov     esi, [esp+4+arg_0]
                push    edi
                test    edx, edx
                mov     eax, esi
                lea     ecx, [edx-1]
                jz      short loc_5CBDD3

loc_5CBDC3:                             ; CODE XREF: _wcsncnt+21↓j
                cmp     word ptr [eax], 0
                jz      short loc_5CBDD9
                add     eax, 2
                mov     edi, ecx
                dec     ecx
                test    edi, edi
                jnz     short loc_5CBDC3

loc_5CBDD3:                             ; CODE XREF: _wcsncnt+11↑j
                cmp     word ptr [eax], 0
                jnz     short loc_5CBDE0

loc_5CBDD9:                             ; CODE XREF: _wcsncnt+17↑j
                sub     eax, esi
                sar     eax, 1
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CBDE0:                             ; CODE XREF: _wcsncnt+27↑j
                pop     edi
                mov     eax, edx
                pop     esi
                retn
_wcsncnt        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __crtLCMapStringA(LCID Locale, DWORD dwMapFlags, LPCSTR lpSrcStr, LPCWCH lpWideCharStr, LPSTR lpDestStr, int cchDest, UINT CodePage)
___crtLCMapStringA proc near            ; CODE XREF: _tolower_0+B9↑p

Locale          = dword ptr  4
dwMapFlags      = dword ptr  8
lpSrcStr        = dword ptr  0Ch
lpWideCharStr   = dword ptr  10h
lpDestStr       = dword ptr  14h
cchDest         = dword ptr  18h
CodePage        = dword ptr  1Ch

                mov     eax, dword_70D57C
                push    ebx
                mov     ebx, ds:LCMapStringA
                push    ebp
                push    esi
                push    edi
                test    eax, eax
                jnz     short loc_5CBE4C
                push    0               ; cchDest
                push    0               ; lpDestStr
                push    1               ; cchSrc
                push    offset aString2  ; lpSrcStr
                push    100h            ; dwMapFlags
                push    0               ; Locale
                call    ebx ; LCMapStringA
                test    eax, eax
                jz      short loc_5CBE22
                mov     eax, 2
                jmp     short loc_5CBE47
; ---------------------------------------------------------------------------

loc_5CBE22:                             ; CODE XREF: ___crtLCMapStringA+29↑j
                push    0               ; cchDest
                push    0               ; lpDestStr
                push    1               ; cchSrc
                push    offset aString1  ; lpSrcStr
                push    100h            ; dwMapFlags
                push    0               ; Locale
                call    LCMapStringW
                test    eax, eax
                jz      loc_5CC005
                mov     eax, 1

loc_5CBE47:                             ; CODE XREF: ___crtLCMapStringA+30↑j
                mov     dword_70D57C, eax

loc_5CBE4C:                             ; CODE XREF: ___crtLCMapStringA+11↑j
                mov     esi, [esp+10h+lpWideCharStr]
                test    esi, esi
                jle     short loc_5CBE6B
                mov     edi, [esp+10h+lpSrcStr]
                push    esi
                push    edi
                call    _strncnt
                mov     esi, eax
                mov     eax, dword_70D57C
                add     esp, 8
                jmp     short loc_5CBE6F
; ---------------------------------------------------------------------------

loc_5CBE6B:                             ; CODE XREF: ___crtLCMapStringA+62↑j
                mov     edi, [esp+10h+lpSrcStr]

loc_5CBE6F:                             ; CODE XREF: ___crtLCMapStringA+79↑j
                cmp     eax, 2
                jnz     short loc_5CBE91
                mov     eax, dword ptr [esp+10h+cchDest]
                mov     ecx, dword ptr [esp+10h+lpDestStr]
                mov     edx, dword ptr [esp+10h+dwMapFlags]
                push    eax             ; cchDest
                mov     eax, dword ptr [esp+14h+Locale]
                push    ecx             ; lpDestStr
                push    esi             ; cchSrc
                push    edi             ; lpSrcStr
                push    edx             ; dwMapFlags
                push    eax             ; Locale
                call    ebx ; LCMapStringA
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CBE91:                             ; CODE XREF: ___crtLCMapStringA+82↑j
                cmp     eax, 1
                jnz     loc_5CBF6C
                mov     ebp, [esp+10h+CodePage]
                mov     [esp+10h+lpWideCharStr], 0
                test    ebp, ebp
                jnz     short loc_5CBEB6
                mov     ecx, CodePage
                mov     [esp+10h+CodePage], ecx
                mov     ebp, ecx

loc_5CBEB6:                             ; CODE XREF: ___crtLCMapStringA+B8↑j
                push    0               ; cchWideChar
                push    0               ; lpWideCharStr
                push    esi             ; cbMultiByte
                push    edi             ; lpMultiByteStr
                push    9               ; dwFlags
                push    ebp             ; CodePage
                call    MultiByteToWideChar
                mov     edi, eax
                test    edi, edi
                jnz     short loc_5CBED0
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CBED0:                             ; CODE XREF: ___crtLCMapStringA+D9↑j
                lea     edx, [edi+edi]
                push    edx             ; varSize
                call    _malloc
                mov     ebx, eax
                add     esp, 4
                test    ebx, ebx
                jnz     short loc_5CBEE7
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CBEE7:                             ; CODE XREF: ___crtLCMapStringA+F0↑j
                mov     eax, dword ptr [esp+10h+lpSrcStr]
                push    edi             ; cchWideChar
                push    ebx             ; lpWideCharStr
                push    esi             ; cbMultiByte
                push    eax             ; lpMultiByteStr
                push    1               ; dwFlags
                push    ebp             ; CodePage
                call    MultiByteToWideChar
                test    eax, eax
                jz      loc_5CBFEF
                mov     ebp, [esp+10h+dwMapFlags]
                mov     ecx, dword ptr [esp+10h+Locale]
                push    0               ; cchDest
                push    0               ; lpDestStr
                push    edi             ; cchSrc
                push    ebx             ; lpSrcStr
                push    ebp             ; dwMapFlags
                push    ecx             ; Locale
                call    LCMapStringW
                mov     esi, eax
                test    esi, esi
                jz      loc_5CBFEF
                test    ebp, 400h
                jz      short loc_5CBF71
                mov     eax, dword ptr [esp+10h+cchDest]
                test    eax, eax
                jz      short loc_5CBF54
                cmp     esi, eax
                jg      loc_5CBFEF
                mov     edx, dword ptr [esp+10h+lpDestStr]
                push    eax             ; cchDest
                mov     eax, dword ptr [esp+14h+Locale]
                push    edx             ; lpDestStr
                push    edi             ; cchSrc
                push    ebx             ; lpSrcStr
                push    ebp             ; dwMapFlags
                push    eax             ; Locale
                call    LCMapStringW
                test    eax, eax
                jz      loc_5CBFEF

loc_5CBF54:                             ; CODE XREF: ___crtLCMapStringA+13E↑j
                push    ebx             ; Block
                call    _free
                mov     ecx, dword ptr [esp+14h+lpWideCharStr]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                add     esp, 4
                mov     eax, esi

loc_5CBF6C:                             ; CODE XREF: ___crtLCMapStringA+A4↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CBF71:                             ; CODE XREF: ___crtLCMapStringA+136↑j
                lea     ecx, [esi+esi]
                push    ecx             ; varSize
                call    _malloc
                add     esp, 4
                mov     [esp+10h+lpWideCharStr], eax
                test    eax, eax
                jz      short loc_5CBFEF
                mov     edx, eax
                mov     eax, dword ptr [esp+10h+Locale]
                push    esi             ; cchDest
                push    edx             ; lpDestStr
                push    edi             ; cchSrc
                push    ebx             ; lpSrcStr
                push    ebp             ; dwMapFlags
                push    eax             ; Locale
                call    LCMapStringW
                test    eax, eax
                jz      short loc_5CBFEF
                mov     eax, dword ptr [esp+10h+cchDest]
                push    0               ; lpUsedDefaultChar
                test    eax, eax
                push    0               ; lpDefaultChar
                jnz     short loc_5CBFC9
                mov     ecx, dword ptr [esp+18h+lpWideCharStr]
                mov     edx, dword ptr [esp+18h+CodePage]
                push    0               ; cbMultiByte
                push    0               ; lpMultiByteStr
                push    esi             ; cchWideChar
                push    ecx             ; lpWideCharStr
                push    220h            ; dwFlags
                push    edx             ; CodePage
                call    WideCharToMultiByte
                mov     esi, eax
                test    esi, esi
                jz      short loc_5CBFEF
                jmp     short loc_5CBF54
; ---------------------------------------------------------------------------

loc_5CBFC9:                             ; CODE XREF: ___crtLCMapStringA+1B5↑j
                mov     ecx, dword ptr [esp+18h+lpWideCharStr]
                mov     edx, dword ptr [esp+18h+CodePage]
                push    eax             ; cbMultiByte
                mov     eax, dword ptr [esp+1Ch+lpDestStr]
                push    eax             ; lpMultiByteStr
                push    esi             ; cchWideChar
                push    ecx             ; lpWideCharStr
                push    220h            ; dwFlags
                push    edx             ; CodePage
                call    WideCharToMultiByte
                mov     esi, eax
                test    esi, esi
                jnz     loc_5CBF54

loc_5CBFEF:                             ; CODE XREF: ___crtLCMapStringA+10A↑j
                push    ebx             ; Block
                call    _free
                mov     eax, dword ptr [esp+14h+lpWideCharStr]
                add     esp, 4
                push    eax             ; Block
                call    _free
                add     esp, 4

loc_5CC005:                             ; CODE XREF: ___crtLCMapStringA+4C↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                retn
___crtLCMapStringA endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_strncnt        proc near               ; CODE XREF: ___crtLCMapStringA+6A↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     edx, dword ptr [esp+arg_4]
                push    esi
                mov     esi, [esp+4+arg_0]
                test    edx, edx
                push    edi
                mov     eax, esi
                lea     ecx, [edx-1]
                jz      short loc_5CC030

loc_5CC023:                             ; CODE XREF: _strncnt+1E↓j
                cmp     byte ptr [eax], 0
                jz      short loc_5CC030
                inc     eax
                mov     edi, ecx
                dec     ecx
                test    edi, edi
                jnz     short loc_5CC023

loc_5CC030:                             ; CODE XREF: _strncnt+11↑j
                cmp     byte ptr [eax], 0
                jnz     short loc_5CC03A
                sub     eax, esi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CC03A:                             ; CODE XREF: _strncnt+23↑j
                pop     edi
                pop     esi
                mov     eax, edx
                retn
_strncnt        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; LONG __stdcall __CxxUnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z proc near

ExceptionInfo   = dword ptr  4

                push    esi
                mov     esi, [esp+4+ExceptionInfo]
                mov     eax, dword ptr [esi]
                cmp     dword ptr [eax], 0E06D7363h
                jnz     short loc_5CC06C
                cmp     dword ptr [eax+10h], 3
                jnz     short loc_5CC06C
                cmp     dword ptr [eax+14h], 19930520h
                jnz     short loc_5CC06C
                call    ?terminate@@YAXXZ ; terminate(void)
; ---------------------------------------------------------------------------
                db 0B8h
                db    1
                db    0
                db    0
                db    0
                db  5Eh ; ^
                db 0C2h
                db    4
                db    0
; ---------------------------------------------------------------------------

loc_5CC06C:                             ; CODE XREF: __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)+D↑j
                mov     eax, [g_lpfn]
                test    eax, eax
                jz      short loc_5CC08D
                push    eax             ; lpfn
                call    ?_ValidateExecute@@YAHP6GHXZ@Z ; _ValidateExecute(int (*)(void))
                add     esp, 4
                test    eax, eax
                jz      short loc_5CC08D
                push    esi             ; ExceptionInfo
                call    [g_lpfn]
                pop     esi
                retn    4
; ---------------------------------------------------------------------------

loc_5CC08D:                             ; CODE XREF: __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)+33↑j
                xor     eax, eax
                pop     esi
                retn    4
?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void __cdecl __CxxSetUnhandledExceptionFilter()
?__CxxSetUnhandledExceptionFilter@@YAXXZ proc near
                push    offset ?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z ; lpTopLevelExceptionFilter
                call    SetUnhandledExceptionFilter
                mov     [g_lpfn], eax
                retn
?__CxxSetUnhandledExceptionFilter@@YAXXZ endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void __cdecl __CxxRestoreUnhandledExceptionFilter()
?__CxxRestoreUnhandledExceptionFilter@@YAXXZ proc near
                mov     eax, [g_lpfn]
                push    eax             ; lpTopLevelExceptionFilter
                call    SetUnhandledExceptionFilter
                retn
?__CxxRestoreUnhandledExceptionFilter@@YAXXZ endp

; ---------------------------------------------------------------------------
                align 10h



; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; BOOL __stdcall ctrlevent_capture(DWORD CtrlType)
_ctrlevent_capture@4 proc near          ; DATA XREF: _signal+108↑o

CtrlType        = dword ptr  4

                push    esi
                push    edi
                push    1
                call    __lock
                mov     eax, dword ptr [esp+0Ch+CtrlType]
                add     esp, 4
                test    eax, eax
                jnz     short loc_5CC326
                mov     esi, dword_70D584
                mov     eax, offset dword_70D584
                mov     edi, 2
                jmp     short loc_5CC336
; ---------------------------------------------------------------------------

loc_5CC326:                             ; CODE XREF: ctrlevent_capture(x)+12↑j
                mov     esi, dword_70D588
                mov     eax, offset dword_70D588
                mov     edi, 15h

loc_5CC336:                             ; CODE XREF: ctrlevent_capture(x)+24↑j
                test    esi, esi
                jnz     short loc_5CC34B
                push    1
                call    __unlock
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                retn    4
; ---------------------------------------------------------------------------

loc_5CC34B:                             ; CODE XREF: ctrlevent_capture(x)+38↑j
                cmp     esi, 1
                jz      short loc_5CC370
                push    1
                mov     dword ptr [eax], 0
                call    __unlock
                add     esp, 4
                push    edi
                call    esi ; dword_70D584
                add     esp, 4
                mov     eax, 1
                pop     edi
                pop     esi
                retn    4
; ---------------------------------------------------------------------------

loc_5CC370:                             ; CODE XREF: ctrlevent_capture(x)+4E↑j
                push    1
                call    __unlock
                add     esp, 4
                mov     eax, 1
                pop     edi
                pop     esi
                retn    4
_ctrlevent_capture@4 endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl raise(int Signal)
_raise          proc near               ; CODE XREF: _abort+C↑p

var_8           = dword ptr -8
var_4           = dword ptr -4
Signal          = dword ptr  4

                sub     esp, 8
                push    ebx
                push    ebp
                mov     ebp, [esp+10h+Signal]
                push    esi
                push    edi
                mov     [esp+18h+var_8], 0
                lea     eax, [ebp-2]    ; switch 21 cases
                cmp     eax, 14h
                ja      def_5CC3B7      ; jumptable 005CC3B7 default case, cases 3,5-7,9,10,12-14,16-20
                xor     ecx, ecx
                mov     cl, ds:byte_5CC588[eax]
                jmp     ds:jpt_5CC3B7[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5CC3BE:                             ; CODE XREF: _raise+27↑j
                mov     ebx, dword_70D584 ; jumptable 005CC3B7 case 2
                mov     esi, [esp+18h+Signal]
                mov     edi, offset dword_70D584
                mov     [esp+18h+var_8], 1
                jmp     short loc_5CC43D
; ---------------------------------------------------------------------------

loc_5CC3D7:                             ; CODE XREF: _raise+27↑j
                mov     ebx, dword_70D588 ; jumptable 005CC3B7 case 21
                mov     esi, [esp+18h+Signal]
                mov     edi, offset dword_70D588
                mov     [esp+18h+var_8], 1
                jmp     short loc_5CC43D
; ---------------------------------------------------------------------------

loc_5CC3F0:                             ; CODE XREF: _raise+27↑j
                mov     ebx, dword_70D58C ; jumptable 005CC3B7 case 22
                mov     esi, [esp+18h+Signal]
                mov     edi, offset dword_70D58C
                mov     [esp+18h+var_8], 1
                jmp     short loc_5CC43D
; ---------------------------------------------------------------------------

loc_5CC409:                             ; CODE XREF: _raise+27↑j
                mov     ebx, dword_70D590 ; jumptable 005CC3B7 case 15
                mov     esi, [esp+18h+Signal]
                mov     edi, offset dword_70D590
                mov     [esp+18h+var_8], 1
                jmp     short loc_5CC43D
; ---------------------------------------------------------------------------

loc_5CC422:                             ; CODE XREF: _raise+27↑j
                call    __getptd        ; jumptable 005CC3B7 cases 4,8,11
                mov     esi, eax
                mov     edx, dword ptr [esi+50h]
                push    edx
                push    ebp
                call    _siglookup
                mov     edi, eax
                add     esp, 8
                add     edi, 8
                mov     ebx, dword ptr [edi]

loc_5CC43D:                             ; CODE XREF: _raise+45↑j
                mov     eax, dword ptr [esp+18h+var_8]
                test    eax, eax
                jz      short loc_5CC44F
                push    1
                call    __lock
                add     esp, 4

loc_5CC44F:                             ; CODE XREF: _raise+B3↑j
                cmp     ebx, 1
                jnz     short loc_5CC473
                mov     eax, dword ptr [esp+18h+var_8]
                test    eax, eax
                jz      loc_5CC553
                push    ebx
                call    __unlock
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5CC473:                             ; CODE XREF: _raise+C2↑j
                test    ebx, ebx
                jnz     short loc_5CC493
                mov     eax, dword ptr [esp+18h+var_8]
                test    eax, eax
                jz      short loc_5CC489
                push    1
                call    __unlock
                add     esp, 4

loc_5CC489:                             ; CODE XREF: _raise+ED↑j
                push    3               ; Code
                call    __exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5CC493:                             ; CODE XREF: _raise+E5↑j
                cmp     ebp, 8
                jz      short loc_5CC4A2
                cmp     ebp, 0Bh
                jz      short loc_5CC4A2
                cmp     ebp, 4
                jnz     short loc_5CC4C3

loc_5CC4A2:                             ; CODE XREF: _raise+106↑j
                mov     eax, dword ptr [esi+54h]
                cmp     ebp, 8
                mov     [esp+18h+Signal], eax
                mov     dword ptr [esi+54h], 0
                jnz     short loc_5CC502
                mov     ecx, dword ptr [esi+58h]
                mov     dword ptr [esi+58h], 8Ch
                mov     [esp+18h+var_4], ecx

loc_5CC4C3:                             ; CODE XREF: _raise+110↑j
                cmp     ebp, 8
                jnz     short loc_5CC502
                mov     eax, dword_6418C8
                mov     edx, dword_6418CC
                add     edx, eax
                cmp     eax, edx
                jge     short loc_5CC508
                lea     ecx, [eax+eax*2]
                shl     ecx, 2

loc_5CC4DF:                             ; CODE XREF: _raise+16E↓j
                mov     edx, dword ptr [esi+50h]
                inc     eax
                mov     dword ptr [edx+ecx+8], 0
                mov     edx, dword_6418C8
                mov     edi, dword_6418CC
                add     ecx, 0Ch
                add     edi, edx
                cmp     eax, edi
                jl      short loc_5CC4DF
                jmp     short loc_5CC508
; ---------------------------------------------------------------------------

loc_5CC502:                             ; CODE XREF: _raise+123↑j
                mov     dword ptr [edi], 0

loc_5CC508:                             ; CODE XREF: _raise+147↑j
                mov     eax, dword ptr [esp+18h+var_8]
                test    eax, eax
                jz      short loc_5CC51A
                push    1
                call    __unlock
                add     esp, 4

loc_5CC51A:                             ; CODE XREF: _raise+17E↑j
                cmp     ebp, 8
                jnz     short loc_5CC52B
                mov     eax, dword ptr [esi+58h]
                push    eax
                push    ebp
                call    ebx ; dword_70D584
                add     esp, 8
                jmp     short loc_5CC531
; ---------------------------------------------------------------------------

loc_5CC52B:                             ; CODE XREF: _raise+18D↑j
                push    ebp
                call    ebx ; dword_70D584
                add     esp, 4

loc_5CC531:                             ; CODE XREF: _raise+199↑j
                cmp     ebp, 8
                jz      short loc_5CC540
                cmp     ebp, 0Bh
                jz      short loc_5CC540
                cmp     ebp, 4
                jnz     short loc_5CC553

loc_5CC540:                             ; CODE XREF: _raise+1A4↑j
                mov     ecx, dword ptr [esp+18h+Signal]
                cmp     ebp, 8
                mov     [esi+54h], ecx
                jnz     short loc_5CC553
                mov     edx, dword ptr [esp+18h+var_4]
                mov     [esi+58h], edx

loc_5CC553:                             ; CODE XREF: _raise+CA↑j
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

def_5CC3B7:                             ; CODE XREF: _raise+19↑j
                pop     edi             ; jumptable 005CC3B7 default case, cases 3,5-7,9,10,12-14,16-20
                pop     esi
                pop     ebp
                or      eax, 0FFFFFFFFh
                pop     ebx
                add     esp, 8
                retn
_raise          endp

; ---------------------------------------------------------------------------
jpt_5CC3B7      dd offset loc_5CC3BE    ; DATA XREF: _raise+27↑r
                dd offset loc_5CC422    ; jump table for switch statement
                dd offset loc_5CC422
                dd offset loc_5CC422
                dd offset loc_5CC409
                dd offset loc_5CC3D7
                dd offset loc_5CC3F0
                dd offset def_5CC3B7
byte_5CC588     db      0,     7,     1,     7 ; DATA XREF: _raise+21↑r
                db      7,     7,     2,     7 ; indirect table for switch statement
                db      7,     3,     7,     7
                db      7,     4,     7,     7
                db      7,     7,     7,     5
                db      6
                align 10h



; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int *__cdecl __fpecode()
___fpecode      proc near
                call    __getptd
                add     eax, 58h ; 'X'
                retn
___fpecode      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void **__cdecl __pxcptinfoptrs()
___pxcptinfoptrs proc near              ; CODE XREF: __fpreset+1↓p
                call    __getptd
                add     eax, 54h ; 'T'
                retn
___pxcptinfoptrs endp

; ---------------------------------------------------------------------------
                align 10h





; =============== S U B R O U T I N E =======================================

; Attributes: library function

__GET_RTERRMSG  proc near

arg_0           = dword ptr  4

                mov     edx, dword ptr [esp+arg_0]
                xor     ecx, ecx
                mov     eax, offset rterrs

loc_5CC82B:                             ; CODE XREF: __GET_RTERRMSG+18↓j
                cmp     edx, [eax]
                jz      short loc_5CC83A
                add     eax, 8
                inc     ecx
                cmp     eax, offset unk_6416E0
                jb      short loc_5CC82B

loc_5CC83A:                             ; CODE XREF: __GET_RTERRMSG+D↑j
                cmp     edx, rterrs[ecx*8]
                jnz     short loc_5CC84B
                mov     eax, lpBuffer[ecx*8]
                retn
; ---------------------------------------------------------------------------

loc_5CC84B:                             ; CODE XREF: __GET_RTERRMSG+21↑j
                xor     eax, eax
                retn
__GET_RTERRMSG  endp

; ---------------------------------------------------------------------------
                align 10h

fFASN:
                call    AugmentSinCos
                xchg    ch, cl
                jmp     short fFPATAN
; ---------------------------------------------------------------------------

fFACS:
                call    AugmentSinCos
                fxch    st(1)
                jmp     short fFPATAN
; ---------------------------------------------------------------------------

fFATN:
                fabs
                fld1
                mov     ch, cl
                xor     cl, cl
                jmp     short fFPATAN
; ---------------------------------------------------------------------------

__fFATN2:
                mov     byte ptr [ebp-90h], 0FEh
                fabs
                fxch    st(1)
                fabs
                fxch    st(1)

fFPATAN:                                ; CODE XREF: .text:005CC857↑j
                fpatan
                or      cl, cl
                jz      short PatanNumeratorTest
                fldpi
                fsubrp  st(1), st

PatanNumeratorTest:                     ; CODE XREF: .text:005CC87F↑j
                or      ch, ch
                jz      short PatanDone
                fchs

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

PatanDone       proc near               ; CODE XREF: .text:005CC887↑j
                retn
PatanDone       endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

AugmentSinCos   proc near               ; CODE XREF: .text:fFASN↑p

; FUNCTION CHUNK AT 005C84E6 SIZE 00000013 BYTES

                fabs
                fld     st
                fld     st
                fld1
                fsubrp  st(1), st
                fxch    st(1)
                fld1
                faddp   st(1), st
                fmulp   st(1), st
                ftst
                fstsw   word ptr [ebp-0A0h]
                wait
                test    byte ptr [ebp-9Fh], 1
                jnz     short DescriminantNeg
                xor     ch, ch
                fsqrt
                retn
; ---------------------------------------------------------------------------

DescriminantNeg:                        ; CODE XREF: AugmentSinCos+23↑j
                pop     eax
                jmp     __rtindfpop
AugmentSinCos   endp ; sp-analysis failed


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__rtpiby2       proc near
                fstp    st
                fld     tbyte_64123A
                retn
__rtpiby2       endp

; ---------------------------------------------------------------------------

_rtforatn20:
                fstp    st
                or      cl, cl
                jz      short zeronpop
                fstp    st
                fldpi
                or      ch, ch
                jz      short postv
                fchs

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

postv           proc near               ; CODE XREF: .text:005CC8D1↑j
                retn
postv           endp

; ---------------------------------------------------------------------------

zeronpop:                               ; CODE XREF: .text:005CC8C9↑j
                jmp     __rtzeronpop
; ---------------------------------------------------------------------------
                db 0DDh
                dd 0BC06E9D8h
                db 0FFh
_rtforatn200    db 0FFh ; Ъ
; ---------------------------------------------------------------------------

loc_5CC8E2:                             ; DATA XREF: .data:006416F4\u2193o
                                        ; .data:00641720\u2193o ...
                fstp    st
                mov     cl, ch
                jmp     short $+2
; ---------------------------------------------------------------------------

_rtforatnby0:                           ; CODE XREF: .text:005CC8E6\u2191j
                call    __rtpiby2
                jmp     __rtchsifneg
; ---------------------------------------------------------------------------
                db 0CCh ; л
                db 0CCh ; л
                db 0CCh ; л
                db 0CCh ; л
                db 0CCh ; л
                db 0CCh ; л
                db 0CCh ; л
                db 0CCh ; л
                db 0CCh ; л
                db 0CCh ; л
                db 0CCh ; л
                db 0CCh ; л
                db 0CCh ; л
                db 0CCh ; л

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _handle_qnan1(int, double, int)
__handle_qnan1  proc near               ; CODE XREF: _fabs+73↑p

arg_0           = dword ptr  4
arg_4           = qword ptr  8
arg_C           = dword ptr  10h

                mov     eax, dword_642634
                test    eax, eax
                jnz     short loc_5CC92E
                mov     eax, dword ptr [esp+arg_C]
                mov     ecx, dword ptr [esp+arg_4]
                push    eax             ; int
                mov     eax, dword ptr [esp+4+arg_4+4]
                push    eax
                push    ecx             ; double
                push    0               ; int
                push    0               ; int
                push    eax             ; int
                push    ecx             ; int
                mov     ecx, dword ptr [esp+1Ch+arg_0]
                push    ecx             ; int
                push    1               ; Value
                call    __umatherr
                add     esp, 24h
                retn
; ---------------------------------------------------------------------------

loc_5CC92E:                             ; CODE XREF: __handle_qnan1+7↑j
                call    __errno
                mov     edx, dword ptr [esp+arg_C]
                push    0FFFFh
                push    edx
                mov     dword ptr [eax], 21h ; '!'
                call    __ctrlfp
                fld     [esp+8+arg_4]
                add     esp, 8
                retn
__handle_qnan1  endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

__handle_qnan2  proc near               ; CODE XREF: __hypothlp+306↑p

var_8           = qword ptr -8
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_C           = dword ptr  10h
arg_14          = dword ptr  18h

                sub     esp, 8
                fld     qword ptr [esp+8+arg_C]
                fadd    qword ptr [esp+8+arg_4]
                mov     eax, dword_642634
                test    eax, eax
                fstp    [esp+8+var_8]
                jnz     short loc_5CC99E
                mov     eax, dword ptr [esp+8+arg_14]
                mov     ecx, dword ptr [esp+8+var_8+4]
                mov     edx, dword ptr [esp+8+var_8]
                push    eax             ; int
                mov     eax, dword ptr [esp+20h]
                push    ecx
                mov     ecx, dword ptr [esp+10h+arg_C]
                push    edx             ; double
                mov     edx, dword ptr [esp+20h]
                push    eax             ; int
                mov     eax, dword ptr [esp+18h+arg_4]
                push    ecx             ; int
                mov     ecx, dword ptr [esp+1Ch+arg_0]
                push    edx             ; int
                push    eax             ; int
                push    ecx             ; int
                push    1               ; Value
                call    __umatherr
                add     esp, 24h
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5CC99E:                             ; CODE XREF: __handle_qnan2+16↑j
                call    __errno
                mov     edx, dword ptr [esp+8+arg_14]
                push    0FFFFh
                push    edx
                mov     dword ptr [eax], 21h ; '!'
                call    __ctrlfp
                fld     [esp+10h+var_8]
                add     esp, 8
                add     esp, 8
                retn
__handle_qnan2  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _except1(char, int, int, int, double, int)
__except1       proc near               ; CODE XREF: _fabs+60↑p

Arguments       = dword ptr -58h
var_20          = dword ptr -20h
arg_0           = byte ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = qword ptr  14h
arg_18          = dword ptr  1Ch

                mov     eax, dword ptr [esp+arg_18]
                sub     esp, 58h
                lea     ecx, [esp+58h+arg_10]
                push    esi
                mov     esi, dword ptr [esp+5Ch+arg_0]
                push    edi
                push    eax
                push    ecx
                push    esi
                call    __handle_exc
                mov     edi, [esp+6Ch+arg_4]
                add     esp, 0Ch
                test    eax, eax
                jnz     short loc_5CCA20
                mov     ecx, dword ptr [esp+60h+var_20]
                lea     edx, [esp+60h+arg_10]
                and     ecx, 0FFFFFFFEh
                lea     eax, [esp+60h+arg_8]
                push    edx             ; int
                mov     [esp+64h+var_20], ecx
                push    eax             ; int
                push    edi             ; int
                lea     ecx, [esp+6Ch+arg_18]
                push    esi             ; char
                lea     edx, [esp+70h+Arguments]
                push    ecx             ; int
                push    edx             ; Arguments
                call    __raise_exc
                add     esp, 18h

loc_5CCA20:                             ; CODE XREF: __except1+22↑j
                push    esi
                call    __errcode
                mov     ecx, dword_642634
                add     esp, 4
                test    ecx, ecx
                jnz     short loc_5CCA64
                test    eax, eax
                jz      short loc_5CCA64
                mov     ecx, dword ptr [esp+60h+arg_18]
                mov     edx, dword ptr [esp+60h+arg_10+4]
                push    ecx             ; int
                mov     ecx, dword ptr [esp+64h+arg_10]
                push    edx
                mov     edx, dword ptr [esp+68h+arg_C]
                push    ecx             ; double
                mov     ecx, dword ptr [esp+6Ch+arg_8]
                push    0               ; int
                push    0               ; int
                push    edx             ; int
                push    ecx             ; int
                push    edi             ; int
                push    eax             ; Value
                call    __umatherr
                add     esp, 24h
                pop     edi
                pop     esi
                add     esp, 58h
                retn
; ---------------------------------------------------------------------------

loc_5CCA64:                             ; CODE XREF: __except1+61↑j
                push    eax             ; Value
                call    __set_errno
                mov     edx, dword ptr [esp+64h+arg_18]
                add     esp, 4
                push    0FFFFh
                push    edx
                call    __ctrlfp
                fld     [esp+68h+arg_10]
                add     esp, 8
                pop     edi
                pop     esi
                add     esp, 58h
                retn
__except1       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _except2(char, int, int, int, int, int, double, int)
__except2       proc near               ; CODE XREF: __hypothlp+19A↑p

Arguments       = dword ptr -58h
var_30          = dword ptr -30h
var_2C          = dword ptr -2Ch
var_20          = dword ptr -20h
arg_0           = byte ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h
arg_14          = dword ptr  18h
arg_18          = qword ptr  1Ch
arg_20          = dword ptr  24h

                mov     eax, dword ptr [esp+arg_20]
                sub     esp, 58h
                lea     ecx, [esp+58h+arg_18]
                push    ebx
                push    ebp
                push    esi
                mov     esi, dword ptr [esp+64h+arg_0]
                push    edi
                push    eax
                push    ecx
                push    esi
                call    __handle_exc
                mov     edi, [esp+74h+arg_14]
                mov     ebx, dword ptr [esp+74h+arg_10]
                mov     ebp, [esp+74h+arg_4]
                add     esp, 0Ch
                test    eax, eax
                jnz     short loc_5CCAFE
                mov     eax, dword ptr [esp+68h+var_20]
                lea     edx, [esp+68h+arg_18]
                or      al, 1
                push    edx             ; int
                and     al, 0E3h
                lea     ecx, [esp+6Ch+arg_20]
                or      al, 2
                lea     edx, [esp+6Ch+Arguments]
                mov     [esp+6Ch+var_20], eax
                lea     eax, [esp+6Ch+arg_8]
                push    eax             ; int
                push    ebp             ; int
                push    esi             ; char
                push    ecx             ; int
                push    edx             ; Arguments
                mov     [esp+80h+var_30], ebx
                mov     [esp+80h+var_2C], edi
                call    __raise_exc
                add     esp, 18h

loc_5CCAFE:                             ; CODE XREF: __except2+32↑j
                push    esi
                call    __errcode
                mov     ecx, dword_642634
                add     esp, 4
                test    ecx, ecx
                jnz     short loc_5CCB51
                test    eax, eax
                jz      short loc_5CCB51
                mov     ecx, dword ptr [esp+68h+arg_20]
                mov     edx, dword ptr [esp+68h+arg_18+4]
                push    ecx             ; int
                mov     ecx, dword ptr [esp+6Ch+arg_18]
                push    edx
                mov     edx, dword ptr [esp+70h+arg_C]
                push    ecx             ; double
                mov     ecx, dword ptr [esp+74h+arg_8]
                push    edi             ; int
                push    ebx             ; int
                push    edx             ; int
                push    ecx             ; int
                push    ebp             ; int
                push    eax             ; Value
                call    __umatherr
                add     esp, 24h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 58h
                retn
; ---------------------------------------------------------------------------

loc_5CCB51:                             ; CODE XREF: __except2+7F↑j
                push    eax             ; Value
                call    __set_errno
                mov     edx, dword ptr [esp+6Ch+arg_20]
                add     esp, 4
                push    0FFFFh
                push    edx
                call    __ctrlfp
                fld     [esp+70h+arg_18]
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 58h
                retn
__except2       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _raise_exc(ULONG_PTR Arguments, int, char, int, int, int)
__raise_exc     proc near               ; CODE XREF: __except1+48↑p

Arguments       = dword ptr  4
arg_4           = dword ptr  8
arg_8           = byte ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h
arg_14          = dword ptr  18h

                mov     eax, dword ptr [esp+Arguments]
                push    ebx
                push    ebp
                push    esi
                push    edi
                xor     edi, edi
                mov     [eax+4], edi
                mov     ecx, dword ptr [esp+10h+Arguments]
                mov     al, [esp+10h+arg_8]
                mov     ebx, 1
                mov     [ecx+8], edi
                mov     edx, dword ptr [esp+10h+Arguments]
                test    al, 10h
                mov     [edx+0Ch], edi
                jz      short loc_5CCBB6
                mov     ecx, dword ptr [esp+10h+Arguments]
                mov     ebp, 0C000008Fh
                or      [ecx+4], ebx
                jmp     short loc_5CCBBA
; ---------------------------------------------------------------------------

loc_5CCBB6:                             ; CODE XREF: __raise_exc+26↑j
                mov     ebp, [esp+10h+Arguments]

loc_5CCBBA:                             ; CODE XREF: __raise_exc+34↑j
                test    al, 2
                jz      short loc_5CCBCB
                mov     ecx, dword ptr [esp+10h+Arguments]
                mov     ebp, 0C0000093h
                or      dword ptr [ecx+4], 2

loc_5CCBCB:                             ; CODE XREF: __raise_exc+3C↑j
                test    bl, al
                jz      short loc_5CCBDC
                mov     ecx, dword ptr [esp+10h+Arguments]
                mov     ebp, 0C0000091h
                or      dword ptr [ecx+4], 4

loc_5CCBDC:                             ; CODE XREF: __raise_exc+4D↑j
                test    al, 4
                jz      short loc_5CCBED
                mov     ecx, dword ptr [esp+10h+Arguments]
                mov     ebp, 0C000008Eh
                or      dword ptr [ecx+4], 8

loc_5CCBED:                             ; CODE XREF: __raise_exc+5E↑j
                test    al, 8
                jz      short loc_5CCBFE
                mov     eax, dword ptr [esp+10h+Arguments]
                mov     ebp, 0C0000090h
                or      dword ptr [eax+4], 10h

loc_5CCBFE:                             ; CODE XREF: __raise_exc+6F↑j
                mov     esi, [esp+10h+arg_4]
                mov     eax, dword ptr [esp+10h+Arguments]
                mov     ecx, dword ptr [esi]
                mov     edx, dword ptr [eax+8]
                not     ecx
                and     ecx, ebx
                and     edx, 0FFFFFFEFh
                shl     ecx, 4
                or      ecx, edx
                mov     [eax+8], ecx
                mov     ecx, dword ptr [esi]
                mov     eax, dword ptr [esp+10h+Arguments]
                not     ecx
                mov     edx, dword ptr [eax+8]
                and     ecx, 4
                shl     ecx, 1
                and     edx, 0FFFFFFF7h
                or      ecx, edx
                mov     [eax+8], ecx
                mov     ecx, dword ptr [esi]
                mov     eax, dword ptr [esp+10h+Arguments]
                not     ecx
                mov     edx, dword ptr [eax+8]
                shr     ecx, 1
                and     ecx, 4
                and     edx, 0FFFFFFFBh
                or      ecx, edx
                mov     [eax+8], ecx
                mov     ecx, dword ptr [esi]
                mov     eax, dword ptr [esp+10h+Arguments]
                not     ecx
                mov     edx, dword ptr [eax+8]
                shr     ecx, 3
                and     ecx, 2
                and     edx, 0FFFFFFFDh
                or      ecx, edx
                mov     [eax+8], ecx
                mov     ecx, dword ptr [esi]
                mov     eax, dword ptr [esp+10h+Arguments]
                not     ecx
                mov     edx, dword ptr [eax+8]
                shr     ecx, 5
                and     ecx, ebx
                and     edx, 0FFFFFFFEh
                or      ecx, edx
                mov     [eax+8], ecx
                call    __statfp
                test    bl, al
                jz      short loc_5CCC8C
                mov     ecx, dword ptr [esp+10h+Arguments]
                or      dword ptr [ecx+0Ch], 10h

loc_5CCC8C:                             ; CODE XREF: __raise_exc+102↑j
                test    al, 4
                jz      short loc_5CCC98
                mov     ecx, dword ptr [esp+10h+Arguments]
                or      dword ptr [ecx+0Ch], 8

loc_5CCC98:                             ; CODE XREF: __raise_exc+10E↑j
                test    al, 8
                jz      short loc_5CCCA4
                mov     ecx, dword ptr [esp+10h+Arguments]
                or      dword ptr [ecx+0Ch], 4

loc_5CCCA4:                             ; CODE XREF: __raise_exc+11A↑j
                test    al, 10h
                jz      short loc_5CCCB0
                mov     ecx, dword ptr [esp+10h+Arguments]
                or      dword ptr [ecx+0Ch], 2

loc_5CCCB0:                             ; CODE XREF: __raise_exc+126↑j
                test    al, 20h
                jz      short loc_5CCCBB
                mov     eax, dword ptr [esp+10h+Arguments]
                or      [eax+0Ch], ebx

loc_5CCCBB:                             ; CODE XREF: __raise_exc+132↑j
                mov     eax, dword ptr [esi]
                and     eax, 0C00h
                cmp     eax, 400h
                ja      short loc_5CCCE7
                jz      short loc_5CCCD8
                cmp     eax, edi
                jnz     short loc_5CCD0C
                mov     eax, dword ptr [esp+10h+Arguments]
                and     dword ptr [eax], 0FFFFFFFCh
                jmp     short loc_5CCD0C
; ---------------------------------------------------------------------------

loc_5CCCD8:                             ; CODE XREF: __raise_exc+149↑j
                mov     eax, dword ptr [esp+10h+Arguments]
                mov     ecx, dword ptr [eax]
                and     ecx, 0FFFFFFFDh
                or      ecx, ebx
                mov     [eax], ecx
                jmp     short loc_5CCD0C
; ---------------------------------------------------------------------------

loc_5CCCE7:                             ; CODE XREF: __raise_exc+147↑j
                cmp     eax, 800h
                jz      short loc_5CCCFE
                cmp     eax, 0C00h
                jnz     short loc_5CCD0C
                mov     eax, dword ptr [esp+10h+Arguments]
                or      dword ptr [eax], 3
                jmp     short loc_5CCD0C
; ---------------------------------------------------------------------------

loc_5CCCFE:                             ; CODE XREF: __raise_exc+16C↑j
                mov     eax, dword ptr [esp+10h+Arguments]
                mov     edx, dword ptr [eax]
                and     edx, 0FFFFFFFEh
                or      edx, 2
                mov     [eax], edx

loc_5CCD0C:                             ; CODE XREF: __raise_exc+14D↑j
                mov     eax, dword ptr [esi]
                and     eax, 300h
                jz      short loc_5CCD3C
                cmp     eax, 200h
                jz      short loc_5CCD2C
                cmp     eax, 300h
                jnz     short loc_5CCD4A
                mov     eax, dword ptr [esp+10h+Arguments]
                and     dword ptr [eax], 0FFFFFFE3h
                jmp     short loc_5CCD4A
; ---------------------------------------------------------------------------

loc_5CCD2C:                             ; CODE XREF: __raise_exc+19A↑j
                mov     eax, dword ptr [esp+10h+Arguments]
                mov     ecx, dword ptr [eax]
                and     ecx, 0FFFFFFE7h
                or      ecx, 4
                mov     [eax], ecx
                jmp     short loc_5CCD4A
; ---------------------------------------------------------------------------

loc_5CCD3C:                             ; CODE XREF: __raise_exc+193↑j
                mov     eax, dword ptr [esp+10h+Arguments]
                mov     edx, dword ptr [eax]
                and     edx, 0FFFFFFEBh
                or      edx, 8
                mov     [eax], edx

loc_5CCD4A:                             ; CODE XREF: __raise_exc+1A1↑j
                mov     eax, dword ptr [esp+10h+Arguments]
                mov     edx, dword ptr [esp+10h+arg_C]
                and     edx, 0FFFh
                mov     ecx, dword ptr [eax]
                and     ecx, 0FFFE001Fh
                shl     edx, 5
                or      ecx, edx
                mov     [eax], ecx
                mov     eax, dword ptr [esp+10h+Arguments]
                mov     ecx, dword ptr [eax+20h]
                or      ecx, ebx
                mov     [eax+20h], ecx
                mov     eax, dword ptr [esp+10h+Arguments]
                mov     ecx, dword ptr [eax+20h]
                and     ecx, 0FFFFFFE3h
                or      ecx, 2
                mov     [eax+20h], ecx
                mov     eax, dword ptr [esp+10h+arg_10]
                mov     ecx, dword ptr [esp+10h+Arguments]
                mov     edx, dword ptr [eax]
                mov     [ecx+10h], edx
                mov     edx, dword ptr [eax+4]
                mov     eax, dword ptr [esp+10h+Arguments]
                mov     [eax+14h], edx
                mov     eax, dword ptr [esp+10h+Arguments]
                mov     edi, [eax+50h]
                or      edi, ebx
                mov     [eax+50h], edi
                mov     eax, dword ptr [esp+10h+Arguments]
                mov     edi, [esp+10h+arg_14]
                mov     ecx, dword ptr [eax+50h]
                and     ecx, 0FFFFFFE3h
                or      ecx, 2
                mov     [eax+50h], ecx
                mov     eax, dword ptr [esp+10h+Arguments]
                mov     edx, dword ptr [edi]
                mov     [eax+40h], edx
                mov     edx, dword ptr [esp+10h+Arguments]
                mov     ecx, dword ptr [edi+4]
                mov     [edx+44h], ecx
                call    __clrfp
                lea     eax, [esp+10h+Arguments]
                push    eax             ; lpArguments
                push    ebx             ; nNumberOfArguments
                push    0               ; dwExceptionFlags
                push    ebp             ; dwExceptionCode
                call    RaiseException
                mov     eax, dword ptr [esp+10h+Arguments]
                test    byte ptr [eax+8], 10h
                jz      short loc_5CCDEE
                and     dword ptr [esi], 0FFFFFFFEh

loc_5CCDEE:                             ; CODE XREF: __raise_exc+269↑j
                test    byte ptr [eax+8], 8
                jz      short loc_5CCDF7
                and     dword ptr [esi], 0FFFFFFFBh

loc_5CCDF7:                             ; CODE XREF: __raise_exc+272↑j
                test    byte ptr [eax+8], 4
                jz      short loc_5CCE00
                and     dword ptr [esi], 0FFFFFFF7h

loc_5CCE00:                             ; CODE XREF: __raise_exc+27B↑j
                test    byte ptr [eax+8], 2
                jz      short loc_5CCE09
                and     dword ptr [esi], 0FFFFFFEFh

loc_5CCE09:                             ; CODE XREF: __raise_exc+284↑j
                test    [eax+8], bl
                jz      short loc_5CCE11
                and     dword ptr [esi], 0FFFFFFDFh

loc_5CCE11:                             ; CODE XREF: __raise_exc+28C↑j
                mov     ecx, dword ptr [eax]
                and     ecx, 3
                cmp     ecx, 3          ; switch 4 cases
                ja      short def_5CCE1B ; jumptable 005CCE1B default case
                jmp     ds:jpt_5CCE1B[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5CCE22:                             ; CODE XREF: __raise_exc+29B↑j
                mov     ecx, dword ptr [esi]      ; jumptable 005CCE1B case 3
                or      ch, 0Ch
                jmp     short loc_5CCE44
; ---------------------------------------------------------------------------

loc_5CCE29:                             ; CODE XREF: __raise_exc+29B↑j
                mov     ecx, dword ptr [esi]      ; jumptable 005CCE1B case 2
                and     ch, 0FBh
                or      ch, 8
                jmp     short loc_5CCE44
; ---------------------------------------------------------------------------

loc_5CCE33:                             ; CODE XREF: __raise_exc+29B↑j
                mov     edx, dword ptr [esi]      ; jumptable 005CCE1B case 1
                and     dh, 0F7h
                or      dh, 4
                mov     [esi], edx
                jmp     short def_5CCE1B ; jumptable 005CCE1B default case
; ---------------------------------------------------------------------------

loc_5CCE3F:                             ; CODE XREF: __raise_exc+29B↑j
                mov     ecx, dword ptr [esi]      ; jumptable 005CCE1B case 0
                and     ch, 0F3h

loc_5CCE44:                             ; CODE XREF: __raise_exc+2A7↑j
                mov     [esi], ecx

def_5CCE1B:                             ; CODE XREF: __raise_exc+299↑j
                mov     ecx, dword ptr [eax]      ; jumptable 005CCE1B default case
                shr     ecx, 2
                and     ecx, 7
                sub     ecx, 0
                jz      short loc_5CCE8A
                dec     ecx
                jz      short loc_5CCE70
                dec     ecx
                jnz     short loc_5CCE94
                mov     ecx, dword ptr [esi]
                and     ch, 0F3h
                mov     [esi], ecx
                mov     ecx, dword ptr [eax+40h]
                mov     [edi], ecx
                mov     edx, dword ptr [eax+44h]
                mov     [edi+4], edx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CCE70:                             ; CODE XREF: __raise_exc+2D4↑j
                mov     ecx, dword ptr [esi]
                and     ch, 0F3h
                or      ch, 2
                mov     [esi], ecx
                mov     ecx, dword ptr [eax+40h]
                mov     [edi], ecx
                mov     edx, dword ptr [eax+44h]
                mov     [edi+4], edx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CCE8A:                             ; CODE XREF: __raise_exc+2D1↑j
                mov     edx, dword ptr [esi]
                and     dh, 0F3h
                or      dh, 3
                mov     [esi], edx

loc_5CCE94:                             ; CODE XREF: __raise_exc+2D7↑j
                mov     ecx, dword ptr [eax+40h]
                mov     [edi], ecx
                mov     edx, dword ptr [eax+44h]
                mov     [edi+4], edx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
__raise_exc     endp

; ---------------------------------------------------------------------------
jpt_5CCE1B      dd offset loc_5CCE3F    ; DATA XREF: __raise_exc+29B↑r
                dd offset loc_5CCE33    ; jump table for switch statement
                dd offset loc_5CCE29
                dd offset loc_5CCE22
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame fuzzy-sp

__handle_exc    proc near               ; CODE XREF: __except1+14↑p

var_10          = dword ptr -10h
var_C           = dword ptr -0Ch
var_8           = qword ptr -8
arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch
arg_8           = dword ptr  10h

                push    ebp
                mov     ebp, esp
                and     esp, 0FFFFFFF8h
                sub     esp, 14h
                mov     eax, dword ptr [ebp+arg_0]
                push    ebx
                push    esi
                mov     esi, eax
                and     esi, 1Fh
                push    edi
                test    al, 8
                mov     [esp+20h+var_10], esi
                mov     ebx, 1
                jz      short loc_5CCEFA
                test    byte ptr [ebp+arg_8], bl
                jz      short loc_5CCEFA
                push    ebx
                call    __set_statfp
                mov     eax, dword ptr [ebp+arg_0]
                add     esp, 4
                and     esi, 0FFFFFFF7h
                jmp     loc_5CD1CB
; ---------------------------------------------------------------------------

loc_5CCEFA:                             ; CODE XREF: __handle_exc+1F↑j
                mov     cl, byte ptr [ebp+arg_8]
                test    al, 4
                jz      short loc_5CCF1B
                test    cl, 4
                jz      short loc_5CCF1B
                push    4
                call    __set_statfp
                mov     eax, dword ptr [ebp+arg_0]
                add     esp, 4
                and     esi, 0FFFFFFFBh
                jmp     loc_5CD1CB
; ---------------------------------------------------------------------------

loc_5CCF1B:                             ; CODE XREF: __handle_exc+3F↑j
                test    bl, al
                jz      loc_5CD0A9
                test    cl, 8
                jz      loc_5CD0A9
                push    8
                call    __set_statfp
                mov     eax, dword ptr [ebp+arg_8]
                add     esp, 4
                and     eax, 0C00h
                cmp     eax, 400h
                ja      loc_5CCFF5
                jz      short loc_5CCFA4
                test    eax, eax
                jnz     loc_5CD09E
                mov     edx, dword ptr [ebp+arg_4]
                fld     qword ptr [edx]
                fcomp   qword ptr [dbl_614B80]
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5CCF80
                mov     ecx, dword ptr g_Number
                mov     eax, dword ptr g_Number+4
                mov     [edx], ecx
                mov     [edx+4], eax
                mov     eax, dword ptr [ebp+arg_0]
                and     esi, 0FFFFFFFEh
                jmp     loc_5CD1CB
; ---------------------------------------------------------------------------

loc_5CCF80:                             ; CODE XREF: __handle_exc+A3↑j
                fld     qword ptr [g_Number]
                fchs
                fstp    [esp+20h+var_8]
                mov     ecx, dword ptr [esp+20h+var_8]
                mov     eax, dword ptr [esp+20h+var_8+4]
                mov     [edx], ecx
                mov     [edx+4], eax
                mov     eax, dword ptr [ebp+arg_0]
                and     esi, 0FFFFFFFEh
                jmp     loc_5CD1CB
; ---------------------------------------------------------------------------

loc_5CCFA4:                             ; CODE XREF: __handle_exc+89↑j
                mov     edx, dword ptr [ebp+arg_4]
                fld     qword ptr [edx]
                fcomp   qword ptr [dbl_614B80]
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5CCFD1
                mov     ecx, dword ptr dbl_641818
                mov     eax, dword ptr dbl_641818+4
                mov     [edx], ecx
                mov     [edx+4], eax
                mov     eax, dword ptr [ebp+arg_0]
                and     esi, 0FFFFFFFEh
                jmp     loc_5CD1CB
; ---------------------------------------------------------------------------

loc_5CCFD1:                             ; CODE XREF: __handle_exc+F4↑j
                fld     qword ptr [g_Number]
                fchs
                fstp    [esp+20h+var_8]
                mov     ecx, dword ptr [esp+20h+var_8]
                mov     eax, dword ptr [esp+20h+var_8+4]
                mov     [edx], ecx
                mov     [edx+4], eax
                mov     eax, dword ptr [ebp+arg_0]
                and     esi, 0FFFFFFFEh
                jmp     loc_5CD1CB
; ---------------------------------------------------------------------------

loc_5CCFF5:                             ; CODE XREF: __handle_exc+83↑j
                cmp     eax, 800h
                jz      short loc_5CD058
                cmp     eax, 0C00h
                jnz     loc_5CD09E
                mov     edx, dword ptr [ebp+arg_4]
                fld     qword ptr [edx]
                fcomp   qword ptr [dbl_614B80]
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5CD034
                mov     ecx, dword ptr dbl_641818
                mov     eax, dword ptr dbl_641818+4
                mov     [edx], ecx
                mov     [edx+4], eax
                mov     eax, dword ptr [ebp+arg_0]
                and     esi, 0FFFFFFFEh
                jmp     loc_5CD1CB
; ---------------------------------------------------------------------------

loc_5CD034:                             ; CODE XREF: __handle_exc+157↑j
                fld     qword ptr [dbl_641818]
                fchs
                fstp    [esp+20h+var_8]
                mov     ecx, dword ptr [esp+20h+var_8]
                mov     eax, dword ptr [esp+20h+var_8+4]
                mov     [edx], ecx
                mov     [edx+4], eax
                mov     eax, dword ptr [ebp+arg_0]
                and     esi, 0FFFFFFFEh
                jmp     loc_5CD1CB
; ---------------------------------------------------------------------------

loc_5CD058:                             ; CODE XREF: __handle_exc+13A↑j
                mov     edx, dword ptr [ebp+arg_4]
                fld     qword ptr [edx]
                fcomp   qword ptr [dbl_614B80]
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5CD085
                mov     ecx, dword ptr g_Number
                mov     eax, dword ptr g_Number+4
                mov     [edx], ecx
                mov     [edx+4], eax
                mov     eax, dword ptr [ebp+arg_0]
                and     esi, 0FFFFFFFEh
                jmp     loc_5CD1CB
; ---------------------------------------------------------------------------

loc_5CD085:                             ; CODE XREF: __handle_exc+1A8↑j
                fld     qword ptr [dbl_641818]
                fchs
                fstp    [esp+20h+var_8]
                mov     ecx, dword ptr [esp+20h+var_8]
                mov     eax, dword ptr [esp+20h+var_8+4]
                mov     [edx], ecx
                mov     [edx+4], eax

loc_5CD09E:                             ; CODE XREF: __handle_exc+8D↑j
                mov     eax, dword ptr [ebp+arg_0]
                and     esi, 0FFFFFFFEh
                jmp     loc_5CD1CB
; ---------------------------------------------------------------------------

loc_5CD0A9:                             ; CODE XREF: __handle_exc+5D↑j
                test    al, 2
                jz      loc_5CD1CB
                test    cl, 10h
                jz      loc_5CD1CB
                xor     esi, esi
                test    al, 10h
                jz      short loc_5CD0C2
                mov     esi, ebx

loc_5CD0C2:                             ; CODE XREF: __handle_exc+1FE↑j
                mov     edi, [ebp+arg_4]
                mov     ecx, dword ptr [edi]
                mov     edx, dword ptr [edi+4]
                mov     dword ptr [esp+20h+var_8], ecx
                mov     dword ptr [esp+20h+var_8+4], edx
                fld     [esp+20h+var_8]
                fcomp   qword ptr [dbl_614B80]
                fnstsw  ax
                test    ah, 40h
                jnz     loc_5CD1AA
                lea     eax, [esp+20h+var_C]
                push    eax             ; int
                push    edx
                push    ecx             ; double
                call    __decomp
                mov     ecx, dword ptr [esp+2Ch+var_C]
                add     esp, 0Ch
                fstp    [esp+20h+var_8]
                add     ecx, 0FFFFFA00h
                cmp     ecx, 0FFFFFBCEh
                jge     short loc_5CD126
                xor     eax, eax
                mov     esi, ebx
                mov     ecx, eax
                mov     edx, eax
                mov     [edi], ecx
                mov     dword ptr [esp+20h+var_8], eax
                mov     dword ptr [esp+20h+var_8+4], eax
                mov     [edi+4], edx
                jmp     loc_5CD1AC
; ---------------------------------------------------------------------------

loc_5CD126:                             ; CODE XREF: __handle_exc+24A↑j
                fld     [esp+20h+var_8]
                fcomp   qword ptr [dbl_614B80]
                fnstsw  ax
                test    ah, 1
                jz      short loc_5CD13B
                mov     edx, ebx
                jmp     short loc_5CD13D
; ---------------------------------------------------------------------------

loc_5CD13B:                             ; CODE XREF: __handle_exc+275↑j
                xor     edx, edx

loc_5CD13D:                             ; CODE XREF: __handle_exc+279↑j
                mov     al, byte ptr [esp+20h+var_8+6]
                and     eax, 0Fh
                or      al, 10h
                cmp     ecx, 0FFFFFC03h
                mov     word ptr [esp+20h+var_8+6], ax
                jge     short loc_5CD18D
                mov     eax, 0FFFFFC03h
                sub     eax, ecx

loc_5CD15A:                             ; CODE XREF: __handle_exc+2CB↓j
                test    byte ptr [esp+20h+var_8], bl
                jz      short loc_5CD166
                test    esi, esi
                jnz     short loc_5CD166
                mov     esi, ebx

loc_5CD166:                             ; CODE XREF: __handle_exc+29E↑j
                mov     ecx, dword ptr [esp+20h+var_8]
                shr     ecx, 1
                mov     dword ptr [esp+20h+var_8], ecx
                mov     cl, byte ptr [esp+20h+var_8+4]
                test    bl, cl
                jz      short loc_5CD180
                or      dword ptr [esp+20h+var_8], 80000000h

loc_5CD180:                             ; CODE XREF: __handle_exc+2B6↑j
                mov     ecx, dword ptr [esp+20h+var_8+4]
                shr     ecx, 1
                dec     eax
                mov     dword ptr [esp+20h+var_8+4], ecx
                jnz     short loc_5CD15A

loc_5CD18D:                             ; CODE XREF: __handle_exc+291↑j
                test    edx, edx
                jz      short loc_5CD19B
                fld     [esp+20h+var_8]
                fchs
                fstp    [esp+20h+var_8]

loc_5CD19B:                             ; CODE XREF: __handle_exc+2CF↑j
                mov     ecx, dword ptr [esp+20h+var_8]
                mov     edx, dword ptr [esp+20h+var_8+4]
                mov     [edi], ecx
                mov     [edi+4], edx
                jmp     short loc_5CD1AC
; ---------------------------------------------------------------------------

loc_5CD1AA:                             ; CODE XREF: __handle_exc+221↑j
                mov     esi, ebx

loc_5CD1AC:                             ; CODE XREF: __handle_exc+261↑j
                test    esi, esi
                jz      short loc_5CD1BA
                push    10h
                call    __set_statfp
                add     esp, 4

loc_5CD1BA:                             ; CODE XREF: __handle_exc+2EE↑j
                mov     eax, dword ptr [esp+20h+var_10]
                and     al, 0FDh
                mov     [esp+20h+var_10], eax
                mov     eax, dword ptr [ebp+arg_0]
                mov     esi, [esp+20h+var_10]

loc_5CD1CB:                             ; CODE XREF: __handle_exc+35↑j
                test    al, 10h
                jz      short loc_5CD1E2
                test    byte ptr [ebp+arg_8], 20h
                jz      short loc_5CD1E2
                push    20h ; ' '
                call    __set_statfp
                add     esp, 4
                and     esi, 0FFFFFFEFh

loc_5CD1E2:                             ; CODE XREF: __handle_exc+30D↑j
                xor     eax, eax
                pop     edi
                test    esi, esi
                pop     esi
                pop     ebx
                setz    al
                mov     esp, ebp
                pop     ebp
                retn
__handle_exc    endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _umatherr(int Value, int, int, int, int, int, double, int)
__umatherr      proc near               ; CODE XREF: __handle_qnan1+25↑p

var_20          = dword ptr -20h
var_1C          = dword ptr -1Ch
var_18          = dword ptr -18h
var_14          = dword ptr -14h
var_10          = dword ptr -10h
var_C           = dword ptr -0Ch
var_8           = qword ptr -8
Value           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h
arg_14          = dword ptr  18h
arg_18          = qword ptr  1Ch
arg_20          = dword ptr  24h

                sub     esp, 20h
                mov     eax, dword ptr [esp+20h+arg_4]
                push    eax
                call    __get_fname
                add     esp, 4
                mov     [esp+20h+var_1C], eax
                test    eax, eax
                jz      short loc_5CD276
                mov     ecx, dword ptr [esp+20h+arg_8]
                mov     edx, dword ptr [esp+20h+arg_C]
                mov     eax, dword ptr [esp+20h+arg_10]
                mov     [esp+20h+var_18], ecx
                mov     ecx, dword ptr [esp+20h+arg_14]
                push    esi
                mov     esi, [esp+24h+Value]
                mov     [esp+24h+var_C], ecx
                mov     ecx, dword ptr [esp+24h+arg_20]
                mov     [esp+24h+var_14], edx
                mov     edx, dword ptr [esp+24h+arg_18]
                mov     [esp+24h+var_10], eax
                mov     eax, dword ptr [esp+24h+arg_18+4]
                push    0FFFFh
                push    ecx
                mov     [esp+2Ch+var_20], esi
                mov     dword ptr [esp+2Ch+var_8], edx
                mov     dword ptr [esp+2Ch+var_8+4], eax
                call    __ctrlfp
                add     esp, 8
                lea     edx, [esp+24h+var_20]
                push    edx
                call    sub_5D33C0
                add     esp, 4
                test    eax, eax
                jnz     short loc_5CD26D
                push    esi             ; Value
                call    __set_errno
                add     esp, 4

loc_5CD26D:                             ; CODE XREF: __umatherr+72↑j
                fld     [esp+24h+var_8]
                pop     esi
                add     esp, 20h
                retn
; ---------------------------------------------------------------------------

loc_5CD276:                             ; CODE XREF: __umatherr+16↑j
                mov     eax, dword ptr [esp+20h+arg_20]
                push    0FFFFh
                push    eax
                call    __ctrlfp
                mov     ecx, dword ptr [esp+28h+Value]
                add     esp, 8
                push    ecx             ; Value
                call    __set_errno
                fld     [esp+24h+arg_18]
                add     esp, 4
                add     esp, 20h
                retn
__umatherr      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; errno_t __cdecl _set_errno(int Value)
__set_errno     proc near               ; CODE XREF: __except1+95↑p

Value           = dword ptr  4

                mov     eax, dword ptr [esp+Value]
                cmp     eax, 1
                jz      short loc_5CD2BC
                jle     short locret_5CD2C7
                cmp     eax, 3
                jg      short locret_5CD2C7
                call    __errno
                mov     dword ptr [eax], 22h ; '"'
                retn
; ---------------------------------------------------------------------------

loc_5CD2BC:                             ; CODE XREF: __set_errno+7↑j
                call    __errno
                mov     dword ptr [eax], 21h ; '!'

locret_5CD2C7:                          ; CODE XREF: __set_errno+9↑j
                retn
__set_errno     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__get_fname     proc near               ; CODE XREF: __umatherr+8↑p

arg_0           = dword ptr  4

                mov     edx, dword ptr [esp+arg_0]
                xor     ecx, ecx
                mov     eax, offset dword_641730

loc_5CD2DB:                             ; CODE XREF: __get_fname+18↓j
                cmp     [eax], edx
                jz      short loc_5CD2ED
                add     eax, 8
                inc     ecx
                cmp     eax, offset Number
                jl      short loc_5CD2DB
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------

loc_5CD2ED:                             ; CODE XREF: __get_fname+D↑j
                mov     eax, off_641734[ecx*8]
                retn
__get_fname     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__errcode       proc near               ; CODE XREF: __except1+51↑p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                test    al, 20h
                jz      short loc_5CD30E
                mov     eax, 5
                retn
; ---------------------------------------------------------------------------

loc_5CD30E:                             ; CODE XREF: __errcode+6↑j
                test    al, 8
                jz      short loc_5CD318
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5CD318:                             ; CODE XREF: __errcode+10↑j
                test    al, 4
                jz      short loc_5CD322
                mov     eax, 2
                retn
; ---------------------------------------------------------------------------

loc_5CD322:                             ; CODE XREF: __errcode+1A↑j
                test    al, 1
                jz      short loc_5CD32C
                mov     eax, 3
                retn
; ---------------------------------------------------------------------------

loc_5CD32C:                             ; CODE XREF: __errcode+24↑j
                and     eax, 0FFh
                and     eax, 2
                shl     eax, 1
                retn
__errcode       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__set_exp       proc near               ; CODE XREF: __hypothlp+168↑p

var_8           = qword ptr -8
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                sub     esp, 8
                mov     eax, dword ptr [esp+8+arg_0]
                mov     ecx, dword ptr [esp+8+arg_4]
                mov     edx, dword ptr [esp+8+arg_8]
                mov     dword ptr [esp+8+var_8], eax
                mov     dword ptr [esp+8+var_8+4], ecx
                mov     ecx, dword ptr [esp+8+arg_4+2]
                lea     eax, [edx+3FEh]
                and     ecx, 800Fh
                shl     eax, 4
                or      ecx, eax
                mov     word ptr [esp+8+var_8+6], cx
                fld     [esp+8+var_8]
                add     esp, 8
                retn
__set_exp       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__get_exp       proc near               ; CODE XREF: __hypothlp+145↑p

arg_6           = dword ptr  0Ah

                mov     eax, dword ptr [esp+arg_6]
                shr     eax, 4
                and     eax, 7FFh
                sub     eax, 3FEh
                movsx   eax, ax
                retn
__get_exp       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__add_exp       proc near

arg_0           = dword ptr  4
arg_6           = dword ptr  0Ah

                mov     eax, dword ptr [esp+arg_6]
                mov     ecx, dword ptr [esp+arg_6+2]
                shr     eax, 4
                and     eax, 7FFh
                lea     edx, [eax+ecx-3FEh]
                mov     eax, dword ptr [esp+8]
                mov     ecx, dword ptr [esp+arg_0]
                push    edx
                push    eax
                push    ecx
                call    __set_exp
                add     esp, 0Ch
                retn
__add_exp       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__set_bexp      proc near

var_8           = qword ptr -8
arg_0           = dword ptr  4
arg_6           = dword ptr  0Ah

                sub     esp, 8
                mov     eax, dword ptr [esp+8+arg_0]
                mov     edx, dword ptr [esp+8+arg_6]
                mov     ecx, dword ptr [esp+10h]
                mov     dword ptr [esp+8+var_8], eax
                mov     eax, dword ptr [esp+8+arg_6+2]
                and     edx, 800Fh
                shl     eax, 4
                or      edx, eax
                mov     dword ptr [esp+8+var_8+4], ecx
                mov     word ptr [esp+8+var_8+6], dx
                fld     [esp+8+var_8]
                add     esp, 8
                retn
__set_bexp      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__sptype        proc near               ; CODE XREF: _fabs+38↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     edx, dword ptr [esp+arg_4]
                mov     ecx, dword ptr [esp+arg_0]
                cmp     edx, 7FF00000h
                jnz     short loc_5CD42A
                test    ecx, ecx
                jnz     short loc_5CD42A
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5CD42A:                             ; CODE XREF: __sptype+E↑j
                cmp     edx, 0FFF00000h
                jnz     short loc_5CD43C
                test    ecx, ecx
                jnz     short loc_5CD43C
                mov     eax, 2
                retn
; ---------------------------------------------------------------------------

loc_5CD43C:                             ; CODE XREF: __sptype+20↑j
                mov     eax, dword ptr [esp+arg_4+2]
                and     eax, 7FF8h
                cmp     ax, 7FF8h
                jnz     short loc_5CD451
                mov     eax, 3
                retn
; ---------------------------------------------------------------------------

loc_5CD451:                             ; CODE XREF: __sptype+39↑j
                cmp     ax, 7FF0h
                jnz     short loc_5CD469
                test    edx, 7FFFFh
                jnz     short loc_5CD463
                test    ecx, ecx
                jz      short loc_5CD469

loc_5CD463:                             ; CODE XREF: __sptype+4D↑j
                mov     eax, 4
                retn
; ---------------------------------------------------------------------------

loc_5CD469:                             ; CODE XREF: __sptype+45↑j
                xor     eax, eax
                retn
__sptype        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _decomp(double, int)
__decomp        proc near               ; CODE XREF: __hypothlp+118↑p

arg_0           = qword ptr  4
arg_8           = dword ptr  0Ch

                fld     [esp+arg_0]
                fcomp   qword ptr [dbl_614B88]
                push    ebx
                push    esi
                push    edi
                fnstsw  ax
                test    ah, 40h
                jz      short loc_5CD4A4
                mov     ecx, dword ptr [esp+0Ch+arg_8]
                mov     dword ptr [esp+0Ch+arg_0], 0
                mov     dword ptr [esp+0Ch+arg_0+4], 0
                xor     esi, esi
                fld     [esp+0Ch+arg_0]
                mov     [ecx], esi
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CD4A4:                             ; CODE XREF: __decomp+12↑j
                mov     esi, dword ptr [esp+0Ch+arg_0+6]
                mov     edx, dword ptr [esp+0Ch+arg_0+4]
                mov     ecx, dword ptr [esp+0Ch+arg_0]
                test    esi, 7FF0h
                jnz     loc_5CD543
                test    edx, 0FFFFFh
                jnz     short loc_5CD4C8
                test    ecx, ecx
                jz      short loc_5CD543

loc_5CD4C8:                             ; CODE XREF: __decomp+52↑j
                fld     [esp+0Ch+arg_0]
                fcomp   qword ptr [dbl_614B88]
                mov     esi, 0FFFFFC03h
                fnstsw  ax
                test    ah, 1
                jz      short loc_5CD4E5
                mov     edi, 1
                jmp     short loc_5CD4E7
; ---------------------------------------------------------------------------

loc_5CD4E5:                             ; CODE XREF: __decomp+6C↑j
                xor     edi, edi

loc_5CD4E7:                             ; CODE XREF: __decomp+73↑j
                mov     bl, byte ptr [esp+0Ch+arg_0+6]
                mov     al, 10h
                test    al, bl
                jnz     short loc_5CD511

loc_5CD4F1:                             ; CODE XREF: __decomp+9F↓j
                shl     edx, 1
                test    ecx, 80000000h
                mov     dword ptr [esp+0Ch+arg_0+4], edx
                jz      short loc_5CD506
                or      edx, 1
                mov     dword ptr [esp+0Ch+arg_0+4], edx

loc_5CD506:                             ; CODE XREF: __decomp+8D↑j
                mov     bl, byte ptr [esp+0Ch+arg_0+6]
                shl     ecx, 1
                dec     esi
                test    al, bl
                jz      short loc_5CD4F1

loc_5CD511:                             ; CODE XREF: __decomp+7F↑j
                and     word ptr [esp+0Ch+arg_0+6], 0FFEFh
                test    edi, edi
                jz      short loc_5CD521
                or      byte ptr [esp+0Ch+arg_0+7], 80h

loc_5CD521:                             ; CODE XREF: __decomp+AA↑j
                mov     eax, dword ptr [esp+0Ch+arg_0+4]
                push    0
                push    eax
                push    ecx
                call    __set_exp
                mov     ecx, dword ptr [esp+18h+arg_8]
                add     esp, 0Ch
                fstp    [esp+0Ch+arg_0]
                fld     [esp+0Ch+arg_0]
                mov     [ecx], esi
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CD543:                             ; CODE XREF: __decomp+46↑j
                push    0
                push    edx
                push    ecx
                call    __set_exp
                mov     ecx, dword ptr [esp+18h+arg_8]
                add     esp, 0Ch
                fstp    [esp+0Ch+arg_0]
                shr     esi, 4
                fld     [esp+0Ch+arg_0]
                and     esi, 7FFh
                pop     edi
                sub     esi, 3FEh
                mov     [ecx], esi
                pop     esi
                pop     ebx
                retn
__decomp        endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

__statfp        proc near               ; CODE XREF: __raise_exc+FB↑p

var_2           = word ptr -2

                push    ebp
                mov     ebp, esp
                push    ecx
                fstsw   [ebp+var_2]
                movsx   eax, [ebp+var_2]
                mov     esp, ebp
                pop     ebp
                retn
__statfp        endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

__clrfp         proc near               ; CODE XREF: __raise_exc+24D↑p

var_2           = word ptr -2

                push    ebp
                mov     ebp, esp
                push    ecx
                fnstsw  [ebp+var_2]
                fnclex
                movsx   eax, [ebp+var_2]
                mov     esp, ebp
                pop     ebp
                retn
__clrfp         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

__ctrlfp        proc near               ; CODE XREF: _fabs+10↑p

var_4           = dword ptr -4
arg_0           = dword ptr  8
arg_4           = dword ptr  0Ch

                push    ebp
                mov     ebp, esp
                push    ecx
                fstcw   word ptr [ebp+var_4]
                mov     eax, dword ptr [ebp+arg_4]
                mov     ecx, dword ptr [ebp+arg_0]
                mov     edx, eax
                and     edx, ecx
                mov     ecx, dword ptr [ebp+var_4]
                not     eax
                and     eax, ecx
                or      edx, eax
                mov     [ebp+arg_4], edx
                fldcw   word ptr [ebp+arg_4]
                movsx   eax, cx
                mov     esp, ebp
                pop     ebp
                retn
__ctrlfp        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

__set_statfp    proc near               ; CODE XREF: __handle_exc+27↑p

var_8           = qword ptr -8
arg_0           = dword ptr  8

                push    ebp
                mov     ebp, esp
                sub     esp, 8
                mov     cl, byte ptr [ebp+arg_0]
                test    cl, 1
                jz      short loc_5CD5E8
                fld     tbyte_641830
                fistp   [ebp+arg_0]
                wait

loc_5CD5E8:                             ; CODE XREF: __set_statfp+C↑j
                test    cl, 8
                jz      short loc_5CD5FD
                fstsw   ax
                fld     tbyte_641830
                fstp    [ebp+var_8]
                wait
                fstsw   ax

loc_5CD5FD:                             ; CODE XREF: __set_statfp+1B↑j
                test    cl, 10h
                jz      short loc_5CD60C
                fld     tbyte_641840
                fstp    [ebp+var_8]
                wait

loc_5CD60C:                             ; CODE XREF: __set_statfp+30↑j
                test    cl, 4
                jz      short loc_5CD61A
                fldz
                fld1
                fdivrp  st(1), st
                fstp    st
                wait

loc_5CD61A:                             ; CODE XREF: __set_statfp+3F↑j
                test    cl, 20h
                jz      short loc_5CD625
                fldpi
                fstp    [ebp+var_8]
                wait

loc_5CD625:                             ; CODE XREF: __set_statfp+4D↑j
                mov     esp, ebp
                pop     ebp
                retn
__set_statfp    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _XcptFilter(int, struct _EXCEPTION_POINTERS *ExceptionInfo)
__XcptFilter    proc near               ; CODE XREF: start+169↑p

var_4           = dword ptr -4
arg_0           = dword ptr  4
ExceptionInfo   = dword ptr  8

                push    ecx
                push    ebx
                push    ebp
                push    esi
                push    edi
                call    __getptd
                mov     ecx, dword ptr [esp+14h+arg_0]
                mov     esi, eax
                mov     eax, dword ptr [esi+50h]
                push    eax
                push    ecx
                call    _xcptlookup
                xor     edi, edi
                add     esp, 8
                cmp     eax, edi
                jz      loc_5CD82C
                mov     edx, dword ptr [eax+8]
                cmp     edx, edi
                mov     [esp+14h+arg_0], edx
                jz      loc_5CD82C
                cmp     edx, 5
                jnz     short loc_5CD679
                mov     [eax+8], edi
                mov     eax, 1
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CD679:                             ; CODE XREF: __XcptFilter+39↑j
                cmp     edx, 1
                jnz     short loc_5CD687
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CD687:                             ; CODE XREF: __XcptFilter+4C↑j
                mov     ecx, dword ptr [esi+54h]
                mov     [esp+14h+var_4], ecx
                mov     ecx, dword ptr [esp+14h+ExceptionInfo]
                mov     [esi+54h], ecx
                mov     ecx, dword ptr [eax+4]
                cmp     ecx, 8
                jnz     loc_5CD813
                mov     ecx, dword_6418C8
                mov     ebx, dword_6418CC
                add     ebx, ecx
                cmp     ecx, ebx
                jge     short loc_5CD6DA
                lea     edx, [ecx+ecx*2]
                shl     edx, 2

loc_5CD6B9:                             ; CODE XREF: __XcptFilter+A4↓j
                mov     ebx, dword ptr [esi+50h]
                inc     ecx
                mov     [ebx+edx+8], edi
                mov     ebx, dword_6418C8
                mov     ebp, dword_6418CC
                add     edx, 0Ch
                add     ebp, ebx
                cmp     ecx, ebp
                jl      short loc_5CD6B9
                mov     edx, dword ptr [esp+14h+arg_0]

loc_5CD6DA:                             ; CODE XREF: __XcptFilter+81↑j
                mov     eax, dword ptr [eax]
                mov     edi, [esi+58h]
                cmp     eax, 0C000008Eh
                jnz     short loc_5CD70B
                mov     dword ptr [esi+58h], 83h
                mov     eax, dword ptr [esi+58h]
                push    eax
                push    8
                call    edx
                mov     ecx, dword ptr [esp+1Ch+var_4]
                add     esp, 8
                mov     [esi+58h], edi
                mov     [esi+54h], ecx
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CD70B:                             ; CODE XREF: __XcptFilter+B4↑j
                cmp     eax, 0C0000090h
                jnz     short loc_5CD737
                mov     dword ptr [esi+58h], 81h
                mov     eax, dword ptr [esi+58h]
                push    eax
                push    8
                call    edx
                mov     ecx, dword ptr [esp+1Ch+var_4]
                add     esp, 8
                mov     [esi+58h], edi
                mov     [esi+54h], ecx
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CD737:                             ; CODE XREF: __XcptFilter+E0↑j
                cmp     eax, 0C0000091h
                jnz     short loc_5CD763
                mov     dword ptr [esi+58h], 84h
                mov     eax, dword ptr [esi+58h]
                push    eax
                push    8
                call    edx
                mov     ecx, dword ptr [esp+1Ch+var_4]
                add     esp, 8
                mov     [esi+58h], edi
                mov     [esi+54h], ecx
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CD763:                             ; CODE XREF: __XcptFilter+10C↑j
                cmp     eax, 0C0000093h
                jnz     short loc_5CD78F
                mov     dword ptr [esi+58h], 85h
                mov     eax, dword ptr [esi+58h]
                push    eax
                push    8
                call    edx
                mov     ecx, dword ptr [esp+1Ch+var_4]
                add     esp, 8
                mov     [esi+58h], edi
                mov     [esi+54h], ecx
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CD78F:                             ; CODE XREF: __XcptFilter+138↑j
                cmp     eax, 0C000008Dh
                jnz     short loc_5CD7BB
                mov     dword ptr [esi+58h], 82h
                mov     eax, dword ptr [esi+58h]
                push    eax
                push    8
                call    edx
                mov     ecx, dword ptr [esp+1Ch+var_4]
                add     esp, 8
                mov     [esi+58h], edi
                mov     [esi+54h], ecx
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CD7BB:                             ; CODE XREF: __XcptFilter+164↑j
                cmp     eax, 0C000008Fh
                jnz     short loc_5CD7E7
                mov     dword ptr [esi+58h], 86h
                mov     eax, dword ptr [esi+58h]
                push    eax
                push    8
                call    edx
                mov     ecx, dword ptr [esp+1Ch+var_4]
                add     esp, 8
                mov     [esi+58h], edi
                mov     [esi+54h], ecx
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CD7E7:                             ; CODE XREF: __XcptFilter+190↑j
                cmp     eax, 0C0000092h
                jnz     short loc_5CD7F5
                mov     dword ptr [esi+58h], 8Ah

loc_5CD7F5:                             ; CODE XREF: __XcptFilter+1BC↑j
                mov     eax, dword ptr [esi+58h]
                push    eax
                push    8
                call    edx
                mov     ecx, dword ptr [esp+1Ch+var_4]
                add     esp, 8
                mov     [esi+58h], edi
                mov     [esi+54h], ecx
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CD813:                             ; CODE XREF: __XcptFilter+6B↑j
                push    ecx
                mov     [eax+8], edi
                call    edx
                mov     ecx, dword ptr [esp+18h+var_4]
                add     esp, 4
                mov     [esi+54h], ecx
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CD82C:                             ; CODE XREF: __XcptFilter+21↑j
                mov     edx, dword ptr [esp+14h+ExceptionInfo]
                push    edx             ; ExceptionInfo
                call    UnhandledExceptionFilter
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
__XcptFilter    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_xcptlookup     proc near               ; CODE XREF: __XcptFilter+15↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     edx, dword ptr [esp+arg_0]
                push    esi
                mov     esi, [esp+4+arg_4]
                push    edi
                mov     edi, _XcptActTabCount
                mov     ecx, dword ptr [esi]
                mov     eax, esi
                cmp     ecx, edx
                jz      short loc_5CD869
                lea     ecx, [edi+edi*2]
                lea     ecx, [esi+ecx*4]

loc_5CD85E:                             ; CODE XREF: _xcptlookup+27↓j
                add     eax, 0Ch
                cmp     eax, ecx
                jnb     short loc_5CD869
                cmp     [eax], edx
                jnz     short loc_5CD85E

loc_5CD869:                             ; CODE XREF: _xcptlookup+16↑j
                lea     ecx, [edi+edi*2]
                lea     ecx, [esi+ecx*4]
                cmp     eax, ecx
                jnb     short loc_5CD877
                cmp     [eax], edx
                jz      short loc_5CD879

loc_5CD877:                             ; CODE XREF: _xcptlookup+31↑j
                xor     eax, eax

loc_5CD879:                             ; CODE XREF: _xcptlookup+35↑j
                pop     edi
                pop     esi
                retn
_xcptlookup     endp

; ---------------------------------------------------------------------------
                align 10h
                mov     eax, dword ptr [esp+4]
                push    1
                push    0
                push    eax
                call    _x_ismbbtype
                add     esp, 0Ch
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ismbbkprint(unsigned int C)
__ismbbkprint   proc near

varC               = dword ptr  4

                mov     eax, dword ptr [esp+varC]
                push    3
                push    0
                push    eax
                call    _x_ismbbtype
                add     esp, 0Ch
                retn
__ismbbkprint   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ismbbkpunct(unsigned int C)
__ismbbkpunct   proc near

varC               = dword ptr  4

                mov     eax, dword ptr [esp+varC]
                push    2
                push    0
                push    eax
                call    _x_ismbbtype
                add     esp, 0Ch
                retn
__ismbbkpunct   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ismbbalnum(unsigned int C)
__ismbbalnum    proc near

varC               = dword ptr  4

                mov     eax, dword ptr [esp+varC]
                push    1
                push    107h
                push    eax
                call    _x_ismbbtype
                add     esp, 0Ch
                retn
__ismbbalnum    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ismbbalpha(unsigned int C)
__ismbbalpha    proc near

varC               = dword ptr  4

                mov     eax, dword ptr [esp+varC]
                push    1
                push    103h
                push    eax
                call    _x_ismbbtype
                add     esp, 0Ch
                retn
__ismbbalpha    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ismbbgraph(unsigned int C)
__ismbbgraph    proc near

varC               = dword ptr  4

                mov     eax, dword ptr [esp+varC]
                push    3
                push    117h
                push    eax
                call    _x_ismbbtype
                add     esp, 0Ch
                retn
__ismbbgraph    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ismbbprint(unsigned int C)
__ismbbprint    proc near

varC               = dword ptr  4

                mov     eax, dword ptr [esp+varC]
                push    3
                push    157h
                push    eax
                call    _x_ismbbtype
                add     esp, 0Ch
                retn
__ismbbprint    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ismbbpunct(unsigned int C)
__ismbbpunct    proc near

varC               = dword ptr  4

                mov     eax, dword ptr [esp+varC]
                push    2
                push    10h
                push    eax
                call    _x_ismbbtype
                add     esp, 0Ch
                retn
__ismbbpunct    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ismbblead(unsigned int Ch)
__ismbblead     proc near               ; CODE XREF: start+EF↑p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                push    4
                push    0
                push    eax
                call    _x_ismbbtype
                add     esp, 0Ch
                retn
__ismbblead     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ismbbtrail(unsigned int Ch)
__ismbbtrail    proc near

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                push    8
                push    0
                push    eax
                call    _x_ismbbtype
                add     esp, 0Ch
                retn
__ismbbtrail    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ismbbkana(unsigned int C)
__ismbbkana     proc near

varC               = dword ptr  4

                cmp     dword_70D4BC, 3A4h
                jnz     short loc_5CD9E7
                mov     eax, dword ptr [esp+varC]
                push    3
                push    0
                push    eax
                call    _x_ismbbtype
                add     esp, 0Ch
                test    eax, eax
                jz      short loc_5CD9E7
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5CD9E7:                             ; CODE XREF: __ismbbkana+A↑j
                xor     eax, eax
                retn
__ismbbkana     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_x_ismbbtype    proc near               ; CODE XREF: .text:005CD889↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = byte ptr  0Ch

                mov     eax, dword ptr [esp+arg_0]
                mov     cl, [esp+arg_8]
                and     eax, 0FFh
                test    __mbctype+1h[eax], cl
                jnz     short loc_5CDA24
                mov     ecx, dword ptr [esp+arg_4]
                test    ecx, ecx
                jz      short loc_5CDA1D
                xor     edx, edx
                mov     dx, word ptr __ctype+2[eax*2]
                mov     eax, edx
                and     eax, ecx
                jmp     short loc_5CDA1F
; ---------------------------------------------------------------------------

loc_5CDA1D:                             ; CODE XREF: _x_ismbbtype+1B↑j
                xor     eax, eax

loc_5CDA1F:                             ; CODE XREF: _x_ismbbtype+2B↑j
                test    eax, eax
                jnz     short loc_5CDA24
                retn
; ---------------------------------------------------------------------------

loc_5CDA24:                             ; CODE XREF: _x_ismbbtype+13↑j
                mov     eax, 1
                retn
_x_ismbbtype    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__setenvp       proc near               ; CODE XREF: start+BF↑p

var_4           = dword ptr -4

                push    ecx
                mov     edx, dword_70D36C
                push    ebx
                push    ebp
                push    esi
                mov     al, [edx]
                xor     esi, esi
                test    al, al
                push    edi
                jz      short loc_5CDA60

loc_5CDA43:                             ; CODE XREF: __setenvp+2E↓j
                cmp     al, 3Dh ; '='
                jz      short loc_5CDA48
                inc     esi

loc_5CDA48:                             ; CODE XREF: __setenvp+15↑j
                mov     edi, edx
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                dec     ecx
                mov     al, [edx+ecx+1]
                lea     edx, [edx+ecx+1]
                test    al, al
                jnz     short loc_5CDA43

loc_5CDA60:                             ; CODE XREF: __setenvp+11↑j
                lea     eax, ds:4[esi*4]
                push    eax             ; varSize
                call    _malloc
                mov     esi, eax
                add     esp, 4
                test    esi, esi
                mov     [esp+14h+var_4], esi
                mov     dword_70D348, esi
                jnz     short loc_5CDA8A
                push    9
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5CDA8A:                             ; CODE XREF: __setenvp+4E↑j
                mov     ebp, dword_70D36C
                mov     dl, [ebp+0]
                test    dl, dl
                jz      short loc_5CDAFA

loc_5CDA97:                             ; CODE XREF: __setenvp+C8↓j
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                dec     ecx
                mov     ebx, ecx
                inc     ebx
                cmp     dl, 3Dh ; '='
                jz      short loc_5CDAF0
                push    ebx             ; varSize
                call    _malloc
                add     esp, 4
                mov     [esi], eax
                test    eax, eax
                jnz     short loc_5CDAC4
                push    9
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5CDAC4:                             ; CODE XREF: __setenvp+88↑j
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                mov     eax, dword ptr [esp+14h+var_4]
                not     ecx
                sub     edi, ecx
                mov     edx, ecx
                mov     esi, edi
                mov     edi, [eax]
                shr     ecx, 2
                rep movsd
                mov     ecx, edx
                and     ecx, 3
                add     eax, 4
                rep movsb
                mov     [esp+14h+var_4], eax
                mov     esi, eax

loc_5CDAF0:                             ; CODE XREF: __setenvp+79↑j
                mov     dl, [ebp+ebx+0]
                add     ebp, ebx
                test    dl, dl
                jnz     short loc_5CDA97

loc_5CDAFA:                             ; CODE XREF: __setenvp+65↑j
                mov     eax, dword_70D36C
                push    eax             ; Block
                call    _free
                add     esp, 4
                mov     dword_70D36C, 0
                mov     dword ptr [esi], 0
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
__setenvp       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__setargv       proc near               ; CODE XREF: start:loc_5C1C5A↑p

var_8           = dword ptr -8
var_4           = dword ptr -4

                sub     esp, 8
                push    esi
                push    edi
                push    104h            ; nSize
                push    offset g_Filename ; lpFilename
                push    0               ; hModule
                call    GetModuleFileNameA
                mov     edi, dword_70E970
                mov     dword_70D358, offset g_Filename
                cmp     byte ptr [edi], 0
                jnz     short loc_5CDB51
                mov     edi, offset g_Filename

loc_5CDB51:                             ; CODE XREF: __setargv+2A↑j
                lea     eax, [esp+10h+var_4]
                lea     ecx, [esp+10h+var_8]
                push    eax
                push    ecx
                push    0
                push    0
                push    edi
                call    _parse_cmdline
                mov     edx, dword ptr [esp+24h+var_4]
                mov     eax, dword ptr [esp+24h+var_8]
                add     esp, 14h
                lea     ecx, [edx+eax*4]
                push    ecx             ; varSize
                call    _malloc
                mov     esi, eax
                add     esp, 4
                test    esi, esi
                jnz     short loc_5CDB8C
                push    8
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5CDB8C:                             ; CODE XREF: __setargv+60↑j
                mov     ecx, dword ptr [esp+10h+var_8]
                lea     edx, [esp+10h+var_4]
                push    edx
                lea     eax, [esp+14h+var_8]
                lea     edx, [esi+ecx*4]
                push    eax
                push    edx
                push    esi
                push    edi
                call    _parse_cmdline
                mov     eax, dword ptr [esp+24h+var_8]
                add     esp, 14h
                dec     eax
                mov     __targv, esi
                pop     edi
                mov     __argc, eax
                pop     esi
                add     esp, 8
                retn
__setargv       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_parse_cmdline  proc near               ; CODE XREF: __setargv+40↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h

                mov     eax, dword ptr [esp+arg_C]
                push    ebx
                push    ebp
                mov     ebp, [esp+8+arg_4]
                push    esi
                mov     esi, [esp+0Ch+arg_8]
                push    edi
                mov     edi, [esp+10h+arg_10]
                test    ebp, ebp
                mov     dword ptr [edi], 0
                mov     dword ptr [eax], 1
                mov     eax, dword ptr [esp+10h+arg_0]
                mov     ebx, 4
                jz      short loc_5CDBF6
                mov     [ebp+0], esi
                add     ebp, ebx
                mov     [esp+10h+arg_4], ebp

loc_5CDBF6:                             ; CODE XREF: _parse_cmdline+2B↑j
                cmp     byte ptr [eax], 22h ; '"'
                jnz     short loc_5CDC51
                mov     cl, [eax+1]
                inc     eax
                cmp     cl, 22h ; '"'
                jz      short loc_5CDC3C

loc_5CDC04:                             ; CODE XREF: _parse_cmdline+7A↓j
                test    cl, cl
                jz      short loc_5CDC3C
                and     ecx, 0FFh
                test    __mbctype+1h[ecx], bl
                jz      short loc_5CDC25
                mov     edx, dword ptr [edi]
                inc     edx
                test    esi, esi
                mov     [edi], edx
                jz      short loc_5CDC25
                mov     cl, [eax]
                mov     [esi], cl
                inc     esi
                inc     eax

loc_5CDC25:                             ; CODE XREF: _parse_cmdline+54↑j
                mov     edx, dword ptr [edi]
                inc     edx
                test    esi, esi
                mov     [edi], edx
                jz      short loc_5CDC33
                mov     dl, [eax]
                mov     [esi], dl
                inc     esi

loc_5CDC33:                             ; CODE XREF: _parse_cmdline+6C↑j
                mov     cl, [eax+1]
                inc     eax
                cmp     cl, 22h ; '"'
                jnz     short loc_5CDC04

loc_5CDC3C:                             ; CODE XREF: _parse_cmdline+42↑j
                mov     edx, dword ptr [edi]
                inc     edx
                test    esi, esi
                mov     [edi], edx
                jz      short loc_5CDC49
                mov     byte ptr [esi], 0
                inc     esi

loc_5CDC49:                             ; CODE XREF: _parse_cmdline+83↑j
                cmp     byte ptr [eax], 22h ; '"'
                jnz     short loc_5CDCA4
                inc     eax
                jmp     short loc_5CDCA4
; ---------------------------------------------------------------------------

loc_5CDC51:                             ; CODE XREF: _parse_cmdline+39↑j
                mov     edx, dword ptr [edi]
                inc     edx
                test    esi, esi
                mov     [edi], edx
                jz      short loc_5CDC5F
                mov     cl, [eax]
                mov     [esi], cl
                inc     esi

loc_5CDC5F:                             ; CODE XREF: _parse_cmdline+98↑j
                mov     cl, [eax]
                inc     eax
                mov     byte ptr [esp+10h+arg_10], cl
                mov     edx, dword ptr [esp+10h+arg_10]
                and     edx, 0FFh
                test    __mbctype+1h[edx], bl
                jz      short loc_5CDC87
                mov     edx, dword ptr [edi]
                inc     edx
                test    esi, esi
                mov     [edi], edx
                jz      short loc_5CDC86
                mov     dl, [eax]
                mov     [esi], dl
                inc     esi

loc_5CDC86:                             ; CODE XREF: _parse_cmdline+BF↑j
                inc     eax

loc_5CDC87:                             ; CODE XREF: _parse_cmdline+B6↑j
                cmp     cl, 20h ; ' '
                jz      short loc_5CDC95
                test    cl, cl
                jz      short loc_5CDC99
                cmp     cl, 9
                jnz     short loc_5CDC51

loc_5CDC95:                             ; CODE XREF: _parse_cmdline+CA↑j
                test    cl, cl
                jnz     short loc_5CDC9C

loc_5CDC99:                             ; CODE XREF: _parse_cmdline+CE↑j
                dec     eax
                jmp     short loc_5CDCA4
; ---------------------------------------------------------------------------

loc_5CDC9C:                             ; CODE XREF: _parse_cmdline+D7↑j
                test    esi, esi
                jz      short loc_5CDCA4
                mov     byte ptr [esi-1], 0

loc_5CDCA4:                             ; CODE XREF: _parse_cmdline+8C↑j
                xor     edx, edx
                mov     [esp+10h+arg_10], edx

loc_5CDCAA:                             ; CODE XREF: _parse_cmdline+1F1↓j
                cmp     byte ptr [eax], 0
                jz      loc_5CDDB6

loc_5CDCB3:                             ; CODE XREF: _parse_cmdline+100↓j
                mov     cl, [eax]
                cmp     cl, 20h ; ' '
                jz      short loc_5CDCBF
                cmp     cl, 9
                jnz     short loc_5CDCC2

loc_5CDCBF:                             ; CODE XREF: _parse_cmdline+F8↑j
                inc     eax
                jmp     short loc_5CDCB3
; ---------------------------------------------------------------------------

loc_5CDCC2:                             ; CODE XREF: _parse_cmdline+FD↑j
                cmp     byte ptr [eax], 0
                jz      loc_5CDDB6
                test    ebp, ebp
                jz      short loc_5CDCD8
                mov     [ebp+0], esi
                add     ebp, ebx
                mov     [esp+10h+arg_4], ebp

loc_5CDCD8:                             ; CODE XREF: _parse_cmdline+10D↑j
                mov     ecx, dword ptr [esp+10h+arg_C]
                inc     dword ptr [ecx]

loc_5CDCDE:                             ; CODE XREF: _parse_cmdline+1B9↓j
                mov     bl, [eax]
                xor     ecx, ecx
                cmp     bl, 5Ch ; '\'
                mov     ebp, 1
                jnz     short loc_5CDCF6

loc_5CDCEC:                             ; CODE XREF: _parse_cmdline+134↓j
                mov     bl, [eax+1]
                inc     eax
                inc     ecx
                cmp     bl, 5Ch ; '\'
                jz      short loc_5CDCEC

loc_5CDCF6:                             ; CODE XREF: _parse_cmdline+12A↑j
                cmp     byte ptr [eax], 22h ; '"'
                jnz     short loc_5CDD20
                test    cl, 1
                jnz     short loc_5CDD1E
                test    edx, edx
                jz      short loc_5CDD0D
                cmp     byte ptr [eax+1], 22h ; '"'
                jnz     short loc_5CDD0D
                inc     eax
                jmp     short loc_5CDD0F
; ---------------------------------------------------------------------------

loc_5CDD0D:                             ; CODE XREF: _parse_cmdline+142↑j
                xor     ebp, ebp

loc_5CDD0F:                             ; CODE XREF: _parse_cmdline+14B↑j
                mov     ebx, dword ptr [esp+10h+arg_10]
                xor     edx, edx
                test    ebx, ebx
                setz    dl
                mov     [esp+10h+arg_10], edx

loc_5CDD1E:                             ; CODE XREF: _parse_cmdline+13E↑j
                shr     ecx, 1

loc_5CDD20:                             ; CODE XREF: _parse_cmdline+139↑j
                mov     ebx, ecx
                dec     ecx
                test    ebx, ebx
                jz      short loc_5CDD38
                inc     ecx

loc_5CDD28:                             ; CODE XREF: _parse_cmdline+176↓j
                test    esi, esi
                jz      short loc_5CDD30
                mov     byte ptr [esi], 5Ch ; '\'
                inc     esi

loc_5CDD30:                             ; CODE XREF: _parse_cmdline+16A↑j
                mov     ebx, dword ptr [edi]
                inc     ebx
                dec     ecx
                mov     [edi], ebx
                jnz     short loc_5CDD28

loc_5CDD38:                             ; CODE XREF: _parse_cmdline+165↑j
                mov     cl, [eax]
                test    cl, cl
                jz      short loc_5CDD9B
                test    edx, edx
                jnz     short loc_5CDD4C
                cmp     cl, 20h ; ' '
                jz      short loc_5CDD9B
                cmp     cl, 9
                jz      short loc_5CDD9B

loc_5CDD4C:                             ; CODE XREF: _parse_cmdline+180↑j
                test    ebp, ebp
                jz      short loc_5CDD95
                test    esi, esi
                jz      short loc_5CDD7E
                mov     ebx, ecx
                and     ebx, 0FFh
                test    __mbctype+1h[ebx], 4
                jz      short loc_5CDD6E
                mov     [esi], cl
                mov     ecx, dword ptr [edi]
                inc     esi
                inc     eax
                inc     ecx
                mov     [edi], ecx

loc_5CDD6E:                             ; CODE XREF: _parse_cmdline+1A3↑j
                mov     cl, [eax]
                mov     [esi], cl
                mov     ecx, dword ptr [edi]
                inc     esi
                inc     ecx
                mov     [edi], ecx
                inc     eax
                jmp     loc_5CDCDE
; ---------------------------------------------------------------------------

loc_5CDD7E:                             ; CODE XREF: _parse_cmdline+192↑j
                and     ecx, 0FFh
                test    __mbctype+1h[ecx], 4
                jz      short loc_5CDD93
                mov     ecx, dword ptr [edi]
                inc     eax
                inc     ecx
                mov     [edi], ecx

loc_5CDD93:                             ; CODE XREF: _parse_cmdline+1CB↑j
                inc     dword ptr [edi]

loc_5CDD95:                             ; CODE XREF: _parse_cmdline+18E↑j
                inc     eax
                jmp     loc_5CDCDE
; ---------------------------------------------------------------------------

loc_5CDD9B:                             ; CODE XREF: _parse_cmdline+17C↑j
                test    esi, esi
                jz      short loc_5CDDA3
                mov     byte ptr [esi], 0
                inc     esi

loc_5CDDA3:                             ; CODE XREF: _parse_cmdline+1DD↑j
                mov     ecx, dword ptr [edi]
                mov     ebp, [esp+10h+arg_4]
                inc     ecx
                mov     ebx, 4
                mov     [edi], ecx
                jmp     loc_5CDCAA
; ---------------------------------------------------------------------------

loc_5CDDB6:                             ; CODE XREF: _parse_cmdline+ED↑j
                test    ebp, ebp
                jz      short loc_5CDDC1
                mov     dword ptr [ebp+0], 0

loc_5CDDC1:                             ; CODE XREF: _parse_cmdline+1F8↑j
                mov     eax, dword ptr [esp+10h+arg_C]
                pop     edi
                pop     esi
                pop     ebp
                mov     ecx, dword ptr [eax]
                pop     ebx
                inc     ecx
                mov     [eax], ecx
                retn
_parse_cmdline  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___crtGetEnvironmentStringsW proc near

penv            = dword ptr -8
var_4           = dword ptr -4

                sub     esp, 8
                mov     eax, dword ptr Filename+104h
                push    ebx
                push    ebp
                push    esi
                mov     esi, ds:GetEnvironmentStringsW
                xor     ebx, ebx
                push    edi
                mov     edi, ds:GetEnvironmentStrings
                test    eax, eax
                mov     [esp+18h+penv], ebx
                mov     [esp+18h+var_4], ebx
                jnz     short loc_5CDE23
                call    esi ; GetEnvironmentStringsW
                test    eax, eax
                mov     [esp+18h+penv], eax
                jz      short loc_5CDE07
                mov     eax, 1
                jmp     short loc_5CDE1A
; ---------------------------------------------------------------------------

loc_5CDE07:                             ; CODE XREF: ___crtGetEnvironmentStringsW+2E↑j
                call    edi ; GetEnvironmentStrings
                test    eax, eax
                mov     [esp+18h+penv], eax
                jz      loc_5CDFC2
                mov     eax, 2

loc_5CDE1A:                             ; CODE XREF: ___crtGetEnvironmentStringsW+35↑j
                mov     ebx, dword ptr [esp+18h+penv]
                mov     dword ptr [g_Filename+104h], eax

loc_5CDE23:                             ; CODE XREF: ___crtGetEnvironmentStringsW+24↑j
                cmp     eax, 1
                jnz     loc_5CDEAC
                test    ebx, ebx
                jnz     short loc_5CDE46
                call    esi ; GetEnvironmentStringsW
                test    eax, eax
                mov     [esp+18h+penv], eax
                jnz     short loc_5CDE42
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5CDE42:                             ; CODE XREF: ___crtGetEnvironmentStringsW+68↑j
                mov     ebx, dword ptr [esp+18h+penv]

loc_5CDE46:                             ; CODE XREF: ___crtGetEnvironmentStringsW+5E↑j
                cmp     word ptr [ebx], 0
                mov     eax, ebx
                jz      short loc_5CDE60

loc_5CDE4E:                             ; CODE XREF: ___crtGetEnvironmentStringsW+85↓j
                add     eax, 2
                cmp     word ptr [eax], 0
                jnz     short loc_5CDE4E
                add     eax, 2
                cmp     word ptr [eax], 0
                jnz     short loc_5CDE4E

loc_5CDE60:                             ; CODE XREF: ___crtGetEnvironmentStringsW+7C↑j
                sub     eax, ebx
                add     eax, 2
                mov     esi, eax
                push    esi             ; varSize
                call    _malloc
                mov     ebp, eax
                add     esp, 4
                test    ebp, ebp
                jnz     short loc_5CDE87
                push    ebx             ; penv
                call    FreeEnvironmentStringsW
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5CDE87:                             ; CODE XREF: ___crtGetEnvironmentStringsW+A4↑j
                mov     ecx, esi
                mov     esi, ebx
                mov     eax, ecx
                mov     edi, ebp
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                push    ebx             ; penv
                and     ecx, 3
                rep movsb
                call    FreeEnvironmentStringsW
                mov     eax, ebp
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5CDEAC:                             ; CODE XREF: ___crtGetEnvironmentStringsW+56↑j
                cmp     eax, 2
                jnz     loc_5CDFA6
                test    ebx, ebx
                jnz     short loc_5CDECF
                call    edi ; GetEnvironmentStrings
                test    eax, eax
                mov     [esp+18h+penv], eax
                jnz     short loc_5CDECB
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5CDECB:                             ; CODE XREF: ___crtGetEnvironmentStringsW+F1↑j
                mov     ebx, dword ptr [esp+18h+penv]

loc_5CDECF:                             ; CODE XREF: ___crtGetEnvironmentStringsW+E7↑j
                mov     al, [ebx]
                mov     esi, ebx
                test    al, al
                jz      short loc_5CDF17

loc_5CDED7:                             ; CODE XREF: ___crtGetEnvironmentStringsW+145↓j
                mov     ecx, CodePage
                push    0               ; cchWideChar
                push    0               ; lpWideCharStr
                push    0FFFFFFFFh      ; cbMultiByte
                push    esi             ; lpMultiByteStr
                push    1               ; dwFlags
                push    ecx             ; CodePage
                call    MultiByteToWideChar
                test    eax, eax
                jz      loc_5CDFC2
                mov     ebp, [esp+18h+var_4]
                mov     edi, esi
                add     ebp, eax
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                mov     [esp+18h+var_4], ebp
                repne scasb
                not     ecx
                dec     ecx
                mov     al, [esi+ecx+1]
                lea     esi, [esi+ecx+1]
                test    al, al
                jnz     short loc_5CDED7

loc_5CDF17:                             ; CODE XREF: ___crtGetEnvironmentStringsW+105↑j
                mov     eax, dword ptr [esp+18h+var_4]
                inc     eax
                mov     [esp+18h+var_4], eax
                lea     edx, [eax+eax]
                push    edx             ; varSize
                call    _malloc
                mov     ebp, eax
                add     esp, 4
                test    ebp, ebp
                jnz     short loc_5CDF43
                push    ebx             ; penv
                call    FreeEnvironmentStringsA
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5CDF43:                             ; CODE XREF: ___crtGetEnvironmentStringsW+160↑j
                mov     eax, dword ptr [esp+18h+penv]
                mov     esi, ebp
                cmp     byte ptr [eax], 0
                jz      short loc_5CDF94

loc_5CDF4E:                             ; CODE XREF: ___crtGetEnvironmentStringsW+1C2↓j
                mov     edx, dword ptr [esp+18h+var_4]
                mov     ecx, esi
                sub     ecx, ebp
                mov     eax, CodePage
                sar     ecx, 1
                sub     edx, ecx
                push    edx             ; cchWideChar
                push    esi             ; lpWideCharStr
                push    0FFFFFFFFh      ; cbMultiByte
                push    ebx             ; lpMultiByteStr
                push    1               ; dwFlags
                push    eax             ; CodePage
                call    MultiByteToWideChar
                test    eax, eax
                jz      short loc_5CDFAE
                mov     edi, ebx
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                push    esi             ; String
                repne scasb
                not     ecx
                dec     ecx
                lea     ebx, [ebx+ecx+1]
                call    _wcslen
                lea     esi, [esi+eax*2+2]
                mov     al, [ebx]
                add     esp, 4
                test    al, al
                jnz     short loc_5CDF4E

loc_5CDF94:                             ; CODE XREF: ___crtGetEnvironmentStringsW+17C↑j
                mov     edx, dword ptr [esp+18h+penv]
                mov     word ptr [esi], 0
                push    edx             ; penv
                call    FreeEnvironmentStringsA
                mov     eax, ebp

loc_5CDFA6:                             ; CODE XREF: ___crtGetEnvironmentStringsW+DF↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5CDFAE:                             ; CODE XREF: ___crtGetEnvironmentStringsW+19F↑j
                push    ebp             ; Block
                call    _free
                mov     ecx, dword ptr [esp+1Ch+penv]
                add     esp, 4
                push    ecx             ; penv
                call    FreeEnvironmentStringsA

loc_5CDFC2:                             ; CODE XREF: ___crtGetEnvironmentStringsW+3F↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                add     esp, 8
                retn
___crtGetEnvironmentStringsW endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___crtGetEnvironmentStringsA proc near  ; CODE XREF: start+99↑p
                mov     eax, dword_70D6A8
                push    ebx
                push    ebp
                mov     ebp, ds:GetEnvironmentStrings
                push    esi
                xor     esi, esi
                xor     ebx, ebx
                push    edi
                mov     edi, ds:GetEnvironmentStringsW
                test    eax, eax
                jnz     short loc_5CE012
                call    edi ; GetEnvironmentStringsW
                mov     esi, eax
                test    esi, esi
                jz      short loc_5CDFFC
                mov     eax, 1
                jmp     short loc_5CE00D
; ---------------------------------------------------------------------------

loc_5CDFFC:                             ; CODE XREF: ___crtGetEnvironmentStringsA+23↑j
                call    ebp ; GetEnvironmentStrings
                mov     ebx, eax
                test    ebx, ebx
                jz      loc_5CE11F
                mov     eax, 2

loc_5CE00D:                             ; CODE XREF: ___crtGetEnvironmentStringsA+2A↑j
                mov     dword_70D6A8, eax

loc_5CE012:                             ; CODE XREF: ___crtGetEnvironmentStringsA+1B↑j
                cmp     eax, 1
                jnz     loc_5CE0B2
                test    esi, esi
                jnz     short loc_5CE02B
                call    edi ; GetEnvironmentStringsW
                mov     esi, eax
                test    esi, esi
                jz      loc_5CE11F

loc_5CE02B:                             ; CODE XREF: ___crtGetEnvironmentStringsA+4D↑j
                cmp     word ptr [esi], 0
                mov     eax, esi
                jz      short loc_5CE045

loc_5CE033:                             ; CODE XREF: ___crtGetEnvironmentStringsA+6A↓j
                add     eax, 2
                cmp     word ptr [eax], 0
                jnz     short loc_5CE033
                add     eax, 2
                cmp     word ptr [eax], 0
                jnz     short loc_5CE033

loc_5CE045:                             ; CODE XREF: ___crtGetEnvironmentStringsA+61↑j
                sub     eax, esi
                push    0               ; lpUsedDefaultChar
                sar     eax, 1
                inc     eax
                push    0               ; lpDefaultChar
                mov     ebp, eax
                push    0               ; cbMultiByte
                push    0               ; lpMultiByteStr
                push    ebp             ; cchWideChar
                push    esi             ; lpWideCharStr
                push    0               ; dwFlags
                push    0               ; CodePage
                call    WideCharToMultiByte
                mov     edi, eax
                test    edi, edi
                jz      short loc_5CE0A4
                push    edi             ; varSize
                call    _malloc
                mov     ebx, eax
                add     esp, 4
                test    ebx, ebx
                jz      short loc_5CE0A4
                push    0               ; lpUsedDefaultChar
                push    0               ; lpDefaultChar
                push    edi             ; cbMultiByte
                push    ebx             ; lpMultiByteStr
                push    ebp             ; cchWideChar
                push    esi             ; lpWideCharStr
                push    0               ; dwFlags
                push    0               ; CodePage
                call    WideCharToMultiByte
                test    eax, eax
                jnz     short loc_5CE096
                push    ebx             ; Block
                call    _free
                add     esp, 4
                xor     ebx, ebx

loc_5CE096:                             ; CODE XREF: ___crtGetEnvironmentStringsA+B9↑j
                push    esi             ; penv
                call    FreeEnvironmentStringsW
                mov     eax, ebx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CE0A4:                             ; CODE XREF: ___crtGetEnvironmentStringsA+94↑j
                push    esi             ; penv
                call    FreeEnvironmentStringsW
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CE0B2:                             ; CODE XREF: ___crtGetEnvironmentStringsA+45↑j
                cmp     eax, 2
                jnz     short loc_5CE11F
                test    ebx, ebx
                jnz     short loc_5CE0C3
                call    ebp ; GetEnvironmentStrings
                mov     ebx, eax
                test    ebx, ebx
                jz      short loc_5CE11F

loc_5CE0C3:                             ; CODE XREF: ___crtGetEnvironmentStringsA+E9↑j
                mov     cl, [ebx]
                mov     eax, ebx
                test    cl, cl
                jz      short loc_5CE0DB

loc_5CE0CB:                             ; CODE XREF: ___crtGetEnvironmentStringsA+101↓j
                mov     cl, [eax+1]
                inc     eax
                test    cl, cl
                jnz     short loc_5CE0CB
                mov     cl, [eax+1]
                inc     eax
                test    cl, cl
                jnz     short loc_5CE0CB

loc_5CE0DB:                             ; CODE XREF: ___crtGetEnvironmentStringsA+F9↑j
                sub     eax, ebx
                inc     eax
                mov     esi, eax
                push    esi             ; varSize
                call    _malloc
                mov     ebp, eax
                add     esp, 4
                test    ebp, ebp
                jnz     short loc_5CE0FD
                push    ebx             ; penv
                call    FreeEnvironmentStringsA
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CE0FD:                             ; CODE XREF: ___crtGetEnvironmentStringsA+11D↑j
                mov     ecx, esi
                mov     esi, ebx
                mov     eax, ecx
                mov     edi, ebp
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                push    ebx             ; penv
                and     ecx, 3
                rep movsb
                call    FreeEnvironmentStringsA
                mov     eax, ebp
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CE11F:                             ; CODE XREF: ___crtGetEnvironmentStringsA+32↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                retn
___crtGetEnvironmentStringsA endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__ioinit        proc near               ; CODE XREF: start+84↑p

var_48          = dword ptr -48h
StartupInfo     = _STARTUPINFOA ptr -44h

                sub     esp, 48h
                push    ebx
                push    ebp
                push    esi
                push    edi
                push    480h            ; varSize
                call    _malloc
                mov     esi, eax
                xor     edi, edi
                add     esp, 4
                cmp     esi, edi
                jnz     short loc_5CE156
                push    1Bh
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5CE156:                             ; CODE XREF: __ioinit+1A↑j
                lea     eax, [esi+480h]
                mov     __pioinfo, esi
                cmp     esi, eax
                mov     uNumber, 20h ; ' '
                mov     bl, 0Ah
                jnb     short loc_5CE195

loc_5CE172:                             ; CODE XREF: __ioinit+63↓j
                mov     byte ptr [esi+4], 0
                mov     dword ptr [esi], 0FFFFFFFFh
                mov     [esi+5], bl
                mov     [esi+8], edi
                mov     ecx, __pioinfo
                add     esi, 24h ; '$'
                add     ecx, 480h
                cmp     esi, ecx
                jb      short loc_5CE172

loc_5CE195:                             ; CODE XREF: __ioinit+40↑j
                lea     edx, [esp+58h+StartupInfo]
                push    edx             ; lpStartupInfo
                call    GetStartupInfoA
                cmp     [esp+58h+StartupInfo.cbReserved2], di
                jz      loc_5CE2A8
                mov     eax, dword ptr [esp+58h+StartupInfo.lpReserved2]
                cmp     eax, edi
                jz      loc_5CE2A8
                mov     ecx, dword ptr [eax]
                lea     edi, [eax+4]
                cmp     ecx, 800h
                mov     [esp+58h+var_48], ecx
                lea     ebp, [edi+ecx]
                jl      short loc_5CE1D3
                mov     [esp+58h+var_48], 800h

loc_5CE1D3:                             ; CODE XREF: __ioinit+99↑j
                mov     eax, dword ptr [esp+58h+var_48]
                mov     ecx, uNumber
                cmp     ecx, eax
                jge     short loc_5CE251
                mov     esi, offset __pioinfo+4h

loc_5CE1E6:                             ; CODE XREF: __ioinit+111↓j
                push    480h            ; varSize
                call    _malloc
                xor     ecx, ecx
                add     esp, 4
                cmp     eax, ecx
                jz      short loc_5CE245
                mov     edx, uNumber
                mov     [esi], eax
                add     edx, 20h ; ' '
                mov     uNumber, edx
                lea     edx, [eax+480h]
                cmp     eax, edx
                jnb     short loc_5CE233

loc_5CE214:                             ; CODE XREF: __ioinit+101↓j
                mov     byte ptr [eax+4], 0
                mov     dword ptr [eax], 0FFFFFFFFh
                mov     [eax+5], bl
                mov     [eax+8], ecx
                mov     edx, dword ptr [esi]
                add     eax, 24h ; '$'
                add     edx, 480h
                cmp     eax, edx
                jb      short loc_5CE214

loc_5CE233:                             ; CODE XREF: __ioinit+E2↑j
                mov     eax, uNumber
                mov     edx, dword ptr [esp+58h+var_48]
                add     esi, 4
                cmp     eax, edx
                jl      short loc_5CE1E6
                jmp     short loc_5CE253
; ---------------------------------------------------------------------------

loc_5CE245:                             ; CODE XREF: __ioinit+C7↑j
                mov     edx, uNumber
                mov     [esp+58h+var_48], edx
                jmp     short loc_5CE253
; ---------------------------------------------------------------------------

loc_5CE251:                             ; CODE XREF: __ioinit+AF↑j
                xor     ecx, ecx

loc_5CE253:                             ; CODE XREF: __ioinit+113↑j
                mov     eax, dword ptr [esp+58h+var_48]
                xor     esi, esi
                cmp     eax, ecx
                jle     short loc_5CE2A8

loc_5CE25D:                             ; CODE XREF: __ioinit+176↓j
                mov     ecx, dword ptr [ebp+0]
                cmp     ecx, 0FFFFFFFFh
                jz      short loc_5CE29B
                mov     al, [edi]
                test    al, 1
                jz      short loc_5CE29B
                test    al, 8
                jnz     short loc_5CE27A
                push    ecx             ; hFile
                call    GetFileType
                test    eax, eax
                jz      short loc_5CE29B

loc_5CE27A:                             ; CODE XREF: __ioinit+13D↑j
                mov     ecx, esi
                mov     eax, esi
                sar     ecx, 5
                and     eax, 1Fh
                lea     edx, [eax+eax*8]
                mov     eax, __pioinfo[ecx*4]
                mov     ecx, dword ptr [ebp+0]
                lea     eax, [eax+edx*4]
                mov     [eax], ecx
                mov     dl, [edi]
                mov     [eax+4], dl

loc_5CE29B:                             ; CODE XREF: __ioinit+133↑j
                mov     eax, dword ptr [esp+58h+var_48]
                inc     esi
                inc     edi
                add     ebp, 4
                cmp     esi, eax
                jl      short loc_5CE25D

loc_5CE2A8:                             ; CODE XREF: __ioinit+75↑j
                mov     ebx, ds:GetStdHandle
                xor     ebp, ebp

loc_5CE2B0:                             ; CODE XREF: __ioinit+1F5↓j
                mov     ecx, __pioinfo
                lea     eax, [ebp+ebp*8+0]
                lea     esi, [ecx+eax*4]
                mov     eax, dword ptr [ecx+eax*4]
                cmp     eax, 0FFFFFFFFh
                jnz     short loc_5CE319
                test    ebp, ebp
                mov     byte ptr [esi+4], 81h
                jnz     short loc_5CE2D4
                mov     eax, 0FFFFFFF6h
                jmp     short loc_5CE2DE
; ---------------------------------------------------------------------------

loc_5CE2D4:                             ; CODE XREF: __ioinit+19B↑j
                mov     eax, ebp
                dec     eax
                neg     eax
                sbb     eax, eax
                add     eax, 0FFFFFFF5h

loc_5CE2DE:                             ; CODE XREF: __ioinit+1A2↑j
                push    eax             ; nStdHandle
                call    ebx ; GetStdHandle
                mov     edi, eax
                cmp     edi, 0FFFFFFFFh
                jz      short loc_5CE312
                push    edi             ; hFile
                call    GetFileType
                test    eax, eax
                jz      short loc_5CE312
                and     eax, 0FFh
                mov     [esi], edi
                cmp     eax, 2
                jnz     short loc_5CE306
                mov     al, [esi+4]
                or      al, 40h
                jmp     short loc_5CE31E
; ---------------------------------------------------------------------------

loc_5CE306:                             ; CODE XREF: __ioinit+1CD↑j
                cmp     eax, 3
                jnz     short loc_5CE321
                mov     al, [esi+4]
                or      al, 8
                jmp     short loc_5CE31E
; ---------------------------------------------------------------------------

loc_5CE312:                             ; CODE XREF: __ioinit+1B6↑j
                mov     al, [esi+4]
                or      al, 40h
                jmp     short loc_5CE31E
; ---------------------------------------------------------------------------

loc_5CE319:                             ; CODE XREF: __ioinit+193↑j
                mov     al, [esi+4]
                or      al, 80h

loc_5CE31E:                             ; CODE XREF: __ioinit+1D4↑j
                mov     [esi+4], al

loc_5CE321:                             ; CODE XREF: __ioinit+1D9↑j
                inc     ebp
                cmp     ebp, 3
                jl      short loc_5CE2B0
                mov     edx, uNumber
                push    edx             ; uNumber
                call    SetHandleCount
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 48h
                retn
__ioinit        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__ioterm        proc near
                push    ebx
                push    ebp
                mov     ebp, ds:DeleteCriticalSection
                push    esi
                push    edi
                mov     ebx, offset __pioinfo

loc_5CE34F:                             ; CODE XREF: __ioterm+58↓j
                mov     esi, [ebx]
                test    esi, esi
                jz      short loc_5CE38F
                lea     eax, [esi+480h]
                cmp     esi, eax
                jnb     short loc_5CE37E
                lea     edi, [esi+0Ch]

loc_5CE362:                             ; CODE XREF: __ioterm+3C↓j
                mov     eax, dword ptr [edi-4]
                test    eax, eax
                jz      short loc_5CE36C
                push    edi             ; lpCriticalSection
                call    ebp ; DeleteCriticalSection

loc_5CE36C:                             ; CODE XREF: __ioterm+27↑j
                mov     ecx, dword ptr [ebx]
                add     esi, 24h ; '$'
                add     ecx, 480h
                add     edi, 24h ; '$'
                cmp     esi, ecx
                jb      short loc_5CE362

loc_5CE37E:                             ; CODE XREF: __ioterm+1D↑j
                mov     edx, dword ptr [ebx]
                push    edx             ; Block
                call    _free
                add     esp, 4
                mov     dword ptr [ebx], 0

loc_5CE38F:                             ; CODE XREF: __ioterm+13↑j
                add     ebx, 4
                cmp     ebx, offset uNumber
                jl      short loc_5CE34F
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
__ioterm        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__fltin2        proc near               ; CODE XREF: _atof+51↑p

var_14          = dword ptr -14h
var_10          = dword ptr -10h
var_C           = byte ptr -0Ch
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                sub     esp, 14h
                lea     eax, [esp+14h+arg_4]
                lea     ecx, [esp+14h+var_C]
                push    ebx
                push    ebp
                mov     ebp, [esp+1Ch+arg_4]
                push    esi
                xor     esi, esi
                push    esi
                push    esi
                push    esi
                push    esi
                push    ebp
                push    eax
                push    ecx
                call    ___strgtold12
                mov     ebx, eax
                add     esp, 1Ch
                test    bl, 4
                jz      short loc_5CE3E1
                mov     esi, 200h
                mov     [esp+20h+var_14], 0
                mov     [esp+20h+var_10], 0
                jmp     short loc_5CE412
; ---------------------------------------------------------------------------

loc_5CE3E1:                             ; CODE XREF: __fltin2+28↑j
                lea     edx, [esp+20h+var_14]
                lea     eax, [esp+20h+var_C]
                push    edx
                push    eax
                call    sub_5CFF00
                add     esp, 8
                test    bl, 2
                jnz     short loc_5CE3FD
                cmp     eax, 1
                jnz     short loc_5CE402

loc_5CE3FD:                             ; CODE XREF: __fltin2+56↑j
                mov     esi, 80h

loc_5CE402:                             ; CODE XREF: __fltin2+5B↑j
                test    bl, 1
                jnz     short loc_5CE40C
                cmp     eax, 2
                jnz     short loc_5CE412

loc_5CE40C:                             ; CODE XREF: __fltin2+65↑j
                or      esi, 100h

loc_5CE412:                             ; CODE XREF: __fltin2+3F↑j
                mov     ecx, dword ptr [esp+20h+arg_4]
                mov     eax, dword ptr [esp+20h+arg_0]
                mov     edx, dword ptr [esp+20h+var_14]
                sub     ecx, ebp
                mov     [eax], esi
                mov     [eax+4], ecx
                mov     ecx, dword ptr [esp+20h+var_10]
                pop     esi
                mov     [eax+10h], edx
                pop     ebp
                mov     [eax+14h], ecx
                pop     ebx
                add     esp, 14h
                retn
__fltin2        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__stbuf         proc near               ; CODE XREF: _fprintf+11↑p

arg_0           = dword ptr  4

                push    esi
                mov     esi, [esp+4+arg_0]
                push    edi
                mov     eax, dword ptr [esi+10h]
                push    eax             ; FileHandle
                call    __isatty
                add     esp, 4
                test    eax, eax
                jz      loc_5CE4DA
                cmp     esi, offset _stdout
                jnz     short loc_5CE466
                xor     edi, edi
                jmp     short loc_5CE473
; ---------------------------------------------------------------------------

loc_5CE466:                             ; CODE XREF: __stbuf+20↑j
                cmp     esi, offset _stderr
                jnz     short loc_5CE4DA
                mov     edi, 1

loc_5CE473:                             ; CODE XREF: __stbuf+24↑j
                mov     ecx, dword_70D6B8
                inc     ecx
                mov     dword_70D6B8, ecx
                mov     eax, dword ptr [esi+0Ch]
                test    eax, 10Ch
                jnz     short loc_5CE4DA
                mov     eax, dword_70D6B0[edi*4]
                test    eax, eax
                jnz     short loc_5CE4AD
                push    1000h           ; varSize
                call    _malloc
                add     esp, 4
                mov     dword_70D6B0[edi*4], eax
                test    eax, eax
                jz      short loc_5CE4DA

loc_5CE4AD:                             ; CODE XREF: __stbuf+53↑j
                mov     eax, dword_70D6B0[edi*4]
                mov     dword ptr [esi+18h], 1000h
                mov     [esi+8], eax
                mov     [esi], eax
                mov     eax, dword ptr [esi+0Ch]
                mov     dword ptr [esi+4], 1000h
                or      eax, 1102h
                mov     [esi+0Ch], eax
                mov     eax, 1
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CE4DA:                             ; CODE XREF: __stbuf+14↑j
                pop     edi
                xor     eax, eax
                pop     esi
                retn
__stbuf         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__ftbuf         proc near               ; CODE XREF: _fprintf+32↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     eax, dword ptr [esp+arg_0]
                push    esi
                test    eax, eax
                jz      short loc_5CE51B
                mov     esi, [esp+4+arg_4]
                mov     eax, dword ptr [esi+0Ch]
                test    ah, 10h
                jz      short loc_5CE51B
                push    esi
                call    __flush
                mov     eax, dword ptr [esi+0Ch]
                add     esp, 4
                and     ah, 0EEh
                mov     dword ptr [esi+18h], 0
                mov     [esi+0Ch], eax
                mov     dword ptr [esi], 0
                mov     dword ptr [esi+8], 0

loc_5CE51B:                             ; CODE XREF: __ftbuf+7↑j
                pop     esi
                retn
__ftbuf         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; intptr_t __cdecl _spawnvp(int Mode, const char *FileName, const char *const *Arguments)
__spawnvp       proc near               ; CODE XREF: __spawnlp+F↑p

Mode            = dword ptr  4
FileName        = dword ptr  8
Arguments       = dword ptr  0Ch

                mov     eax, dword ptr [esp+Arguments]
                mov     ecx, dword ptr [esp+FileName]
                mov     edx, dword ptr [esp+Mode]
                push    0               ; Environment
                push    eax             ; Arguments
                push    ecx             ; FileName
                push    edx             ; Mode
                call    __spawnvpe
                add     esp, 10h
                retn
__spawnvp       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___initstdio    proc near               ; DATA XREF: .data:0062C244↓o
                mov     eax, Count
                push    esi
                test    eax, eax
                jnz     short loc_5CE551
                mov     eax, 200h
                jmp     short loc_5CE55B
; ---------------------------------------------------------------------------

loc_5CE551:                             ; CODE XREF: ___initstdio+8↑j
                cmp     eax, 14h
                jge     short loc_5CE560
                mov     eax, 14h

loc_5CE55B:                             ; CODE XREF: ___initstdio+F↑j
                mov     [g_Count], eax

loc_5CE560:                             ; CODE XREF: ___initstdio+14↑j
                push    4               ; varSize
                push    eax             ; Count
                call    _calloc
                add     esp, 8
                mov     dword_70D838, eax
                test    eax, eax
                jnz     short loc_5CE5A2
                push    4               ; varSize
                push    14h             ; Count
                mov     [g_Count], 14h
                call    _calloc
                add     esp, 8
                mov     dword_70D838, eax
                test    eax, eax
                jnz     short loc_5CE5A2
                push    1Ah
                call    __amsg_exit
; ---------------------------------------------------------------------------
                mov     eax, dword_70D838
                add     esp, 4

loc_5CE5A2:                             ; CODE XREF: ___initstdio+32↑j
                xor     edx, edx
                mov     ecx, offset off_641900
                jmp     short loc_5CE5B0
; ---------------------------------------------------------------------------

loc_5CE5AB:                             ; CODE XREF: ___initstdio+7F↓j
                mov     eax, dword_70D838

loc_5CE5B0:                             ; CODE XREF: ___initstdio+69↑j
                mov     [eax+edx], ecx
                add     ecx, 20h ; ' '
                add     edx, 4
                cmp     ecx, offset dword_641B80
                jl      short loc_5CE5AB
                xor     ecx, ecx
                mov     edx, offset unk_641910

loc_5CE5C8:                             ; CODE XREF: ___initstdio+B8↓j
                mov     esi, ecx
                mov     eax, ecx
                sar     esi, 5
                and     eax, 1Fh
                mov     esi, __pioinfo[esi*4]
                lea     eax, [eax+eax*8]
                mov     eax, dword ptr [esi+eax*4]
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5CE5E8
                test    eax, eax
                jnz     short loc_5CE5EE

loc_5CE5E8:                             ; CODE XREF: ___initstdio+A2↑j
                mov     dword ptr [edx], 0FFFFFFFFh

loc_5CE5EE:                             ; CODE XREF: ___initstdio+A6↑j
                add     edx, 20h ; ' '
                inc     ecx
                cmp     edx, offset unk_641970
                jl      short loc_5CE5C8
                pop     esi
                retn
___initstdio    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___endstdio     proc near               ; DATA XREF: .data:0062C254↓o
                call    __flushall
                mov     al, _exitflag
                test    al, al
                jz      short locret_5CE613
                jmp     __fcloseall
; ---------------------------------------------------------------------------

locret_5CE613:                          ; CODE XREF: ___endstdio+C↑j
                retn
___endstdio     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___loctotime_t  proc near               ; CODE XREF: _time+110↑p

var_24          = byte ptr -24h
var_1C          = dword ptr -1Ch
var_14          = dword ptr -14h
var_10          = dword ptr -10h
var_8           = dword ptr -8
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h
arg_14          = dword ptr  18h
arg_18          = dword ptr  1Ch

                sub     esp, 24h
                push    ebx
                mov     ebx, dword ptr [esp+28h+arg_0]
                sub     ebx, 76Ch
                push    ebp
                push    esi
                cmp     ebx, 46h ; 'F'
                push    edi
                jl      loc_5CE6F7
                cmp     ebx, 8Ah
                jg      loc_5CE6F7
                mov     edi, [esp+34h+arg_4]
                mov     ecx, dword ptr [esp+34h+arg_8]
                mov     esi, dword_641C6C[edi*4]
                add     esi, ecx
                test    bl, 3
                jnz     short loc_5CE662
                cmp     edi, 2
                jle     short loc_5CE662
                inc     esi

loc_5CE662:                             ; CODE XREF: ___loctotime_t+3A↑j
                call    ___tzset
                lea     eax, [ebx+ebx*8]
                mov     [esp+34h+var_8], esi
                mov     [esp+34h+var_10], ebx
                lea     ecx, [ebx+eax*8]
                lea     eax, [ebx-1]
                mov     edx, ecx
                add     edx, esi
                sar     eax, 2
                lea     ecx, [edx+ecx*4]
                add     eax, ecx
                mov     ecx, dword ptr [esp+34h+arg_C]
                mov     [esp+34h+var_1C], ecx
                lea     edx, [eax+eax*2]
                lea     eax, [ecx+edx*8]
                mov     edx, eax
                shl     edx, 4
                sub     edx, eax
                mov     eax, dword ptr [esp+34h+arg_10]
                lea     eax, [eax+edx*4]
                mov     edx, eax
                shl     edx, 4
                sub     edx, eax
                mov     eax, dword ptr [esp+34h+arg_14]
                dec     edi
                lea     edx, [eax+edx*4]
                mov     eax, dword_641B80
                mov     [esp+34h+var_14], edi
                lea     ebp, [edx+eax+7C558180h]
                mov     eax, dword ptr [esp+34h+arg_18]
                cmp     eax, 1
                jz      short loc_5CE6E7
                cmp     eax, 0FFFFFFFFh
                jnz     short loc_5CE6ED
                mov     eax, dword_641B84
                test    eax, eax
                jz      short loc_5CE6ED
                lea     ecx, [esp+34h+var_24]
                push    ecx
                call    __isindst
                add     esp, 4
                test    eax, eax
                jz      short loc_5CE6ED

loc_5CE6E7:                             ; CODE XREF: ___loctotime_t+A6↑j
                add     ebp, dword_641B88

loc_5CE6ED:                             ; CODE XREF: ___loctotime_t+AB↑j
                mov     eax, ebp
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 24h
                retn
; ---------------------------------------------------------------------------

loc_5CE6F7:                             ; CODE XREF: ___loctotime_t+14↑j
                pop     edi
                pop     esi
                pop     ebp
                or      eax, 0FFFFFFFFh
                pop     ebx
                add     esp, 24h
                retn
___loctotime_t  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; char *__cdecl strpbrk(const char *varStr, const char *Control)
_strpbrk        proc near               ; CODE XREF: __mbspbrk+13↑p

var_24          = dword ptr -24h
varStr             = dword ptr  8
Control         = dword ptr  0Ch

                push    ebp
                mov     ebp, esp
                push    esi
                xor     eax, eax
                push    eax
                push    eax
                push    eax
                push    eax
                push    eax
                push    eax
                push    eax
                push    eax
                mov     edx, dword ptr [ebp+Control]
                db      2Eh
                mov     eax, eax

loc_5CE724:                             ; CODE XREF: _strpbrk+1F↓j
                mov     al, [edx]
                or      al, al
                jz      short loc_5CE731
                inc     edx
                bts     [esp+24h+var_24], eax
                jmp     short loc_5CE724
; ---------------------------------------------------------------------------

loc_5CE731:                             ; CODE XREF: _strpbrk+18↑j
                mov     esi, [ebp+varStr]

loc_5CE734:                             ; CODE XREF: _strpbrk+2F↓j
                mov     al, [esi]
                or      al, al
                jz      short loc_5CE744
                inc     esi
                bt      [esp+24h+var_24], eax
                jnb     short loc_5CE734
                lea     eax, [esi-1]

loc_5CE744:                             ; CODE XREF: _strpbrk+28↑j
                add     esp, 20h
                pop     esi
                leave
                retn
_strpbrk        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; char *__cdecl _strrev(char *varStr)
__strrev        proc near               ; CODE XREF: __mbsrev+15↑p

varStr             = dword ptr  8

                push    ebp
                mov     ebp, esp
                push    edi
                push    esi
                mov     edi, [ebp+varStr]
                mov     edx, edi
                mov     esi, edi
                xor     eax, eax
                or      ecx, 0FFFFFFFFh
                repne scasb
                cmp     ecx, 0FFFFFFFEh
                jz      short done_0
                dec     edi
                dec     edi

lupe:                                   ; CODE XREF: __strrev+28↓j
                cmp     esi, edi
                jnb     short done_0
                mov     ah, [esi]
                mov     al, [edi]
                mov     [esi], al
                mov     [edi], ah
                inc     esi
                dec     edi
                jmp     short lupe
; ---------------------------------------------------------------------------

done_0:                                 ; CODE XREF: __strrev+16↑j
                mov     eax, edx
                pop     esi
                pop     edi
                leave
                retn
__strrev        endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; size_t __cdecl strspn(const char *varStr, const char *Control)
_strspn         proc near               ; CODE XREF: __mbsspn+13↑p

var_24          = dword ptr -24h
varStr             = dword ptr  8
Control         = dword ptr  0Ch

                push    ebp
                mov     ebp, esp
                push    esi
                xor     eax, eax
                push    eax
                push    eax
                push    eax
                push    eax
                push    eax
                push    eax
                push    eax
                push    eax
                mov     edx, dword ptr [ebp+Control]
                db      2Eh
                mov     eax, eax

loc_5CE794:                             ; CODE XREF: _strspn+1F↓j
                mov     al, [edx]
                or      al, al
                jz      short loc_5CE7A1
                inc     edx
                bts     [esp+24h+var_24], eax
                jmp     short loc_5CE794
; ---------------------------------------------------------------------------

loc_5CE7A1:                             ; CODE XREF: _strspn+18↑j
                mov     esi, [ebp+varStr]
                or      ecx, 0FFFFFFFFh
                nop

loc_5CE7A8:                             ; CODE XREF: _strspn+34↓j
                inc     ecx
                mov     al, [esi]
                or      al, al
                jz      short loc_5CE7B6
                inc     esi
                bt      [esp+24h+var_24], eax
                jb      short loc_5CE7A8

loc_5CE7B6:                             ; CODE XREF: _strspn+2D↑j
                mov     eax, ecx
                add     esp, 20h
                pop     esi
                leave
                retn
_strspn         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; size_t __cdecl strcspn(const char *varStr, const char *Control)
_strcspn        proc near               ; CODE XREF: __mbscspn+13↑p

var_24          = dword ptr -24h
varStr             = dword ptr  8
Control         = dword ptr  0Ch

                push    ebp
                mov     ebp, esp
                push    esi
                xor     eax, eax
                push    eax
                push    eax
                push    eax
                push    eax
                push    eax
                push    eax
                push    eax
                push    eax
                mov     edx, dword ptr [ebp+Control]
                db      2Eh
                mov     eax, eax

loc_5CE7D4:                             ; CODE XREF: _strcspn+1F↓j
                mov     al, [edx]
                or      al, al
                jz      short loc_5CE7E1
                inc     edx
                bts     [esp+24h+var_24], eax
                jmp     short loc_5CE7D4
; ---------------------------------------------------------------------------

loc_5CE7E1:                             ; CODE XREF: _strcspn+18↑j
                mov     esi, [ebp+varStr]
                or      ecx, 0FFFFFFFFh
                nop

loc_5CE7E8:                             ; CODE XREF: _strcspn+34↓j
                inc     ecx
                mov     al, [esi]
                or      al, al
                jz      short loc_5CE7F6
                inc     esi
                bt      [esp+24h+var_24], eax
                jnb     short loc_5CE7E8

loc_5CE7F6:                             ; CODE XREF: _strcspn+2D↑j
                mov     eax, ecx
                add     esp, 20h
                pop     esi
                leave
                retn
_strcspn        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __crtGetStringTypeW(DWORD dwInfoType, LPCWCH lpSrcStr, int cchSrc, LPWORD lpCharType, UINT CodePage, LCID Locale)
___crtGetStringTypeW proc near          ; CODE XREF: sub_5D2570+16F↓p

CharType        = word ptr -4
dwInfoType      = dword ptr  4
lpSrcStr        = dword ptr  8
cchSrc          = dword ptr  0Ch
lpCharType      = dword ptr  10h
CodePage        = dword ptr  14h
Locale          = dword ptr  18h

                push    ecx
                mov     eax, dword_70D6BC
                push    ebx
                xor     ebx, ebx
                push    ebp
                push    esi
                mov     esi, ds:GetStringTypeW
                cmp     eax, ebx
                push    edi
                jnz     short loc_5CE858
                lea     eax, [esp+14h+CharType]
                push    eax             ; lpCharType
                push    1               ; cchSrc
                push    offset aString1  ; lpSrcStr
                push    1               ; dwInfoType
                call    esi ; GetStringTypeW
                test    eax, eax
                jz      short loc_5CE831
                mov     eax, 1
                jmp     short loc_5CE853
; ---------------------------------------------------------------------------

loc_5CE831:                             ; CODE XREF: ___crtGetStringTypeW+28↑j
                lea     ecx, [esp+14h+CharType]
                push    ecx             ; lpCharType
                push    1               ; cchSrc
                push    offset aString2  ; lpSrcStr
                push    1               ; dwInfoType
                push    ebx             ; Locale
                call    GetStringTypeA
                test    eax, eax
                jz      loc_5CE8D4
                mov     eax, 2

loc_5CE853:                             ; CODE XREF: ___crtGetStringTypeW+2F↑j
                mov     dword_70D6BC, eax

loc_5CE858:                             ; CODE XREF: ___crtGetStringTypeW+14↑j
                cmp     eax, 1
                jnz     short loc_5CE879
                mov     edx, dword ptr [esp+14h+lpCharType]
                mov     eax, dword ptr [esp+14h+cchSrc]
                mov     ecx, dword ptr [esp+14h+lpSrcStr]
                push    edx             ; lpCharType
                mov     edx, dword ptr [esp+18h+dwInfoType]
                push    eax             ; cchSrc
                push    ecx             ; lpSrcStr
                push    edx             ; dwInfoType
                call    esi ; GetStringTypeW
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CE879:                             ; CODE XREF: ___crtGetStringTypeW+5B↑j
                cmp     eax, 2
                jnz     loc_5CE97E
                mov     eax, dword ptr [esp+14h+CodePage]
                mov     dword ptr [esp+14h+CharType], ebx
                cmp     eax, ebx
                jnz     short loc_5CE897
                mov     eax, CodePage
                mov     [esp+14h+CodePage], eax

loc_5CE897:                             ; CODE XREF: ___crtGetStringTypeW+8C↑j
                mov     edi, [esp+14h+cchSrc]
                mov     ecx, dword ptr [esp+14h+lpSrcStr]
                mov     edx, dword ptr [esp+14h+CodePage]
                push    ebx             ; lpUsedDefaultChar
                push    ebx             ; lpDefaultChar
                push    ebx             ; cbMultiByte
                push    ebx             ; lpMultiByteStr
                push    edi             ; cchWideChar
                push    ecx             ; lpWideCharStr
                push    220h            ; dwFlags
                push    edx             ; CodePage
                call    WideCharToMultiByte
                mov     esi, eax
                cmp     esi, ebx
                jnz     short loc_5CE8C3
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CE8C3:                             ; CODE XREF: ___crtGetStringTypeW+B9↑j
                push    esi             ; varSize
                push    1               ; Count
                call    _calloc
                mov     ebp, eax
                add     esp, 8
                test    ebp, ebp
                jnz     short loc_5CE8DC

loc_5CE8D4:                             ; CODE XREF: ___crtGetStringTypeW+48↑j
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CE8DC:                             ; CODE XREF: ___crtGetStringTypeW+D2↑j
                mov     eax, dword ptr [esp+14h+lpSrcStr]
                mov     ecx, dword ptr [esp+14h+CodePage]
                push    0               ; lpUsedDefaultChar
                push    0               ; lpDefaultChar
                push    esi             ; cbMultiByte
                push    ebp             ; lpMultiByteStr
                push    edi             ; cchWideChar
                push    eax             ; lpWideCharStr
                push    220h            ; dwFlags
                push    ecx             ; CodePage
                call    WideCharToMultiByte
                test    eax, eax
                jz      short loc_5CE968
                lea     edx, [esi+esi+2]
                push    edx             ; varSize
                call    _malloc
                mov     ebx, eax
                add     esp, 4
                test    ebx, ebx
                jz      short loc_5CE968
                mov     eax, dword ptr [esp+14h+Locale]
                test    eax, eax
                jnz     short loc_5CE91C
                mov     eax, dword_70D558

loc_5CE91C:                             ; CODE XREF: ___crtGetStringTypeW+115↑j
                mov     ecx, dword ptr [esp+14h+dwInfoType]
                push    ebx             ; lpCharType
                add     edi, edi
                push    esi             ; cchSrc
                push    ebp             ; lpSrcStr
                push    ecx             ; dwInfoType
                mov     word ptr [ebx+edi], 0FFFFh
                push    eax             ; Locale
                mov     word ptr [ebx+edi-2], 0FFFFh
                call    GetStringTypeA
                cmp     word ptr [ebx+edi-2], 0FFFFh
                mov     dword ptr [esp+14h+CharType], eax
                jz      short loc_5CE960
                cmp     word ptr [ebx+edi], 0FFFFh
                jnz     short loc_5CE960
                mov     edx, dword ptr [esp+14h+lpCharType]
                push    edi             ; varSize
                push    ebx             ; Src
                push    edx             ; void *
                call    _memcpy_0
                add     esp, 0Ch
                jmp     short loc_5CE968
; ---------------------------------------------------------------------------

loc_5CE960:                             ; CODE XREF: ___crtGetStringTypeW+145↑j
                mov     dword ptr [esp+14h+CharType], 0

loc_5CE968:                             ; CODE XREF: ___crtGetStringTypeW+FA↑j
                push    ebp             ; Block
                call    _free
                add     esp, 4
                push    ebx             ; Block
                call    _free
                mov     eax, dword ptr [esp+18h+CharType]
                add     esp, 4

loc_5CE97E:                             ; CODE XREF: ___crtGetStringTypeW+7C↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
___crtGetStringTypeW endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __crtGetStringTypeA(DWORD dwInfoType, LPCSTR lpSrcStr, int cchSrc, LPWORD lpCharType, UINT CodePage, LCID Locale)
___crtGetStringTypeA proc near          ; CODE XREF: __ismbcdigit+48↑p

CharType        = word ptr -2
dwInfoType      = dword ptr  4
lpSrcStr        = dword ptr  8
cchSrc          = dword ptr  0Ch
lpCharType      = dword ptr  10h
CodePage        = dword ptr  14h
Locale          = dword ptr  18h

                push    ecx
                mov     eax, dword_70D6C0
                push    ebx
                push    ebp
                push    esi
                mov     esi, ds:GetStringTypeA
                push    edi
                xor     edi, edi
                cmp     eax, edi
                jnz     short loc_5CE9C9
                lea     eax, [esp+14h+CharType]
                push    eax             ; lpCharType
                push    1               ; cchSrc
                push    offset aString2  ; lpSrcStr
                push    1               ; dwInfoType
                push    edi             ; Locale
                call    esi ; GetStringTypeA
                test    eax, eax
                jz      loc_5CEA8E
                mov     eax, 2
                mov     dword_70D6C0, eax

loc_5CE9C9:                             ; CODE XREF: ___crtGetStringTypeA+14↑j
                cmp     eax, 2
                jnz     short loc_5CE9F8
                mov     eax, dword ptr [esp+14h+Locale]
                cmp     eax, edi
                jnz     short loc_5CE9DB
                mov     eax, dword_70D558

loc_5CE9DB:                             ; CODE XREF: ___crtGetStringTypeA+44↑j
                mov     edx, dword ptr [esp+14h+lpCharType]
                mov     ecx, dword ptr [esp+14h+cchSrc]
                push    edx             ; lpCharType
                mov     edx, dword ptr [esp+18h+lpSrcStr]
                push    ecx             ; cchSrc
                mov     ecx, dword ptr [esp+1Ch+dwInfoType]
                push    edx             ; lpSrcStr
                push    ecx             ; dwInfoType
                push    eax             ; Locale
                call    esi ; GetStringTypeA
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CE9F8:                             ; CODE XREF: ___crtGetStringTypeA+3C↑j
                cmp     eax, 1
                jnz     loc_5CEA88
                mov     ebx, dword ptr [esp+14h+CodePage]
                mov     [esp+14h+Locale], edi
                cmp     ebx, edi
                jnz     short loc_5CEA13
                mov     ebx, CodePage

loc_5CEA13:                             ; CODE XREF: ___crtGetStringTypeA+7B↑j
                mov     ebp, [esp+14h+cchSrc]
                mov     edx, dword ptr [esp+14h+lpSrcStr]
                push    edi             ; cchWideChar
                push    edi             ; lpWideCharStr
                push    ebp             ; cbMultiByte
                push    edx             ; lpMultiByteStr
                push    9               ; dwFlags
                push    ebx             ; CodePage
                call    MultiByteToWideChar
                mov     esi, eax
                test    esi, esi
                jz      short loc_5CEA79
                push    esi             ; varSize
                push    2               ; Count
                call    _calloc
                mov     edi, eax
                add     esp, 8
                test    edi, edi
                jz      short loc_5CEA79
                mov     eax, dword ptr [esp+14h+lpSrcStr]
                push    esi             ; cchWideChar
                push    edi             ; lpWideCharStr
                push    ebp             ; cbMultiByte
                push    eax             ; lpMultiByteStr
                push    1               ; dwFlags
                push    ebx             ; CodePage
                call    MultiByteToWideChar
                test    eax, eax
                jz      short loc_5CEA79
                mov     ecx, dword ptr [esp+14h+lpCharType]
                mov     edx, dword ptr [esp+14h+dwInfoType]
                push    ecx             ; lpCharType
                push    eax             ; cchSrc
                push    edi             ; lpSrcStr
                push    edx             ; dwInfoType
                call    GetStringTypeW
                push    edi             ; Block
                mov     esi, eax
                call    _free
                add     esp, 4
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CEA79:                             ; CODE XREF: ___crtGetStringTypeA+9C↑j
                mov     esi, [esp+14h+Locale]
                push    edi             ; Block
                call    _free
                add     esp, 4
                mov     eax, esi

loc_5CEA88:                             ; CODE XREF: ___crtGetStringTypeA+6B↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CEA8E:                             ; CODE XREF: ___crtGetStringTypeA+29↑j
                lea     ecx, [esp+14h+CharType]
                push    ecx             ; lpCharType
                push    1               ; cchSrc
                push    offset aString1  ; lpSrcStr
                push    1               ; dwInfoType
                call    GetStringTypeW
                test    eax, eax
                jz      short loc_5CEAB5
                mov     eax, 1
                mov     dword_70D6C0, eax
                jmp     loc_5CE9C9
; ---------------------------------------------------------------------------

loc_5CEAB5:                             ; CODE XREF: ___crtGetStringTypeA+114↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                pop     ecx
                retn
___crtGetStringTypeA endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _write(int FileHandle, const void *Buf, unsigned int MaxCharCount)
__write         proc near               ; CODE XREF: _fwrite_lk+C1↑p

FileHandle      = dword ptr  4
Buf             = dword ptr  8
MaxCharCount    = dword ptr  0Ch

                mov     eax, uNumber
                push    esi
                mov     esi, [esp+4+FileHandle]
                push    edi
                cmp     esi, eax
                jnb     short loc_5CEB16
                mov     eax, esi
                mov     ecx, esi
                and     eax, 1Fh
                sar     ecx, 5
                lea     edx, [eax+eax*8]
                mov     eax, __pioinfo[ecx*4]
                test    byte ptr [eax+edx*4+4], 1
                jz      short loc_5CEB16
                push    esi
                call    __lock_fhandle
                mov     ecx, dword ptr [esp+0Ch+MaxCharCount]
                mov     edx, dword ptr [esp+0Ch+Buf]
                add     esp, 4
                push    ecx             ; nNumberOfBytesToWrite
                push    edx             ; lpBuffer
                push    esi             ; FileHandle
                call    __write_lk
                add     esp, 0Ch
                mov     edi, eax
                push    esi
                call    __unlock_fhandle
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CEB16:                             ; CODE XREF: __write+D↑j
                call    __errno
                mov     dword ptr [eax], 9
                call    ___doserrno
                mov     dword ptr [eax], 0
                pop     edi
                or      eax, 0FFFFFFFFh
                pop     esi
                retn
__write         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _write_lk(int FileHandle, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite)
__write_lk      proc near               ; CODE XREF: __write+3E↑p

var_41C         = dword ptr -41Ch
var_418         = dword ptr -418h
var_414         = dword ptr -414h
NumberOfBytesWritten= dword ptr -410h
var_40C         = dword ptr -40Ch
var_408         = dword ptr -408h
Buffer          = byte ptr -404h
FileHandle      = dword ptr  4
lpBuffer        = dword ptr  8
nNumberOfBytesToWrite= dword ptr  0Ch

                sub     esp, 41Ch
                push    ebx
                mov     ebx, dword ptr [esp+420h+nNumberOfBytesToWrite]
                push    ebp
                xor     ebp, ebp
                push    esi
                cmp     ebx, ebp
                push    edi
                mov     [esp+42Ch+var_41C], ebp
                mov     [esp+42Ch+var_40C], ebp
                jnz     short loc_5CEB6C
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 41Ch
                retn
; ---------------------------------------------------------------------------

loc_5CEB6C:                             ; CODE XREF: __write_lk+1D↑j
                mov     ecx, dword ptr [esp+42Ch+FileHandle]
                mov     eax, ecx
                sar     eax, 5
                lea     edi, __pioinfo[eax*4]
                mov     eax, ecx
                and     eax, 1Fh
                mov     [esp+42Ch+var_408], edi
                mov     edx, dword ptr [edi]
                lea     esi, [eax+eax*8]
                shl     esi, 2
                mov     [esp+42Ch+var_418], esi
                test    byte ptr [esi+edx+4], 20h
                jz      short loc_5CEBA7
                push    2               ; dwMoveMethod
                push    ebp             ; lDistanceToMove
                push    ecx             ; FileHandle
                call    __lseek_lk
                add     esp, 0Ch

loc_5CEBA7:                             ; CODE XREF: __write_lk+59↑j
                mov     eax, dword ptr [edi]
                add     eax, esi
                test    byte ptr [eax+4], 80h
                jz      loc_5CED09
                mov     ebp, [esp+42Ch+lpBuffer]
                mov     [esp+42Ch+var_414], 0
                test    ebx, ebx
                mov     edi, ebp
                jbe     loc_5CEC51

loc_5CEBCE:                             ; CODE XREF: __write_lk+10B↓j
                lea     eax, [esp+42Ch+Buffer]

loc_5CEBD2:                             ; CODE XREF: __write_lk+C0↓j
                mov     ecx, edi
                sub     ecx, ebp
                cmp     ecx, ebx
                jnb     short loc_5CEC02
                mov     cl, [edi]
                inc     edi
                cmp     cl, 0Ah
                jnz     short loc_5CEBEF
                mov     esi, [esp+42Ch+var_40C]
                mov     byte ptr [eax], 0Dh
                inc     esi
                inc     eax
                mov     [esp+42Ch+var_40C], esi

loc_5CEBEF:                             ; CODE XREF: __write_lk+A0↑j
                mov     [eax], cl
                inc     eax
                mov     edx, eax
                lea     ecx, [esp+42Ch+Buffer]
                sub     edx, ecx
                cmp     edx, 400h
                jl      short loc_5CEBD2

loc_5CEC02:                             ; CODE XREF: __write_lk+98↑j
                mov     esi, eax
                lea     edx, [esp+42Ch+Buffer]
                lea     eax, [esp+42Ch+NumberOfBytesWritten]
                sub     esi, edx
                mov     edx, dword ptr [esp+42Ch+var_408]
                push    0               ; lpOverlapped
                push    eax             ; lpNumberOfBytesWritten
                lea     ecx, [esp+434h+Buffer]
                mov     eax, dword ptr [edx]
                push    esi             ; nNumberOfBytesToWrite
                push    ecx             ; lpBuffer
                mov     ecx, dword ptr [esp+43Ch+var_418]
                mov     edx, dword ptr [ecx+eax]
                push    edx             ; hFile
                call    WriteFile
                test    eax, eax
                jz      loc_5CECFA
                mov     eax, dword ptr [esp+42Ch+NumberOfBytesWritten]
                mov     edx, dword ptr [esp+42Ch+var_41C]
                add     edx, eax
                cmp     eax, esi
                mov     [esp+42Ch+var_41C], edx
                jl      short loc_5CEC4D
                mov     eax, edi
                sub     eax, ebp
                cmp     eax, ebx
                jb      short loc_5CEBCE

loc_5CEC4D:                             ; CODE XREF: __write_lk+103↑j
                mov     esi, [esp+42Ch+var_418]

loc_5CEC51:                             ; CODE XREF: __write_lk+88↑j
                mov     eax, dword ptr [esp+42Ch+var_41C]
                test    eax, eax
                jnz     loc_5CECE9
                mov     eax, dword ptr [esp+42Ch+var_414]
                test    eax, eax
                jz      short loc_5CECA5
                cmp     eax, 5
                jnz     short loc_5CEC8E
                call    __errno
                mov     dword ptr [eax], 9
                call    ___doserrno
                mov     dword ptr [eax], 5
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 41Ch
                retn
; ---------------------------------------------------------------------------

loc_5CEC8E:                             ; CODE XREF: __write_lk+128↑j
                push    eax
                call    __dosmaperr
                add     esp, 4
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 41Ch
                retn
; ---------------------------------------------------------------------------

loc_5CECA5:                             ; CODE XREF: __write_lk+123↑j
                mov     ecx, dword ptr [esp+42Ch+var_408]
                mov     edx, dword ptr [ecx]
                test    byte ptr [esi+edx+4], 40h
                jz      short loc_5CECC5
                cmp     byte ptr [ebp+0], 1Ah
                jnz     short loc_5CECC5
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 41Ch
                retn
; ---------------------------------------------------------------------------

loc_5CECC5:                             ; CODE XREF: __write_lk+170↑j
                call    __errno
                mov     dword ptr [eax], 1Ch
                call    ___doserrno
                mov     dword ptr [eax], 0
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 41Ch
                retn
; ---------------------------------------------------------------------------

loc_5CECE9:                             ; CODE XREF: __write_lk+117↑j
                mov     ecx, dword ptr [esp+42Ch+var_40C]
                pop     edi
                pop     esi
                pop     ebp
                sub     eax, ecx
                pop     ebx
                add     esp, 41Ch
                retn
; ---------------------------------------------------------------------------

loc_5CECFA:                             ; CODE XREF: __write_lk+ED↑j
                call    GetLastError
                mov     [esp+42Ch+var_414], eax
                jmp     loc_5CEC4D
; ---------------------------------------------------------------------------

loc_5CED09:                             ; CODE XREF: __write_lk+6F↑j
                mov     edx, dword ptr [eax]
                lea     ecx, [esp+42Ch+NumberOfBytesWritten]
                push    ebp             ; lpOverlapped
                mov     ebp, [esp+430h+lpBuffer]
                push    ecx             ; lpNumberOfBytesWritten
                push    ebx             ; nNumberOfBytesToWrite
                push    ebp             ; lpBuffer
                push    edx             ; hFile
                call    WriteFile
                test    eax, eax
                jz      short loc_5CED3A
                mov     eax, dword ptr [esp+42Ch+NumberOfBytesWritten]
                mov     [esp+42Ch+var_414], 0
                mov     [esp+42Ch+var_41C], eax
                jmp     loc_5CEC51
; ---------------------------------------------------------------------------

loc_5CED3A:                             ; CODE XREF: __write_lk+1E3↑j
                call    GetLastError
                mov     [esp+42Ch+var_414], eax
                jmp     loc_5CEC51
__write_lk      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _commit(int FileHandle)
__commit        proc near               ; CODE XREF: __fflush_lk+23↑p

FileHandle      = dword ptr  4

                mov     eax, uNumber
                push    ebp
                push    esi
                push    edi
                mov     edi, [esp+0Ch+FileHandle]
                cmp     edi, eax
                jnb     short loc_5CEDDC
                mov     eax, edi
                sar     eax, 5
                lea     ebp, __pioinfo[eax*4]
                mov     eax, edi
                and     eax, 1Fh
                mov     ecx, dword ptr [ebp+0]
                lea     esi, [eax+eax*8]
                shl     esi, 2
                test    byte ptr [ecx+esi+4], 1
                jz      short loc_5CEDDC
                push    edi
                call    __lock_fhandle
                mov     edx, dword ptr [ebp+0]
                add     esp, 4
                test    byte ptr [edx+esi+4], 1
                jz      short loc_5CEDBF
                push    edi             ; FileHandle
                call    __get_osfhandle
                add     esp, 4
                push    eax             ; hFile
                call    FlushFileBuffers
                test    eax, eax
                jnz     short loc_5CEDB2
                call    GetLastError
                mov     esi, eax
                jmp     short loc_5CEDB4
; ---------------------------------------------------------------------------

loc_5CEDB2:                             ; CODE XREF: __commit+56↑j
                xor     esi, esi

loc_5CEDB4:                             ; CODE XREF: __commit+60↑j
                test    esi, esi
                jz      short loc_5CEDCD
                call    ___doserrno
                mov     [eax], esi

loc_5CEDBF:                             ; CODE XREF: __commit+42↑j
                call    __errno
                mov     dword ptr [eax], 9
                or      esi, 0FFFFFFFFh

loc_5CEDCD:                             ; CODE XREF: __commit+66↑j
                push    edi
                call    __unlock_fhandle
                add     esp, 4
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebp
                retn
; ---------------------------------------------------------------------------

loc_5CEDDC:                             ; CODE XREF: __commit+E↑j
                call    __errno
                pop     edi
                mov     dword ptr [eax], 9
                pop     esi
                or      eax, 0FFFFFFFFh
                pop     ebp
                retn
__commit        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___tzset        proc near               ; CODE XREF: __make_time_t+1B0↑p
                mov     eax, dword_70D780
                test    eax, eax
                jnz     short locret_5CEE21
                push    0Bh
                call    __lock
                mov     eax, dword_70D780
                add     esp, 4
                test    eax, eax
                jnz     short loc_5CEE17
                call    __tzset_lk
                inc     dword_70D780

loc_5CEE17:                             ; CODE XREF: ___tzset+1A↑j
                push    0Bh
                call    __unlock
                add     esp, 4

locret_5CEE21:                          ; CODE XREF: ___tzset+7↑j
                retn
___tzset        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void __cdecl _tzset()
__tzset         proc near
                push    0Bh
                call    __lock
                add     esp, 4
                call    __tzset_lk
                push    0Bh
                call    __unlock
                add     esp, 4
                retn
__tzset         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__tzset_lk      proc near               ; CODE XREF: ___tzset+1C↑p

var_4           = dword ptr -4

                push    ecx
                push    ebp
                push    esi
                push    edi
                xor     esi, esi
                push    0Ch
                mov     [esp+14h+var_4], esi
                call    __lock
                add     esp, 4
                mov     dword_70D6C8, esi
                mov     dword_641C28, 0FFFFFFFFh
                mov     dword_641C18, 0FFFFFFFFh
                push    offset aTz      ; "TZ"
                call    __getenv_lk
                mov     ebp, eax
                add     esp, 4
                cmp     ebp, esi
                jnz     loc_5CEF6B
                push    0Ch
                call    __unlock
                add     esp, 4
                push    offset g_TimeZoneInformation ; lpTimeZoneInformation
                call    GetTimeZoneInformation
                cmp     eax, 0FFFFFFFFh
                jz      loc_5CF123
                mov     eax, [g_TimeZoneInformation.Bias]
                mov     ecx, [g_TimeZoneInformation.StandardBias]
                xor     edi, edi
                mov     esi, 1
                lea     eax, [eax+eax*2]
                mov     dword_70D6C8, esi
                lea     eax, [eax+eax*4]
                shl     eax, 2
                cmp     [g_TimeZoneInformation.StandardDate.wMonth], di
                mov     dword_641B80, eax
                jz      short loc_5CEEF0
                lea     edx, [ecx+ecx*2]
                lea     edx, [edx+edx*4]
                lea     eax, [eax+edx*4]
                mov     dword_641B80, eax

loc_5CEEF0:                             ; CODE XREF: __tzset_lk+90↑j
                cmp     [g_TimeZoneInformation.DaylightDate.wMonth], di
                jz      short loc_5CEF1B
                mov     eax, [g_TimeZoneInformation.DaylightBias]
                cmp     eax, edi
                jz      short loc_5CEF1B
                sub     eax, ecx
                mov     dword_641B84, esi
                lea     eax, [eax+eax*2]
                lea     ecx, [eax+eax*4]
                shl     ecx, 2
                mov     dword_641B88, ecx
                jmp     short loc_5CEF27
; ---------------------------------------------------------------------------

loc_5CEF1B:                             ; CODE XREF: __tzset_lk+A7↑j
                mov     dword_641B84, edi
                mov     dword_641B88, edi

loc_5CEF27:                             ; CODE XREF: __tzset_lk+C9↑j
                mov     edx, [g_Dest]
                push    40h ; '@'       ; MaxCount
                push    offset g_TimeZoneInformation.StandardName ; Source
                push    edx             ; Dest
                call    _wcstombs
                mov     eax, off_641C14
                add     esp, 0Ch
                push    40h ; '@'       ; MaxCount
                push    offset g_TimeZoneInformation.DaylightName ; Source
                push    eax             ; Dest
                call    _wcstombs
                mov     ecx, off_641C14
                add     esp, 0Ch
                mov     byte ptr [ecx+3Fh], 0
                mov     edx, [g_Dest]
                mov     byte ptr [edx+3Fh], 0
                pop     edi
                pop     esi
                pop     ebp
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CEF6B:                             ; CODE XREF: __tzset_lk+3F↑j
                cmp     byte ptr [ebp+0], 0
                jz      loc_5CF119
                mov     edi, dword_70D77C
                cmp     edi, esi
                jz      short loc_5CEFB4
                mov     esi, edi
                mov     eax, ebp

loc_5CEF83:                             ; CODE XREF: __tzset_lk+151↓j
                mov     dl, [eax]
                mov     cl, dl
                cmp     dl, [esi]
                jnz     short loc_5CEFA7
                test    cl, cl
                jz      short loc_5CEFA3
                mov     dl, [eax+1]
                mov     cl, dl
                cmp     dl, [esi+1]
                jnz     short loc_5CEFA7
                add     eax, 2
                add     esi, 2
                test    cl, cl
                jnz     short loc_5CEF83

loc_5CEFA3:                             ; CODE XREF: __tzset_lk+13D↑j
                xor     eax, eax
                jmp     short loc_5CEFAC
; ---------------------------------------------------------------------------

loc_5CEFA7:                             ; CODE XREF: __tzset_lk+139↑j
                sbb     eax, eax
                sbb     eax, 0FFFFFFFFh

loc_5CEFAC:                             ; CODE XREF: __tzset_lk+155↑j
                test    eax, eax
                jz      loc_5CF119

loc_5CEFB4:                             ; CODE XREF: __tzset_lk+12D↑j
                push    edi             ; Block
                call    _free
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                add     esp, 4
                repne scasb
                not     ecx
                push    ecx             ; varSize
                call    _malloc
                mov     edx, eax
                add     esp, 4
                test    edx, edx
                mov     dword_70D77C, edx
                jz      loc_5CF119
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                push    0Ch
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     eax, ecx
                mov     esi, edi
                mov     edi, edx
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                and     ecx, 3
                rep movsb
                call    __unlock
                mov     ecx, [g_Dest]
                add     esp, 4
                push    3               ; Count
                push    ebp             ; Source
                push    ecx             ; Destination
                call    _strncpy
                mov     edx, [g_Dest]
                add     ebp, 3
                add     esp, 0Ch
                mov     byte ptr [edx+3], 0
                mov     al, [ebp+0]
                cmp     al, 2Dh ; '-'
                jnz     short loc_5CF038
                mov     esi, 1
                inc     ebp
                jmp     short loc_5CF03C
; ---------------------------------------------------------------------------

loc_5CF038:                             ; CODE XREF: __tzset_lk+1DE↑j
                mov     esi, [esp+10h+var_4]

loc_5CF03C:                             ; CODE XREF: __tzset_lk+1E6↑j
                push    ebp             ; String
                call    _atol
                lea     eax, [eax+eax*4]
                add     esp, 4
                lea     eax, [eax+eax*4]
                lea     ecx, [eax+eax*8]
                shl     ecx, 4
                mov     dword_641B80, ecx

loc_5CF057:                             ; CODE XREF: __tzset_lk+217↓j
                mov     al, [ebp+0]
                cmp     al, 2Bh ; '+'
                jz      short loc_5CF066
                cmp     al, 30h ; '0'
                jl      short loc_5CF069
                cmp     al, 39h ; '9'
                jg      short loc_5CF069

loc_5CF066:                             ; CODE XREF: __tzset_lk+20C↑j
                inc     ebp
                jmp     short loc_5CF057
; ---------------------------------------------------------------------------

loc_5CF069:                             ; CODE XREF: __tzset_lk+210↑j
                cmp     byte ptr [ebp+0], 3Ah ; ':'
                jnz     short loc_5CF0D2
                inc     ebp
                push    ebp             ; String
                call    _atol
                mov     ecx, dword_641B80
                lea     eax, [eax+eax*2]
                add     esp, 4
                lea     eax, [eax+eax*4]
                lea     ecx, [ecx+eax*4]
                mov     dword_641B80, ecx
                mov     al, [ebp+0]
                cmp     al, 30h ; '0'
                jl      short loc_5CF0A1

loc_5CF095:                             ; CODE XREF: __tzset_lk+24F↓j
                cmp     al, 39h ; '9'
                jg      short loc_5CF0A1
                mov     al, [ebp+1]
                inc     ebp
                cmp     al, 30h ; '0'
                jge     short loc_5CF095

loc_5CF0A1:                             ; CODE XREF: __tzset_lk+243↑j
                cmp     byte ptr [ebp+0], 3Ah ; ':'
                jnz     short loc_5CF0D2
                inc     ebp
                push    ebp             ; String
                call    _atol
                mov     ecx, dword_641B80
                add     esp, 4
                add     ecx, eax
                mov     dword_641B80, ecx
                mov     al, [ebp+0]
                cmp     al, 30h ; '0'
                jl      short loc_5CF0D2

loc_5CF0C6:                             ; CODE XREF: __tzset_lk+280↓j
                cmp     al, 39h ; '9'
                jg      short loc_5CF0D2
                mov     al, [ebp+1]
                inc     ebp
                cmp     al, 30h ; '0'
                jge     short loc_5CF0C6

loc_5CF0D2:                             ; CODE XREF: __tzset_lk+21D↑j
                test    esi, esi
                jz      short loc_5CF0DE
                neg     ecx
                mov     dword_641B80, ecx

loc_5CF0DE:                             ; CODE XREF: __tzset_lk+284↑j
                movsx   eax, byte ptr [ebp+0]
                test    eax, eax
                mov     dword_641B84, eax
                jz      short loc_5CF10B
                mov     edx, off_641C14
                push    3               ; Count
                push    ebp             ; Source
                push    edx             ; Destination
                call    _strncpy
                mov     eax, off_641C14
                add     esp, 0Ch
                mov     byte ptr [eax+3], 0
                pop     edi
                pop     esi
                pop     ebp
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CF10B:                             ; CODE XREF: __tzset_lk+299↑j
                mov     ecx, off_641C14
                mov     byte ptr [ecx], 0
                pop     edi
                pop     esi
                pop     ebp
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5CF119:                             ; CODE XREF: __tzset_lk+11F↑j
                push    0Ch
                call    __unlock
                add     esp, 4

loc_5CF123:                             ; CODE XREF: __tzset_lk+5D↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ecx
                retn
__tzset_lk      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__isindst       proc near               ; CODE XREF: _localtime+4A↑p

arg_0           = dword ptr  4

                push    esi
                push    0Bh
                call    __lock
                mov     eax, dword ptr [esp+8+arg_0]
                add     esp, 4
                push    eax
                call    sub_5CF160
                add     esp, 4
                mov     esi, eax
                push    0Bh
                call    __unlock
                add     esp, 4
                mov     eax, esi
                pop     esi
                retn
__isindst       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_5CF160      proc near               ; CODE XREF: __isindst+10↑p

arg_0           = dword ptr  4

                mov     eax, dword_641B84
                push    esi
                test    eax, eax
                push    edi
                jnz     short loc_5CF170
                xor     eax, eax
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CF170:                             ; CODE XREF: sub_5CF160+9↑j
                mov     esi, [esp+8+arg_0]
                mov     ecx, dword_641C18
                mov     eax, dword ptr [esi+14h]
                cmp     eax, ecx
                jnz     short loc_5CF18D
                cmp     eax, dword_641C28
                jz      loc_5CF334

loc_5CF18D:                             ; CODE XREF: sub_5CF160+1F↑j
                mov     ecx, dword_70D6C8
                test    ecx, ecx
                jz      loc_5CF2F7
                cmp     [TimeZoneInformation.DaylightDate.wYear], 0
                jnz     short loc_5CF1FB
                mov     edx, dword ptr TimeZoneInformation.DaylightDate.wSecond
                xor     ecx, ecx
                mov     cx, TimeZoneInformation.DaylightDate.wMilliseconds
                and     edx, 0FFFFh
                push    ecx
                xor     ecx, ecx
                mov     cx, TimeZoneInformation.DaylightDate.wMinute
                push    edx
                mov     edx, dword ptr TimeZoneInformation.DaylightDate.wHour
                push    ecx
                mov     ecx, dword ptr TimeZoneInformation.DaylightDate.wDayOfWeek
                and     edx, 0FFFFh
                push    edx
                and     ecx, 0FFFFh
                push    0
                push    ecx
                xor     edx, edx
                xor     ecx, ecx
                mov     dx, TimeZoneInformation.DaylightDate.wDay
                mov     cx, TimeZoneInformation.DaylightDate.wMonth
                push    edx
                push    ecx
                push    eax
                push    1
                jmp     short loc_5CF244
; ---------------------------------------------------------------------------

loc_5CF1FB:                             ; CODE XREF: sub_5CF160+43↑j
                mov     ecx, dword ptr TimeZoneInformation.DaylightDate.wSecond
                xor     edx, edx
                mov     dx, TimeZoneInformation.DaylightDate.wMilliseconds
                and     ecx, 0FFFFh
                push    edx
                xor     edx, edx
                mov     dx, TimeZoneInformation.DaylightDate.wMinute
                push    ecx
                mov     ecx, dword ptr TimeZoneInformation.DaylightDate.wHour
                push    edx
                and     ecx, 0FFFFh
                xor     edx, edx
                mov     dx, TimeZoneInformation.DaylightDate.wDay
                push    ecx
                xor     ecx, ecx
                push    edx
                mov     cx, TimeZoneInformation.DaylightDate.wMonth
                push    0
                push    0
                push    ecx
                push    eax
                push    0

loc_5CF244:                             ; CODE XREF: sub_5CF160+99↑j
                push    1
                call    _cvtdate
                add     esp, 2Ch
                cmp     [TimeZoneInformation.StandardDate.wYear], 0
                jnz     short loc_5CF2AB
                mov     eax, dword ptr TimeZoneInformation.StandardDate.wSecond
                xor     edx, edx
                mov     dx, TimeZoneInformation.StandardDate.wMilliseconds
                and     eax, 0FFFFh
                push    edx
                mov     edx, dword ptr TimeZoneInformation.StandardDate.wHour
                xor     ecx, ecx
                push    eax
                mov     cx, TimeZoneInformation.StandardDate.wMinute
                mov     eax, dword ptr TimeZoneInformation.StandardDate.wDayOfWeek
                and     edx, 0FFFFh
                push    ecx
                push    edx
                and     eax, 0FFFFh
                xor     ecx, ecx
                xor     edx, edx
                mov     cx, TimeZoneInformation.StandardDate.wDay
                mov     dx, TimeZoneInformation.StandardDate.wMonth
                push    0
                push    eax
                mov     eax, dword ptr [esi+14h]
                push    ecx
                push    edx
                push    eax
                jmp     short loc_5CF328
; ---------------------------------------------------------------------------

loc_5CF2AB:                             ; CODE XREF: sub_5CF160+F6↑j
                mov     edx, dword ptr TimeZoneInformation.StandardDate.wSecond
                xor     ecx, ecx
                mov     cx, TimeZoneInformation.StandardDate.wMilliseconds
                and     edx, 0FFFFh
                push    ecx
                mov     ecx, dword ptr TimeZoneInformation.StandardDate.wHour
                xor     eax, eax
                push    edx
                mov     ax, TimeZoneInformation.StandardDate.wMinute
                xor     edx, edx
                mov     dx, TimeZoneInformation.StandardDate.wDay
                and     ecx, 0FFFFh
                push    eax
                push    ecx
                mov     ecx, dword ptr [esi+14h]
                xor     eax, eax
                mov     ax, TimeZoneInformation.StandardDate.wMonth
                push    edx
                push    0
                push    0
                push    eax
                push    ecx
                push    0
                jmp     short loc_5CF32A
; ---------------------------------------------------------------------------

loc_5CF2F7:                             ; CODE XREF: sub_5CF160+35↑j
                push    0
                push    0
                push    0
                push    2
                push    0
                push    0
                push    1
                push    4
                push    eax
                push    1
                push    1
                call    _cvtdate
                add     esp, 2Ch
                mov     edx, dword ptr [esi+14h]
                push    0
                push    0
                push    0
                push    2
                push    0
                push    0
                push    5
                push    0Ah
                push    edx

loc_5CF328:                             ; CODE XREF: sub_5CF160+149↑j
                push    1

loc_5CF32A:                             ; CODE XREF: sub_5CF160+195↑j
                push    0
                call    _cvtdate
                add     esp, 2Ch

loc_5CF334:                             ; CODE XREF: sub_5CF160+27↑j
                mov     edx, dword_641C1C
                mov     eax, dword_641C2C
                mov     ecx, dword ptr [esi+1Ch]
                cmp     edx, eax
                jge     short loc_5CF35E
                cmp     ecx, edx
                jl      short loc_5CF36E
                cmp     ecx, eax
                jg      short loc_5CF36E
                cmp     ecx, edx
                jle     short loc_5CF373
                cmp     ecx, eax
                jge     short loc_5CF373
                mov     eax, 1
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CF35E:                             ; CODE XREF: sub_5CF160+1E4↑j
                cmp     ecx, eax
                jl      short loc_5CF3C1
                cmp     ecx, edx
                jg      short loc_5CF3C1
                cmp     ecx, eax
                jle     short loc_5CF373
                cmp     ecx, edx
                jge     short loc_5CF373

loc_5CF36E:                             ; CODE XREF: sub_5CF160+1E8↑j
                xor     eax, eax
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CF373:                             ; CODE XREF: sub_5CF160+1F0↑j
                mov     eax, dword ptr [esi+8]
                mov     edi, [esi+4]
                mov     esi, [esi]
                lea     eax, [eax+eax*2]
                lea     eax, [eax+eax*4]
                lea     eax, [edi+eax*4]
                lea     eax, [eax+eax*2]
                lea     eax, [eax+eax*4]
                lea     eax, [esi+eax*4]
                lea     eax, [eax+eax*4]
                lea     eax, [eax+eax*4]
                lea     eax, [eax+eax*4]
                shl     eax, 3
                cmp     ecx, edx
                jnz     short loc_5CF3AF
                mov     edx, dword_641C20
                xor     ecx, ecx
                cmp     eax, edx
                setnl   cl
                mov     eax, ecx
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CF3AF:                             ; CODE XREF: sub_5CF160+23B↑j
                mov     ecx, dword_641C30
                xor     edx, edx
                cmp     eax, ecx
                setl    dl
                mov     eax, edx
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CF3C1:                             ; CODE XREF: sub_5CF160+200↑j
                pop     edi
                mov     eax, 1
                pop     esi
                retn
sub_5CF160      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_cvtdate        proc near               ; CODE XREF: sub_5CF160+E6↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h
arg_14          = dword ptr  18h
arg_18          = dword ptr  1Ch
arg_1C          = dword ptr  20h
arg_20          = dword ptr  24h
arg_24          = dword ptr  28h
arg_28          = dword ptr  2Ch

                mov     eax, dword ptr [esp+arg_4]
                push    ebx
                mov     ebx, dword ptr [esp+4+arg_8]
                push    ebp
                push    esi
                cmp     eax, 1
                push    edi
                jnz     loc_5CF485
                mov     eax, ebx
                and     eax, 3
                mov     [esp+10h+arg_8], eax
                jnz     short loc_5CF403
                mov     eax, dword ptr [esp+10h+arg_C]
                lea     edi, ds:0[eax*4]
                mov     eax, dword_641C34[edi]
                jmp     short loc_5CF414
; ---------------------------------------------------------------------------

loc_5CF403:                             ; CODE XREF: _cvtdate+1E↑j
                mov     ecx, dword ptr [esp+10h+arg_C]
                lea     edi, ds:0[ecx*4]
                mov     eax, dword_641C6C[edi]

loc_5CF414:                             ; CODE XREF: _cvtdate+31↑j
                lea     edx, [ebx+ebx*8]
                lea     ecx, [eax+1]
                lea     esi, [ebx-1]
                lea     eax, [ebx+edx*8]
                mov     edx, eax
                add     edx, ecx
                sar     esi, 2
                lea     eax, [edx+eax*4]
                lea     eax, [esi+eax-63DBh]
                mov     esi, 7
                cdq
                idiv    esi
                mov     esi, [esp+10h+arg_14]
                mov     eax, dword ptr [esp+10h+arg_10]
                mov     ebp, eax
                cmp     edx, esi
                jge     short loc_5CF456
                shl     ebp, 3
                sub     ebp, eax
                sub     ebp, edx
                add     ebp, esi
                lea     ecx, [ecx+ebp-7]
                jmp     short loc_5CF461
; ---------------------------------------------------------------------------

loc_5CF456:                             ; CODE XREF: _cvtdate+75↑j
                shl     ebp, 3
                sub     ebp, eax
                sub     ebp, edx
                add     ebp, esi
                add     ecx, ebp

loc_5CF461:                             ; CODE XREF: _cvtdate+84↑j
                cmp     eax, 5
                jnz     short loc_5CF4A6
                mov     eax, dword ptr [esp+10h+arg_8]
                test    eax, eax
                jnz     short loc_5CF476
                mov     edi, dword_641C38[edi]
                jmp     short loc_5CF47C
; ---------------------------------------------------------------------------

loc_5CF476:                             ; CODE XREF: _cvtdate+9C↑j
                mov     edi, dword_641C70[edi]

loc_5CF47C:                             ; CODE XREF: _cvtdate+A4↑j
                cmp     ecx, edi
                jle     short loc_5CF4A6
                sub     ecx, 7
                jmp     short loc_5CF4A6
; ---------------------------------------------------------------------------

loc_5CF485:                             ; CODE XREF: _cvtdate+F↑j
                test    bl, 3
                jnz     short loc_5CF497
                mov     ecx, dword ptr [esp+10h+arg_C]
                mov     ecx, dword_641C34[ecx*4]
                jmp     short loc_5CF4A2
; ---------------------------------------------------------------------------

loc_5CF497:                             ; CODE XREF: _cvtdate+B8↑j
                mov     edx, dword ptr [esp+10h+arg_C]
                mov     ecx, dword_641C6C[edx*4]

loc_5CF4A2:                             ; CODE XREF: _cvtdate+C5↑j
                add     ecx, [esp+10h+arg_18]

loc_5CF4A6:                             ; CODE XREF: _cvtdate+94↑j
                cmp     [esp+10h+arg_0], 1
                jnz     short loc_5CF4F4
                mov     eax, dword ptr [esp+10h+arg_1C]
                mov     edx, dword ptr [esp+10h+arg_20]
                mov     dword_641C1C, ecx
                mov     ecx, eax
                shl     ecx, 4
                sub     ecx, eax
                mov     dword_641C18, ebx
                lea     eax, [edx+ecx*4]
                mov     edx, dword ptr [esp+10h+arg_24]
                mov     ecx, eax
                shl     ecx, 4
                sub     ecx, eax
                lea     eax, [edx+ecx*4]
                mov     ecx, dword ptr [esp+10h+arg_28]
                lea     eax, [eax+eax*4]
                lea     eax, [eax+eax*4]
                lea     eax, [eax+eax*4]
                lea     edx, [ecx+eax*8]
                mov     dword_641C20, edx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CF4F4:                             ; CODE XREF: _cvtdate+DB↑j
                mov     eax, dword ptr [esp+10h+arg_1C]
                mov     edx, dword ptr [esp+10h+arg_20]
                mov     dword_641C2C, ecx
                mov     ecx, eax
                shl     ecx, 4
                sub     ecx, eax
                lea     eax, [edx+ecx*4]
                mov     edx, dword ptr [esp+10h+arg_24]
                mov     ecx, eax
                shl     ecx, 4
                sub     ecx, eax
                lea     eax, [edx+ecx*4]
                mov     edx, dword_641B88
                add     eax, edx
                mov     ecx, dword ptr [esp+10h+arg_28]
                lea     eax, [eax+eax*4]
                lea     eax, [eax+eax*4]
                lea     eax, [eax+eax*4]
                lea     eax, [ecx+eax*8]
                test    eax, eax
                mov     dword_641C30, eax
                jge     short loc_5CF550
                add     eax, 5265BFFh
                mov     dword_641C28, ebx
                mov     dword_641C30, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5CF550:                             ; CODE XREF: _cvtdate+169↑j
                cmp     eax, 5265C00h
                jl      short loc_5CF561
                sub     eax, 5265BFFh
                mov     dword_641C30, eax

loc_5CF561:                             ; CODE XREF: _cvtdate+185↑j
                pop     edi
                pop     esi
                mov     dword_641C28, ebx
                pop     ebp
                pop     ebx
                retn
_cvtdate        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl _getcwd(char *DstBuf, int SizeInBytes)
__getcwd        proc near               ; CODE XREF: __fullpath+BD↑p

DstBuf          = dword ptr  4
SizeInBytes     = dword ptr  8

                push    esi
                push    0Ch
                call    __lock
                mov     eax, dword ptr [esp+8+SizeInBytes]
                mov     ecx, dword ptr [esp+8+DstBuf]
                add     esp, 4
                push    eax             ; int
                push    ecx             ; int
                push    0               ; RootPathName
                call    __getdcwd_lk
                add     esp, 0Ch
                mov     esi, eax
                push    0Ch
                call    __unlock
                add     esp, 4
                mov     eax, esi
                pop     esi
                retn
__getcwd        endp

; ---------------------------------------------------------------------------
                align 10h
                push    esi
                push    0Ch
                call    __lock
                mov     eax, dword ptr [esp+14h]
                mov     ecx, dword ptr [esp+10h]
                mov     edx, dword ptr [esp+0Ch]
                add     esp, 4
                push    eax
                push    ecx
                push    edx
                call    __getdcwd_lk
                add     esp, 0Ch
                mov     esi, eax
                push    0Ch
                call    __unlock
                add     esp, 4
                mov     eax, esi
                pop     esi
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _getdcwd_lk(CHAR RootPathName, int, int)
__getdcwd_lk    proc near               ; CODE XREF: __getcwd+17↑p

FileName        = byte ptr -10Ch
var_10B         = byte ptr -10Bh
var_10A         = byte ptr -10Ah
var_109         = byte ptr -109h
FilePart        = dword ptr -108h
Buffer          = byte ptr -104h
RootPathName    = byte ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                sub     esp, 10Ch
                push    ebx
                mov     ebx, dword ptr [esp+110h+RootPathName]
                push    esi
                push    edi
                test    ebx, ebx
                jz      short loc_5CF655
                push    ebx             ; RootPathName
                call    __validdrive
                add     esp, 4
                test    eax, eax
                jnz     short loc_5CF623
                call    ___doserrno
                mov     dword ptr [eax], 0Fh
                call    __errno
                mov     dword ptr [eax], 0Dh
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebx
                add     esp, 10Ch
                retn
; ---------------------------------------------------------------------------

loc_5CF623:                             ; CODE XREF: __getdcwd_lk+1F↑j
                lea     eax, [esp+118h+FilePart]
                lea     ecx, [esp+118h+Buffer]
                push    eax             ; lpFilePart
                push    ecx             ; lpBuffer
                lea     edx, [esp+120h+FileName]
                add     bl, 40h ; '@'
                push    104h            ; nBufferLength
                push    edx             ; lpFileName
                mov     [esp+128h+FileName], bl
                mov     [esp+128h+var_10B], 3Ah ; ':'
                mov     [esp+128h+var_10A], 2Eh ; '.'
                mov     [esp+128h+var_109], 0
                call    GetFullPathNameA
                jmp     short loc_5CF665
; ---------------------------------------------------------------------------

loc_5CF655:                             ; CODE XREF: __getdcwd_lk+12↑j
                lea     eax, [esp+118h+Buffer]
                push    eax             ; lpBuffer
                push    104h            ; nBufferLength
                call    GetCurrentDirectoryA

loc_5CF665:                             ; CODE XREF: __getdcwd_lk+73↑j
                test    eax, eax
                jz      loc_5CF6FF
                inc     eax
                cmp     eax, 104h
                ja      loc_5CF6FF
                mov     edx, dword ptr [esp+118h+arg_4]
                mov     ecx, dword ptr [esp+118h+arg_8]
                test    edx, edx
                jnz     short loc_5CF6B7
                cmp     eax, ecx
                jg      short loc_5CF691
                mov     eax, ecx

loc_5CF691:                             ; CODE XREF: __getdcwd_lk+AD↑j
                push    eax             ; varSize
                call    _malloc
                mov     edx, eax
                add     esp, 4
                test    edx, edx
                jnz     short loc_5CF6D2
                call    __errno
                mov     dword ptr [eax], 0Ch
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebx
                add     esp, 10Ch
                retn
; ---------------------------------------------------------------------------

loc_5CF6B7:                             ; CODE XREF: __getdcwd_lk+A9↑j
                cmp     eax, ecx
                jle     short loc_5CF6D2
                call    __errno
                mov     dword ptr [eax], 22h ; '"'
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebx
                add     esp, 10Ch
                retn
; ---------------------------------------------------------------------------

loc_5CF6D2:                             ; CODE XREF: __getdcwd_lk+BE↑j
                lea     edi, [esp+118h+Buffer]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     ebx, ecx
                mov     edi, edx
                mov     eax, edi
                shr     ecx, 2
                rep movsd
                mov     ecx, ebx
                and     ecx, 3
                rep movsb
                pop     edi
                pop     esi
                pop     ebx
                add     esp, 10Ch
                retn
; ---------------------------------------------------------------------------

loc_5CF6FF:                             ; CODE XREF: __getdcwd_lk+87↑j
                pop     edi
                pop     esi
                xor     eax, eax
                pop     ebx
                add     esp, 10Ch
                retn
__getdcwd_lk    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _validdrive(CHAR RootPathName)
__validdrive    proc near               ; CODE XREF: __getdcwd_lk+15↑p

RootPathName    = byte ptr  4

                mov     eax, dword ptr [esp+RootPathName]
                test    eax, eax
                jnz     short loc_5CF71E
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5CF71E:                             ; CODE XREF: __validdrive+6↑j
                add     al, 40h ; '@'
                mov     byte ptr [esp+5], 3Ah ; ':'
                mov     [esp+RootPathName], al
                lea     eax, [esp+RootPathName]
                push    eax             ; lpRootPathName
                mov     byte ptr [esp+0Ah], 5Ch ; '\'
                mov     byte ptr [esp+0Bh], 0
                call    GetDriveTypeA
                test    eax, eax
                jz      short loc_5CF74D
                cmp     eax, 1
                jz      short loc_5CF74D
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5CF74D:                             ; CODE XREF: __validdrive+30↑j
                xor     eax, eax
                retn
__validdrive    endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; unsigned __int8 *__cdecl _mbsnbcpy(unsigned __int8 *Dest, const unsigned __int8 *Source, size_t Count)
__mbsnbcpy      proc near               ; CODE XREF: __splitpath+34↑p

Destination     = dword ptr  4
Source          = dword ptr  8
Count           = dword ptr  0Ch

                mov     eax, dword_70D4BC
                push    esi
                push    edi
                mov     edi, [esp+8+Destination]
                test    eax, eax
                mov     esi, edi
                jnz     short loc_5CF777
                mov     eax, dword ptr [esp+8+Count]
                mov     ecx, dword ptr [esp+8+Source]
                push    eax             ; Count
                push    ecx             ; Source
                push    edi             ; Destination
                call    _strncpy
                add     esp, 0Ch
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CF777:                             ; CODE XREF: __mbsnbcpy+F↑j
                push    ebp
                push    19h
                call    __lock
                mov     edx, dword ptr [esp+10h+Count]
                add     esp, 4
                test    edx, edx
                jz      short loc_5CF7CD
                mov     eax, dword ptr [esp+0Ch+Source]

loc_5CF78E:                             ; CODE XREF: __mbsnbcpy+6F↓j
                mov     cl, [eax]
                dec     edx
                mov     ebp, ecx
                and     ebp, 0FFh
                test    ss:__mbctype+1h[ebp], 4
                mov     [edi], cl
                jz      short loc_5CF7B7
                inc     edi
                inc     eax
                test    edx, edx
                jz      short loc_5CF7C3
                mov     cl, [eax]
                dec     edx
                mov     [edi], cl
                inc     edi
                inc     eax
                test    cl, cl
                jz      short loc_5CF7C9
                jmp     short loc_5CF7BD
; ---------------------------------------------------------------------------

loc_5CF7B7:                             ; CODE XREF: __mbsnbcpy+52↑j
                inc     edi
                inc     eax
                test    cl, cl
                jz      short loc_5CF7CD

loc_5CF7BD:                             ; CODE XREF: __mbsnbcpy+65↑j
                test    edx, edx
                jnz     short loc_5CF78E
                jmp     short loc_5CF7CD
; ---------------------------------------------------------------------------

loc_5CF7C3:                             ; CODE XREF: __mbsnbcpy+58↑j
                mov     byte ptr [edi-1], 0
                jmp     short loc_5CF7CD
; ---------------------------------------------------------------------------

loc_5CF7C9:                             ; CODE XREF: __mbsnbcpy+63↑j
                mov     byte ptr [edi-2], 0

loc_5CF7CD:                             ; CODE XREF: __mbsnbcpy+38↑j
                mov     eax, edx
                dec     edx
                test    eax, eax
                jz      short loc_5CF7E7
                lea     ecx, [edx+1]
                xor     eax, eax
                mov     edx, ecx
                shr     ecx, 2
                rep stosd
                mov     ecx, edx
                and     ecx, 3
                rep stosb

loc_5CF7E7:                             ; CODE XREF: __mbsnbcpy+82↑j
                push    19h
                call    __unlock
                add     esp, 4
                mov     eax, esi
                pop     ebp
                pop     edi
                pop     esi
                retn
__mbsnbcpy      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ValidateRead(const void *lp, UINT_PTR ucb)
?_ValidateRead@@YAHPBXI@Z proc near     ; CODE XREF: FindHandler(EHExceptionRecord *,EHRegistrationNode *,_CONTEXT *,void *,_s_FuncInfo const *,uchar,int,EHRegistrationNode *)+7B↑p

lp              = dword ptr  4
ucb             = dword ptr  8

                mov     eax, dword ptr [esp+ucb]
                mov     ecx, dword ptr [esp+lp]
                push    esi
                push    eax             ; ucb
                push    ecx             ; lp
                mov     esi, 1
                call    IsBadReadPtr
                test    eax, eax
                jz      short loc_5CF81C
                xor     esi, esi

loc_5CF81C:                             ; CODE XREF: _ValidateRead(void const *,uint)+18↑j
                mov     eax, esi
                pop     esi
                retn
?_ValidateRead@@YAHPBXI@Z endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ValidateWrite(void *lp, UINT_PTR ucb)
?_ValidateWrite@@YAHPAXI@Z proc near    ; CODE XREF: BuildCatchObject(EHExceptionRecord *,EHRegistrationNode *,_s_HandlerType const *,_s_CatchableType const *)+79↑p

lp              = dword ptr  4
ucb             = dword ptr  8

                mov     eax, dword ptr [esp+ucb]
                mov     ecx, dword ptr [esp+lp]
                push    esi
                push    eax             ; ucb
                push    ecx             ; lp
                mov     esi, 1
                call    IsBadWritePtr
                test    eax, eax
                jz      short loc_5CF83C
                xor     esi, esi

loc_5CF83C:                             ; CODE XREF: _ValidateWrite(void *,uint)+18↑j
                mov     eax, esi
                pop     esi
                retn
?_ValidateWrite@@YAHPAXI@Z endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _ValidateExecute(FARPROC lpfn)
?_ValidateExecute@@YAHP6GHXZ@Z proc near

lpfn            = dword ptr  4

                mov     eax, dword ptr [esp+lpfn]
                push    esi
                push    eax             ; lpfn
                mov     esi, 1
                call    IsBadCodePtr
                test    eax, eax
                jz      short loc_5CF857
                xor     esi, esi

loc_5CF857:                             ; CODE XREF: _ValidateExecute(int (*)(void))+13↑j
                mov     eax, esi
                pop     esi
                retn
?_ValidateExecute@@YAHP6GHXZ@Z endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; unsigned int __cdecl _statusfp()
__statusfp      proc near

var_4           = dword ptr -4

                push    ebp
                mov     ebp, esp
                push    ecx
                fstsw   word ptr [ebp+var_4]
                mov     eax, dword ptr [ebp+var_4]
                push    eax
                call    __abstract_sw
                add     esp, 4
                mov     esp, ebp
                pop     ebp
                retn
__statusfp      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; unsigned int __cdecl _clearfp()
__clearfp       proc near

var_4           = dword ptr -4

                push    ebp
                mov     ebp, esp
                push    ecx
                fnstsw  word ptr [ebp+var_4]
                fnclex
                mov     eax, dword ptr [ebp+var_4]
                push    eax
                call    __abstract_sw
                add     esp, 4
                mov     esp, ebp
                pop     ebp
                retn
__clearfp       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; unsigned int __cdecl _control87(unsigned int NewValue, unsigned int Mask)
__control87     proc near               ; CODE XREF: __controlfp+F↓p

var_4           = dword ptr -4
NewValue        = dword ptr  8
varMask            = dword ptr  0Ch

                push    ebp
                mov     ebp, esp
                push    ecx
                push    esi
                fstcw   word ptr [ebp+var_4]
                mov     eax, dword ptr [ebp+var_4]
                push    eax
                call    __abstract_cw
                mov     ecx, dword ptr [ebp+varMask]
                mov     edx, dword ptr [ebp+NewValue]
                mov     esi, ecx
                add     esp, 4
                not     ecx
                and     esi, edx
                and     ecx, eax
                or      esi, ecx
                push    esi
                call    __hw_cw
                add     esp, 4
                mov     [ebp+varMask], eax
                fldcw   word ptr [ebp+varMask]
                mov     eax, esi
                pop     esi
                mov     esp, ebp
                pop     ebp
                retn
__control87     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; unsigned int __cdecl _controlfp(unsigned int NewValue, unsigned int Mask)
__controlfp     proc near               ; CODE XREF: __setdefaultprecision+A↑p

NewValue        = dword ptr  4
varMask            = dword ptr  8

                mov     eax, dword ptr [esp+varMask]
                mov     ecx, dword ptr [esp+NewValue]
                and     eax, 0FFF7FFFFh
                push    eax             ; Mask
                push    ecx             ; NewValue
                call    __control87
                add     esp, 8
                retn
__controlfp     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; void __cdecl _fpreset()
__fpreset       proc near
                push    esi
                call    ___pxcptinfoptrs
                mov     esi, [eax]
                fninit
                call    __setdefaultprecision
                test    esi, esi
                jz      short loc_5CF92C
                mov     eax, dword ptr [esi+4]
                test    dword ptr [eax], 10008h
                jz      short loc_5CF92C
                mov     dword ptr [eax+20h], 0
                mov     dword ptr [eax+24h], 0FFFFh

loc_5CF92C:                             ; CODE XREF: __fpreset+11↑j
                pop     esi
                retn
__fpreset       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__abstract_cw   proc near               ; CODE XREF: __control87+D↑p

arg_0           = dword ptr  4

                push    ebx
                mov     ebx, dword ptr [esp+4+arg_0]
                xor     eax, eax
                test    bl, 1
                jz      short loc_5CF941
                mov     eax, 10h

loc_5CF941:                             ; CODE XREF: __abstract_cw+A↑j
                test    bl, 4
                jz      short loc_5CF948
                or      al, 8

loc_5CF948:                             ; CODE XREF: __abstract_cw+14↑j
                test    bl, 8
                jz      short loc_5CF94F
                or      al, 4

loc_5CF94F:                             ; CODE XREF: __abstract_cw+1B↑j
                test    bl, 10h
                jz      short loc_5CF956
                or      al, 2

loc_5CF956:                             ; CODE XREF: __abstract_cw+22↑j
                test    bl, 20h
                jz      short loc_5CF95D
                or      al, 1

loc_5CF95D:                             ; CODE XREF: __abstract_cw+29↑j
                test    bl, 2
                jz      short loc_5CF967
                or      eax, 80000h

loc_5CF967:                             ; CODE XREF: __abstract_cw+30↑j
                mov     edx, ebx
                and     edx, 0FFFFh
                mov     ecx, edx
                and     ecx, 0C00h
                cmp     ecx, 400h
                jg      short loc_5CF986
                jnz     short loc_5CF99E
                or      ah, 1
                jmp     short loc_5CF99E
; ---------------------------------------------------------------------------

loc_5CF986:                             ; CODE XREF: __abstract_cw+4D↑j
                cmp     ecx, 800h
                jz      short loc_5CF99B
                cmp     ecx, 0C00h
                jnz     short loc_5CF99E
                or      ah, 3
                jmp     short loc_5CF99E
; ---------------------------------------------------------------------------

loc_5CF99B:                             ; CODE XREF: __abstract_cw+5C↑j
                or      ah, 2

loc_5CF99E:                             ; CODE XREF: __abstract_cw+4F↑j
                and     edx, 300h
                jz      short loc_5CF9B5
                cmp     edx, 200h
                jnz     short loc_5CF9BA
                or      eax, 10000h
                jmp     short loc_5CF9BA
; ---------------------------------------------------------------------------

loc_5CF9B5:                             ; CODE XREF: __abstract_cw+74↑j
                or      eax, 20000h

loc_5CF9BA:                             ; CODE XREF: __abstract_cw+7C↑j
                test    bh, 10h
                jz      short loc_5CF9C4
                or      eax, 40000h

loc_5CF9C4:                             ; CODE XREF: __abstract_cw+8D↑j
                pop     ebx
                retn
__abstract_cw   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__hw_cw         proc near               ; CODE XREF: __control87+26↑p

arg_0           = dword ptr  4

                mov     edx, dword ptr [esp+arg_0]
                xor     eax, eax
                test    dl, 10h
                jz      short loc_5CF9E0
                mov     eax, 1

loc_5CF9E0:                             ; CODE XREF: __hw_cw+9↑j
                test    dl, 8
                jz      short loc_5CF9E7
                or      al, 4

loc_5CF9E7:                             ; CODE XREF: __hw_cw+13↑j
                test    dl, 4
                jz      short loc_5CF9EE
                or      al, 8

loc_5CF9EE:                             ; CODE XREF: __hw_cw+1A↑j
                test    dl, 2
                jz      short loc_5CF9F5
                or      al, 10h

loc_5CF9F5:                             ; CODE XREF: __hw_cw+21↑j
                test    dl, 1
                jz      short loc_5CF9FC
                or      al, 20h

loc_5CF9FC:                             ; CODE XREF: __hw_cw+28↑j
                test    edx, 80000h
                jz      short loc_5CFA06
                or      al, 2

loc_5CFA06:                             ; CODE XREF: __hw_cw+32↑j
                mov     ecx, edx
                and     ecx, 300h
                cmp     ecx, 100h
                ja      short loc_5CFA1D
                jnz     short loc_5CFA35
                or      ah, 4
                jmp     short loc_5CFA35
; ---------------------------------------------------------------------------

loc_5CFA1D:                             ; CODE XREF: __hw_cw+44↑j
                cmp     ecx, 200h
                jz      short loc_5CFA32
                cmp     ecx, 300h
                jnz     short loc_5CFA35
                or      ah, 0Ch
                jmp     short loc_5CFA35
; ---------------------------------------------------------------------------

loc_5CFA32:                             ; CODE XREF: __hw_cw+53↑j
                or      ah, 8

loc_5CFA35:                             ; CODE XREF: __hw_cw+46↑j
                mov     ecx, edx
                and     ecx, 30000h
                jz      short loc_5CFA4C
                cmp     ecx, 10000h
                jnz     short loc_5CFA4F
                or      ah, 2
                jmp     short loc_5CFA4F
; ---------------------------------------------------------------------------

loc_5CFA4C:                             ; CODE XREF: __hw_cw+6D↑j
                or      ah, 3

loc_5CFA4F:                             ; CODE XREF: __hw_cw+75↑j
                test    edx, 40000h
                jz      short locret_5CFA5A
                or      ah, 10h

locret_5CFA5A:                          ; CODE XREF: __hw_cw+85↑j
                retn
__hw_cw         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__abstract_sw   proc near               ; CODE XREF: __statusfp+C↑p

arg_0           = byte ptr  4

                mov     cl, [esp+arg_0]
                xor     eax, eax
                test    cl, 1
                jz      short loc_5CFA70
                mov     eax, 10h

loc_5CFA70:                             ; CODE XREF: __abstract_sw+9↑j
                test    cl, 4
                jz      short loc_5CFA77
                or      al, 8

loc_5CFA77:                             ; CODE XREF: __abstract_sw+13↑j
                test    cl, 8
                jz      short loc_5CFA7E
                or      al, 4

loc_5CFA7E:                             ; CODE XREF: __abstract_sw+1A↑j
                test    cl, 10h
                jz      short loc_5CFA85
                or      al, 2

loc_5CFA85:                             ; CODE XREF: __abstract_sw+21↑j
                test    cl, 20h
                jz      short loc_5CFA8C
                or      al, 1

loc_5CFA8C:                             ; CODE XREF: __abstract_sw+28↑j
                test    cl, 2
                jz      short locret_5CFA96
                or      eax, 80000h

locret_5CFA96:                          ; CODE XREF: __abstract_sw+2F↑j
                retn
__abstract_sw   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__ZeroTail      proc near               ; CODE XREF: __RoundMan+50↓p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     ecx, dword ptr [esp+arg_4]
                push    esi
                mov     eax, ecx
                cdq
                and     edx, 1Fh
                add     eax, edx
                mov     esi, eax
                mov     eax, ecx
                cdq
                xor     eax, edx
                mov     ecx, 1Fh
                sub     eax, edx
                and     eax, 1Fh
                xor     eax, edx
                sub     eax, edx
                or      edx, 0FFFFFFFFh
                sub     ecx, eax
                mov     eax, dword ptr [esp+4+arg_0]
                shl     edx, cl
                sar     esi, 5
                mov     ecx, dword ptr [eax+esi*4]
                not     edx
                test    ecx, edx
                jz      short loc_5CFADD
                xor     eax, eax
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CFADD:                             ; CODE XREF: __ZeroTail+37↑j
                inc     esi
                cmp     esi, 3
                jge     short loc_5CFAFF
                lea     eax, [eax+esi*4]

loc_5CFAE6:                             ; CODE XREF: __ZeroTail+52↓j
                cmp     dword ptr [eax], 0
                jnz     short loc_5CFAFB
                inc     esi
                add     eax, 4
                cmp     esi, 3
                jl      short loc_5CFAE6
                mov     eax, 1
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CFAFB:                             ; CODE XREF: __ZeroTail+49↑j
                xor     eax, eax
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5CFAFF:                             ; CODE XREF: __ZeroTail+41↑j
                mov     eax, 1
                pop     esi
                retn
__ZeroTail      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__IncMan        proc near               ; CODE XREF: __RoundMan+62↓p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     ecx, dword ptr [esp+arg_4]
                push    ebx
                mov     eax, ecx
                push    esi
                cdq
                and     edx, 1Fh
                mov     ebx, dword ptr [esp+8+arg_0]
                add     eax, edx
                push    edi
                mov     esi, eax
                mov     eax, ecx
                cdq
                xor     eax, edx
                mov     ecx, 1Fh
                sub     eax, edx
                and     eax, 1Fh
                xor     eax, edx
                sub     eax, edx
                sub     ecx, eax
                mov     eax, 1
                sar     esi, 5
                shl     eax, cl
                mov     ecx, dword ptr [ebx+esi*4]
                lea     edi, [ebx+esi*4]
                push    edi
                push    eax
                push    ecx
                call    ___addl
                add     esp, 0Ch
                dec     esi
                js      short loc_5CFB75
                lea     edi, [ebx+esi*4]

loc_5CFB5B:                             ; CODE XREF: __IncMan+63↓j
                test    eax, eax
                jz      short loc_5CFB75
                mov     edx, dword ptr [edi]
                push    edi
                push    1
                push    edx
                call    ___addl
                add     esp, 0Ch
                dec     esi
                sub     edi, 4
                test    esi, esi
                jge     short loc_5CFB5B

loc_5CFB75:                             ; CODE XREF: __IncMan+46↑j
                pop     edi
                pop     esi
                pop     ebx
                retn
__IncMan        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__RoundMan      proc near               ; CODE XREF: __ld12cvt+95↓p

var_4           = dword ptr -4
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                push    ecx
                mov     eax, dword ptr [esp+4+arg_4]
                push    ebx
                push    ebp
                push    esi
                lea     ebp, [eax-1]
                mov     ebx, dword ptr [esp+10h+arg_0]
                mov     [esp+10h+arg_4], ebp
                inc     ebp
                mov     eax, ebp
                push    edi
                cdq
                and     edx, 1Fh
                mov     edi, 1Fh
                add     eax, edx
                mov     [esp+14h+var_4], 0
                mov     esi, eax
                mov     eax, ebp
                cdq
                xor     eax, edx
                sub     eax, edx
                and     eax, 1Fh
                xor     eax, edx
                sub     eax, edx
                mov     edx, 1
                sub     edi, eax
                mov     ecx, edi
                sar     esi, 5
                shl     edx, cl
                test    [ebx+esi*4], edx
                jz      short loc_5CFBEE
                inc     ebp
                push    ebp
                push    ebx
                call    __ZeroTail
                add     esp, 8
                test    eax, eax
                jnz     short loc_5CFBEE
                mov     eax, dword ptr [esp+14h+arg_4]
                push    eax
                push    ebx
                call    __IncMan
                add     esp, 8
                mov     edx, eax
                jmp     short loc_5CFBF2
; ---------------------------------------------------------------------------

loc_5CFBEE:                             ; CODE XREF: __RoundMan+4B↑j
                mov     edx, dword ptr [esp+14h+var_4]

loc_5CFBF2:                             ; CODE XREF: __RoundMan+6C↑j
                or      eax, 0FFFFFFFFh
                mov     ecx, edi
                shl     eax, cl
                mov     ecx, dword ptr [ebx+esi*4]
                and     ecx, eax
                mov     [ebx+esi*4], ecx
                inc     esi
                cmp     esi, 3
                jge     short loc_5CFC15
                mov     ecx, 3
                lea     edi, [ebx+esi*4]
                sub     ecx, esi
                xor     eax, eax
                rep stosd

loc_5CFC15:                             ; CODE XREF: __RoundMan+85↑j
                pop     edi
                pop     esi
                pop     ebp
                mov     eax, edx
                pop     ebx
                pop     ecx
                retn
__RoundMan      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__CopyMan       proc near               ; CODE XREF: __ld12cvt+84↓p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     eax, dword ptr [esp+arg_4]
                mov     ecx, dword ptr [esp+arg_0]
                push    esi
                sub     ecx, eax
                mov     edx, 3

loc_5CFC30:                             ; CODE XREF: __CopyMan+19↓j
                mov     esi, [eax]
                mov     [eax+ecx], esi
                add     eax, 4
                dec     edx
                jnz     short loc_5CFC30
                pop     esi
                retn
__CopyMan       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__FillZeroMan   proc near               ; CODE XREF: __ld12cvt+68↓p

arg_0           = dword ptr  4

                mov     ecx, dword ptr [esp+arg_0]
                xor     eax, eax
                mov     [ecx], eax
                mov     [ecx+4], eax
                mov     [ecx+8], eax
                retn
__FillZeroMan   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__IsZeroMan     proc near               ; CODE XREF: __ld12cvt+53↓p

arg_0           = dword ptr  4

                mov     ecx, dword ptr [esp+arg_0]
                xor     eax, eax

loc_5CFC56:                             ; CODE XREF: __IsZeroMan+12↓j
                cmp     dword ptr [ecx], 0
                jnz     short loc_5CFC6A
                inc     eax
                add     ecx, 4
                cmp     eax, 3
                jl      short loc_5CFC56
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5CFC6A:                             ; CODE XREF: __IsZeroMan+9↑j
                xor     eax, eax
                retn
__IsZeroMan     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__ShrMan        proc near               ; CODE XREF: __ld12cvt+E9↓p

var_8           = dword ptr -8
var_4           = dword ptr -4
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                sub     esp, 8
                mov     ecx, dword ptr [esp+8+arg_4]
                push    ebx
                mov     eax, ecx
                push    ebp
                cdq
                and     edx, 1Fh
                push    esi
                add     eax, edx
                push    edi
                sar     eax, 5
                mov     [esp+18h+var_4], eax
                mov     eax, ecx
                cdq
                xor     eax, edx
                mov     esi, [esp+18h+arg_0]
                sub     eax, edx
                or      edi, 0FFFFFFFFh
                and     eax, 1Fh
                mov     ebp, 20h ; ' '
                xor     eax, edx
                xor     ebx, ebx
                sub     eax, edx
                mov     [esp+18h+arg_4], 3
                mov     ecx, eax
                shl     edi, cl
                sub     ebp, eax
                not     edi

loc_5CFCB6:                             ; CODE XREF: __ShrMan+6D↓j
                mov     edx, dword ptr [esi]
                mov     ecx, edi
                and     ecx, edx
                add     esi, 4
                mov     [esp+18h+var_8], ecx
                mov     ecx, eax
                shr     edx, cl
                mov     ecx, ebp
                or      edx, ebx
                mov     ebx, dword ptr [esp+18h+var_8]
                shl     ebx, cl
                mov     ecx, dword ptr [esp+18h+arg_4]
                mov     [esi-4], edx
                dec     ecx
                mov     [esp+18h+arg_4], ecx
                jnz     short loc_5CFCB6
                mov     ebx, dword ptr [esp+18h+var_4]
                mov     esi, 2
                mov     ecx, 8
                lea     edi, ds:0[ebx*4]

loc_5CFCF4:                             ; CODE XREF: __ShrMan+A7↓j
                cmp     esi, ebx
                jl      short loc_5CFD08
                mov     edx, dword ptr [esp+18h+arg_0]
                mov     eax, ecx
                sub     eax, edi
                mov     eax, dword ptr [edx+eax]
                mov     [edx+ecx], eax
                jmp     short loc_5CFD13
; ---------------------------------------------------------------------------

loc_5CFD08:                             ; CODE XREF: __ShrMan+86↑j
                mov     edx, dword ptr [esp+18h+arg_0]
                mov     dword ptr [edx+ecx], 0

loc_5CFD13:                             ; CODE XREF: __ShrMan+96↑j
                dec     esi
                sub     ecx, 4
                jns     short loc_5CFCF4
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8
                retn
__ShrMan        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__ld12cvt       proc near               ; CODE XREF: sub_5CFF00+F↓p

var_18          = dword ptr -18h
var_14          = dword ptr -14h
var_10          = dword ptr -10h
var_C           = byte ptr -0Ch
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                sub     esp, 18h
                mov     ecx, dword ptr [esp+18h+arg_0]
                xor     eax, eax
                push    ebx
                push    ebp
                mov     ax, [ecx+0Ah]
                mov     edx, dword ptr [ecx+2]
                mov     ebx, eax
                and     eax, 8000h
                mov     ebp, eax
                mov     eax, dword ptr [ecx+6]
                mov     [esp+20h+var_18], eax
                xor     eax, eax
                mov     ax, [ecx]
                and     ebx, 7FFFh
                sub     ebx, 3FFFh
                push    esi
                shl     eax, 10h
                push    edi
                mov     edi, [esp+28h+arg_8]
                cmp     ebx, 0FFFFC001h
                mov     [esp+28h+var_14], edx
                mov     [esp+28h+var_10], eax
                jnz     short loc_5CFDAA
                lea     ecx, [esp+28h+var_18]
                xor     esi, esi
                push    ecx
                call    __IsZeroMan
                add     esp, 4
                test    eax, eax
                jnz     loc_5CFEAF
                lea     edx, [esp+28h+var_18]
                push    edx
                call    __FillZeroMan
                add     esp, 4
                mov     eax, 2
                jmp     loc_5CFEB1
; ---------------------------------------------------------------------------

loc_5CFDAA:                             ; CODE XREF: __ld12cvt+4A↑j
                lea     eax, [esp+28h+var_18]
                lea     ecx, [esp+28h+var_C]
                push    eax
                push    ecx
                call    __CopyMan
                mov     edx, dword ptr [edi+8]
                add     esp, 8
                lea     eax, [esp+28h+var_18]
                push    edx
                push    eax
                call    __RoundMan
                add     esp, 8
                test    eax, eax
                jz      short loc_5CFDD2
                inc     ebx

loc_5CFDD2:                             ; CODE XREF: __ld12cvt+9F↑j
                mov     eax, dword ptr [edi+4]
                mov     esi, [edi+8]
                mov     ecx, eax
                sub     ecx, esi
                cmp     ebx, ecx
                jge     short loc_5CFDF9
                lea     edx, [esp+28h+var_18]
                push    edx
                call    __FillZeroMan
                add     esp, 4
                xor     esi, esi
                mov     eax, 2
                jmp     loc_5CFEB1
; ---------------------------------------------------------------------------

loc_5CFDF9:                             ; CODE XREF: __ld12cvt+AE↑j
                cmp     ebx, eax
                jg      short loc_5CFE4D
                sub     eax, ebx
                lea     ecx, [esp+28h+var_18]
                mov     esi, eax
                lea     eax, [esp+28h+var_C]
                push    eax
                push    ecx
                call    __CopyMan
                add     esp, 8
                lea     edx, [esp+28h+var_18]
                push    esi
                push    edx
                call    __ShrMan
                mov     eax, dword ptr [edi+8]
                add     esp, 8
                lea     ecx, [esp+28h+var_18]
                push    eax
                push    ecx
                call    __RoundMan
                mov     edx, dword ptr [edi+0Ch]
                add     esp, 8
                inc     edx
                lea     eax, [esp+28h+var_18]
                push    edx
                push    eax
                call    __ShrMan
                add     esp, 8
                xor     esi, esi
                mov     eax, 2
                jmp     short loc_5CFEB1
; ---------------------------------------------------------------------------

loc_5CFE4D:                             ; CODE XREF: __ld12cvt+CB↑j
                cmp     ebx, [edi]
                jl      short loc_5CFE8B
                lea     ecx, [esp+28h+var_18]
                push    ecx
                call    __FillZeroMan
                mov     ebx, dword ptr [esp+2Ch+var_18]
                mov     edx, dword ptr [edi+0Ch]
                add     esp, 4
                lea     eax, [esp+28h+var_18]
                or      ebx, 80000000h
                push    edx
                push    eax
                mov     [esp+30h+var_18], ebx
                call    __ShrMan
                mov     esi, [edi+14h]
                mov     eax, dword ptr [edi]
                add     esp, 8
                add     esi, eax
                mov     eax, 1
                jmp     short loc_5CFEB1
; ---------------------------------------------------------------------------

loc_5CFE8B:                             ; CODE XREF: __ld12cvt+11F↑j
                mov     esi, [edi+14h]
                mov     ecx, dword ptr [edi+0Ch]
                add     esi, ebx
                mov     ebx, dword ptr [esp+28h+var_18]
                lea     edx, [esp+28h+var_18]
                and     ebx, 7FFFFFFFh
                push    ecx
                push    edx
                mov     [esp+30h+var_18], ebx
                call    __ShrMan
                add     esp, 8

loc_5CFEAF:                             ; CODE XREF: __ld12cvt+5D↑j
                xor     eax, eax

loc_5CFEB1:                             ; CODE XREF: __ld12cvt+75↑j
                mov     edx, dword ptr [edi+0Ch]
                mov     ecx, 1Fh
                sub     ecx, edx
                mov     edx, dword ptr [esp+28h+var_18]
                shl     esi, cl
                mov     edi, [edi+10h]
                neg     ebp
                sbb     ebp, ebp
                and     ebp, 80000000h
                or      esi, ebp
                or      esi, edx
                cmp     edi, 40h ; '@'
                jnz     short loc_5CFEEC
                mov     ecx, dword ptr [esp+28h+arg_4]
                mov     edx, dword ptr [esp+28h+var_14]
                mov     [ecx+4], esi
                mov     [ecx], edx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
; ---------------------------------------------------------------------------

loc_5CFEEC:                             ; CODE XREF: __ld12cvt+1A5↑j
                cmp     edi, 20h ; ' '
                jnz     short loc_5CFEF7
                mov     ecx, dword ptr [esp+28h+arg_4]
                mov     [ecx], esi

loc_5CFEF7:                             ; CODE XREF: __ld12cvt+1BF↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
__ld12cvt       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_5CFF00      proc near               ; CODE XREF: __fltin2+4B↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     eax, dword ptr [esp+arg_4]
                mov     ecx, dword ptr [esp+arg_0]
                push    offset unk_641CA8
                push    eax
                push    ecx
                call    __ld12cvt
                add     esp, 0Ch
                retn
sub_5CFF00      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_5CFF20      proc near               ; CODE XREF: sub_5D0040+2C↓p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     eax, dword ptr [esp+arg_4]
                mov     ecx, dword ptr [esp+arg_0]
                push    offset unk_641CC0
                push    eax
                push    ecx
                call    __ld12cvt
                add     esp, 0Ch
                retn
sub_5CFF20      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__ld12told      proc near               ; CODE XREF: __atoldbl+2C↓p

var_C           = dword ptr -0Ch
var_8           = dword ptr -8
var_4           = dword ptr -4
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                sub     esp, 0Ch
                mov     ecx, dword ptr [esp+0Ch+arg_0]
                push    ebx
                push    esi
                push    edi
                mov     ax, [ecx+0Ah]
                mov     edx, dword ptr [ecx+2]
                mov     esi, eax
                and     eax, 8000h
                mov     edi, eax
                mov     eax, dword ptr [ecx+6]
                mov     [esp+18h+var_C], eax
                xor     eax, eax
                mov     ax, [ecx]
                lea     ecx, [esp+18h+var_C]
                shl     eax, 10h
                push    40h ; '@'
                push    ecx
                xor     ebx, ebx
                and     esi, 7FFFh
                mov     [esp+20h+var_8], edx
                mov     [esp+20h+var_4], eax
                call    __RoundMan
                add     esp, 8
                test    eax, eax
                jz      short loc_5CFF94
                mov     ecx, 80000000h
                inc     esi
                jmp     short loc_5CFF98
; ---------------------------------------------------------------------------

loc_5CFF94:                             ; CODE XREF: __ld12told+4A↑j
                mov     ecx, dword ptr [esp+18h+var_C]

loc_5CFF98:                             ; CODE XREF: __ld12told+52↑j
                cmp     si, 7FFFh
                jnz     short loc_5CFFA4
                mov     ebx, 1

loc_5CFFA4:                             ; CODE XREF: __ld12told+5D↑j
                mov     eax, dword ptr [esp+18h+arg_4]
                mov     edx, dword ptr [esp+18h+var_8]
                or      edi, esi
                mov     [eax+8], di
                mov     [eax+4], ecx
                mov     [eax], edx
                pop     edi
                mov     eax, ebx
                pop     esi
                pop     ebx
                add     esp, 0Ch
                retn
__ld12told      endp


; =============== S U B R O U T I N E =======================================


sub_5CFFC0      proc near               ; CODE XREF: __fassign+15↑p

var_C           = byte ptr -0Ch
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     eax, dword ptr [esp+arg_4]
                sub     esp, 0Ch
                lea     ecx, [esp+0Ch+arg_4]
                lea     edx, [esp+0Ch+var_C]
                push    0
                push    0
                push    0
                push    0
                push    eax
                push    ecx
                push    edx
                call    ___strgtold12
                mov     eax, dword ptr [esp+28h+arg_0]
                add     esp, 1Ch
                lea     ecx, [esp+0Ch+var_C]
                push    eax
                push    ecx
                call    sub_5CFF00
                add     esp, 8
                add     esp, 0Ch
                retn
sub_5CFFC0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _atoldbl(_LDOUBLE *Result, char *String)
__atoldbl       proc near

var_C           = byte ptr -0Ch
Result          = dword ptr  4
String          = dword ptr  8

                mov     eax, dword ptr [esp+String]
                sub     esp, 0Ch
                lea     ecx, [esp+0Ch+String]
                lea     edx, [esp+0Ch+var_C]
                push    0
                push    0
                push    0
                push    1
                push    eax
                push    ecx
                push    edx
                call    ___strgtold12
                mov     eax, dword ptr [esp+28h+Result]
                add     esp, 1Ch
                lea     ecx, [esp+0Ch+var_C]
                push    eax
                push    ecx
                call    __ld12told
                add     esp, 8
                add     esp, 0Ch
                retn
__atoldbl       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_5D0040      proc near               ; CODE XREF: __fassign+3C↑p

var_C           = byte ptr -0Ch
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     eax, dword ptr [esp+arg_4]
                sub     esp, 0Ch
                lea     ecx, [esp+0Ch+arg_4]
                lea     edx, [esp+0Ch+var_C]
                push    0
                push    0
                push    0
                push    0
                push    eax
                push    ecx
                push    edx
                call    ___strgtold12
                mov     eax, dword ptr [esp+28h+arg_0]
                add     esp, 1Ch
                lea     ecx, [esp+0Ch+var_C]
                push    eax
                push    ecx
                call    sub_5CFF20
                add     esp, 8
                add     esp, 0Ch
                retn
sub_5D0040      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__fptostr       proc near               ; CODE XREF: __cftoe+4D↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                mov     ecx, dword ptr [esp+arg_8]
                push    ebx
                push    ebp
                mov     ebp, [esp+8+arg_0]
                mov     edx, dword ptr [ecx+0Ch]
                push    esi
                mov     esi, [esp+0Ch+arg_4]
                push    edi
                lea     edi, [ebp+1]
                mov     byte ptr [ebp+0], 30h ; '0'
                test    esi, esi
                mov     eax, edi
                jle     short loc_5D00BE
                mov     ebx, esi

loc_5D00A2:                             ; CODE XREF: __fptostr+38↓j
                mov     cl, [edx]
                test    cl, cl
                jz      short loc_5D00AE
                movsx   ecx, cl
                inc     edx
                jmp     short loc_5D00B3
; ---------------------------------------------------------------------------

loc_5D00AE:                             ; CODE XREF: __fptostr+26↑j
                mov     ecx, 30h ; '0'

loc_5D00B3:                             ; CODE XREF: __fptostr+2C↑j
                mov     [eax], cl
                inc     eax
                dec     esi
                dec     ebx
                jnz     short loc_5D00A2
                mov     ecx, dword ptr [esp+10h+arg_8]

loc_5D00BE:                             ; CODE XREF: __fptostr+1E↑j
                test    esi, esi
                mov     byte ptr [eax], 0
                jl      short loc_5D00E1
                cmp     byte ptr [edx], 35h ; '5'
                jl      short loc_5D00E1
                mov     dl, [eax-1]
                dec     eax
                cmp     dl, 39h ; '9'
                jnz     short loc_5D00DF

loc_5D00D3:                             ; CODE XREF: __fptostr+5D↓j
                mov     byte ptr [eax], 30h ; '0'
                mov     dl, [eax-1]
                dec     eax
                cmp     dl, 39h ; '9'
                jz      short loc_5D00D3

loc_5D00DF:                             ; CODE XREF: __fptostr+51↑j
                inc     byte ptr [eax]

loc_5D00E1:                             ; CODE XREF: __fptostr+43↑j
                cmp     byte ptr [ebp+0], 31h ; '1'
                jnz     short loc_5D00EF
                inc     dword ptr [ecx+4]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D00EF:                             ; CODE XREF: __fptostr+65↑j
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     eax, ecx
                mov     esi, edi
                mov     edi, ebp
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                and     ecx, 3
                rep movsb
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
__fptostr       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__fltout2       proc near               ; CODE XREF: __cftoe+1A↑p

var_28          = dword ptr -28h
var_24          = dword ptr -24h
var_20          = word ptr -20h
var_1C          = word ptr -1Ch
var_1A          = byte ptr -1Ah
var_18          = byte ptr -18h
arg_0           = byte ptr  4
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                sub     esp, 28h
                lea     eax, [esp+28h+arg_0]
                lea     ecx, [esp+28h+var_28]
                push    ebx
                push    esi
                push    edi
                push    eax
                push    ecx
                call    ___dtold
                add     esp, 8
                lea     edx, [esp+34h+var_1C]
                mov     ecx, dword ptr [esp+34h+var_28]
                push    edx
                push    0
                push    11h
                mov     edx, dword ptr [esp+40h+var_24]
                sub     esp, 0Ch
                mov     eax, esp
                mov     [eax], ecx
                mov     cx, [esp+4Ch+var_20]
                mov     [eax+4], edx
                mov     [eax+8], cx
                call    _$I10_OUTPUT
                mov     edx, dword ptr [esp+4Ch+arg_8]
                lea     edi, [esp+4Ch+var_18]
                movsx   ecx, [esp+4Ch+var_1C]
                mov     [edx+8], eax
                mov     [edx+4], ecx
                movsx   eax, [esp+4Ch+var_1A]
                mov     [edx], eax
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                add     esp, 18h
                repne scasb
                mov     eax, dword ptr [esp+34h+arg_C]
                not     ecx
                sub     edi, ecx
                mov     ebx, ecx
                mov     esi, edi
                mov     edi, eax
                shr     ecx, 2
                rep movsd
                mov     ecx, ebx
                and     ecx, 3
                rep movsb
                pop     edi
                mov     [edx+0Ch], eax
                pop     esi
                mov     eax, edx
                pop     ebx
                add     esp, 28h
                retn
__fltout2       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___dtold        proc near               ; CODE XREF: __fltout2+10↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                push    ebx
                push    ebp
                push    esi
                mov     esi, [esp+0Ch+arg_4]
                push    edi
                mov     ebx, 80000000h
                mov     cx, [esi+6]
                mov     edx, dword ptr [esi+4]
                mov     eax, ecx
                mov     edi, [esi]
                shr     eax, 4
                and     ecx, 8000h
                and     eax, 7FFh
                mov     ebp, ecx
                mov     ecx, eax
                and     edx, 0FFFFFh
                and     ecx, 0FFFFh
                jz      short loc_5D01FF
                cmp     ecx, 7FFh
                jz      short loc_5D01F8
                lea     esi, [eax+3C00h]
                jmp     short loc_5D0221
; ---------------------------------------------------------------------------

loc_5D01F8:                             ; CODE XREF: ___dtold+3E↑j
                mov     esi, 7FFFh
                jmp     short loc_5D0221
; ---------------------------------------------------------------------------

loc_5D01FF:                             ; CODE XREF: ___dtold+36↑j
                xor     ebx, ebx
                cmp     edx, ebx
                jnz     short loc_5D021B
                cmp     edi, ebx
                jnz     short loc_5D021B
                mov     eax, dword ptr [esp+10h+arg_0]
                mov     [eax+4], ebx
                mov     [eax], ebx
                mov     [eax+8], bx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D021B:                             ; CODE XREF: ___dtold+53↑j
                lea     esi, [eax+3C01h]

loc_5D0221:                             ; CODE XREF: ___dtold+46↑j
                mov     eax, dword ptr [esp+10h+arg_0]
                mov     ecx, edi
                shr     ecx, 15h
                shl     edx, 0Bh
                or      ecx, edx
                or      ecx, ebx
                shl     edi, 0Bh
                test    ecx, 80000000h
                mov     [eax+4], ecx
                mov     [eax], edi
                jnz     short loc_5D0263

loc_5D0241:                             ; CODE XREF: ___dtold+B1↓j
                mov     edx, dword ptr [eax]
                add     ecx, ecx
                mov     edi, edx
                add     edx, edx
                shr     edi, 1Fh
                or      edi, ecx
                add     esi, 0FFFFh
                mov     ecx, edi
                mov     [eax+4], edi
                test    ecx, 80000000h
                mov     [eax], edx
                jz      short loc_5D0241

loc_5D0263:                             ; CODE XREF: ___dtold+8F↑j
                or      esi, ebp
                pop     edi
                mov     [eax+8], si
                pop     esi
                pop     ebp
                pop     ebx
                retn
___dtold        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function noreturn

__fptrap        proc near               ; CODE XREF: __output+4DD↑p
                push    2
                call    __amsg_exit
__fptrap        endp

; ---------------------------------------------------------------------------
                add     esp, 4
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__87except      proc near               ; CODE XREF: __startOneArgErrorHandling+24↑p

Arguments       = dword ptr -58h
var_30          = dword ptr -30h
var_2C          = dword ptr -2Ch
var_20          = dword ptr -20h
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                sub     esp, 58h
                mov     ecx, dword ptr [esp+58h+arg_8]
                push    ebx
                push    esi
                mov     esi, [esp+60h+arg_4]
                xor     eax, eax
                push    edi
                mov     ax, [ecx]
                mov     ecx, dword ptr [esi]
                dec     ecx             ; switch 8 cases
                mov     [esp+64h+arg_8], eax
                cmp     ecx, 7
                ja      short def_5D029F ; jumptable 005D029F default case, case 6
                jmp     ds:jpt_5D029F[ecx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5D02A6:                             ; CODE XREF: __87except+1F↑j
                mov     edi, 8          ; jumptable 005D029F cases 1,5

loc_5D02AB:                             ; CODE XREF: __87except+D5↓j
                lea     ebx, [esi+18h]
                push    eax
                push    ebx
                push    edi
                call    __handle_exc
                add     esp, 0Ch
                test    eax, eax
                jnz     short loc_5D030C
                mov     eax, dword ptr [esp+64h+arg_0]
                cmp     eax, 10h
                jz      short loc_5D02D7
                cmp     eax, 16h
                jz      short loc_5D02D7
                cmp     eax, 1Dh
                jz      short loc_5D02D7
                and     [esp+64h+var_20], 0FFFFFFFEh
                jmp     short loc_5D02F3
; ---------------------------------------------------------------------------

loc_5D02D7:                             ; CODE XREF: __87except+44↑j
                mov     edx, dword ptr [esp+64h+var_20]
                mov     ecx, dword ptr [esi+10h]
                and     edx, 0FFFFFFE3h
                mov     [esp+64h+var_30], ecx
                or      edx, 3
                mov     [esp+64h+var_20], edx
                mov     edx, dword ptr [esi+14h]
                mov     [esp+64h+var_2C], edx

loc_5D02F3:                             ; CODE XREF: __87except+55↑j
                lea     ecx, [esi+8]
                push    ebx             ; int
                push    ecx             ; int
                push    eax             ; int
                lea     edx, [esp+70h+arg_8]
                push    edi             ; char
                lea     eax, [esp+74h+Arguments]
                push    edx             ; int
                push    eax             ; Arguments
                call    __raise_exc
                add     esp, 18h

loc_5D030C:                             ; CODE XREF: __87except+3B↑j
                mov     eax, dword ptr [esp+64h+arg_8]

def_5D029F:                             ; CODE XREF: __87except+1D↑j
                push    0FFFFh          ; jumptable 005D029F default case, case 6
                push    eax
                call    __ctrlfp
                mov     ecx, dword ptr [esi]
                add     esp, 8
                xor     eax, eax
                cmp     ecx, 8
                jz      short loc_5D033A
                mov     ecx, dword_642634
                test    ecx, ecx
                jnz     short loc_5D033A
                push    esi
                call    sub_5D33C0
                add     esp, 4

loc_5D033A:                             ; CODE XREF: __87except+A5↑j
                test    eax, eax
                jnz     short loc_5D0349
                mov     ecx, dword ptr [esi]
                push    ecx             ; Value
                call    __set_errno
                add     esp, 4

loc_5D0349:                             ; CODE XREF: __87except+BC↑j
                pop     edi
                pop     esi
                pop     ebx
                add     esp, 58h
                retn
; ---------------------------------------------------------------------------

loc_5D0350:                             ; CODE XREF: __87except+1F↑j
                mov     edi, 11h        ; jumptable 005D029F case 3
                jmp     loc_5D02AB
; ---------------------------------------------------------------------------

loc_5D035A:                             ; CODE XREF: __87except+1F↑j
                mov     edi, 12h        ; jumptable 005D029F case 4
                jmp     loc_5D02AB
; ---------------------------------------------------------------------------

loc_5D0364:                             ; CODE XREF: __87except+1F↑j
                mov     edi, 4          ; jumptable 005D029F case 2
                jmp     loc_5D02AB
; ---------------------------------------------------------------------------

loc_5D036E:                             ; CODE XREF: __87except+1F↑j
                mov     edi, 10h        ; jumptable 005D029F case 8
                jmp     loc_5D02AB
; ---------------------------------------------------------------------------

loc_5D0378:                             ; CODE XREF: __87except+1F↑j
                mov     dword ptr [esi], 1 ; jumptable 005D029F case 7
                jmp     short def_5D029F ; jumptable 005D029F default case, case 6
__87except      endp

; ---------------------------------------------------------------------------
jpt_5D029F      dd offset loc_5D02A6    ; DATA XREF: __87except+1F↑r
                dd offset loc_5D0364    ; jump table for switch statement
                dd offset loc_5D0350
                dd offset loc_5D035A
                dd offset loc_5D02A6
                dd offset def_5D029F
                dd offset loc_5D0378
                dd offset loc_5D036E

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__getbuf        proc near               ; CODE XREF: __flsbuf+6B↑p

arg_0           = dword ptr  4

                mov     eax, dword_70D6B8
                push    1000h           ; varSize
                inc     eax
                mov     dword_70D6B8, eax
                call    _malloc
                mov     ecx, dword ptr [esp+4+arg_0]
                add     esp, 4
                test    eax, eax
                mov     [ecx+8], eax
                mov     eax, dword ptr [ecx+0Ch]
                jz      short loc_5D03DF
                mov     edx, dword ptr [ecx+8]
                or      al, 8
                mov     [ecx+0Ch], eax
                mov     dword ptr [ecx+18h], 1000h
                mov     [ecx], edx
                mov     dword ptr [ecx+4], 0
                retn
; ---------------------------------------------------------------------------

loc_5D03DF:                             ; CODE XREF: __getbuf+24↑j
                or      al, 4
                mov     dword ptr [ecx+18h], 2
                mov     [ecx+0Ch], eax
                lea     eax, [ecx+14h]
                mov     edx, eax
                mov     [ecx+8], eax
                mov     [ecx], edx
                mov     dword ptr [ecx+4], 0
                retn
__getbuf        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _isatty(int FileHandle)
__isatty        proc near               ; CODE XREF: __flsbuf+5E↑p

FileHandle      = dword ptr  4

                mov     eax, dword ptr [esp+FileHandle]
                mov     ecx, uNumber
                cmp     eax, ecx
                jb      short loc_5D0411
                xor     eax, eax
                retn
; ---------------------------------------------------------------------------

loc_5D0411:                             ; CODE XREF: __isatty+C↑j
                mov     ecx, eax
                and     eax, 1Fh
                sar     ecx, 5
                lea     edx, [eax+eax*8]
                mov     eax, __pioinfo[ecx*4]
                mov     al, [eax+edx*4+4]
                and     eax, 40h
                retn
__isatty        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl wctomb(char *MbCh, wchar_t WCh)
_wctomb         proc near               ; CODE XREF: __output+2CA↑p

MbCh            = dword ptr  4
WCh             = word ptr  8

                push    ebx
                push    esi
                push    edi
                push    offset Addend   ; lpAddend
                call    InterlockedIncrement
                mov     eax, dword_70E964
                mov     edi, ds:InterlockedDecrement
                test    eax, eax
                jz      short loc_5D0465
                push    offset Addend   ; lpAddend
                call    edi ; InterlockedDecrement
                push    13h
                call    __lock
                add     esp, 4
                mov     esi, 1
                jmp     short loc_5D0467
; ---------------------------------------------------------------------------

loc_5D0465:                             ; CODE XREF: _wctomb+1B↑j
                xor     esi, esi

loc_5D0467:                             ; CODE XREF: _wctomb+33↑j
                mov     eax, dword ptr [esp+0Ch+WCh]
                mov     ecx, dword ptr [esp+0Ch+MbCh]
                push    eax             ; WideCharStr
                push    ecx             ; lpMultiByteStr
                call    __wctomb_lk
                add     esp, 8
                mov     ebx, eax
                test    esi, esi
                jz      short loc_5D048F
                push    13h
                call    __unlock
                add     esp, 4
                mov     eax, ebx
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D048F:                             ; CODE XREF: _wctomb+4D↑j
                push    offset Addend   ; lpAddend
                call    edi ; InterlockedDecrement
                pop     edi
                mov     eax, ebx
                pop     esi
                pop     ebx
                retn
_wctomb         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _wctomb_lk(LPSTR lpMultiByteStr, WCHAR WideCharStr)
__wctomb_lk     proc near               ; CODE XREF: _wctomb+41↑p

lpMultiByteStr  = dword ptr  4
WideCharStr     = word ptr  8

                mov     eax, dword ptr [esp+lpMultiByteStr]
                test    eax, eax
                jnz     short loc_5D04A9
                retn
; ---------------------------------------------------------------------------

loc_5D04A9:                             ; CODE XREF: __wctomb_lk+6↑j
                mov     ecx, dword_70D558
                test    ecx, ecx
                jnz     short loc_5D04C7
                mov     cx, [esp+WideCharStr]
                cmp     cx, 0FFh
                ja      short loc_5D0503
                mov     [eax], cl
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5D04C7:                             ; CODE XREF: __wctomb_lk+11↑j
                mov     edx, [g_SrcSizeInBytes]
                lea     ecx, [esp+lpMultiByteStr]
                push    ecx             ; lpUsedDefaultChar
                mov     ecx, CodePage
                push    0               ; lpDefaultChar
                push    edx             ; cbMultiByte
                push    eax             ; lpMultiByteStr
                lea     eax, [esp+10h+WideCharStr]
                push    1               ; cchWideChar
                push    eax             ; lpWideCharStr
                push    220h            ; dwFlags
                push    ecx             ; CodePage
                mov     [esp+20h+lpMultiByteStr], 0
                call    WideCharToMultiByte
                test    eax, eax
                jz      short loc_5D0503
                mov     ecx, dword ptr [esp+lpMultiByteStr]
                test    ecx, ecx
                jz      short locret_5D0511

loc_5D0503:                             ; CODE XREF: __wctomb_lk+1D↑j
                call    __errno
                mov     dword ptr [eax], 2Ah ; '*'
                or      eax, 0FFFFFFFFh

locret_5D0511:                          ; CODE XREF: __wctomb_lk+61↑j
                retn
__wctomb_lk     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Microsoft VisualC 2-14/net runtime
; Attributes: library function

; int __cdecl unknown_libname_319(_TBYTE, _TBYTE, int, int)
unknown_libname_319 proc near           ; CODE XREF: unknown_libname_320+48↓p

arg_0           = tbyte ptr  4
arg_C           = tbyte ptr  10h
arg_18          = dword ptr  1Ch
arg_1C          = dword ptr  20h

                fld     [esp+arg_C]
                fld     [esp+arg_0]

loc_5D0528:                             ; CODE XREF: unknown_libname_319+10B↓j
                mov     eax, dword ptr [esp+arg_0+4]
                add     eax, eax
                jnb     loc_5D05BA
                xor     eax, 0E000000h
                test    eax, 0E000000h
                jz      short loc_5D0543
                fdivp   st(1), st
                retn
; ---------------------------------------------------------------------------

loc_5D0543:                             ; CODE XREF: unknown_libname_319+1E↑j
                shr     eax, 1Ch
                cmp     byte_641CE0[eax], 0
                jnz     short loc_5D0552
                fdivp   st(1), st
                retn
; ---------------------------------------------------------------------------

loc_5D0552:                             ; CODE XREF: unknown_libname_319+2D↑j
                mov     eax, dword ptr [esp+arg_0+8]
                and     eax, 7FFFh
                jz      short loc_5D05C4
                cmp     eax, 7FFFh
                jz      short loc_5D05C4
                fnstcw  word ptr [esp+arg_18]
                mov     eax, dword ptr [esp+arg_18]
                or      eax, 33Fh
                and     eax, 0F3FFh
                mov     [esp+arg_1C], eax
                fldcw   word ptr [esp+arg_1C]
                mov     eax, dword ptr [esp+arg_C+8]
                and     eax, 7FFFh
                cmp     eax, 1
                jz      short loc_5D05A3
                fmul    flt_641CF0
                fxch    st(1)
                fmul    flt_641CF0
                fxch    st(1)
                fldcw   word ptr [esp+arg_18]
                fdivp   st(1), st
                retn
; ---------------------------------------------------------------------------

loc_5D05A3:                             ; CODE XREF: unknown_libname_319+6A↑j
                fmul    flt_641CF4
                fxch    st(1)
                fmul    flt_641CF4
                fxch    st(1)
                fldcw   word ptr [esp+arg_18]
                fdivp   st(1), st
                retn
; ---------------------------------------------------------------------------

loc_5D05BA:                             ; CODE XREF: unknown_libname_319+E↑j
                mov     eax, dword ptr [esp+arg_0]
                or      eax, dword ptr [esp+arg_0+4]
                jnz     short loc_5D05C7

loc_5D05C4:                             ; CODE XREF: unknown_libname_319+3B↑j
                fdivp   st(1), st
                retn
; ---------------------------------------------------------------------------

loc_5D05C7:                             ; CODE XREF: unknown_libname_319+A2↑j
                mov     eax, dword ptr [esp+arg_0+8]
                and     eax, 7FFFh
                jnz     short loc_5D05C4
                fnstcw  word ptr [esp+arg_18]
                mov     eax, dword ptr [esp+arg_18]
                or      eax, 33Fh
                and     eax, 0F3FFh
                mov     [esp+arg_1C], eax
                fldcw   word ptr [esp+arg_1C]
                mov     eax, dword ptr [esp+arg_C+8]
                and     eax, 7FFFh
                jz      short loc_5D0608
                cmp     eax, 7FFFh
                jz      short loc_5D0630
                mov     eax, dword ptr [esp+arg_C+4]
                add     eax, eax
                jnb     short loc_5D0630
                jmp     short loc_5D0610
; ---------------------------------------------------------------------------

loc_5D0608:                             ; CODE XREF: unknown_libname_319+D5↑j
                mov     eax, dword ptr [esp+arg_C+4]
                add     eax, eax
                jb      short loc_5D0630

loc_5D0610:                             ; CODE XREF: unknown_libname_319+E6↑j
                fxch    st(1)
                fstp    st
                fld     st
                fmul    flt_641CF8
                fstp    [esp+arg_0]
                fld     [esp+arg_C]
                fxch    st(1)
                wait
                fldcw   word ptr [esp+arg_18]
                jmp     loc_5D0528
; ---------------------------------------------------------------------------

loc_5D0630:                             ; CODE XREF: unknown_libname_319+DC↑j
                fldcw   word ptr [esp+arg_18]
                fdivp   st(1), st
                retn
unknown_libname_319 endp


; =============== S U B R O U T I N E =======================================

; Microsoft VisualC 2-14/net runtime
; Attributes: library function

unknown_libname_320 proc near

var_2C          = tbyte ptr -2Ch
var_20          = tbyte ptr -20h
var_C           = tbyte ptr -0Ch
arg_8           = tbyte ptr  0Ch
arg_1C          = tbyte ptr  20h

                sub     esp, 2Ch
                and     eax, 3Fh        ; switch 64 cases
                jmp     jpt_5D063D[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5D0644:                             ; CODE XREF: unknown_libname_320+6↑j
                fdiv    st, st          ; jumptable 005D063D case 0
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D064A:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 1
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D064F:                             ; CODE XREF: unknown_libname_320+6↑j
                fdivr   st, st          ; jumptable 005D063D case 2
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0655:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 3
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D065A:                             ; CODE XREF: unknown_libname_320+6↑j
                fdiv    st, st          ; jumptable 005D063D case 4
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0660:                             ; CODE XREF: unknown_libname_320+6↑j
                fdivp   st, st          ; jumptable 005D063D case 5
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0666:                             ; CODE XREF: unknown_libname_320+6↑j
                fdivr   st, st          ; jumptable 005D063D case 6
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D066C:                             ; CODE XREF: unknown_libname_320+6↑j
                fdivrp  st, st          ; jumptable 005D063D case 7
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0672:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 8
                fld     st
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                fstp    [esp+2Ch+var_C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fld     [esp+2Ch+var_C]
                fxch    st(1)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D068E:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 9
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D0693:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    tbyte ptr [esp+0] ; jumptable 005D063D case 10
                fstp    [esp+arg_8]     ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fld     [esp+arg_8]
                fxch    st(1)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D06A9:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 11
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D06AE:                             ; CODE XREF: unknown_libname_320+6↑j
                fxch    st(1)           ; jumptable 005D063D case 12
                fstp    [esp+arg_8]     ; _TBYTE
                fld     st
                fstp    tbyte ptr [esp+0] ; _TBYTE
                fstp    [esp+arg_1C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fld     [esp+arg_1C]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D06CA:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_2C] ; jumptable 005D063D case 13
                fstp    [esp+2Ch+var_20] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D06DA:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 14
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fld     [esp+2Ch+var_20]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D06EE:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 15
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D06FE:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 16
                fxch    st(1)
                fld     st
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                fstp    [esp+2Ch+var_C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(1)
                fld     [esp+2Ch+var_C]
                fxch    st(2)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D071E:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 17
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D0723:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    tbyte ptr [esp+0] ; jumptable 005D063D case 18
                fxch    st(1)
                fstp    [esp+arg_8]     ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(1)
                fld     [esp+arg_8]
                fxch    st(2)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D073D:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 19
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D0742:                             ; CODE XREF: unknown_libname_320+6↑j
                fxch    st(2)           ; jumptable 005D063D case 20
                fstp    [esp+arg_8]     ; _TBYTE
                fxch    st(1)
                fld     st
                fstp    tbyte ptr [esp+0] ; _TBYTE
                fstp    [esp+arg_1C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(1)
                fld     [esp+arg_1C]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0762:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_2C] ; jumptable 005D063D case 21
                fxch    st(1)
                fstp    [esp+2Ch+var_20] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(1)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0776:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 22
                fxch    st(1)
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(1)
                fld     [esp+2Ch+var_20]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D078E:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 23
                fxch    st(1)
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(1)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D07A2:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 24
                fxch    st(2)
                fld     st
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                fstp    [esp+2Ch+var_C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(2)
                fld     [esp+2Ch+var_C]
                fxch    st(3)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D07C2:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 25
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D07C7:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    tbyte ptr [esp+0] ; jumptable 005D063D case 26
                fxch    st(2)
                fstp    [esp+arg_8]     ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(2)
                fld     [esp+arg_8]
                fxch    st(3)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D07E1:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 27
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D07E6:                             ; CODE XREF: unknown_libname_320+6↑j
                fxch    st(3)           ; jumptable 005D063D case 28
                fstp    [esp+arg_8]     ; _TBYTE
                fxch    st(2)
                fld     st
                fstp    tbyte ptr [esp+0] ; _TBYTE
                fstp    [esp+arg_1C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(2)
                fld     [esp+arg_1C]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0806:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_2C] ; jumptable 005D063D case 29
                fxch    st(2)
                fstp    [esp+2Ch+var_20] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(2)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D081A:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 30
                fxch    st(2)
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(2)
                fld     [esp+2Ch+var_20]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0832:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 31
                fxch    st(2)
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(2)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0846:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 32
                fxch    st(3)
                fld     st
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                fstp    [esp+2Ch+var_C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(3)
                fld     [esp+2Ch+var_C]
                fxch    st(4)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0866:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 33
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D086B:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    tbyte ptr [esp+0] ; jumptable 005D063D case 34
                fxch    st(3)
                fstp    [esp+arg_8]     ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(3)
                fld     [esp+arg_8]
                fxch    st(4)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0885:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 35
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D088A:                             ; CODE XREF: unknown_libname_320+6↑j
                fxch    st(4)           ; jumptable 005D063D case 36
                fstp    [esp+arg_8]     ; _TBYTE
                fxch    st(3)
                fld     st
                fstp    tbyte ptr [esp+0] ; _TBYTE
                fstp    [esp+arg_1C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(3)
                fld     [esp+arg_1C]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D08AA:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_2C] ; jumptable 005D063D case 37
                fxch    st(3)
                fstp    [esp+2Ch+var_20] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(3)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D08BE:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 38
                fxch    st(3)
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(3)
                fld     [esp+2Ch+var_20]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D08D6:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 39
                fxch    st(3)
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(3)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D08EA:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 40
                fxch    st(4)
                fld     st
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                fstp    [esp+2Ch+var_C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(4)
                fld     [esp+2Ch+var_C]
                fxch    st(5)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D090A:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 41
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D090F:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    tbyte ptr [esp+0] ; jumptable 005D063D case 42
                fxch    st(4)
                fstp    [esp+arg_8]     ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(4)
                fld     [esp+arg_8]
                fxch    st(5)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0929:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 43
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D092E:                             ; CODE XREF: unknown_libname_320+6↑j
                fxch    st(5)           ; jumptable 005D063D case 44
                fstp    [esp+arg_8]     ; _TBYTE
                fxch    st(4)
                fld     st
                fstp    tbyte ptr [esp+0] ; _TBYTE
                fstp    [esp+arg_1C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(4)
                fld     [esp+arg_1C]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D094E:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_2C] ; jumptable 005D063D case 45
                fxch    st(4)
                fstp    [esp+2Ch+var_20] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(4)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0962:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 46
                fxch    st(4)
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(4)
                fld     [esp+2Ch+var_20]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D097A:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 47
                fxch    st(4)
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(4)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D098E:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 48
                fxch    st(5)
                fld     st
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                fstp    [esp+2Ch+var_C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(5)
                fld     [esp+2Ch+var_C]
                fxch    st(6)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D09AE:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 49
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D09B3:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    tbyte ptr [esp+0] ; jumptable 005D063D case 50
                fxch    st(5)
                fstp    [esp+arg_8]     ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(5)
                fld     [esp+arg_8]
                fxch    st(6)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D09CD:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 51
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D09D2:                             ; CODE XREF: unknown_libname_320+6↑j
                fxch    st(6)           ; jumptable 005D063D case 52
                fstp    [esp+arg_8]     ; _TBYTE
                fxch    st(5)
                fld     st
                fstp    tbyte ptr [esp+0] ; _TBYTE
                fstp    [esp+arg_1C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(5)
                fld     [esp+arg_1C]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D09F2:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_2C] ; jumptable 005D063D case 53
                fxch    st(5)
                fstp    [esp+2Ch+var_20] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(5)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0A06:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 54
                fxch    st(5)
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(5)
                fld     [esp+2Ch+var_20]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0A1E:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 55
                fxch    st(5)
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(5)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0A32:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 56
                fxch    st(6)
                fld     st
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                fstp    [esp+2Ch+var_C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(6)
                fld     [esp+2Ch+var_C]
                fxch    st(7)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0A52:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 57
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D0A57:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    tbyte ptr [esp+0] ; jumptable 005D063D case 58
                fxch    st(6)
                fstp    [esp+arg_8]     ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(6)
                fld     [esp+arg_8]
                fxch    st(7)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0A71:                             ; CODE XREF: unknown_libname_320+6↑j
                add     esp, 2Ch        ; jumptable 005D063D case 59
                int     6               ;  - internal hardware - UNDEFINED OPCODE (80286+)

loc_5D0A76:                             ; CODE XREF: unknown_libname_320+6↑j
                fxch    st(7)           ; jumptable 005D063D case 60
                fstp    [esp+arg_8]     ; _TBYTE
                fxch    st(6)
                fld     st
                fstp    tbyte ptr [esp+0] ; _TBYTE
                fstp    [esp+arg_1C]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(6)
                fld     [esp+arg_1C]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0A96:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_2C] ; jumptable 005D063D case 61
                fxch    st(6)
                fstp    [esp+2Ch+var_20] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(6)
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0AAA:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 62
                fxch    st(6)
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(6)
                fld     [esp+2Ch+var_20]
                add     esp, 2Ch
                retn
; ---------------------------------------------------------------------------

loc_5D0AC2:                             ; CODE XREF: unknown_libname_320+6↑j
                fstp    [esp+2Ch+var_20] ; jumptable 005D063D case 63
                fxch    st(6)
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                fxch    st(6)
                add     esp, 2Ch
                retn
unknown_libname_320 endp ; sp-analysis failed


; =============== S U B R O U T I N E =======================================

; Microsoft VisualC 2-14/net runtime
; Attributes: library function

unknown_libname_321 proc near           ; CODE XREF: .text:005D0B1A↓p

var_2C          = tbyte ptr -2Ch
var_20          = tbyte ptr -20h

                sub     esp, 2Ch
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                fstp    [esp+2Ch+var_20] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                add     esp, 2Ch
                retn
unknown_libname_321 endp


; =============== S U B R O U T I N E =======================================

; Microsoft VisualC 2-14/net runtime
; Attributes: library function

unknown_libname_322 proc near           ; CODE XREF: .text:005D0C1A↓p

var_2C          = tbyte ptr -2Ch
var_20          = tbyte ptr -20h

                sub     esp, 2Ch
                fstp    [esp+2Ch+var_20] ; _TBYTE
                fstp    [esp+2Ch+var_2C] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                add     esp, 2Ch
                retn
unknown_libname_322 endp

; ---------------------------------------------------------------------------

unknown_libname_323:                    ; Microsoft VisualC 2-14/net runtime
                push    eax
                mov     eax, dword ptr [esp+8]
                and     eax, 7F800000h
                cmp     eax, 7F800000h
                jz      short loc_5D0B40
                fnstsw  ax
                and     eax, 3800h
                jz      short loc_5D0B23
                fld     dword ptr [esp+8]
                call    unknown_libname_321 ; Microsoft VisualC 2-14/net runtime
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

loc_5D0B23:                             ; CODE XREF: .text:005D0B14↑j
                fxch    st(1)
                sub     esp, 0Ch
                fstp    tbyte ptr [esp]
                fld     dword ptr [esp+14h]
                call    unknown_libname_321 ; Microsoft VisualC 2-14/net runtime
                fld     tbyte ptr [esp]
                fxch    st(1)
                add     esp, 0Ch
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

loc_5D0B40:                             ; CODE XREF: .text:005D0B0B↑j
                fdiv    dword ptr [esp+8]
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

unknown_libname_324:                    ; Microsoft VisualC 2-14/net runtime
                push    eax
                mov     eax, dword ptr [esp+0Ch]
                and     eax, 7FF00000h
                cmp     eax, 7FF00000h
                jz      short loc_5D0B8C
                fnstsw  ax
                and     eax, 3800h
                jz      short loc_5D0B6F
                fld     qword ptr [esp+8]
                call    unknown_libname_321 ; Microsoft VisualC 2-14/net runtime
                pop     eax
                retn    8
; ---------------------------------------------------------------------------

loc_5D0B6F:                             ; CODE XREF: .text:005D0B60↑j
                fxch    st(1)
                sub     esp, 0Ch
                fstp    tbyte ptr [esp]
                fld     qword ptr [esp+14h]
                call    unknown_libname_321 ; Microsoft VisualC 2-14/net runtime
                fld     tbyte ptr [esp]
                fxch    st(1)
                add     esp, 0Ch
                pop     eax
                retn    8
; ---------------------------------------------------------------------------

loc_5D0B8C:                             ; CODE XREF: .text:005D0B57↑j
                fdiv    qword ptr [esp+8]
                pop     eax
                retn    8
; ---------------------------------------------------------------------------

unknown_libname_325:                    ; Microsoft VisualC 2-14/net runtime
                push    eax
                fnstsw  ax
                and     eax, 3800h
                jz      short loc_5D0BAB
                fild    word ptr [esp+8]
                call    unknown_libname_321 ; Microsoft VisualC 2-14/net runtime
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

loc_5D0BAB:                             ; CODE XREF: .text:005D0B9C↑j
                fxch    st(1)
                sub     esp, 0Ch
                fstp    tbyte ptr [esp]
                fild    word ptr [esp+14h]
                call    unknown_libname_321 ; Microsoft VisualC 2-14/net runtime
                fld     tbyte ptr [esp]
                fxch    st(1)
                add     esp, 0Ch
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

unknown_libname_326:                    ; Microsoft VisualC 2-14/net runtime
                push    eax
                fnstsw  ax
                and     eax, 3800h
                jz      short loc_5D0BDF
                fild    dword ptr [esp+8]
                call    unknown_libname_321 ; Microsoft VisualC 2-14/net runtime
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

loc_5D0BDF:                             ; CODE XREF: .text:005D0BD0↑j
                fxch    st(1)
                sub     esp, 0Ch
                fstp    tbyte ptr [esp]
                fild    dword ptr [esp+14h]
                call    unknown_libname_321 ; Microsoft VisualC 2-14/net runtime
                fld     tbyte ptr [esp]
                fxch    st(1)
                add     esp, 0Ch
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

unknown_libname_327:                    ; Microsoft VisualC 2-14/net runtime
                push    eax
                mov     eax, dword ptr [esp+8]
                and     eax, 7F800000h
                cmp     eax, 7F800000h
                jz      short loc_5D0C40
                fnstsw  ax
                and     eax, 3800h
                jz      short loc_5D0C23
                fld     dword ptr [esp+8]
                call    unknown_libname_322 ; Microsoft VisualC 2-14/net runtime
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

loc_5D0C23:                             ; CODE XREF: .text:005D0C14↑j
                fxch    st(1)
                sub     esp, 0Ch
                fstp    tbyte ptr [esp]
                fld     dword ptr [esp+14h]
                call    unknown_libname_322 ; Microsoft VisualC 2-14/net runtime
                fld     tbyte ptr [esp]
                fxch    st(1)
                add     esp, 0Ch
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

loc_5D0C40:                             ; CODE XREF: .text:005D0C0B↑j
                fdivr   dword ptr [esp+8]
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

unknown_libname_328:                    ; Microsoft VisualC 2-14/net runtime
                push    eax
                mov     eax, dword ptr [esp+0Ch]
                and     eax, 7FF00000h
                cmp     eax, 7FF00000h
                jz      short loc_5D0C8C
                fnstsw  ax
                and     eax, 3800h
                jz      short loc_5D0C6F
                fld     qword ptr [esp+8]
                call    unknown_libname_322 ; Microsoft VisualC 2-14/net runtime
                pop     eax
                retn    8
; ---------------------------------------------------------------------------

loc_5D0C6F:                             ; CODE XREF: .text:005D0C60↑j
                fxch    st(1)
                sub     esp, 0Ch
                fstp    tbyte ptr [esp]
                fld     qword ptr [esp+14h]
                call    unknown_libname_322 ; Microsoft VisualC 2-14/net runtime
                fld     tbyte ptr [esp]
                fxch    st(1)
                add     esp, 0Ch
                pop     eax
                retn    8
; ---------------------------------------------------------------------------

loc_5D0C8C:                             ; CODE XREF: .text:005D0C57↑j
                fdivr   qword ptr [esp+8]
                pop     eax
                retn    8
; ---------------------------------------------------------------------------

unknown_libname_329:                    ; Microsoft VisualC 2-14/net runtime
                push    eax
                fnstsw  ax
                and     eax, 3800h
                jz      short loc_5D0CAB
                fild    word ptr [esp+8]
                call    unknown_libname_322 ; Microsoft VisualC 2-14/net runtime
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

loc_5D0CAB:                             ; CODE XREF: .text:005D0C9C↑j
                fxch    st(1)
                sub     esp, 0Ch
                fstp    tbyte ptr [esp]
                fild    word ptr [esp+14h]
                call    unknown_libname_322 ; Microsoft VisualC 2-14/net runtime
                fld     tbyte ptr [esp]
                fxch    st(1)
                add     esp, 0Ch
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

unknown_libname_330:                    ; Microsoft VisualC 2-14/net runtime
                push    eax
                fnstsw  ax
                and     eax, 3800h
                jz      short loc_5D0CDF
                fild    dword ptr [esp+8]
                call    unknown_libname_322 ; Microsoft VisualC 2-14/net runtime
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

loc_5D0CDF:                             ; CODE XREF: .text:005D0CD0↑j
                fxch    st(1)
                sub     esp, 0Ch
                fstp    tbyte ptr [esp]
                fild    dword ptr [esp+14h]
                call    unknown_libname_322 ; Microsoft VisualC 2-14/net runtime
                fld     tbyte ptr [esp]
                fxch    st(1)
                add     esp, 0Ch
                pop     eax
                retn    4
; ---------------------------------------------------------------------------

unknown_libname_331:                    ; Microsoft VisualC 2-14/net runtime
                push    eax
                sub     esp, 2Ch
                fstp    tbyte ptr [esp]
                fstp    tbyte ptr [esp+0Ch]
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                add     esp, 2Ch
                pop     eax
                retn

; =============== S U B R O U T I N E =======================================

; Microsoft VisualC 2-14/net runtime
; Attributes: library function

unknown_libname_332 proc near           ; CODE XREF: fFYTOX:badP5_fdivr↑p

var_30          = tbyte ptr -30h
var_24          = tbyte ptr -24h

                push    eax
                sub     esp, 2Ch
                fstp    [esp+30h+var_24] ; _TBYTE
                fstp    [esp+30h+var_30] ; _TBYTE
                call    unknown_libname_319 ; Microsoft VisualC 2-14/net runtime
                add     esp, 2Ch
                pop     eax
                retn
unknown_libname_332 endp


; =============== S U B R O U T I N E =======================================

; Microsoft VisualC 2-14/net runtime
; Attributes: library function

unknown_libname_333 proc near           ; CODE XREF: unknown_libname_334+18↓p

var_28          = byte ptr -28h
var_24          = dword ptr -24h
arg_6           = dword ptr  0Ah
arg_C           = tbyte ptr  10h
arg_1E          = dword ptr  22h
arg_24          = dword ptr  28h
arg_28          = dword ptr  2Ch
arg_2C          = dword ptr  30h

                push    eax
                push    ebx
                push    ecx
                mov     eax, dword ptr [esp+0Ch+arg_6]
                xor     eax, 700h
                test    eax, 700h
                jnz     loc_5D0EC0
                shr     eax, 0Bh
                and     eax, 0Fh
                cmp     byte_641CFC[eax], 0
                jz      loc_5D0EC0
                mov     eax, dword ptr [esp+0Ch+arg_6]
                and     eax, 7FFF0000h
                cmp     eax, 7FFF0000h
                jz      loc_5D0EC0
                mov     eax, dword ptr [esp+0Ch+arg_1E]
                and     eax, 7FFF0000h
                jz      loc_5D0EC0
                cmp     eax, 7FFF0000h
                jz      loc_5D0EC0
                mov     eax, dword ptr [esp+2Ch]
                add     eax, eax
                jnz     loc_5D0EC0
                mov     eax, dword ptr [esp+14h]
                add     eax, eax
                jnz     loc_5D0EC0
                mov     eax, dword ptr [esp+0Ch+arg_6+2]
                and     eax, 7FFFh
                add     eax, 3Fh ; '?'
                mov     ebx, dword ptr [esp+0Ch+arg_1E+2]
                and     ebx, 7FFFh
                sub     ebx, eax
                ja      short loc_5D0E0E

loc_5D0DB0:                             ; CODE XREF: unknown_libname_333+E6↓j
                mov     eax, dword ptr [esp+0Ch+arg_6+2]
                and     eax, 7FFFh
                add     eax, 0Ah
                mov     ebx, dword ptr [esp+0Ch+arg_1E+2]
                and     ebx, 7FFFh
                sub     ebx, eax
                js      loc_5D0EC0
                fld     tbyte ptr [esp+28h]
                mov     eax, dword ptr [esp+0Ch+arg_6+2]
                mov     ebx, dword ptr [esp+0Ch+arg_1E+2]
                and     ebx, 7FFFh
                mov     ecx, ebx
                sub     ebx, eax
                and     ebx, 7
                or      ebx, 4
                sub     ecx, ebx
                mov     ebx, eax
                and     ebx, 8000h
                or      ecx, ebx
                mov     [esp+0Ch+arg_6+2], ecx
                fld     tbyte ptr [esp+10h]
                mov     [esp+0Ch+arg_6+2], eax
                fxch    st(1)
                fprem
                fstp    tbyte ptr [esp+28h]
                fstp    st
                jmp     short loc_5D0DB0
; ---------------------------------------------------------------------------

loc_5D0E0E:                             ; CODE XREF: unknown_libname_333+88↑j
                test    edx, 2
                jnz     short loc_5D0E1E
                fld     tbyte ptr [esp+10h]
                fstp    [esp+0Ch+arg_C]

loc_5D0E1E:                             ; CODE XREF: unknown_libname_333+EE↑j
                fnstcw  word ptr [esp+0Ch+arg_24]
                mov     eax, dword ptr [esp+0Ch+arg_24]
                or      eax, 33Fh
                mov     [esp+0Ch+arg_28], eax
                fldcw   word ptr [esp+0Ch+arg_28]
                mov     eax, dword ptr [esp+0Ch+arg_6+2]
                and     eax, 7FFFh
                mov     ebx, dword ptr [esp+0Ch+arg_1E+2]
                and     ebx, 7FFFh
                sub     ebx, eax
                and     ebx, 3Fh
                or      ebx, 20h
                add     ebx, 1
                mov     ecx, ebx
                mov     eax, dword ptr [esp+0Ch+arg_6+2]
                mov     ebx, dword ptr [esp+0Ch+arg_1E+2]
                and     ebx, 7FFFh
                and     eax, 8000h
                or      ebx, eax
                mov     [esp+0Ch+arg_6+2], ebx
                fld     tbyte ptr [esp+10h]
                fabs
                fld     tbyte ptr [esp+28h]
                fabs

loc_5D0E78:                             ; CODE XREF: unknown_libname_333+16C↓j
                fcom    st(1)
                fnstsw  ax
                and     eax, 100h
                jnz     short loc_5D0E85
                fsub    st, st(1)

loc_5D0E85:                             ; CODE XREF: unknown_libname_333+15B↑j
                fxch    st(1)
                fmul    dbl_641D2C
                fxch    st(1)
                sub     ecx, 1
                jnz     short loc_5D0E78
                mov     ebx, dword ptr [esp+0Ch+arg_1E+2]
                fstp    tbyte ptr [esp+28h]
                fstp    st
                fld     [esp+0Ch+arg_C]
                fld     tbyte_641D34
                fprem
                fstp    st
                fld     tbyte ptr [esp+28h]
                fldcw   word ptr [esp+0Ch+arg_24]
                and     ebx, 8000h
                jz      short loc_5D0ECA
                fchs
                jmp     short loc_5D0ECA
; ---------------------------------------------------------------------------

loc_5D0EC0:                             ; CODE XREF: unknown_libname_333+11↑j
                fld     tbyte ptr [esp+10h]
                fld     tbyte ptr [esp+28h]
                fprem

loc_5D0ECA:                             ; CODE XREF: unknown_libname_333+194↑j
                test    edx, 3
                jz      short loc_5D0F28
                fnstsw  word ptr [esp+0Ch+arg_2C]
                test    edx, 1
                jz      short loc_5D0EFD
                fnstcw  word ptr [esp+0Ch+arg_24]
                mov     eax, dword ptr [esp+0Ch+arg_24]
                or      eax, 300h
                mov     [esp+0Ch+arg_28], eax
                fldcw   word ptr [esp+0Ch+arg_28]
                fmul    dbl_641D1C
                fldcw   word ptr [esp+0Ch+arg_24]

loc_5D0EFD:                             ; CODE XREF: unknown_libname_333+1B6↑j
                mov     eax, dword ptr [esp+0Ch+arg_2C]
                fxch    st(1)
                fstp    st
                fld     [esp+0Ch+arg_C]
                fxch    st(1)
                and     eax, 4300h
                sub     esp, 1Ch
                fnstenv [esp+28h+var_28]
                and     [esp+28h+var_24], 0BCFFh
                or      [esp+28h+var_24], eax
                fldenv  [esp+28h+var_28]
                add     esp, 1Ch

loc_5D0F28:                             ; CODE XREF: unknown_libname_333+1AA↑j
                pop     ecx
                pop     ebx
                pop     eax
                retn
unknown_libname_333 endp


; =============== S U B R O U T I N E =======================================

; Microsoft VisualC 2-14/net runtime
; Attributes: library function

unknown_libname_334 proc near           ; CODE XREF: .text:unknown_libname_337↓p

var_34          = tbyte ptr -34h
var_28          = tbyte ptr -28h
var_1C          = tbyte ptr -1Ch
var_10          = dword ptr -10h
var_C           = dword ptr -0Ch

                push    edx
                sub     esp, 30h
                fstp    [esp+34h+var_1C]
                fstp    [esp+34h+var_34]
                xor     edx, edx
                mov     eax, dword ptr [esp+34h+var_34+6]
                test    eax, 7FFF0000h
                jz      short loc_5D0F4E
                call    unknown_libname_333 ; Microsoft VisualC 2-14/net runtime
                add     esp, 30h
                pop     edx
                retn
; ---------------------------------------------------------------------------

loc_5D0F4E:                             ; CODE XREF: unknown_libname_334+16↑j
                fld     [esp+34h+var_34]
                fld     [esp+34h+var_1C]
                mov     eax, dword ptr [esp+34h+var_34]
                or      eax, dword ptr [esp+34h+var_34+4]
                jz      short loc_5D0FD7
                fxch    st(1)
                fstp    [esp+34h+var_28]
                fld     [esp+34h+var_34]
                fxch    st(1)
                or      edx, 2
                fnstcw  word ptr [esp+34h+var_10]
                mov     eax, dword ptr [esp+34h+var_10]
                or      eax, 33Fh
                mov     [esp+34h+var_C], eax
                fldcw   word ptr [esp+34h+var_C]
                mov     eax, dword ptr [esp+34h+var_1C+8]
                and     eax, 7FFFh
                cmp     eax, 7FBEh
                ja      short loc_5D0FA9
                or      edx, 1
                fmul    dbl_641D14
                fstp    [esp+34h+var_1C]
                fmul    dbl_641D14
                fstp    [esp+34h+var_34]
                jmp     short loc_5D0FC9
; ---------------------------------------------------------------------------

loc_5D0FA9:                             ; CODE XREF: unknown_libname_334+63↑j
                fnstcw  word ptr [esp+34h+var_10]
                mov     eax, dword ptr [esp+34h+var_10]
                or      eax, 300h
                mov     [esp+34h+var_C], eax
                fldcw   word ptr [esp+34h+var_C]
                fstp    st
                fmul    dbl_641D14
                fstp    [esp+34h+var_34]

loc_5D0FC9:                             ; CODE XREF: unknown_libname_334+7B↑j
                fldcw   word ptr [esp+34h+var_10]
                call    unknown_libname_333 ; Microsoft VisualC 2-14/net runtime
                add     esp, 30h
                pop     edx
                retn
; ---------------------------------------------------------------------------

loc_5D0FD7:                             ; CODE XREF: unknown_libname_334+30↑j
                fprem
                add     esp, 30h
                pop     edx
                retn
unknown_libname_334 endp


; =============== S U B R O U T I N E =======================================

; Microsoft VisualC 2-14/net runtime
; Attributes: library function

unknown_libname_335 proc near           ; CODE XREF: unknown_libname_336+1B↓p

var_28          = byte ptr -28h
var_24          = dword ptr -24h
arg_6           = dword ptr  0Ah
arg_C           = tbyte ptr  10h
arg_1E          = dword ptr  22h
arg_24          = dword ptr  28h
arg_28          = dword ptr  2Ch
arg_2C          = dword ptr  30h

                push    eax
                push    ebx
                push    ecx
                mov     eax, dword ptr [esp+0Ch+arg_6]
                xor     eax, 700h
                test    eax, 700h
                jnz     loc_5D1178
                shr     eax, 0Bh
                and     eax, 0Fh
                cmp     byte_641CFC[eax], 0
                jz      loc_5D1178
                mov     eax, dword ptr [esp+0Ch+arg_6]
                and     eax, 7FFF0000h
                cmp     eax, 7FFF0000h
                jz      loc_5D1178
                mov     eax, dword ptr [esp+0Ch+arg_1E]
                and     eax, 7FFF0000h
                jz      loc_5D1178
                cmp     eax, 7FFF0000h
                jz      loc_5D1178
                mov     eax, dword ptr [esp+2Ch]
                add     eax, eax
                jnz     loc_5D1178
                mov     eax, dword ptr [esp+14h]
                add     eax, eax
                jnz     loc_5D1178
                mov     eax, dword ptr [esp+0Ch+arg_6+2]
                and     eax, 7FFFh
                add     eax, 3Fh ; '?'
                mov     ebx, dword ptr [esp+0Ch+arg_1E+2]
                and     ebx, 7FFFh
                sub     ebx, eax
                ja      short loc_5D10C6

loc_5D1068:                             ; CODE XREF: unknown_libname_335+E6↓j
                mov     eax, dword ptr [esp+0Ch+arg_6+2]
                and     eax, 7FFFh
                add     eax, 0Ah
                mov     ebx, dword ptr [esp+0Ch+arg_1E+2]
                and     ebx, 7FFFh
                sub     ebx, eax
                js      loc_5D1178
                fld     tbyte ptr [esp+28h]
                mov     eax, dword ptr [esp+0Ch+arg_6+2]
                mov     ebx, dword ptr [esp+0Ch+arg_1E+2]
                and     ebx, 7FFFh
                mov     ecx, ebx
                sub     ebx, eax
                and     ebx, 7
                or      ebx, 4
                sub     ecx, ebx
                mov     ebx, eax
                and     ebx, 8000h
                or      ecx, ebx
                mov     [esp+0Ch+arg_6+2], ecx
                fld     tbyte ptr [esp+10h]
                mov     [esp+0Ch+arg_6+2], eax
                fxch    st(1)
                fprem
                fstp    tbyte ptr [esp+28h]
                fstp    st
                jmp     short loc_5D1068
; ---------------------------------------------------------------------------

loc_5D10C6:                             ; CODE XREF: unknown_libname_335+88↑j
                test    ebx, 2
                jnz     short loc_5D10D6
                fld     tbyte ptr [esp+10h]
                fstp    [esp+0Ch+arg_C]

loc_5D10D6:                             ; CODE XREF: unknown_libname_335+EE↑j
                fnstcw  word ptr [esp+0Ch+arg_24]
                mov     eax, dword ptr [esp+0Ch+arg_24]
                or      eax, 33Fh
                mov     [esp+0Ch+arg_28], eax
                fldcw   word ptr [esp+0Ch+arg_28]
                mov     eax, dword ptr [esp+0Ch+arg_6+2]
                and     eax, 7FFFh
                mov     ebx, dword ptr [esp+0Ch+arg_1E+2]
                and     ebx, 7FFFh
                sub     ebx, eax
                and     ebx, 3Fh
                or      ebx, 20h
                add     ebx, 1
                mov     ecx, ebx
                mov     eax, dword ptr [esp+0Ch+arg_6+2]
                mov     ebx, dword ptr [esp+0Ch+arg_1E+2]
                and     ebx, 7FFFh
                and     eax, 8000h
                or      ebx, eax
                mov     [esp+0Ch+arg_6+2], ebx
                fld     tbyte ptr [esp+10h]
                fabs
                fld     tbyte ptr [esp+28h]
                fabs

loc_5D1130:                             ; CODE XREF: unknown_libname_335+16C↓j
                fcom    st(1)
                fnstsw  ax
                and     eax, 100h
                jnz     short loc_5D113D
                fsub    st, st(1)

loc_5D113D:                             ; CODE XREF: unknown_libname_335+15B↑j
                fxch    st(1)
                fmul    dbl_641D2C
                fxch    st(1)
                sub     ecx, 1
                jnz     short loc_5D1130
                mov     ebx, dword ptr [esp+0Ch+arg_1E+2]
                fstp    tbyte ptr [esp+28h]
                fstp    st
                fld     [esp+0Ch+arg_C]
                fld     tbyte_641D34
                fprem1
                fstp    st
                fld     tbyte ptr [esp+28h]
                fldcw   word ptr [esp+0Ch+arg_24]
                and     ebx, 8000h
                jz      short loc_5D1182
                fchs
                jmp     short loc_5D1182
; ---------------------------------------------------------------------------

loc_5D1178:                             ; CODE XREF: unknown_libname_335+11↑j
                fld     tbyte ptr [esp+10h]
                fld     tbyte ptr [esp+28h]
                fprem1

loc_5D1182:                             ; CODE XREF: unknown_libname_335+194↑j
                test    edx, 3
                jz      short loc_5D11E0
                fnstsw  word ptr [esp+0Ch+arg_2C]
                test    edx, 1
                jz      short loc_5D11B5
                fnstcw  word ptr [esp+0Ch+arg_24]
                mov     eax, dword ptr [esp+0Ch+arg_24]
                or      eax, 300h
                mov     [esp+0Ch+arg_28], eax
                fldcw   word ptr [esp+0Ch+arg_28]
                fmul    dbl_641D1C
                fldcw   word ptr [esp+0Ch+arg_24]

loc_5D11B5:                             ; CODE XREF: unknown_libname_335+1B6↑j
                mov     eax, dword ptr [esp+0Ch+arg_2C]
                fxch    st(1)
                fstp    st
                fld     [esp+0Ch+arg_C]
                fxch    st(1)
                and     eax, 4300h
                sub     esp, 1Ch
                fnstenv [esp+28h+var_28]
                and     [esp+28h+var_24], 0BCFFh
                or      [esp+28h+var_24], eax
                fldenv  [esp+28h+var_28]
                add     esp, 1Ch

loc_5D11E0:                             ; CODE XREF: unknown_libname_335+1AA↑j
                pop     ecx
                pop     ebx
                pop     eax
                retn
unknown_libname_335 endp


; =============== S U B R O U T I N E =======================================

; Microsoft VisualC 2-14/net runtime
; Attributes: library function

unknown_libname_336 proc near           ; CODE XREF: .text:unknown_libname_338↓p

var_34          = tbyte ptr -34h
var_28          = tbyte ptr -28h
var_1C          = tbyte ptr -1Ch
var_10          = dword ptr -10h
var_C           = dword ptr -0Ch

                push    edx
                sub     esp, 30h
                fstp    [esp+34h+var_1C]
                fstp    [esp+34h+var_34]
                mov     edx, 0
                mov     eax, dword ptr [esp+34h+var_34+6]
                test    eax, 7FFF0000h
                jz      short loc_5D1209
                call    unknown_libname_335 ; Microsoft VisualC 2-14/net runtime
                add     esp, 30h
                pop     edx
                retn
; ---------------------------------------------------------------------------

loc_5D1209:                             ; CODE XREF: unknown_libname_336+19↑j
                fld     [esp+34h+var_34]
                fld     [esp+34h+var_1C]
                mov     eax, dword ptr [esp+34h+var_34]
                or      eax, dword ptr [esp+34h+var_34+4]
                jz      short loc_5D1292
                fxch    st(1)
                fstp    [esp+34h+var_28]
                fld     [esp+34h+var_34]
                fxch    st(1)
                or      edx, 2
                fnstcw  word ptr [esp+34h+var_10]
                mov     eax, dword ptr [esp+34h+var_10]
                or      eax, 33Fh
                mov     [esp+34h+var_C], eax
                fldcw   word ptr [esp+34h+var_C]
                mov     eax, dword ptr [esp+34h+var_1C+8]
                and     eax, 7FFFh
                cmp     eax, 7FBEh
                ja      short loc_5D1264
                or      edx, 1
                fmul    dbl_641D14
                fstp    [esp+34h+var_1C]
                fmul    dbl_641D14
                fstp    [esp+34h+var_34]
                jmp     short loc_5D1284
; ---------------------------------------------------------------------------

loc_5D1264:                             ; CODE XREF: unknown_libname_336+66↑j
                fnstcw  word ptr [esp+34h+var_10]
                mov     eax, dword ptr [esp+34h+var_10]
                or      eax, 300h
                mov     [esp+34h+var_C], eax
                fldcw   word ptr [esp+34h+var_C]
                fstp    st
                fmul    dbl_641D14
                fstp    [esp+34h+var_34]

loc_5D1284:                             ; CODE XREF: unknown_libname_336+7E↑j
                fldcw   word ptr [esp+34h+var_10]
                call    unknown_libname_335 ; Microsoft VisualC 2-14/net runtime
                add     esp, 30h
                pop     edx
                retn
; ---------------------------------------------------------------------------

loc_5D1292:                             ; CODE XREF: unknown_libname_336+33↑j
                fprem
                add     esp, 30h
                pop     edx
                retn
unknown_libname_336 endp

; ---------------------------------------------------------------------------

unknown_libname_337:                    ; Microsoft VisualC 2-14/net runtime
                call    unknown_libname_334
                retn
; ---------------------------------------------------------------------------

unknown_libname_338:                    ; Microsoft VisualC 2-14/net runtime
                call    unknown_libname_336
                retn
; ---------------------------------------------------------------------------

unknown_libname_339:                    ; Microsoft VisualC 2-14/net runtime
                fpatan
                retn
; ---------------------------------------------------------------------------

unknown_libname_340:                    ; Microsoft VisualC 2-14/net runtime
                fptan
                retn
; ---------------------------------------------------------------------------
                align 10h
                mov     eax, dword ptr [esp+0Ch]
                mov     ecx, dword ptr [esp+8]
                mov     edx, dword ptr [esp+4]
                push    eax
                push    40h ; '@'
                push    ecx
                push    edx
                call    __sopen
                add     esp, 10h
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int _sopen(const char *FileName, int OpenFlag, int ShareFlag, ...)
__sopen         proc near               ; CODE XREF: __openfile+111↑p

var_11          = byte ptr -11h
dwDesiredAccess = dword ptr -10h
SecurityAttributes= _SECURITY_ATTRIBUTES ptr -0Ch
lpFileName      = dword ptr  4
OpenFlag        = dword ptr  8
ShareFlag       = dword ptr  0Ch
arg_C           = dword ptr  10h

                sub     esp, 14h
                mov     ecx, dword ptr [esp+14h+OpenFlag]
                push    ebx
                push    ebp
                push    esi
                mov     dl, 80h
                xor     esi, esi
                test    dl, cl
                push    edi
                mov     [esp+24h+SecurityAttributes.nLength], 0Ch
                mov     [esp+24h+SecurityAttributes.lpSecurityDescriptor], esi
                jz      short loc_5D12FA
                mov     [esp+24h+SecurityAttributes.bInheritHandle], esi
                mov     [esp+24h+var_11], 10h
                jmp     short loc_5D1307
; ---------------------------------------------------------------------------

loc_5D12FA:                             ; CODE XREF: __sopen+1D↑j
                mov     [esp+24h+SecurityAttributes.bInheritHandle], 1
                mov     [esp+24h+var_11], 0

loc_5D1307:                             ; CODE XREF: __sopen+28↑j
                test    ch, 80h
                jnz     short loc_5D1321
                test    ch, 40h
                jnz     short loc_5D131D
                cmp     dword_70D7D0, 8000h
                jz      short loc_5D1321

loc_5D131D:                             ; CODE XREF: __sopen+3F↑j
                or      [esp+24h+var_11], dl

loc_5D1321:                             ; CODE XREF: __sopen+3A↑j
                mov     eax, ecx
                and     eax, 3
                sub     eax, esi
                jz      short loc_5D1348
                dec     eax
                jz      short loc_5D133E
                dec     eax
                jnz     def_5D1368      ; jumptable 005D1368 default case, cases 17-31,33-47,49-63
                mov     [esp+24h+dwDesiredAccess], 0C0000000h
                jmp     short loc_5D1350
; ---------------------------------------------------------------------------

loc_5D133E:                             ; CODE XREF: __sopen+5B↑j
                mov     [esp+24h+dwDesiredAccess], 40000000h
                jmp     short loc_5D1350
; ---------------------------------------------------------------------------

loc_5D1348:                             ; CODE XREF: __sopen+58↑j
                mov     [esp+24h+dwDesiredAccess], 80000000h

loc_5D1350:                             ; CODE XREF: __sopen+6C↑j
                mov     eax, dword ptr [esp+24h+ShareFlag]
                add     eax, 0FFFFFFF0h ; switch 49 cases
                cmp     eax, 30h
                ja      def_5D1368      ; jumptable 005D1368 default case, cases 17-31,33-47,49-63
                xor     ebx, ebx
                mov     bl, ds:byte_5D1638[eax]
                jmp     ds:jpt_5D1368[ebx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5D136F:                             ; CODE XREF: __sopen+98↑j
                xor     ebx, ebx        ; jumptable 005D1368 case 16
                jmp     short loc_5D1386
; ---------------------------------------------------------------------------

loc_5D1373:                             ; CODE XREF: __sopen+98↑j
                mov     ebx, 1          ; jumptable 005D1368 case 32
                jmp     short loc_5D1386
; ---------------------------------------------------------------------------

loc_5D137A:                             ; CODE XREF: __sopen+98↑j
                mov     ebx, 2          ; jumptable 005D1368 case 48
                jmp     short loc_5D1386
; ---------------------------------------------------------------------------

loc_5D1381:                             ; CODE XREF: __sopen+98↑j
                mov     ebx, 3          ; jumptable 005D1368 case 64

loc_5D1386:                             ; CODE XREF: __sopen+A1↑j
                mov     eax, ecx
                and     eax, 700h
                cmp     eax, 100h
                jg      short loc_5D13A6
                jz      short loc_5D139F
                cmp     eax, esi
                jz      short loc_5D13D6
                jmp     def_5D1368      ; jumptable 005D1368 default case, cases 17-31,33-47,49-63
; ---------------------------------------------------------------------------

loc_5D139F:                             ; CODE XREF: __sopen+C4↑j
                mov     ebp, 4
                jmp     short loc_5D13FB
; ---------------------------------------------------------------------------

loc_5D13A6:                             ; CODE XREF: __sopen+C2↑j
                cmp     eax, 300h
                jg      short loc_5D13C2
                jz      short loc_5D13BB
                cmp     eax, 200h
                jz      short loc_5D13F6
                jmp     def_5D1368      ; jumptable 005D1368 default case, cases 17-31,33-47,49-63
; ---------------------------------------------------------------------------

loc_5D13BB:                             ; CODE XREF: __sopen+DD↑j
                mov     ebp, 2
                jmp     short loc_5D13FB
; ---------------------------------------------------------------------------

loc_5D13C2:                             ; CODE XREF: __sopen+DB↑j
                cmp     eax, 500h
                jg      short loc_5D13DD
                jz      short loc_5D13EF
                cmp     eax, 400h
                jnz     def_5D1368      ; jumptable 005D1368 default case, cases 17-31,33-47,49-63

loc_5D13D6:                             ; CODE XREF: __sopen+C8↑j
                mov     ebp, 3
                jmp     short loc_5D13FB
; ---------------------------------------------------------------------------

loc_5D13DD:                             ; CODE XREF: __sopen+F7↑j
                cmp     eax, 600h
                jz      short loc_5D13F6
                cmp     eax, 700h
                jnz     def_5D1368      ; jumptable 005D1368 default case, cases 17-31,33-47,49-63

loc_5D13EF:                             ; CODE XREF: __sopen+F9↑j
                mov     ebp, 1
                jmp     short loc_5D13FB
; ---------------------------------------------------------------------------

loc_5D13F6:                             ; CODE XREF: __sopen+E4↑j
                mov     ebp, 5

loc_5D13FB:                             ; CODE XREF: __sopen+D4↑j
                test    ch, 1
                mov     edi, 80h
                jz      short loc_5D141C
                mov     esi, dword_70D328
                mov     eax, dword ptr [esp+24h+arg_C]
                not     esi
                and     eax, esi
                test    dl, al
                jnz     short loc_5D141C
                mov     edi, 1

loc_5D141C:                             ; CODE XREF: __sopen+133↑j
                test    cl, 40h
                jz      short loc_5D1434
                mov     eax, dword ptr [esp+24h+dwDesiredAccess]
                or      edi, 4000000h
                or      eax, 10000h
                mov     [esp+24h+dwDesiredAccess], eax

loc_5D1434:                             ; CODE XREF: __sopen+14F↑j
                test    ch, 10h
                jz      short loc_5D143F
                or      edi, 100h

loc_5D143F:                             ; CODE XREF: __sopen+167↑j
                test    cl, 20h
                jz      short loc_5D144C
                or      edi, 8000000h
                jmp     short loc_5D1457
; ---------------------------------------------------------------------------

loc_5D144C:                             ; CODE XREF: __sopen+172↑j
                test    cl, 10h
                jz      short loc_5D1457
                or      edi, 10000000h

loc_5D1457:                             ; CODE XREF: __sopen+17A↑j
                call    __alloc_osfhnd
                mov     esi, eax
                cmp     esi, 0FFFFFFFFh
                jnz     short loc_5D1483
                call    __errno
                mov     dword ptr [eax], 18h
                call    ___doserrno
                mov     dword ptr [eax], 0
                or      eax, esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
; ---------------------------------------------------------------------------

loc_5D1483:                             ; CODE XREF: __sopen+191↑j
                mov     edx, dword ptr [esp+24h+dwDesiredAccess]
                mov     eax, dword ptr [esp+24h+lpFileName]
                push    0               ; hTemplateFile
                push    edi             ; dwFlagsAndAttributes
                lea     ecx, [esp+2Ch+SecurityAttributes]
                push    ebp             ; dwCreationDisposition
                push    ecx             ; lpSecurityAttributes
                push    ebx             ; dwShareMode
                push    edx             ; dwDesiredAccess
                push    eax             ; lpFileName
                call    CreateFileA
                mov     edi, eax
                cmp     edi, 0FFFFFFFFh
                jz      short loc_5D14B6
                push    edi             ; hFile
                call    GetFileType
                test    eax, eax
                jnz     short loc_5D14D9
                push    edi             ; hObject
                call    CloseHandle

loc_5D14B6:                             ; CODE XREF: __sopen+1D2↑j
                call    GetLastError
                push    eax
                call    __dosmaperr
                add     esp, 4
                push    esi
                call    __unlock_fhandle
                add     esp, 4
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
; ---------------------------------------------------------------------------

loc_5D14D9:                             ; CODE XREF: __sopen+1DD↑j
                cmp     eax, 2
                jnz     short loc_5D14E6
                mov     al, [esp+24h+var_11]
                or      al, 40h
                jmp     short loc_5D14F1
; ---------------------------------------------------------------------------

loc_5D14E6:                             ; CODE XREF: __sopen+20C↑j
                cmp     eax, 3
                jnz     short loc_5D14F5
                mov     al, [esp+24h+var_11]
                or      al, 8

loc_5D14F1:                             ; CODE XREF: __sopen+214↑j
                mov     [esp+24h+var_11], al

loc_5D14F5:                             ; CODE XREF: __sopen+219↑j
                push    edi             ; hHandle
                push    esi             ; int
                call    __set_osfhnd
                mov     bl, [esp+2Ch+var_11]
                mov     eax, esi
                mov     ecx, esi
                or      bl, 1
                and     eax, 1Fh
                mov     [esp+2Ch+var_11], bl
                sar     ecx, 5
                lea     edi, [eax+eax*8]
                mov     al, [esp+2Ch+var_11]
                mov     edx, __pioinfo[ecx*4]
                lea     ebx, __pioinfo[ecx*4]
                mov     cl, al
                add     esp, 8
                shl     edi, 2
                and     cl, 48h
                mov     [edi+edx+4], al
                mov     byte ptr [esp+24h+lpFileName], cl
                jnz     loc_5D15D3
                test    al, 80h
                jz      loc_5D15D3
                test    byte ptr [esp+24h+OpenFlag], 2
                jz      loc_5D15D3
                push    2               ; dwMoveMethod
                push    0FFFFFFFFh      ; lDistanceToMove
                push    esi             ; FileHandle
                call    __lseek_lk
                mov     ebp, eax
                add     esp, 0Ch
                cmp     ebp, 0FFFFFFFFh
                jnz     short loc_5D1575
                call    ___doserrno
                cmp     dword ptr [eax], 83h
                jz      short loc_5D15D3
                jmp     short loc_5D15B6
; ---------------------------------------------------------------------------

loc_5D1575:                             ; CODE XREF: __sopen+294↑j
                lea     eax, [esp+24h+ShareFlag]
                push    1               ; nNumberOfBytesToRead
                push    eax             ; lpBuffer
                push    esi             ; FileHandle
                mov     byte ptr [esp+30h+ShareFlag], 0
                call    __read_lk
                add     esp, 0Ch
                test    eax, eax
                jnz     short loc_5D15A4
                cmp     byte ptr [esp+24h+ShareFlag], 1Ah
                jnz     short loc_5D15A4
                push    ebp             ; LONG
                push    esi             ; FileHandle
                call    __chsize_lk
                add     esp, 8
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5D15B6

loc_5D15A4:                             ; CODE XREF: __sopen+2BC↑j
                push    0               ; dwMoveMethod
                push    0               ; lDistanceToMove
                push    esi             ; FileHandle
                call    __lseek_lk
                add     esp, 0Ch
                cmp     eax, 0FFFFFFFFh
                jnz     short loc_5D15D3

loc_5D15B6:                             ; CODE XREF: __sopen+2A3↑j
                push    esi             ; FileHandle
                call    __close
                add     esp, 4
                push    esi
                call    __unlock_fhandle
                add     esp, 4
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
; ---------------------------------------------------------------------------

loc_5D15D3:                             ; CODE XREF: __sopen+269↑j
                mov     al, byte ptr [esp+24h+lpFileName]
                test    al, al
                jnz     short loc_5D15F1
                test    byte ptr [esp+24h+OpenFlag], 8
                jz      short loc_5D15F1
                mov     ecx, dword ptr [ebx]
                lea     eax, [edi+ecx+4]
                mov     cl, [edi+ecx+4]
                or      cl, 20h
                mov     [eax], cl

loc_5D15F1:                             ; CODE XREF: __sopen+309↑j
                push    esi
                call    __unlock_fhandle
                add     esp, 4
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
; ---------------------------------------------------------------------------

def_5D1368:                             ; CODE XREF: __sopen+5E↑j
                call    __errno         ; jumptable 005D1368 default case, cases 17-31,33-47,49-63
                mov     dword ptr [eax], 16h
                call    ___doserrno
                mov     [eax], esi
                pop     edi
                pop     esi
                pop     ebp
                or      eax, 0FFFFFFFFh
                pop     ebx
                add     esp, 14h
                retn
__sopen         endp

; ---------------------------------------------------------------------------
                align 4
jpt_5D1368      dd offset loc_5D136F    ; DATA XREF: __sopen+98↑r
                dd offset loc_5D1373    ; jump table for switch statement
                dd offset loc_5D137A
                dd offset loc_5D1381
                dd offset def_5D1368
byte_5D1638     db      0,     4,     4,     4 ; DATA XREF: __sopen+92↑r
                db      4,     4,     4,     4 ; indirect table for switch statement
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      1,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      2,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      3
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl mbtowc(wchar_t *DstCh, const char *SrcCh, size_t SrcSizeInBytes)
_mbtowc         proc near               ; CODE XREF: __input+4A9↑p

DstCh           = dword ptr  4
SrcCh           = dword ptr  8
SrcSizeInBytes  = dword ptr  0Ch

                push    ebx
                push    esi
                push    edi
                push    offset Addend   ; lpAddend
                call    InterlockedIncrement
                mov     eax, dword_70E964
                mov     edi, ds:InterlockedDecrement
                test    eax, eax
                jz      short loc_5D16A5
                push    offset Addend   ; lpAddend
                call    edi ; InterlockedDecrement
                push    13h
                call    __lock
                add     esp, 4
                mov     esi, 1
                jmp     short loc_5D16A7
; ---------------------------------------------------------------------------

loc_5D16A5:                             ; CODE XREF: _mbtowc+1B↑j
                xor     esi, esi

loc_5D16A7:                             ; CODE XREF: _mbtowc+33↑j
                mov     eax, dword ptr [esp+0Ch+SrcSizeInBytes]
                mov     ecx, dword ptr [esp+0Ch+SrcCh]
                mov     edx, dword ptr [esp+0Ch+DstCh]
                push    eax             ; int
                push    ecx             ; lpMultiByteStr
                push    edx             ; lpWideCharStr
                call    __mbtowc_lk
                add     esp, 0Ch
                mov     ebx, eax
                test    esi, esi
                jz      short loc_5D16D4
                push    13h
                call    __unlock
                add     esp, 4
                mov     eax, ebx
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D16D4:                             ; CODE XREF: _mbtowc+52↑j
                push    offset Addend   ; lpAddend
                call    edi ; InterlockedDecrement
                pop     edi
                mov     eax, ebx
                pop     esi
                pop     ebx
                retn
_mbtowc         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _mbtowc_lk(LPWSTR lpWideCharStr, LPCCH lpMultiByteStr, int)
__mbtowc_lk     proc near               ; CODE XREF: _mbtowc+46↑p

lpWideCharStr   = dword ptr  4
lpMultiByteStr  = dword ptr  8
arg_8           = dword ptr  0Ch

                push    esi
                mov     esi, [esp+4+lpMultiByteStr]
                test    esi, esi
                push    edi
                jz      loc_5D17E9
                mov     edi, [esp+8+arg_8]
                test    edi, edi
                jz      loc_5D17E9
                mov     al, [esi]
                test    al, al
                jnz     short loc_5D1726
                mov     eax, dword ptr [esp+8+lpWideCharStr]
                test    eax, eax
                jz      loc_5D17E9
                mov     word ptr [eax], 0
                xor     eax, eax
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D1726:                             ; CODE XREF: __mbtowc_lk+1E↑j
                mov     ecx, dword_70D558
                test    ecx, ecx
                jnz     short loc_5D174B
                mov     ecx, dword ptr [esp+8+lpWideCharStr]
                test    ecx, ecx
                jz      loc_5D17E1
                movzx   ax, al
                mov     [ecx], ax
                mov     eax, 1
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D174B:                             ; CODE XREF: __mbtowc_lk+3E↑j
                mov     ecx, off_641268
                and     eax, 0FFh
                test    byte ptr [ecx+eax*2+1], 80h
                jz      short loc_5D17AD
                mov     eax, [g_SrcSizeInBytes]
                cmp     eax, 1
                jle     short loc_5D1791
                cmp     edi, eax
                jl      short loc_5D1793
                mov     ecx, dword ptr [esp+8+lpWideCharStr]
                xor     edx, edx
                test    ecx, ecx
                setnz   dl
                push    edx             ; cchWideChar
                push    ecx             ; lpWideCharStr
                push    eax             ; cbMultiByte
                mov     eax, CodePage
                push    esi             ; lpMultiByteStr
                push    9               ; dwFlags
                push    eax             ; CodePage
                call    MultiByteToWideChar
                test    eax, eax
                mov     eax, [g_SrcSizeInBytes]
                jnz     short loc_5D17EB

loc_5D1791:                             ; CODE XREF: __mbtowc_lk+75↑j
                cmp     edi, eax

loc_5D1793:                             ; CODE XREF: __mbtowc_lk+79↑j
                jb      short loc_5D17D0
                mov     cl, [esi+1]
                test    cl, cl
                jnz     short loc_5D17EB
                call    __errno
                mov     dword ptr [eax], 2Ah ; '*'
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D17AD:                             ; CODE XREF: __mbtowc_lk+6B↑j
                mov     eax, dword ptr [esp+8+lpWideCharStr]
                xor     ecx, ecx
                mov     edx, CodePage
                test    eax, eax
                setnz   cl
                push    ecx             ; cchWideChar
                push    eax             ; lpWideCharStr
                push    1               ; cbMultiByte
                push    esi             ; lpMultiByteStr
                push    9               ; dwFlags
                push    edx             ; CodePage
                call    MultiByteToWideChar
                test    eax, eax
                jnz     short loc_5D17E1

loc_5D17D0:                             ; CODE XREF: __mbtowc_lk:loc_5D1793↑j
                call    __errno
                mov     dword ptr [eax], 2Ah ; '*'
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D17E1:                             ; CODE XREF: __mbtowc_lk+46↑j
                mov     eax, 1
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D17E9:                             ; CODE XREF: __mbtowc_lk+8↑j
                xor     eax, eax

loc_5D17EB:                             ; CODE XREF: __mbtowc_lk+9F↑j
                pop     edi
                pop     esi
                retn
__mbtowc_lk     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__allshl        proc near               ; CODE XREF: __input+694↑p
                cmp     cl, 40h ; '@'
                jnb     short RETZERO
                cmp     cl, 20h ; ' '
                jnb     short MORE32
                shld    edx, eax, cl
                shl     eax, cl
                retn
; ---------------------------------------------------------------------------

MORE32:                                 ; CODE XREF: __allshl+8↑j
                mov     edx, eax
                xor     eax, eax
                and     cl, 1Fh
                shl     edx, cl
                retn
; ---------------------------------------------------------------------------

RETZERO:                                ; CODE XREF: __allshl+3↑j
                xor     eax, eax
                xor     edx, edx
                retn
__allshl        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl ungetc(int Character, FILE *Stream)
_ungetc         proc near

Character       = dword ptr  4
Stream          = dword ptr  8

                push    esi
                mov     esi, [esp+4+Stream]
                push    edi
                push    esi             ; Stream
                call    __lock_file
                mov     eax, dword ptr [esp+0Ch+Character]
                add     esp, 4
                push    esi             ; Stream
                push    eax             ; Character
                call    _ungetc_0
                add     esp, 8
                mov     edi, eax
                push    esi             ; Stream
                call    __unlock_file
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
_ungetc         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl ungetc_0(int Character, FILE *Stream)
_ungetc_0       proc near               ; CODE XREF: __un_inc+F↑p

Character       = dword ptr  4
Stream          = dword ptr  8

                push    ebx
                mov     ebx, dword ptr [esp+4+Character]
                cmp     ebx, 0FFFFFFFFh
                push    esi
                jz      short loc_5D18BD
                mov     esi, [esp+8+Stream]
                mov     eax, dword ptr [esi+0Ch]
                test    al, 1
                jnz     short loc_5D185E
                test    al, 80h
                jz      short loc_5D18BD
                test    al, 2
                jnz     short loc_5D18BD

loc_5D185E:                             ; CODE XREF: _ungetc_0+14↑j
                mov     eax, dword ptr [esi+8]
                test    eax, eax
                jnz     short loc_5D186E
                push    esi
                call    __getbuf
                add     esp, 4

loc_5D186E:                             ; CODE XREF: _ungetc_0+23↑j
                mov     eax, dword ptr [esi]
                mov     ecx, dword ptr [esi+8]
                cmp     eax, ecx
                jnz     short loc_5D1881
                mov     ecx, dword ptr [esi+4]
                test    ecx, ecx
                jnz     short loc_5D18BD
                inc     eax
                mov     [esi], eax

loc_5D1881:                             ; CODE XREF: _ungetc_0+35↑j
                test    byte ptr [esi+0Ch], 40h
                jz      short loc_5D189B
                mov     edx, dword ptr [esi]
                dec     edx
                mov     eax, edx
                mov     [esi], edx
                cmp     [eax], bl
                jz      short loc_5D18A2
                inc     eax
                mov     [esi], eax
                or      eax, 0FFFFFFFFh
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D189B:                             ; CODE XREF: _ungetc_0+45↑j
                mov     eax, dword ptr [esi]
                dec     eax
                mov     [esi], eax
                mov     [eax], bl

loc_5D18A2:                             ; CODE XREF: _ungetc_0+50↑j
                mov     eax, dword ptr [esi+0Ch]
                mov     edx, dword ptr [esi+4]
                and     al, 0EFh
                inc     edx
                or      al, 1
                mov     [esi+4], edx
                mov     [esi+0Ch], eax
                mov     eax, ebx
                and     eax, 0FFh
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D18BD:                             ; CODE XREF: _ungetc_0+9↑j
                pop     esi
                or      eax, 0FFFFFFFFh
                pop     ebx
                retn
_ungetc_0       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___init_time    proc near               ; DATA XREF: .data:0064153C↓o
                mov     eax, dword_70D564
                push    esi
                test    eax, eax
                jz      short loc_5D1949
                push    0ACh            ; varSize
                push    1               ; Count
                call    _calloc
                mov     esi, eax
                add     esp, 8
                test    esi, esi
                jnz     short loc_5D18F6
                mov     eax, 1
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D18F6:                             ; CODE XREF: ___init_time+1D↑j
                push    esi
                call    __get_lc_time
                add     esp, 4
                test    eax, eax
                jz      short loc_5D191C
                push    esi
                call    __free_lc_time
                add     esp, 4
                push    esi             ; Block
                call    _free
                add     esp, 4
                mov     eax, 1
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D191C:                             ; CODE XREF: ___init_time+31↑j
                mov     eax, dword_70D784
                mov     off_63F10C, esi
                push    eax
                call    __free_lc_time
                mov     ecx, dword_70D784
                add     esp, 4
                push    ecx             ; Block
                call    _free
                add     esp, 4
                mov     dword_70D784, esi
                xor     eax, eax
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D1949:                             ; CODE XREF: ___init_time+8↑j
                mov     edx, dword_70D784
                mov     off_63F10C, offset off_63F060
                push    edx
                call    __free_lc_time
                mov     eax, dword_70D784
                add     esp, 4
                push    eax             ; Block
                call    _free
                add     esp, 4
                mov     dword_70D784, 0
                xor     eax, eax
                pop     esi
                retn
___init_time    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__get_lc_time   proc near               ; CODE XREF: ___init_time+27↑p

arg_0           = dword ptr  4

                push    ebx
                push    ebp
                push    edi
                mov     edi, [esp+0Ch+arg_0]
                xor     ebx, ebx
                xor     ebp, ebp
                mov     bx, word_70D7BE
                mov     bp, word_70D7C0
                test    edi, edi
                jnz     short loc_5D19A4
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D19A4:                             ; CODE XREF: __get_lc_time+1B↑j
                lea     eax, [edi+4]
                push    esi
                push    eax             ; int
                push    31h ; '1'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+8]
                mov     esi, eax
                push    ecx             ; int
                push    32h ; '2'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [edi+0Ch]
                or      esi, eax
                push    edx             ; int
                push    33h ; '3'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                lea     eax, [edi+10h]
                push    eax             ; int
                push    34h ; '4'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+14h]
                or      esi, eax
                push    ecx             ; int
                push    35h ; '5'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [edi+18h]
                or      esi, eax
                push    edx             ; int
                push    36h ; '6'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                push    edi             ; int
                push    37h ; '7'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                lea     eax, [edi+20h]
                push    eax             ; int
                push    2Ah ; '*'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+24h]
                or      esi, eax
                push    ecx             ; int
                push    2Bh ; '+'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [edi+28h]
                or      esi, eax
                push    edx             ; int
                push    2Ch ; ','       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                lea     eax, [edi+2Ch]
                push    eax             ; int
                push    2Dh ; '-'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+30h]
                or      esi, eax
                push    ecx             ; int
                push    2Eh ; '.'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [edi+34h]
                or      esi, eax
                push    edx             ; int
                push    2Fh ; '/'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                lea     eax, [edi+1Ch]
                push    eax             ; int
                push    30h ; '0'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+38h]
                or      esi, eax
                push    ecx             ; int
                push    44h ; 'D'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [edi+3Ch]
                or      esi, eax
                push    edx             ; int
                push    45h ; 'E'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                lea     eax, [edi+40h]
                push    eax             ; int
                push    46h ; 'F'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+44h]
                or      esi, eax
                push    ecx             ; int
                push    47h ; 'G'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [edi+48h]
                or      esi, eax
                push    edx             ; int
                push    48h ; 'H'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                lea     eax, [edi+4Ch]
                push    eax             ; int
                push    49h ; 'I'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+50h]
                or      esi, eax
                push    ecx             ; int
                push    4Ah ; 'J'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [edi+54h]
                or      esi, eax
                push    edx             ; int
                push    4Bh ; 'K'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                lea     eax, [edi+58h]
                push    eax             ; int
                push    4Ch ; 'L'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+5Ch]
                or      esi, eax
                push    ecx             ; int
                push    4Dh ; 'M'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [edi+60h]
                or      esi, eax
                push    edx             ; int
                push    4Eh ; 'N'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                lea     eax, [edi+64h]
                push    eax             ; int
                push    4Fh ; 'O'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+68h]
                or      esi, eax
                push    ecx             ; int
                push    38h ; '8'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [edi+6Ch]
                or      esi, eax
                push    edx             ; int
                push    39h ; '9'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                lea     eax, [edi+70h]
                push    eax             ; int
                push    3Ah ; ':'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+74h]
                or      esi, eax
                push    ecx             ; int
                push    3Bh ; ';'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [edi+78h]
                or      esi, eax
                push    edx             ; int
                push    3Ch ; '<'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                lea     eax, [edi+7Ch]
                push    eax             ; int
                push    3Dh ; '='       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+80h]
                or      esi, eax
                push    ecx             ; int
                push    3Eh ; '>'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [edi+84h]
                or      esi, eax
                push    edx             ; int
                push    3Fh ; '?'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                lea     eax, [edi+88h]
                push    eax             ; int
                push    40h ; '@'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+8Ch]
                or      esi, eax
                push    ecx             ; int
                push    41h ; 'A'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [edi+90h]
                or      esi, eax
                push    edx             ; int
                push    42h ; 'B'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                lea     eax, [edi+94h]
                push    eax             ; int
                push    43h ; 'C'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+98h]
                or      esi, eax
                push    ecx             ; int
                push    28h ; '('       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [edi+9Ch]
                or      esi, eax
                push    edx             ; int
                push    29h ; ')'       ; LCType
                push    ebx             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                lea     eax, [edi+0A0h]
                push    eax             ; int
                push    1Fh             ; LCType
                push    ebp             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [edi+0A4h]
                or      esi, eax
                push    ecx             ; int
                push    20h ; ' '       ; LCType
                push    ebp             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                push    edi             ; int
                push    ebp             ; Block
                call    _storeTimeFmt
                add     esp, 8
                or      esi, eax
                mov     eax, esi
                pop     esi
                pop     edi
                pop     ebp
                pop     ebx
                retn
__get_lc_time   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__free_lc_time  proc near               ; CODE XREF: ___init_time+34↑p

arg_0           = dword ptr  4

                push    esi
                mov     esi, [esp+4+arg_0]
                test    esi, esi
                jz      loc_5D1F31
                mov     eax, dword ptr [esi+4]
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+8]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+0Ch]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+10h]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+14h]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+18h]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+20h]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+24h]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+28h]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+2Ch]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+30h]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+34h]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+1Ch]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+38h]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+3Ch]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+40h]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+44h]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+48h]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+4Ch]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+50h]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+54h]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+58h]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+5Ch]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+60h]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+64h]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+68h]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+6Ch]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+70h]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+74h]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+78h]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+7Ch]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+80h]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+84h]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+88h]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+8Ch]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+90h]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+94h]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+98h]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+9Ch]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+0A0h]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+0A4h]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+0A8h]
                add     esp, 4
                push    eax             ; Block
                call    _free
                add     esp, 4

loc_5D1F31:                             ; CODE XREF: __free_lc_time+7↑j
                pop     esi
                retn
__free_lc_time  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl storeTimeFmt(void *Block, int)
_storeTimeFmt   proc near               ; CODE XREF: __get_lc_time+360↑p

var_8           = dword ptr -8
var_4           = dword ptr -4
Block           = dword ptr  4
arg_4           = dword ptr  8

                sub     esp, 8
                push    esi
                lea     eax, [esp+0Ch+var_4]
                push    edi
                mov     edi, [esp+10h+Block]
                push    eax             ; int
                push    23h ; '#'       ; LCType
                push    edi             ; Locale
                push    0               ; CodePage
                mov     [esp+20h+var_4], 0
                mov     [esp+20h+var_8], 0
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [esp+10h+var_8]
                mov     esi, eax
                push    ecx             ; int
                push    25h ; '%'       ; LCType
                push    edi             ; Locale
                push    0               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [esp+10h+Block]
                or      esi, eax
                push    edx             ; int
                push    1Eh             ; LCType
                push    edi             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      esi, eax
                jz      short loc_5D1F9F
                mov     eax, esi
                pop     edi
                pop     esi
                add     esp, 8
                retn
; ---------------------------------------------------------------------------

loc_5D1F9F:                             ; CODE XREF: _storeTimeFmt+55↑j
                push    0Dh             ; varSize
                call    _malloc
                mov     ecx, dword ptr [esp+14h+arg_4]
                add     esp, 4
                mov     [ecx+0A8h], eax
                mov     ecx, dword ptr [esp+10h+var_4]
                test    ecx, ecx
                jz      short loc_5D1FCC
                mov     byte ptr [eax], 48h ; 'H'
                mov     ecx, dword ptr [esp+10h+var_8]
                inc     eax
                test    ecx, ecx
                jz      short loc_5D1FDC
                mov     byte ptr [eax], 48h ; 'H'
                jmp     short loc_5D1FDB
; ---------------------------------------------------------------------------

loc_5D1FCC:                             ; CODE XREF: _storeTimeFmt+79↑j
                mov     byte ptr [eax], 68h ; 'h'
                mov     ecx, dword ptr [esp+10h+var_8]
                inc     eax
                test    ecx, ecx
                jz      short loc_5D1FDC
                mov     byte ptr [eax], 68h ; 'h'

loc_5D1FDB:                             ; CODE XREF: _storeTimeFmt+8A↑j
                inc     eax

loc_5D1FDC:                             ; CODE XREF: _storeTimeFmt+85↑j
                mov     edx, dword ptr [esp+10h+Block]
                mov     cl, [edx]
                test    cl, cl
                jz      short loc_5D1FF1

loc_5D1FE6:                             ; CODE XREF: _storeTimeFmt+AF↓j
                mov     [eax], cl
                mov     cl, [edx+1]
                inc     eax
                inc     edx
                test    cl, cl
                jnz     short loc_5D1FE6

loc_5D1FF1:                             ; CODE XREF: _storeTimeFmt+A4↑j
                mov     byte ptr [eax], 6Dh ; 'm'
                mov     ecx, dword ptr [esp+10h+var_8]
                inc     eax
                test    ecx, ecx
                jz      short loc_5D2001
                mov     byte ptr [eax], 6Dh ; 'm'
                inc     eax

loc_5D2001:                             ; CODE XREF: _storeTimeFmt+BB↑j
                mov     edx, dword ptr [esp+10h+Block]
                mov     cl, [edx]
                test    cl, cl
                jz      short loc_5D2016

loc_5D200B:                             ; CODE XREF: _storeTimeFmt+D4↓j
                mov     [eax], cl
                mov     cl, [edx+1]
                inc     eax
                inc     edx
                test    cl, cl
                jnz     short loc_5D200B

loc_5D2016:                             ; CODE XREF: _storeTimeFmt+C9↑j
                mov     byte ptr [eax], 73h ; 's'
                inc     eax
                mov     byte ptr [eax], 73h ; 's'
                mov     byte ptr [eax+1], 0
                mov     edx, dword ptr [esp+10h+Block]
                push    edx             ; Block
                call    _free
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                add     esp, 8
                retn
_storeTimeFmt   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___init_numeric proc near               ; DATA XREF: .data:00641530↓o
                mov     eax, dword_70D560
                push    ebx
                push    esi
                xor     ebx, ebx
                xor     esi, esi
                cmp     eax, ebx
                mov     si, word_70D7BA
                push    edi
                jz      loc_5D2159
                push    offset dword_70D788 ; int
                push    0Eh             ; LCType
                push    esi             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                mov     edi, eax
                push    offset dword_70D78C ; int
                push    0Fh             ; LCType
                push    esi             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      edi, eax
                push    offset dword_70D790 ; int
                push    10h             ; LCType
                push    esi             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      edi, eax
                mov     eax, dword_70D790
                push    eax
                call    _fix_grouping
                add     esp, 4
                cmp     edi, ebx
                jz      short loc_5D20EE
                mov     ecx, dword_70D788
                push    ecx             ; Block
                call    _free
                mov     edx, dword_70D78C
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword_70D790
                add     esp, 4
                push    eax             ; Block
                call    _free
                add     esp, 4
                mov     dword_70D788, ebx
                mov     dword_70D78C, ebx
                mov     dword_70D790, ebx
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D20EE:                             ; CODE XREF: ___init_numeric+67↑j
                mov     ecx, off_642670
                mov     eax, dword ptr [ecx]
                cmp     eax, offset unk_642638
                jz      short loc_5D212A
                push    eax             ; Block
                call    _free
                mov     edx, off_642670
                add     esp, 4
                mov     eax, dword ptr [edx+4]
                push    eax             ; Block
                call    _free
                mov     ecx, off_642670
                add     esp, 4
                mov     edx, dword ptr [ecx+8]
                push    edx             ; Block
                call    _free
                add     esp, 4

loc_5D212A:                             ; CODE XREF: ___init_numeric+BB↑j
                mov     ecx, off_642670
                mov     eax, dword_70D788
                mov     [ecx], eax
                mov     edx, off_642670
                mov     eax, dword_70D78C
                mov     [edx+4], eax
                mov     ecx, off_642670
                mov     edx, dword_70D790
                mov     [ecx+8], edx
                jmp     loc_5D2217
; ---------------------------------------------------------------------------

loc_5D2159:                             ; CODE XREF: ___init_numeric+15↑j
                mov     eax, dword_70D788
                push    eax             ; Block
                call    _free
                mov     ecx, dword_70D78C
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword_70D790
                add     esp, 4
                push    edx             ; Block
                call    _free
                add     esp, 4
                mov     dword_70D788, ebx
                mov     dword_70D78C, ebx
                mov     dword_70D790, ebx
                push    2               ; varSize
                call    _malloc
                mov     ecx, off_642670
                add     esp, 4
                mov     [ecx], eax
                mov     edx, off_642670
                mov     eax, dword ptr [edx]
                cmp     eax, ebx
                jnz     short loc_5D21BC
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D21BC:                             ; CODE XREF: ___init_numeric+173↑j
                mov     cx, ds:word_6147B0
                push    2               ; varSize
                mov     [eax], cx
                call    _malloc
                mov     edx, off_642670
                add     esp, 4
                mov     [edx+4], eax
                mov     eax, off_642670
                mov     eax, dword ptr [eax+4]
                cmp     eax, ebx
                jnz     short loc_5D21EC
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D21EC:                             ; CODE XREF: ___init_numeric+1A3↑j
                push    2               ; varSize
                mov     [eax], bl
                call    _malloc
                mov     ecx, off_642670
                add     esp, 4
                mov     [ecx+8], eax
                mov     edx, off_642670
                mov     eax, dword ptr [edx+8]
                cmp     eax, ebx
                jnz     short loc_5D2215
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D2215:                             ; CODE XREF: ___init_numeric+1CC↑j
                mov     [eax], bl

loc_5D2217:                             ; CODE XREF: ___init_numeric+114↑j
                mov     eax, off_642670
                pop     edi
                pop     esi
                pop     ebx
                mov     ecx, dword ptr [eax]
                xor     eax, eax
                mov     dl, [ecx]
                mov     dword_64147C, 1
                mov     byte_641478, dl
                retn
___init_numeric endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_fix_grouping   proc near               ; CODE XREF: ___init_numeric+5D↑p

arg_0           = dword ptr  4

                mov     ecx, dword ptr [esp+arg_0]
                mov     al, [ecx]
                test    al, al
                jz      short locret_5D225D

loc_5D224A:                             ; CODE XREF: _fix_grouping+1B↓j
                cmp     al, 30h ; '0'
                jl      short loc_5D225E
                cmp     al, 39h ; '9'
                jg      short loc_5D225E
                sub     al, 30h ; '0'
                mov     [ecx], al

loc_5D2256:                             ; CODE XREF: _fix_grouping+20↓j
                inc     ecx

loc_5D2257:                             ; CODE XREF: _fix_grouping+31↓j
                mov     al, [ecx]
                test    al, al
                jnz     short loc_5D224A

locret_5D225D:                          ; CODE XREF: _fix_grouping+8↑j
                retn
; ---------------------------------------------------------------------------

loc_5D225E:                             ; CODE XREF: _fix_grouping+C↑j
                cmp     al, 3Bh ; ';'
                jnz     short loc_5D2256
                mov     eax, ecx

loc_5D2264:                             ; CODE XREF: _fix_grouping+2F↓j
                mov     dl, [eax+1]
                mov     [eax], dl
                mov     dl, [eax+1]
                inc     eax
                test    dl, dl
                jnz     short loc_5D2264
                jmp     short loc_5D2257
_fix_grouping   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___init_monetary proc near              ; DATA XREF: .data:00641524↓o
                mov     eax, dword_70D55C
                push    esi
                test    eax, eax
                jz      loc_5D231B
                push    30h ; '0'       ; varSize
                push    1               ; Count
                call    _calloc
                mov     esi, eax
                add     esp, 8
                test    esi, esi
                jnz     short loc_5D22A7
                mov     eax, 1
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D22A7:                             ; CODE XREF: ___init_monetary+1E↑j
                push    esi
                call    __get_lc_lconv
                add     esp, 4
                test    eax, eax
                jz      short loc_5D22CD
                push    esi
                call    __free_lc_lconv
                add     esp, 4
                push    esi             ; Block
                call    _free
                add     esp, 4
                mov     eax, 1
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D22CD:                             ; CODE XREF: ___init_monetary+32↑j
                mov     eax, off_642670
                mov     ecx, dword ptr [eax]
                mov     [esi], ecx
                mov     edx, off_642670
                mov     eax, dword ptr [edx+4]
                mov     [esi+4], eax
                mov     ecx, off_642670
                mov     edx, dword ptr [ecx+8]
                mov     [esi+8], edx
                mov     eax, dword_70D794
                push    eax
                mov     off_642670, esi
                call    __free_lc_lconv
                mov     ecx, dword_70D794
                add     esp, 4
                push    ecx             ; Block
                call    _free
                add     esp, 4
                mov     dword_70D794, esi
                xor     eax, eax
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D231B:                             ; CODE XREF: ___init_monetary+8↑j
                mov     eax, off_642670
                mov     edx, dword ptr [eax]
                mov     off_642640, edx
                mov     ecx, dword ptr [eax+4]
                mov     off_642644, ecx
                mov     edx, dword ptr [eax+8]
                mov     eax, dword_70D794
                mov     off_642648, edx
                push    eax
                mov     off_642670, offset off_642640
                call    __free_lc_lconv
                mov     ecx, dword_70D794
                add     esp, 4
                push    ecx             ; Block
                call    _free
                add     esp, 4
                mov     dword_70D794, 0
                xor     eax, eax
                pop     esi
                retn
___init_monetary endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__get_lc_lconv  proc near               ; CODE XREF: ___init_monetary+28↑p

arg_0           = dword ptr  4

                push    ebx
                mov     ebx, dword ptr [esp+4+arg_0]
                push    esi
                xor     esi, esi
                mov     si, word_70D7B4
                test    ebx, ebx
                jnz     short loc_5D2389
                or      eax, 0FFFFFFFFh
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D2389:                             ; CODE XREF: __get_lc_lconv+11↑j
                push    edi
                lea     eax, [ebx+0Ch]
                push    ebp
                push    eax             ; int
                push    15h             ; LCType
                push    esi             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [ebx+10h]
                mov     edi, eax
                push    ecx             ; int
                push    14h             ; LCType
                push    esi             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [ebx+14h]
                or      edi, eax
                push    edx             ; int
                push    16h             ; LCType
                push    esi             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      edi, eax
                lea     eax, [ebx+18h]
                push    eax             ; int
                push    17h             ; LCType
                push    esi             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ebp, [ebx+1Ch]
                or      edi, eax
                push    ebp             ; int
                push    18h             ; LCType
                push    esi             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                mov     ecx, dword ptr [ebp+0]
                add     esp, 10h
                or      edi, eax
                push    ecx
                call    _fix_grouping_0
                add     esp, 4
                lea     edx, [ebx+20h]
                push    edx             ; int
                push    50h ; 'P'       ; LCType
                push    esi             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      edi, eax
                lea     eax, [ebx+24h]
                push    eax             ; int
                push    51h ; 'Q'       ; LCType
                push    esi             ; Locale
                push    1               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [ebx+28h]
                or      edi, eax
                push    ecx             ; int
                push    1Ah             ; LCType
                push    esi             ; Locale
                push    0               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [ebx+29h]
                or      edi, eax
                push    edx             ; int
                push    19h             ; LCType
                push    esi             ; Locale
                push    0               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      edi, eax
                lea     eax, [ebx+2Ah]
                push    eax             ; int
                push    54h ; 'T'       ; LCType
                push    esi             ; Locale
                push    0               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [ebx+2Bh]
                or      edi, eax
                push    ecx             ; int
                push    55h ; 'U'       ; LCType
                push    esi             ; Locale
                push    0               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     edx, [ebx+2Ch]
                or      edi, eax
                push    edx             ; int
                push    56h ; 'V'       ; LCType
                push    esi             ; Locale
                push    0               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      edi, eax
                lea     eax, [ebx+2Dh]
                push    eax             ; int
                push    57h ; 'W'       ; LCType
                push    esi             ; Locale
                push    0               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                lea     ecx, [ebx+2Eh]
                or      edi, eax
                push    ecx             ; int
                push    52h ; 'R'       ; LCType
                push    esi             ; Locale
                push    0               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                add     ebx, 2Fh ; '/'
                or      edi, eax
                push    ebx             ; int
                push    53h ; 'S'       ; LCType
                push    esi             ; Locale
                push    0               ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                or      edi, eax
                mov     eax, edi
                pop     ebp
                pop     edi
                pop     esi
                pop     ebx
                retn
__get_lc_lconv  endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_fix_grouping_0 proc near               ; CODE XREF: __get_lc_lconv+7E↑p

arg_0           = dword ptr  4

                mov     ecx, dword ptr [esp+arg_0]
                mov     al, [ecx]
                test    al, al
                jz      short locret_5D24DD

loc_5D24CA:                             ; CODE XREF: _fix_grouping_0+1B↓j
                cmp     al, 30h ; '0'
                jl      short loc_5D24DE
                cmp     al, 39h ; '9'
                jg      short loc_5D24DE
                sub     al, 30h ; '0'
                mov     [ecx], al

loc_5D24D6:                             ; CODE XREF: _fix_grouping_0+20↓j
                inc     ecx

loc_5D24D7:                             ; CODE XREF: _fix_grouping_0+31↓j
                mov     al, [ecx]
                test    al, al
                jnz     short loc_5D24CA

locret_5D24DD:                          ; CODE XREF: _fix_grouping_0+8↑j
                retn
; ---------------------------------------------------------------------------

loc_5D24DE:                             ; CODE XREF: _fix_grouping_0+C↑j
                cmp     al, 3Bh ; ';'
                jnz     short loc_5D24D6
                mov     eax, ecx

loc_5D24E4:                             ; CODE XREF: _fix_grouping_0+2F↓j
                mov     dl, [eax+1]
                mov     [eax], dl
                mov     dl, [eax+1]
                inc     eax
                test    dl, dl
                jnz     short loc_5D24E4
                jmp     short loc_5D24D7
_fix_grouping_0 endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

__free_lc_lconv proc near               ; CODE XREF: ___init_monetary+35↑p

arg_0           = dword ptr  4

                push    esi
                mov     esi, [esp+4+arg_0]
                test    esi, esi
                jz      short loc_5D2564
                mov     eax, dword ptr [esi+0Ch]
                cmp     eax, offset unk_70D7E0
                jz      short loc_5D2564
                push    eax             ; Block
                call    _free
                mov     eax, dword ptr [esi+10h]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+14h]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+18h]
                add     esp, 4
                push    edx             ; Block
                call    _free
                mov     eax, dword ptr [esi+1Ch]
                add     esp, 4
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esi+20h]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esi+24h]
                add     esp, 4
                push    edx             ; Block
                call    _free
                add     esp, 4

loc_5D2564:                             ; CODE XREF: __free_lc_lconv+7↑j
                pop     esi
                retn
__free_lc_lconv endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_5D2570      proc near               ; DATA XREF: .data:00641518↓o

Block           = dword ptr -20h
var_1C          = dword ptr -1Ch
var_18          = dword ptr -18h
CPInfo          = _cpinfo ptr -14h

                mov     eax, dword_70D558
                sub     esp, 20h
                push    ebx
                push    ebp
                push    esi
                push    edi
                xor     ebp, ebp
                xor     edi, edi
                xor     ebx, ebx
                cmp     eax, ebp
                jz      loc_5D27E8
                cmp     [g_CodePage], ebp
                jnz     short loc_5D25B3
                xor     eax, eax
                push    offset CodePage ; int
                mov     ax, word_70D7AC
                push    0Bh             ; LCType
                push    eax             ; Locale
                push    ebp             ; CodePage
                call    ___getlocaleinfo
                add     esp, 10h
                test    eax, eax
                jnz     loc_5D27A9

loc_5D25B3:                             ; CODE XREF: sub_5D2570+20↑j
                push    202h            ; varSize
                call    _malloc
                add     esp, 4
                mov     esi, eax
                mov     [esp+30h+var_18], esi
                push    202h            ; varSize
                call    _malloc
                add     esp, 4
                mov     ebx, eax
                mov     [esp+30h+var_1C], ebx
                push    101h            ; varSize
                call    _malloc
                add     esp, 4
                mov     edi, eax
                push    202h            ; varSize
                call    _malloc
                add     esp, 4
                cmp     esi, ebp
                mov     [esp+30h+Block], eax
                jz      loc_5D27AF
                cmp     ebx, ebp
                jz      loc_5D27AF
                cmp     edi, ebp
                jz      loc_5D27AF
                cmp     eax, ebp
                jz      loc_5D27AF
                xor     eax, eax

loc_5D261B:                             ; CODE XREF: sub_5D2570+B4↓j
                mov     [eax+edi], al
                inc     eax
                cmp     eax, 100h
                jl      short loc_5D261B
                mov     edx, CodePage
                lea     ecx, [esp+30h+CPInfo]
                push    ecx             ; lpCPInfo
                push    edx             ; CodePage
                call    GetCPInfo
                test    eax, eax
                jz      loc_5D27AF
                mov     eax, dword ptr [esp+30h+CPInfo.MaxCharSize]
                cmp     eax, 2
                ja      loc_5D27AF
                and     eax, 0FFFFh
                cmp     eax, 1
                mov     [g_SrcSizeInBytes], eax
                jle     short loc_5D2694
                mov     al, [esp+30h+CPInfo.LeadByte]
                test    al, al
                jz      short loc_5D2694
                lea     ecx, [esp+30h+CPInfo.LeadByte+1]

loc_5D2668:                             ; CODE XREF: sub_5D2570+122↓j
                mov     dl, [ecx]
                test    dl, dl
                jz      short loc_5D2694
                xor     eax, eax
                and     edx, 0FFh
                mov     al, [ecx-1]
                cmp     eax, edx
                jg      short loc_5D268A

loc_5D267D:                             ; CODE XREF: sub_5D2570+118↓j
                xor     edx, edx
                mov     byte ptr [eax+edi], 0
                mov     dl, [ecx]
                inc     eax
                cmp     eax, edx
                jle     short loc_5D267D

loc_5D268A:                             ; CODE XREF: sub_5D2570+10B↑j
                mov     al, [ecx+1]
                add     ecx, 2
                test    al, al
                jnz     short loc_5D2668

loc_5D2694:                             ; CODE XREF: sub_5D2570+EA↑j
                lea     ebx, [esi+2]
                push    ebp             ; Locale
                push    ebp             ; CodePage
                push    ebx             ; lpCharType
                push    100h            ; cchSrc
                push    edi             ; lpSrcStr
                push    1               ; dwInfoType
                call    ___crtGetStringTypeA
                add     esp, 18h
                test    eax, eax
                jz      loc_5D27AF
                mov     edx, dword ptr [esp+30h+Block]
                mov     [esi], bp
                mov     ecx, edx
                xor     eax, eax

loc_5D26BD:                             ; CODE XREF: sub_5D2570+159↓j
                mov     [ecx], ax
                add     ecx, 2
                inc     eax
                cmp     eax, 100h
                jl      short loc_5D26BD
                mov     eax, dword ptr [esp+30h+var_1C]
                push    0               ; Locale
                push    0               ; CodePage
                lea     ebp, [eax+2]
                push    ebp             ; lpCharType
                push    100h            ; cchSrc
                push    edx             ; lpSrcStr
                push    1               ; dwInfoType
                call    ___crtGetStringTypeW
                add     esp, 18h
                test    eax, eax
                jz      loc_5D27AF
                mov     ecx, dword ptr [esp+30h+var_1C]
                mov     word ptr [ecx], 0
                mov     eax, [g_SrcSizeInBytes]
                cmp     eax, 1
                jle     short loc_5D274A
                mov     al, [esp+30h+CPInfo.LeadByte]
                test    al, al
                jz      short loc_5D274A
                lea     esi, [esp+30h+CPInfo.LeadByte+1]

loc_5D270E:                             ; CODE XREF: sub_5D2570+1D4↓j
                mov     cl, [esi]
                test    cl, cl
                jz      short loc_5D2746
                xor     eax, eax
                and     ecx, 0FFh
                mov     al, [esi-1]
                cmp     eax, ecx
                jg      short loc_5D273C
                mov     edx, dword ptr [esp+30h+var_18]
                lea     ecx, [edx+eax*2+2]

loc_5D272B:                             ; CODE XREF: sub_5D2570+1CA↓j
                xor     edx, edx
                mov     word ptr [ecx], 8000h
                mov     dl, [esi]
                inc     eax
                add     ecx, 2
                cmp     eax, edx
                jle     short loc_5D272B

loc_5D273C:                             ; CODE XREF: sub_5D2570+1B1↑j
                mov     al, [esi+1]
                add     esi, 2
                test    al, al
                jnz     short loc_5D270E

loc_5D2746:                             ; CODE XREF: sub_5D2570+1A2↑j
                mov     esi, [esp+30h+var_18]

loc_5D274A:                             ; CODE XREF: sub_5D2570+190↑j
                mov     eax, dword_70D798
                mov     off_641268, ebx
                test    eax, eax
                mov     off_64126C, ebp
                jz      short loc_5D2768
                push    eax             ; Block
                call    _free
                add     esp, 4

loc_5D2768:                             ; CODE XREF: sub_5D2570+1ED↑j
                mov     eax, dword_70D79C
                mov     dword_70D798, esi
                test    eax, eax
                jz      short loc_5D2780
                push    eax             ; Block
                call    _free
                add     esp, 4

loc_5D2780:                             ; CODE XREF: sub_5D2570+205↑j
                mov     eax, dword ptr [esp+30h+var_1C]
                push    edi             ; Block
                mov     dword_70D79C, eax
                call    _free
                mov     ecx, dword ptr [esp+34h+Block]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 20h
                retn
; ---------------------------------------------------------------------------

loc_5D27A9:                             ; CODE XREF: sub_5D2570+3D↑j
                mov     esi, [esp+30h+var_18]
                jmp     short loc_5D27B3
; ---------------------------------------------------------------------------

loc_5D27AF:                             ; CODE XREF: sub_5D2570+8B↑j
                mov     ebx, dword ptr [esp+30h+Block]

loc_5D27B3:                             ; CODE XREF: sub_5D2570+23D↑j
                push    esi             ; Block
                call    _free
                mov     edx, dword ptr [esp+34h+var_1C]
                add     esp, 4
                push    edx             ; Block
                call    _free
                add     esp, 4
                push    edi             ; Block
                call    _free
                add     esp, 4
                push    ebx             ; Block
                call    _free
                add     esp, 4
                mov     eax, 1
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 20h
                retn
; ---------------------------------------------------------------------------

loc_5D27E8:                             ; CODE XREF: sub_5D2570+14↑j
                mov     eax, 641272h
                mov     off_641268, eax
                mov     off_64126C, eax
                mov     eax, dword_70D798
                push    eax             ; Block
                call    _free
                mov     ecx, dword_70D79C
                add     esp, 4
                push    ecx             ; Block
                call    _free
                add     esp, 4
                mov     dword_70D798, ebp
                mov     dword_70D79C, ebp
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 20h
                retn
sub_5D2570      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================


sub_5D2830      proc near               ; DATA XREF: .data:0064150C↓o
                xor     eax, eax
                retn
sub_5D2830      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; int __cdecl strncmp(const char *Str1, const char *Str2, size_t MaxCount)
_strncmp        proc near               ; CODE XREF: _setlocale+FD↑p

Str1            = dword ptr  8
Str2            = dword ptr  0Ch
MaxCount        = dword ptr  10h

                push    ebp
                mov     ebp, esp
                push    edi
                push    esi
                push    ebx
                mov     ecx, dword ptr [ebp+MaxCount]
                jecxz   short toend_1
                mov     ebx, ecx
                mov     edi, [ebp+Str1]
                mov     esi, edi
                xor     eax, eax
                repne scasb
                neg     ecx
                add     ecx, ebx

okay:
                mov     edi, esi
                mov     esi, [ebp+Str2]
                repe cmpsb
                mov     al, [esi-1]
                xor     ecx, ecx
                cmp     al, [edi-1]
                ja      short lastbig
                jz      short toend_1

firstbig:
                dec     ecx
                dec     ecx

lastbig:                                ; CODE XREF: _strncmp+29↑j
                not     ecx

toend_1:                                ; CODE XREF: _strncmp+9↑j
                mov     eax, ecx
                pop     ebx
                pop     esi
                pop     edi
                leave
                retn
_strncmp        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __get_qualified_locale(char *String1, int, LPSTR lpLCData)
___get_qualified_locale proc near       ; CODE XREF: __expandlocale+10E↑p

var_8C          = dword ptr -8Ch
var_88          = dword ptr -88h
var_84          = dword ptr -84h
String          = word ptr -80h
String1         = dword ptr  4
arg_4           = dword ptr  8
lpLCData        = dword ptr  0Ch

                sub     esp, 8Ch
                mov     ecx, dword ptr [esp+8Ch+arg_4]
                push    ebx
                xor     eax, eax
                push    ebp
                xor     ebx, ebx
                push    esi
                cmp     ecx, eax
                push    edi
                mov     [esp+9Ch+var_84], ebx
                jnz     short loc_5D28B1
                cmp     [esp+9Ch+lpLCData], eax
                jnz     short loc_5D28B1
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8Ch
                retn
; ---------------------------------------------------------------------------

loc_5D28B1:                             ; CODE XREF: ___get_qualified_locale+1B↑j
                mov     esi, [esp+9Ch+String1]
                xor     bp, bp
                cmp     esi, eax
                mov     word ptr [esp+9Ch+var_8C], bp
                mov     word ptr [esp+9Ch+var_8C+2], ax
                mov     word ptr [esp+9Ch+var_88], ax
                jz      short loc_5D28FB
                cmp     byte ptr [esi], 0
                jz      short loc_5D28FB
                push    esi             ; String1
                call    _trans_lang_lang
                mov     bp, ax
                add     esp, 4
                test    bp, bp
                mov     word ptr [esp+9Ch+var_8C], bp
                jnz     short loc_5D28F6
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8Ch
                retn
; ---------------------------------------------------------------------------

loc_5D28F6:                             ; CODE XREF: ___get_qualified_locale+67↑j
                mov     ax, word ptr [esp+9Ch+var_8C+2]

loc_5D28FB:                             ; CODE XREF: ___get_qualified_locale+4C↑j
                lea     ecx, [esi+40h]
                test    ecx, ecx
                jz      short loc_5D292C
                cmp     byte ptr [ecx], 0
                jz      short loc_5D292C
                push    ecx             ; String1
                call    _trans_ctry_ctry
                add     esp, 4
                mov     word ptr [esp+9Ch+var_8C+2], ax
                test    ax, ax
                jnz     short loc_5D2927
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8Ch
                retn
; ---------------------------------------------------------------------------

loc_5D2927:                             ; CODE XREF: ___get_qualified_locale+98↑j
                mov     bp, word ptr [esp+9Ch+var_8C]

loc_5D292C:                             ; CODE XREF: ___get_qualified_locale+80↑j
                lea     edi, [esi+80h]
                test    edi, edi
                jz      loc_5D29E0
                cmp     byte ptr [edi], 0
                jz      loc_5D29E0
                mov     esi, offset unk_615168
                mov     ecx, edi

loc_5D294A:                             ; CODE XREF: ___get_qualified_locale+E8↓j
                mov     bl, [ecx]
                mov     dl, bl
                cmp     bl, [esi]
                jnz     short loc_5D296E
                test    dl, dl
                jz      short loc_5D296A
                mov     bl, [ecx+1]
                mov     dl, bl
                cmp     bl, [esi+1]
                jnz     short loc_5D296E
                add     ecx, 2
                add     esi, 2
                test    dl, dl
                jnz     short loc_5D294A

loc_5D296A:                             ; CODE XREF: ___get_qualified_locale+D4↑j
                xor     ecx, ecx
                jmp     short loc_5D2973
; ---------------------------------------------------------------------------

loc_5D296E:                             ; CODE XREF: ___get_qualified_locale+D0↑j
                sbb     ecx, ecx
                sbb     ecx, 0FFFFFFFFh

loc_5D2973:                             ; CODE XREF: ___get_qualified_locale+EC↑j
                test    ecx, ecx
                jz      short loc_5D29DC
                mov     esi, offset unk_615164
                mov     ecx, edi

loc_5D297E:                             ; CODE XREF: ___get_qualified_locale+11C↓j
                mov     bl, [ecx]
                mov     dl, bl
                cmp     bl, [esi]
                jnz     short loc_5D29A2
                test    dl, dl
                jz      short loc_5D299E
                mov     bl, [ecx+1]
                mov     dl, bl
                cmp     bl, [esi+1]
                jnz     short loc_5D29A2
                add     ecx, 2
                add     esi, 2
                test    dl, dl
                jnz     short loc_5D297E

loc_5D299E:                             ; CODE XREF: ___get_qualified_locale+108↑j
                xor     ecx, ecx
                jmp     short loc_5D29A7
; ---------------------------------------------------------------------------

loc_5D29A2:                             ; CODE XREF: ___get_qualified_locale+104↑j
                sbb     ecx, ecx
                sbb     ecx, 0FFFFFFFFh

loc_5D29A7:                             ; CODE XREF: ___get_qualified_locale+120↑j
                test    ecx, ecx
                jnz     short loc_5D29B2
                mov     ebx, 1
                jmp     short loc_5D29E0
; ---------------------------------------------------------------------------

loc_5D29B2:                             ; CODE XREF: ___get_qualified_locale+129↑j
                push    edi             ; String
                call    _atoi
                add     esp, 4
                mov     word ptr [esp+9Ch+var_88], ax
                test    ax, ax
                jnz     short loc_5D29D2
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8Ch
                retn
; ---------------------------------------------------------------------------

loc_5D29D2:                             ; CODE XREF: ___get_qualified_locale+143↑j
                mov     bp, word ptr [esp+9Ch+var_8C]
                mov     ax, word ptr [esp+9Ch+var_8C+2]

loc_5D29DC:                             ; CODE XREF: ___get_qualified_locale+F5↑j
                mov     ebx, dword ptr [esp+9Ch+var_84]

loc_5D29E0:                             ; CODE XREF: ___get_qualified_locale+B4↑j
                test    bp, bp
                jnz     short loc_5D2A20
                test    ax, ax
                jnz     short loc_5D2A07
                mov     esi, ds:GetUserDefaultLCID
                call    esi ; GetUserDefaultLCID
                cmp     word ptr [esp+9Ch+var_88], bp
                mov     word ptr [esp+9Ch+var_8C+2], ax
                mov     word ptr [esp+9Ch+var_8C], ax
                jnz     short loc_5D2A71
                call    esi ; GetUserDefaultLCID
                jmp     short loc_5D2A75
; ---------------------------------------------------------------------------

loc_5D2A07:                             ; CODE XREF: ___get_qualified_locale+168↑j
                mov     eax, dword ptr [esp+9Ch+var_8C+2]
                push    eax
                call    _trans_ctry_lang
                add     esp, 4
                mov     word ptr [esp+9Ch+var_8C], ax
                mov     word ptr [esp+9Ch+var_8C+2], ax
                jmp     short loc_5D2A2A
; ---------------------------------------------------------------------------

loc_5D2A20:                             ; CODE XREF: ___get_qualified_locale+163↑j
                test    ax, ax
                jnz     short loc_5D2A3D
                mov     word ptr [esp+9Ch+var_8C+2], bp

loc_5D2A2A:                             ; CODE XREF: ___get_qualified_locale+19E↑j
                cmp     word ptr [esp+9Ch+var_88], 0
                jnz     short loc_5D2A71
                mov     eax, dword ptr [esp+9Ch+var_8C]
                and     eax, 0FFFFh
                jmp     short loc_5D2A75
; ---------------------------------------------------------------------------

loc_5D2A3D:                             ; CODE XREF: ___get_qualified_locale+1A3↑j
                lea     ecx, [esp+9Ch+var_8C]
                lea     edx, [esp+9Ch+var_8C+2]
                push    ecx
                push    edx
                call    _match_ctry_lang
                add     esp, 8
                test    eax, eax
                jnz     short loc_5D2A5E
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8Ch
                retn
; ---------------------------------------------------------------------------

loc_5D2A5E:                             ; CODE XREF: ___get_qualified_locale+1D1↑j
                cmp     word ptr [esp+9Ch+var_88], 0
                jnz     short loc_5D2A71
                mov     eax, dword ptr [esp+9Ch+var_8C+2]
                and     eax, 0FFFFh
                jmp     short loc_5D2A75
; ---------------------------------------------------------------------------

loc_5D2A71:                             ; CODE XREF: ___get_qualified_locale+181↑j
                mov     eax, dword ptr [esp+9Ch+var_84]

loc_5D2A75:                             ; CODE XREF: ___get_qualified_locale+185↑j
                cmp     word ptr [esp+9Ch+var_88], 0
                jnz     short loc_5D2AC5
                neg     ebx
                sbb     ebx, ebx
                push    0               ; CodePage
                and     ebx, 0FFFFF007h
                lea     ecx, [esp+0A0h+String]
                push    40h ; '@'       ; cchData
                add     ebx, 1004h
                push    ecx             ; lpLCData
                push    ebx             ; LCType
                push    eax             ; Locale
                call    ___crtGetLocaleInfoW
                add     esp, 14h
                test    eax, eax
                jnz     short loc_5D2AAF
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8Ch
                retn
; ---------------------------------------------------------------------------

loc_5D2AAF:                             ; CODE XREF: ___get_qualified_locale+222↑j
                push    0Ah             ; Radix
                lea     edx, [esp+0A0h+String]
                push    0               ; EndPtr
                push    edx             ; String
                call    _wcstol
                add     esp, 0Ch
                mov     word ptr [esp+9Ch+var_88], ax

loc_5D2AC5:                             ; CODE XREF: ___get_qualified_locale+1FB↑j
                mov     eax, dword ptr [esp+9Ch+var_88]
                and     eax, 0FFFFh
                push    eax             ; CodePage
                call    IsValidCodePage
                test    eax, eax
                jnz     short loc_5D2AE4
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8Ch
                retn
; ---------------------------------------------------------------------------

loc_5D2AE4:                             ; CODE XREF: ___get_qualified_locale+257↑j
                mov     ecx, dword ptr [esp+9Ch+var_8C]
                push    1               ; dwFlags
                and     ecx, 0FFFFh
                push    ecx             ; Locale
                call    IsValidLocale
                test    eax, eax
                jnz     short loc_5D2B06
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8Ch
                retn
; ---------------------------------------------------------------------------

loc_5D2B06:                             ; CODE XREF: ___get_qualified_locale+279↑j
                mov     ecx, dword ptr [esp+9Ch+arg_4]
                mov     eax, dword ptr [esp+9Ch+var_8C]
                test    ecx, ecx
                jz      short loc_5D2B20
                mov     dx, word ptr [esp+9Ch+var_88]
                mov     [ecx], eax
                mov     [ecx+4], dx

loc_5D2B20:                             ; CODE XREF: ___get_qualified_locale+293↑j
                mov     esi, [esp+9Ch+lpLCData]
                test    esi, esi
                jz      short loc_5D2B9D
                push    0               ; CodePage
                push    40h ; '@'       ; cchData
                push    esi             ; lpLCData
                and     eax, 0FFFFh
                push    1001h           ; LCType
                push    eax             ; Locale
                call    ___crtGetLocaleInfoA
                add     esp, 14h
                test    eax, eax
                jnz     short loc_5D2B52
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8Ch
                retn
; ---------------------------------------------------------------------------

loc_5D2B52:                             ; CODE XREF: ___get_qualified_locale+2C5↑j
                mov     ecx, dword ptr [esp+9Ch+var_8C+2]
                push    0               ; CodePage
                lea     eax, [esi+40h]
                push    40h ; '@'       ; cchData
                push    eax             ; lpLCData
                and     ecx, 0FFFFh
                push    1002h           ; LCType
                push    ecx             ; Locale
                call    ___crtGetLocaleInfoA
                add     esp, 14h
                test    eax, eax
                jnz     short loc_5D2B81
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 8Ch
                retn
; ---------------------------------------------------------------------------

loc_5D2B81:                             ; CODE XREF: ___get_qualified_locale+2F4↑j
                mov     edx, dword ptr [esp+9Ch+var_88]
                add     esi, 80h
                push    0Ah             ; Radix
                and     edx, 0FFFFh
                push    esi             ; Buffer
                push    edx             ; Value
                call    __itoa
                add     esp, 0Ch

loc_5D2B9D:                             ; CODE XREF: ___get_qualified_locale+2A9↑j
                pop     edi
                pop     esi
                pop     ebp
                mov     eax, 1
                pop     ebx
                add     esp, 8Ch
                retn
___get_qualified_locale endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl trans_lang_lang(char *String1)
_trans_lang_lang proc near              ; CODE XREF: ___get_qualified_locale+54↑p

String1         = dword ptr  4

                push    ebx
                push    ebp
                mov     ebp, [esp+8+String1]
                push    esi
                push    edi
                xor     edi, edi
                mov     ebx, 63h ; 'c'

loc_5D2BBF:                             ; CODE XREF: _trans_lang_lang+3D↓j
                lea     eax, [ebx+edi]
                cdq
                sub     eax, edx
                mov     esi, eax
                sar     esi, 1
                mov     eax, off_641E40[esi*8]
                push    eax             ; String2
                push    ebp             ; String1
                call    __strcmpi
                add     esp, 8
                test    eax, eax
                jz      short loc_5D2BEF
                jge     short loc_5D2BE4
                mov     ebx, esi
                jmp     short loc_5D2BE6
; ---------------------------------------------------------------------------

loc_5D2BE4:                             ; CODE XREF: _trans_lang_lang+2E↑j
                mov     edi, esi

loc_5D2BE6:                             ; CODE XREF: _trans_lang_lang+32↑j
                lea     ecx, [edi+1]
                cmp     ecx, ebx
                jz      short loc_5D2BFC
                jmp     short loc_5D2BBF
; ---------------------------------------------------------------------------

loc_5D2BEF:                             ; CODE XREF: _trans_lang_lang+2C↑j
                mov     ax, word ptr dword_641E44[esi*8]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D2BFC:                             ; CODE XREF: _trans_lang_lang+3B↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     ax, ax
                pop     ebx
                retn
_trans_lang_lang endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl trans_ctry_ctry(char *String1)
_trans_ctry_ctry proc near              ; CODE XREF: ___get_qualified_locale+88↑p

String1         = dword ptr  4

                push    ebx
                push    ebp
                mov     ebp, [esp+8+String1]
                push    esi
                push    edi
                xor     edi, edi
                mov     ebx, 57h ; 'W'

loc_5D2C1F:                             ; CODE XREF: _trans_ctry_ctry+3D↓j
                lea     eax, [ebx+edi]
                cdq
                sub     eax, edx
                mov     esi, eax
                sar     esi, 1
                mov     eax, off_642158[esi*8]
                push    eax             ; String2
                push    ebp             ; String1
                call    __strcmpi
                add     esp, 8
                test    eax, eax
                jz      short loc_5D2C4F
                jge     short loc_5D2C44
                mov     ebx, esi
                jmp     short loc_5D2C46
; ---------------------------------------------------------------------------

loc_5D2C44:                             ; CODE XREF: _trans_ctry_ctry+2E↑j
                mov     edi, esi

loc_5D2C46:                             ; CODE XREF: _trans_ctry_ctry+32↑j
                lea     ecx, [edi+1]
                cmp     ecx, ebx
                jz      short loc_5D2C5C
                jmp     short loc_5D2C1F
; ---------------------------------------------------------------------------

loc_5D2C4F:                             ; CODE XREF: _trans_ctry_ctry+2C↑j
                mov     ax, word ptr dword_64215C[esi*8]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D2C5C:                             ; CODE XREF: _trans_ctry_ctry+3B↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     ax, ax
                pop     ebx
                retn
_trans_ctry_ctry endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_trans_ctry_lang proc near              ; CODE XREF: ___get_qualified_locale+18C↑p

arg_0           = dword ptr  4

                push    esi
                mov     esi, [esp+4+arg_0]
                cmp     si, 64h ; 'd'
                jbe     short loc_5D2C89
                push    esi
                call    _testSpecialCtry
                add     esp, 4
                test    ax, ax
                jnz     short loc_5D2CB4

loc_5D2C89:                             ; CODE XREF: _trans_ctry_lang+9↑j
                mov     eax, esi
                mov     ecx, 64h ; 'd'
                and     eax, 0FFFFh
                cdq
                idiv    ecx
                cmp     dx, 5Ah ; 'Z'
                jbe     short loc_5D2CA3
                xor     ax, ax
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D2CA3:                             ; CODE XREF: _trans_ctry_lang+2C↑j
                and     edx, 0FFFFh
                lea     edx, [edx+edx*2]
                mov     ax, word_642410[edx*2]

loc_5D2CB4:                             ; CODE XREF: _trans_ctry_lang+17↑j
                pop     esi
                retn
_trans_ctry_lang endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_testSpecialCtry proc near              ; CODE XREF: _trans_ctry_lang+C↑p

arg_0           = word ptr  4

                mov     ax, [esp+arg_0]
                sub     ax, 354h
                neg     ax
                sbb     eax, eax
                and     eax, 0FFFFF3FCh
                add     eax, 0C04h
                retn
_testSpecialCtry endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_match_ctry_lang proc near              ; CODE XREF: ___get_qualified_locale+1C7↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     ecx, dword ptr [esp+arg_4]
                push    ebx
                mov     ebx, dword ptr [esp+4+arg_0]
                push    ebp
                push    esi
                push    edi
                mov     ax, [ebx]
                mov     di, [ecx]
                and     eax, 0FFFFh
                mov     ecx, 64h ; 'd'
                cdq
                idiv    ecx
                cmp     dx, 5Ah ; 'Z'
                jbe     short loc_5D2D0C
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D2D0C:                             ; CODE XREF: _match_ctry_lang+23↑j
                xor     esi, esi
                and     edx, 0FFFFh
                lea     eax, [edx+edx*2]
                lea     edx, word_642410[eax*2]
                mov     ecx, edx

loc_5D2D20:                             ; CODE XREF: _match_ctry_lang+5B↓j
                mov     ax, [ecx]
                test    ax, ax
                jz      short loc_5D2D3D
                mov     ebp, eax
                xor     ebp, edi
                test    ebp, 3FFh
                jz      short loc_5D2D52
                inc     esi
                add     ecx, 2
                cmp     esi, 3
                jb      short loc_5D2D20

loc_5D2D3D:                             ; CODE XREF: _match_ctry_lang+46↑j
                mov     ax, [edx]
                xor     ecx, ecx
                test    ax, ax
                setnz   cl
                mov     [ebx], ax
                mov     eax, ecx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D2D52:                             ; CODE XREF: _match_ctry_lang+52↑j
                and     edi, 0FFFFh
                test    edi, 0FFFFFC00h
                jnz     short loc_5D2D67
                mov     edx, dword ptr [esp+10h+arg_4]
                mov     [edx], ax

loc_5D2D67:                             ; CODE XREF: _match_ctry_lang+7E↑j
                pop     edi
                pop     esi
                mov     [ebx], ax
                pop     ebp
                mov     eax, 1
                pop     ebx
                retn
_match_ctry_lang endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function bp-based frame

; int __cdecl _frnd(double)
__frnd          proc near               ; CODE XREF: __d_inttype+1D↑p

var_8           = qword ptr -8
arg_0           = qword ptr  8

                push    ebp
                mov     ebp, esp
                sub     esp, 8
                fld     [ebp+arg_0]
                frndint
                fstp    [ebp+var_8]
                fld     [ebp+var_8]
                mov     esp, ebp
                pop     ebp
                retn
__frnd          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl _copysign(double Number, double Sign)
__copysign      proc near               ; CODE XREF: _ldexp+11F↓p

var_8           = qword ptr -8
Number          = qword ptr  4
arg_C           = dword ptr  10h

                sub     esp, 8
                mov     eax, dword ptr [esp+8+Number]
                mov     edx, dword ptr [esp+8+Number+4]
                mov     dword ptr [esp+8+var_8], eax
                mov     eax, dword ptr [esp+8+arg_C]
                mov     ecx, eax
                xor     ecx, edx
                and     ecx, 7FFFFFFFh
                xor     ecx, eax
                mov     dword ptr [esp+8+var_8+4], ecx
                fld     [esp+8+var_8]
                add     esp, 8
                retn
__copysign      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl _chgsign(double X)
__chgsign       proc near

var_8           = qword ptr -8
X               = qword ptr  4

                sub     esp, 8
                mov     eax, dword ptr [esp+8+X]
                mov     dword ptr [esp+8+var_8], eax
                mov     eax, dword ptr [esp+8+X+4]
                mov     ecx, eax
                not     ecx
                xor     eax, ecx
                and     eax, 7FFFFFFFh
                xor     eax, ecx
                mov     dword ptr [esp+8+var_8+4], eax
                fld     [esp+8+var_8]
                add     esp, 8
                retn
__chgsign       endp

; ---------------------------------------------------------------------------
                align 10h
                mov     eax, dword ptr [esp+0Ch]
                mov     ecx, dword ptr [esp+8]
                mov     edx, dword ptr [esp+4]
                push    eax
                push    ecx
                push    edx
                call    _ldexp
                add     esp, 0Ch
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl _logb(double X)
__logb          proc near

var_1C          = qword ptr -1Ch
var_4           = dword ptr -4
X               = qword ptr  4

                push    ecx
                push    ebx
                push    esi
                push    edi
                push    0FFFFh
                push    133Fh
                call    __ctrlfp
                mov     esi, eax
                mov     eax, dword ptr [esp+18h+X+6]
                and     eax, 7FF0h
                add     esp, 8
                cmp     eax, 7FF0h
                jnz     short loc_5D2EB5
                mov     edi, dword ptr [esp+10h+X+4]
                mov     ebx, dword ptr [esp+10h+X]
                push    edi
                push    ebx
                call    __sptype
                add     esp, 8
                test    eax, eax
                jle     short loc_5D2E91
                cmp     eax, 2
                jle     short loc_5D2E7A
                cmp     eax, 3
                jnz     short loc_5D2E91
                push    esi             ; int
                push    edi
                push    ebx             ; double
                push    25h ; '%'       ; int
                call    __handle_qnan1
                add     esp, 10h
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D2E7A:                             ; CODE XREF: __logb+41↑j
                push    0FFFFh
                push    esi
                call    __ctrlfp
                fld     [esp+18h+X]
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D2E91:                             ; CODE XREF: __logb+3C↑j
                fld     [esp+10h+X]
                fsub    qword ptr [dbl_615170]
                push    esi             ; int
                sub     esp, 8
                fstp    [esp+1Ch+var_1C] ; double
                push    edi             ; int
                push    ebx             ; int
                push    25h ; '%'       ; int
                push    8               ; char
                call    __except1
                add     esp, 1Ch
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D2EB5:                             ; CODE XREF: __logb+26↑j
                fld     [esp+10h+X]
                fcomp   qword ptr [dbl_615178]
                fnstsw  ax
                test    ah, 40h
                jz      short loc_5D2EF0
                fld     qword ptr [g_Number]
                mov     ecx, dword ptr [esp+10h+X+4]
                mov     edx, dword ptr [esp+10h+X]
                push    esi             ; int
                sub     esp, 8
                fchs
                fstp    [esp+1Ch+var_1C] ; double
                push    ecx             ; int
                push    edx             ; int
                push    25h ; '%'       ; int
                push    4               ; char
                call    __except1
                add     esp, 1Ch
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D2EF0:                             ; CODE XREF: __logb+A4↑j
                mov     ecx, dword ptr [esp+10h+X+4]
                mov     edx, dword ptr [esp+10h+X]
                lea     eax, [esp+10h+var_4]
                push    eax             ; int
                push    ecx
                push    edx             ; double
                call    __decomp
                mov     eax, dword ptr [esp+1Ch+var_4]
                add     esp, 0Ch
                dec     eax
                fstp    st
                mov     dword ptr [esp+10h+X], eax
                push    0FFFFh
                fild    dword ptr [esp+14h+X]
                push    esi
                fstp    [esp+18h+X]
                call    __ctrlfp
                fld     [esp+18h+X]
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
__logb          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl _nextafter(double X, double Y)
__nextafter     proc near

var_30          = qword ptr -30h
var_14          = qword ptr -14h
var_C           = qword ptr -0Ch
X               = qword ptr  4
Y               = qword ptr  0Ch

                sub     esp, 14h
                push    ebx
                push    ebp
                push    esi
                push    edi
                push    0FFFFh
                push    133Fh
                call    __ctrlfp
                mov     ebx, eax
                mov     eax, dword ptr [esp+2Ch+X+6]
                mov     esi, dword ptr [esp+2Ch+X+4]
                mov     edi, dword ptr [esp+2Ch+X]
                mov     ebp, dword ptr [esp+2Ch+Y+4]
                mov     ecx, eax
                and     ecx, 7FF0h
                add     esp, 8
                cmp     ecx, 7FF0h
                mov     ecx, dword ptr [esp+24h+Y+6]
                jz      short loc_5D2F8F
                mov     edx, ecx
                and     edx, 7FF0h
                cmp     edx, 7FF0h
                jnz     short loc_5D3003

loc_5D2F8F:                             ; CODE XREF: __nextafter+3D↑j
                and     eax, 7FF8h
                cmp     ax, 7FF0h
                jnz     short loc_5D2FA6
                test    esi, 7FFFFh
                jnz     short loc_5D2FC3
                test    edi, edi
                jnz     short loc_5D2FC3

loc_5D2FA6:                             ; CODE XREF: __nextafter+58↑j
                and     ecx, 7FF8h
                cmp     cx, 7FF0h
                jnz     short loc_5D2FEE
                test    ebp, 7FFFFh
                jnz     short loc_5D2FC3
                mov     edx, dword ptr [esp+24h+Y]
                test    edx, edx
                jz      short loc_5D2FEE

loc_5D2FC3:                             ; CODE XREF: __nextafter+60↑j
                fld     [esp+24h+Y]
                fadd    [esp+24h+X]
                mov     eax, dword ptr [esp+24h+Y]
                push    ebx             ; int
                sub     esp, 8
                fstp    [esp+30h+var_30] ; double
                push    ebp             ; int
                push    eax             ; int
                push    esi             ; int
                push    edi             ; int
                push    26h ; '&'       ; int
                push    8               ; char
                call    __except2
                add     esp, 24h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
; ---------------------------------------------------------------------------

loc_5D2FEE:                             ; CODE XREF: __nextafter+71↑j
                cmp     ax, 7FF8h
                jz      loc_5D321C
                cmp     cx, 7FF8h
                jz      loc_5D321C

loc_5D3003:                             ; CODE XREF: __nextafter+4D↑j
                fld     [esp+24h+Y]
                fcomp   [esp+24h+X]
                fnstsw  ax
                test    ah, 40h
                jz      short loc_5D302C
                push    0FFFFh
                push    ebx
                call    __ctrlfp
                fld     [esp+2Ch+X]
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
; ---------------------------------------------------------------------------

loc_5D302C:                             ; CODE XREF: __nextafter+D0↑j
                fld     [esp+24h+X]
                fcomp   qword ptr [dbl_615178]
                fnstsw  ax
                test    ah, 40h
                jz      short loc_5D3068
                fld     [esp+24h+Y]
                fcomp   [esp+24h+X]
                mov     edx, 1
                mov     dword ptr [esp+24h+var_C], edx
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5D305D
                xor     ecx, ecx
                mov     dword ptr [esp+24h+var_C+4], ecx
                jmp     short loc_5D3070
; ---------------------------------------------------------------------------

loc_5D305D:                             ; CODE XREF: __nextafter+113↑j
                mov     ecx, 80000000h
                mov     dword ptr [esp+24h+var_C+4], ecx
                jmp     short loc_5D3070
; ---------------------------------------------------------------------------

loc_5D3068:                             ; CODE XREF: __nextafter+FB↑j
                mov     edx, dword ptr [esp+24h+var_C]
                mov     ecx, dword ptr [esp+24h+var_C+4]

loc_5D3070:                             ; CODE XREF: __nextafter+11B↑j
                fld     [esp+24h+X]
                fcomp   qword ptr [dbl_615178]
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5D3090
                fld     [esp+24h+Y]
                fcomp   [esp+24h+X]
                fnstsw  ax
                test    ah, 1
                jnz     short loc_5D30B0

loc_5D3090:                             ; CODE XREF: __nextafter+13F↑j
                fld     [esp+24h+X]
                fcomp   qword ptr [dbl_615178]
                fnstsw  ax
                test    ah, 1
                jz      short loc_5D30C6
                fld     [esp+24h+Y]
                fcomp   [esp+24h+X]
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5D30C6

loc_5D30B0:                             ; CODE XREF: __nextafter+14E↑j
                lea     edx, [edi-1]
                mov     ecx, esi
                test    edi, edi
                mov     dword ptr [esp+24h+var_C], edx
                mov     dword ptr [esp+24h+var_C+4], ecx
                jnz     short loc_5D311E
                lea     ecx, [esi-1]
                jmp     short loc_5D311A
; ---------------------------------------------------------------------------

loc_5D30C6:                             ; CODE XREF: __nextafter+15F↑j
                fld     [esp+24h+X]
                fcomp   qword ptr [dbl_615178]
                fnstsw  ax
                test    ah, 41h
                jnz     short loc_5D30E6
                fld     [esp+24h+Y]
                fcomp   [esp+24h+X]
                fnstsw  ax
                test    ah, 41h
                jz      short loc_5D3106

loc_5D30E6:                             ; CODE XREF: __nextafter+195↑j
                fld     [esp+24h+X]
                fcomp   qword ptr [dbl_615178]
                fnstsw  ax
                test    ah, 1
                jz      short loc_5D311E
                fld     [esp+24h+Y]
                fcomp   [esp+24h+X]
                fnstsw  ax
                test    ah, 1
                jz      short loc_5D311E

loc_5D3106:                             ; CODE XREF: __nextafter+1A4↑j
                lea     edx, [edi+1]
                mov     ecx, esi
                test    edx, edx
                mov     dword ptr [esp+24h+var_C], edx
                mov     dword ptr [esp+24h+var_C+4], ecx
                jnz     short loc_5D311E
                lea     ecx, [esi+1]

loc_5D311A:                             ; CODE XREF: __nextafter+184↑j
                mov     dword ptr [esp+24h+var_C+4], ecx

loc_5D311E:                             ; CODE XREF: __nextafter+17F↑j
                test    dword ptr [esp+24h+var_C+6], 7FF0h
                jnz     short loc_5D318F
                test    ecx, 0FFFFFh
                jnz     short loc_5D3134
                test    edx, edx
                jz      short loc_5D318F

loc_5D3134:                             ; CODE XREF: __nextafter+1EE↑j
                lea     eax, [esp+24h+X]
                push    eax             ; int
                push    ecx
                push    edx             ; double
                call    __decomp
                mov     ecx, dword ptr [esp+30h+X]
                add     esp, 0Ch
                fstp    [esp+24h+var_14]
                mov     edx, dword ptr [esp+24h+var_14+4]
                mov     eax, dword ptr [esp+24h+var_14]
                add     ecx, 600h
                push    ecx
                push    edx
                push    eax
                call    __set_exp
                fstp    [esp+30h+var_C]
                mov     ecx, dword ptr [esp+30h+var_C+4]
                mov     edx, dword ptr [esp+30h+var_C]
                mov     eax, dword ptr [esp+30h+Y]
                add     esp, 0Ch
                push    ebx             ; int
                push    ecx
                push    edx             ; double
                push    ebp             ; int
                push    eax             ; int
                push    esi             ; int
                push    edi             ; int
                push    26h ; '&'       ; int
                push    12h             ; char
                call    __except2
                add     esp, 24h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
; ---------------------------------------------------------------------------

loc_5D318F:                             ; CODE XREF: __nextafter+1E6↑j
                cmp     ecx, 7FF00000h
                jnz     short loc_5D319B
                test    edx, edx
                jz      short loc_5D31A7

loc_5D319B:                             ; CODE XREF: __nextafter+255↑j
                cmp     ecx, 0FFF00000h
                jnz     short loc_5D3202
                test    edx, edx
                jnz     short loc_5D3202

loc_5D31A7:                             ; CODE XREF: __nextafter+259↑j
                lea     eax, [esp+24h+X]
                push    eax             ; int
                push    ecx
                push    edx             ; double
                call    __decomp
                mov     ecx, dword ptr [esp+30h+X]
                add     esp, 0Ch
                fstp    [esp+24h+var_14]
                mov     edx, dword ptr [esp+24h+var_14+4]
                mov     eax, dword ptr [esp+24h+var_14]
                add     ecx, 0FFFFFA00h
                push    ecx
                push    edx
                push    eax
                call    __set_exp
                fstp    [esp+30h+var_C]
                mov     ecx, dword ptr [esp+30h+var_C+4]
                mov     edx, dword ptr [esp+30h+var_C]
                mov     eax, dword ptr [esp+30h+Y]
                add     esp, 0Ch
                push    ebx             ; int
                push    ecx
                push    edx             ; double
                push    ebp             ; int
                push    eax             ; int
                push    esi             ; int
                push    edi             ; int
                push    26h ; '&'       ; int
                push    11h             ; char
                call    __except2
                add     esp, 24h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
; ---------------------------------------------------------------------------

loc_5D3202:                             ; CODE XREF: __nextafter+261↑j
                push    0FFFFh
                push    ebx
                call    __ctrlfp
                fld     [esp+2Ch+var_C]
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
; ---------------------------------------------------------------------------

loc_5D321C:                             ; CODE XREF: __nextafter+B2↑j
                mov     ecx, dword ptr [esp+24h+Y]
                push    ebx
                push    ebp
                push    ecx
                push    esi
                push    edi
                push    26h ; '&'
                call    __handle_qnan2
                add     esp, 18h
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 14h
                retn
__nextafter     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _finite(double X)
__finite        proc near

arg_6           = dword ptr  0Ah

                mov     eax, dword ptr [esp+arg_6]
                xor     ecx, ecx
                and     eax, 7FF0h
                cmp     eax, 7FF0h
                setnz   cl
                mov     eax, ecx
                retn
__finite        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _isnan(double X)
__isnan         proc near

X               = qword ptr  4

                mov     eax, dword ptr [esp+X+6]
                and     eax, 7FF8h
                cmp     ax, 7FF0h
                jnz     short loc_5D3281
                test    dword ptr [esp+8], 7FFFFh
                jnz     short loc_5D3287
                mov     ecx, dword ptr [esp+X]
                test    ecx, ecx
                jnz     short loc_5D3287

loc_5D3281:                             ; CODE XREF: __isnan+D↑j
                cmp     ax, 7FF8h
                jnz     short loc_5D328D

loc_5D3287:                             ; CODE XREF: __isnan+17↑j
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5D328D:                             ; CODE XREF: __isnan+25↑j
                xor     eax, eax
                retn
__isnan         endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _fpclass(double X)
__fpclass       proc near               ; CODE XREF: __d_inttype+F↑p

X               = qword ptr  4

                mov     eax, dword ptr [esp+X+6]
                mov     ecx, eax
                and     ecx, 7FF0h
                cmp     cx, 7FF0h
                jnz     short loc_5D32D6
                mov     eax, dword ptr [esp+8]
                mov     ecx, dword ptr [esp+X]
                push    eax
                push    ecx
                call    __sptype
                add     esp, 8
                dec     eax
                jz      short loc_5D32D0
                dec     eax
                jz      short loc_5D32CA
                dec     eax
                jz      short loc_5D32C4
                mov     eax, 1
                retn
; ---------------------------------------------------------------------------

loc_5D32C4:                             ; CODE XREF: __fpclass+2C↑j
                mov     eax, 2
                retn
; ---------------------------------------------------------------------------

loc_5D32CA:                             ; CODE XREF: __fpclass+29↑j
                mov     eax, 4
                retn
; ---------------------------------------------------------------------------

loc_5D32D0:                             ; CODE XREF: __fpclass+26↑j
                mov     eax, 200h
                retn
; ---------------------------------------------------------------------------

loc_5D32D6:                             ; CODE XREF: __fpclass+11↑j
                and     eax, 8000h
                test    cx, cx
                mov     edx, eax
                jnz     short loc_5D3302
                test    dword ptr [esp+8], 0FFFFFh
                jnz     short loc_5D32F4
                mov     eax, dword ptr [esp+X]
                test    eax, eax
                jz      short loc_5D3302

loc_5D32F4:                             ; CODE XREF: __fpclass+5A↑j
                mov     eax, edx
                neg     eax
                sbb     eax, eax
                and     al, 90h
                add     eax, 80h
                retn
; ---------------------------------------------------------------------------

loc_5D3302:                             ; CODE XREF: __fpclass+50↑j
                fld     [esp+X]
                fcomp   qword ptr [dbl_615178]
                fnstsw  ax
                test    ah, 40h
                mov     eax, edx
                jz      short loc_5D331F
                neg     eax
                sbb     eax, eax
                and     al, 0E0h
                add     eax, 40h ; '@'
                retn
; ---------------------------------------------------------------------------

loc_5D331F:                             ; CODE XREF: __fpclass+83↑j
                neg     eax
                sbb     eax, eax
                and     al, 8
                add     eax, 100h
                retn
__fpclass       endp

; ---------------------------------------------------------------------------
                align 10h



; =============== S U B R O U T I N E =======================================


sub_5D33C0      proc near               ; CODE XREF: __umatherr+68↑p
                xor     eax, eax
                retn
sub_5D33C0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___strgtold12   proc near               ; CODE XREF: __fltin2+1B↑p

var_60          = dword ptr -60h
var_5C          = dword ptr -5Ch
var_58          = dword ptr -58h
var_54          = dword ptr -54h
var_50          = dword ptr -50h
var_4C          = dword ptr -4Ch
var_48          = dword ptr -48h
var_44          = dword ptr -44h
var_40          = dword ptr -40h
var_3C          = dword ptr -3Ch
var_38          = dword ptr -38h
var_34          = dword ptr -34h
var_30          = dword ptr -30h
var_2C          = dword ptr -2Ch
var_26          = dword ptr -26h
var_22          = dword ptr -22h
var_1C          = byte ptr -1Ch
var_5           = byte ptr -5
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = dword ptr  14h
arg_14          = dword ptr  18h
arg_18          = dword ptr  1Ch

                sub     esp, 60h
                mov     ecx, dword ptr [esp+60h+arg_8]
                push    ebx
                lea     eax, [esp+64h+var_1C]
                push    ebp
                push    esi
                mov     [esp+6Ch+var_5C], eax
                push    edi
                xor     eax, eax
                xor     esi, esi
                xor     edx, edx
                mov     edi, ecx
                mov     [esp+70h+var_3C], eax
                mov     [esp+70h+var_4C], 1
                mov     [esp+70h+var_54], esi
                mov     [esp+70h+var_58], eax
                mov     [esp+70h+var_40], eax
                mov     [esp+70h+var_44], eax
                mov     [esp+70h+var_38], eax
                mov     [esp+70h+var_34], eax
                mov     [esp+70h+var_48], eax
                mov     [esp+70h+var_60], edx
                mov     [esp+70h+var_30], eax
                mov     ebp, ecx
                mov     [esp+70h+var_50], edi

loc_5D3421:                             ; CODE XREF: ___strgtold12+69↓j
                mov     cl, [ebp+0]
                cmp     cl, 20h ; ' '
                jz      short loc_5D3438
                cmp     cl, 9
                jz      short loc_5D3438
                cmp     cl, 0Ah
                jz      short loc_5D3438
                cmp     cl, 0Dh
                jnz     short loc_5D343B

loc_5D3438:                             ; CODE XREF: ___strgtold12+57↑j
                inc     ebp
                jmp     short loc_5D3421
; ---------------------------------------------------------------------------

loc_5D343B:                             ; CODE XREF: ___strgtold12+66↑j
                mov     ecx, 1
                jmp     short loc_5D3446
; ---------------------------------------------------------------------------

loc_5D3442:                             ; CODE XREF: ___strgtold12+4D6↓j
                mov     edx, dword ptr [esp+70h+var_60]

loc_5D3446:                             ; CODE XREF: ___strgtold12+70↑j
                mov     bl, [ebp+0]
                inc     ebp
                cmp     eax, 0Bh        ; switch 12 cases
                mov     byte ptr [esp+70h+arg_8], bl
                ja      def_5D3457      ; jumptable 005D3457 default case, case 10
                jmp     ds:jpt_5D3457[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5D345E:                             ; CODE XREF: ___strgtold12+87↑j
                cmp     bl, 31h ; '1'   ; jumptable 005D3457 case 0
                jl      short loc_5D3472
                cmp     bl, 39h ; '9'
                jg      short loc_5D3472
                mov     eax, 3
                jmp     loc_5D38A2
; ---------------------------------------------------------------------------

loc_5D3472:                             ; CODE XREF: ___strgtold12+91↑j
                cmp     bl, byte_641478
                jnz     short loc_5D3484
                mov     eax, 5
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D3484:                             ; CODE XREF: ___strgtold12+A8↑j
                movsx   eax, bl
                sub     eax, 2Bh ; '+'
                jz      short loc_5D34B3
                sub     eax, 2
                jz      short loc_5D34A1
                sub     eax, 3
                jnz     def_5D3506      ; jumptable 005D3506 default case, cases 44,46,47,49-67,70-99
                mov     eax, ecx
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D34A1:                             ; CODE XREF: ___strgtold12+BF↑j
                mov     eax, 2
                mov     [esp+70h+var_3C], 8000h
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D34B3:                             ; CODE XREF: ___strgtold12+BA↑j
                mov     eax, 2
                mov     [esp+70h+var_3C], 0
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D34C5:                             ; CODE XREF: ___strgtold12+87↑j
                cmp     bl, 31h ; '1'   ; jumptable 005D3457 case 1
                mov     [esp+70h+var_58], ecx
                jl      short loc_5D34DD
                cmp     bl, 39h ; '9'
                jg      short loc_5D34DD
                mov     eax, 3
                jmp     loc_5D38A2
; ---------------------------------------------------------------------------

loc_5D34DD:                             ; CODE XREF: ___strgtold12+FC↑j
                cmp     bl, byte_641478
                jnz     short loc_5D34EF
                mov     eax, 4
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D34EF:                             ; CODE XREF: ___strgtold12+113↑j
                movsx   eax, bl
                add     eax, 0FFFFFFD5h ; switch 59 cases
                cmp     eax, 3Ah
                ja      def_5D3506      ; jumptable 005D3506 default case, cases 44,46,47,49-67,70-99
                xor     edx, edx
                mov     dl, ds:byte_5D3A78[eax]
                jmp     ds:jpt_5D3506[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5D350D:                             ; CODE XREF: ___strgtold12+87↑j
                cmp     bl, 31h ; '1'   ; jumptable 005D3457 case 2
                jl      short loc_5D3521
                cmp     bl, 39h ; '9'
                jg      short loc_5D3521
                mov     eax, 3
                jmp     loc_5D38A2
; ---------------------------------------------------------------------------

loc_5D3521:                             ; CODE XREF: ___strgtold12+140↑j
                cmp     bl, byte_641478
                jnz     short loc_5D3533
                mov     eax, 5
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D3533:                             ; CODE XREF: ___strgtold12+157↑j
                cmp     bl, 30h ; '0'
                jz      short loc_5D3544 ; jumptable 005D3506 case 48
                mov     eax, 0Ah
                mov     ebp, edi
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D3544:                             ; CODE XREF: ___strgtold12+136↑j
                mov     eax, ecx        ; jumptable 005D3506 case 48
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D354B:                             ; CODE XREF: ___strgtold12+87↑j
                mov     [esp+70h+var_58], ecx ; jumptable 005D3457 case 3

loc_5D354F:                             ; CODE XREF: ___strgtold12+1D7↓j
                cmp     [g_SrcSizeInBytes], ecx
                jle     short loc_5D3572
                mov     eax, dword ptr [esp+70h+arg_8]
                push    4               ; Type
                and     eax, 0FFh
                push    eax             ; C
                call    __isctype
                add     esp, 8
                mov     ecx, 1
                jmp     short loc_5D3587
; ---------------------------------------------------------------------------

loc_5D3572:                             ; CODE XREF: ___strgtold12+185↑j
                mov     edx, dword ptr [esp+70h+arg_8]
                mov     eax, off_641268
                and     edx, 0FFh
                mov     al, [eax+edx*2]
                and     eax, 4

loc_5D3587:                             ; CODE XREF: ___strgtold12+1A0↑j
                test    eax, eax
                jz      short loc_5D35BC
                cmp     esi, 19h
                jnb     short loc_5D35A9
                mov     eax, dword ptr [esp+70h+var_5C]
                sub     bl, 30h ; '0'
                inc     esi
                mov     [eax], bl
                mov     bl, [ebp+0]
                inc     eax
                mov     byte ptr [esp+70h+arg_8], bl
                mov     [esp+70h+var_5C], eax
                inc     ebp
                jmp     short loc_5D354F
; ---------------------------------------------------------------------------

loc_5D35A9:                             ; CODE XREF: ___strgtold12+1BE↑j
                mov     eax, dword ptr [esp+70h+var_60]
                mov     bl, [ebp+0]
                inc     eax
                mov     byte ptr [esp+70h+arg_8], bl
                mov     [esp+70h+var_60], eax
                inc     ebp
                jmp     short loc_5D354F
; ---------------------------------------------------------------------------

loc_5D35BC:                             ; CODE XREF: ___strgtold12+1B9↑j
                mov     al, byte_641478
                mov     [esp+70h+var_54], esi
                cmp     bl, al
                jnz     short loc_5D35D3
                mov     eax, 4
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D35D3:                             ; CODE XREF: ___strgtold12+1F7↑j
                movsx   eax, bl
                add     eax, 0FFFFFFD5h ; switch 59 cases
                cmp     eax, 3Ah
                ja      def_5D3506      ; jumptable 005D3506 default case, cases 44,46,47,49-67,70-99
                xor     edx, edx
                mov     dl, ds:byte_5D3AC8[eax]
                jmp     ds:jpt_5D35EA[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5D35F1:                             ; CODE XREF: ___strgtold12+87↑j
                test    esi, esi        ; jumptable 005D3457 case 4
                mov     [esp+70h+var_58], ecx
                mov     [esp+70h+var_40], ecx
                jnz     short loc_5D3614
                cmp     bl, 30h ; '0'
                jnz     short loc_5D3614

loc_5D3602:                             ; CODE XREF: ___strgtold12+23E↓j
                mov     bl, [ebp+0]
                dec     edx
                inc     ebp
                cmp     bl, 30h ; '0'
                mov     byte ptr [esp+70h+arg_8], bl
                jz      short loc_5D3602
                mov     [esp+70h+var_60], edx

loc_5D3614:                             ; CODE XREF: ___strgtold12+22B↑j
                cmp     [g_SrcSizeInBytes], ecx
                jle     short loc_5D3637
                mov     eax, dword ptr [esp+70h+arg_8]
                push    4               ; Type
                and     eax, 0FFh
                push    eax             ; C
                call    __isctype
                add     esp, 8
                mov     ecx, 1
                jmp     short loc_5D364C
; ---------------------------------------------------------------------------

loc_5D3637:                             ; CODE XREF: ___strgtold12+24A↑j
                mov     edx, dword ptr [esp+70h+arg_8]
                mov     eax, off_641268
                and     edx, 0FFh
                mov     al, [eax+edx*2]
                and     eax, 4

loc_5D364C:                             ; CODE XREF: ___strgtold12+265↑j
                test    eax, eax
                jz      short loc_5D3677
                cmp     esi, 19h
                jnb     short loc_5D366D
                mov     eax, dword ptr [esp+70h+var_5C]
                sub     bl, 30h ; '0'
                inc     esi
                mov     [eax], bl
                inc     eax
                mov     [esp+70h+var_5C], eax
                mov     eax, dword ptr [esp+70h+var_60]
                dec     eax
                mov     [esp+70h+var_60], eax

loc_5D366D:                             ; CODE XREF: ___strgtold12+283↑j
                mov     bl, [ebp+0]
                inc     ebp
                mov     byte ptr [esp+70h+arg_8], bl
                jmp     short loc_5D3614
; ---------------------------------------------------------------------------

loc_5D3677:                             ; CODE XREF: ___strgtold12+27E↑j
                movsx   eax, bl
                add     eax, 0FFFFFFD5h ; switch 59 cases
                mov     [esp+70h+var_54], esi
                cmp     eax, 3Ah
                ja      def_5D3506      ; jumptable 005D3506 default case, cases 44,46,47,49-67,70-99
                xor     edx, edx
                mov     dl, ds:byte_5D3B18[eax]
                jmp     ds:jpt_5D3692[edx*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5D3699:                             ; CODE XREF: ___strgtold12+136↑j
                mov     eax, 6          ; jumptable 005D3506 cases 68,69,100,101
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D36A3:                             ; CODE XREF: ___strgtold12+136↑j
                dec     ebp             ; jumptable 005D3506 cases 43,45
                mov     eax, 0Bh
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D36AE:                             ; CODE XREF: ___strgtold12+87↑j
                mov     eax, [g_SrcSizeInBytes] ; jumptable 005D3457 case 5
                mov     [esp+70h+var_40], ecx
                cmp     eax, ecx
                jle     short loc_5D36D1
                mov     eax, dword ptr [esp+70h+arg_8]
                push    4               ; Type
                and     eax, 0FFh
                push    eax             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5D36E7
; ---------------------------------------------------------------------------

loc_5D36D1:                             ; CODE XREF: ___strgtold12+2E9↑j
                mov     ecx, dword ptr [esp+70h+arg_8]
                mov     edx, off_641268
                and     ecx, 0FFh
                mov     al, [edx+ecx*2]
                and     eax, 4

loc_5D36E7:                             ; CODE XREF: ___strgtold12+2FF↑j
                test    eax, eax
                jz      short loc_5D36FB
                mov     eax, 4
                dec     ebp
                mov     ecx, 1
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D36FB:                             ; CODE XREF: ___strgtold12+319↑j
                mov     eax, 0Ah
                mov     ebp, edi
                mov     ecx, 1
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D370C:                             ; CODE XREF: ___strgtold12+87↑j
                lea     edi, [ebp-2]    ; jumptable 005D3457 case 6
                cmp     bl, 31h ; '1'
                mov     [esp+70h+var_50], edi
                jl      short loc_5D3727
                cmp     bl, 39h ; '9'
                jg      short loc_5D3727
                mov     eax, 9
                jmp     loc_5D38A2
; ---------------------------------------------------------------------------

loc_5D3727:                             ; CODE XREF: ___strgtold12+346↑j
                movsx   eax, bl
                sub     eax, 2Bh ; '+'
                jz      loc_5D3896
                sub     eax, 2
                jz      loc_5D3887
                sub     eax, 3
                jmp     short loc_5D3786
; ---------------------------------------------------------------------------

loc_5D3741:                             ; CODE XREF: ___strgtold12+87↑j
                cmp     bl, 30h ; '0'   ; jumptable 005D3457 case 8
                mov     [esp+70h+var_44], ecx
                jnz     short loc_5D3753

loc_5D374A:                             ; CODE XREF: ___strgtold12+381↓j
                mov     bl, [ebp+0]
                inc     ebp
                cmp     bl, 30h ; '0'
                jz      short loc_5D374A

loc_5D3753:                             ; CODE XREF: ___strgtold12+378↑j
                cmp     bl, 31h ; '1'
                jl      def_5D3506      ; jumptable 005D3506 default case, cases 44,46,47,49-67,70-99
                cmp     bl, 39h ; '9'
                jg      def_5D3506      ; jumptable 005D3506 default case, cases 44,46,47,49-67,70-99
                mov     eax, 9
                jmp     loc_5D38A2
; ---------------------------------------------------------------------------

loc_5D376F:                             ; CODE XREF: ___strgtold12+87↑j
                cmp     bl, 31h ; '1'   ; jumptable 005D3457 case 7
                jl      short loc_5D3783
                cmp     bl, 39h ; '9'
                jg      short loc_5D3783
                mov     eax, 9
                jmp     loc_5D38A2
; ---------------------------------------------------------------------------

loc_5D3783:                             ; CODE XREF: ___strgtold12+3A2↑j
                cmp     bl, 30h ; '0'

loc_5D3786:                             ; CODE XREF: ___strgtold12+36F↑j
                jz      short loc_5D3794
                mov     eax, 0Ah
                mov     ebp, edi
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D3794:                             ; CODE XREF: ___strgtold12:loc_5D3786↑j
                mov     eax, 8
                jmp     def_5D3457      ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D379E:                             ; CODE XREF: ___strgtold12+87↑j
                mov     [esp+70h+var_44], ecx ; jumptable 005D3457 case 9
                xor     edi, edi

loc_5D37A4:                             ; CODE XREF: ___strgtold12+42F↓j
                cmp     [g_SrcSizeInBytes], ecx
                jle     short loc_5D37C4
                mov     esi, [esp+70h+arg_8]
                push    4               ; Type
                mov     eax, esi
                and     eax, 0FFh
                push    eax             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5D37DC
; ---------------------------------------------------------------------------

loc_5D37C4:                             ; CODE XREF: ___strgtold12+3DA↑j
                mov     esi, [esp+70h+arg_8]
                mov     edx, off_641268
                mov     ecx, esi
                and     ecx, 0FFh
                mov     al, [edx+ecx*2]
                and     eax, 4

loc_5D37DC:                             ; CODE XREF: ___strgtold12+3F2↑j
                test    eax, eax
                jz      short loc_5D3806
                movsx   ecx, bl
                lea     eax, [edi+edi*4]
                lea     edi, [ecx+eax*2-30h]
                cmp     edi, 1450h
                jg      short loc_5D3801
                mov     bl, [ebp+0]
                inc     ebp
                mov     byte ptr [esp+70h+arg_8], bl
                mov     ecx, 1
                jmp     short loc_5D37A4
; ---------------------------------------------------------------------------

loc_5D3801:                             ; CODE XREF: ___strgtold12+420↑j
                mov     edi, 1451h

loc_5D3806:                             ; CODE XREF: ___strgtold12+40E↑j
                mov     [esp+70h+var_48], edi

loc_5D380A:                             ; CODE XREF: ___strgtold12+478↓j
                cmp     [g_SrcSizeInBytes], 1
                jle     short loc_5D3826
                and     esi, 0FFh
                push    4               ; Type
                push    esi             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5D3838
; ---------------------------------------------------------------------------

loc_5D3826:                             ; CODE XREF: ___strgtold12+441↑j
                mov     edx, off_641268
                and     esi, 0FFh
                mov     al, [edx+esi*2]
                and     eax, 4

loc_5D3838:                             ; CODE XREF: ___strgtold12+454↑j
                test    eax, eax
                jz      short loc_5D384A
                mov     al, [ebp+0]
                inc     ebp
                mov     byte ptr [esp+70h+arg_8], al
                mov     esi, [esp+70h+arg_8]
                jmp     short loc_5D380A
; ---------------------------------------------------------------------------

loc_5D384A:                             ; CODE XREF: ___strgtold12+46A↑j
                mov     esi, [esp+70h+var_54]
                mov     edi, [esp+70h+var_50]
                mov     eax, 0Ah
                dec     ebp
                mov     ecx, 1
                jmp     short def_5D3457 ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D385F:                             ; CODE XREF: ___strgtold12+87↑j
                mov     eax, dword ptr [esp+70h+arg_18] ; jumptable 005D3457 case 11
                test    eax, eax
                jz      short def_5D3506 ; jumptable 005D3506 default case, cases 44,46,47,49-67,70-99
                movsx   eax, bl
                lea     edi, [ebp-1]
                sub     eax, 2Bh ; '+'
                mov     [esp+70h+var_50], edi
                jz      short loc_5D3896
                sub     eax, 2
                jz      short loc_5D3887
                mov     eax, 0Ah
                mov     ebp, edi
                jmp     short def_5D3457 ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D3887:                             ; CODE XREF: ___strgtold12+366↑j
                mov     eax, 7
                mov     [esp+70h+var_4C], 0FFFFFFFFh
                jmp     short def_5D3457 ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

loc_5D3896:                             ; CODE XREF: ___strgtold12+35D↑j
                mov     eax, 7
                jmp     short def_5D3457 ; jumptable 005D3457 default case, case 10
; ---------------------------------------------------------------------------

def_5D3506:                             ; CODE XREF: ___strgtold12+C4↑j
                mov     eax, 0Ah        ; jumptable 005D3506 default case, cases 44,46,47,49-67,70-99

loc_5D38A2:                             ; CODE XREF: ___strgtold12+9D↑j
                dec     ebp

def_5D3457:                             ; CODE XREF: ___strgtold12+81↑j
                cmp     eax, 0Ah        ; jumptable 005D3457 default case, case 10
                jnz     loc_5D3442
                mov     ecx, dword ptr [esp+70h+arg_4]
                mov     eax, dword ptr [esp+70h+var_58]
                test    eax, eax
                mov     [ecx], ebp
                jz      loc_5D3964
                cmp     esi, 18h
                jbe     short loc_5D38E6
                mov     al, [esp+70h+var_5]
                cmp     al, 5
                jl      short loc_5D38D1
                inc     al
                mov     [esp+70h+var_5], al

loc_5D38D1:                             ; CODE XREF: ___strgtold12+4F9↑j
                mov     eax, dword ptr [esp+70h+var_5C]
                mov     ecx, dword ptr [esp+70h+var_60]
                dec     eax
                inc     ecx
                mov     esi, 18h
                mov     [esp+70h+var_60], ecx
                jmp     short loc_5D38EE
; ---------------------------------------------------------------------------

loc_5D38E6:                             ; CODE XREF: ___strgtold12+4F1↑j
                mov     eax, dword ptr [esp+70h+var_5C]
                mov     ecx, dword ptr [esp+70h+var_60]

loc_5D38EE:                             ; CODE XREF: ___strgtold12+514↑j
                test    esi, esi
                jbe     loc_5D3A23
                mov     dl, [eax-1]
                dec     eax
                test    dl, dl
                jnz     short loc_5D390C

loc_5D38FE:                             ; CODE XREF: ___strgtold12+536↓j
                mov     dl, [eax-1]
                dec     esi
                inc     ecx
                dec     eax
                test    dl, dl
                jz      short loc_5D38FE
                mov     [esp+70h+var_60], ecx

loc_5D390C:                             ; CODE XREF: ___strgtold12+52C↑j
                lea     edx, [esp+70h+var_2C]
                lea     eax, [esp+70h+var_1C]
                push    edx
                push    esi
                push    eax
                call    ___mtold12
                mov     eax, dword ptr [esp+7Ch+var_4C]
                add     esp, 0Ch
                test    eax, eax
                mov     eax, dword ptr [esp+70h+var_48]
                jge     short loc_5D392D
                neg     eax

loc_5D392D:                             ; CODE XREF: ___strgtold12+559↑j
                mov     edx, dword ptr [esp+70h+var_60]
                mov     ecx, dword ptr [esp+70h+var_44]
                add     eax, edx
                test    ecx, ecx
                jnz     short loc_5D3942
                add     eax, [esp+70h+arg_10]

loc_5D3942:                             ; CODE XREF: ___strgtold12+569↑j
                mov     ecx, dword ptr [esp+70h+var_40]
                test    ecx, ecx
                jnz     short loc_5D3951
                sub     eax, [esp+70h+arg_14]

loc_5D3951:                             ; CODE XREF: ___strgtold12+578↑j
                cmp     eax, 1450h
                jle     loc_5D39E4
                mov     [esp+70h+var_38], 1

loc_5D3964:                             ; CODE XREF: ___strgtold12+4E8↑j
                mov     esi, [esp+70h+arg_8]
                mov     edx, dword ptr [esp+70h+arg_8]
                mov     eax, dword ptr [esp+70h+arg_8]
                mov     ecx, dword ptr [esp+70h+arg_8]

loc_5D3974:                             ; CODE XREF: ___strgtold12+64E↓j
                mov     edi, [esp+70h+var_58]
                test    edi, edi
                jnz     short loc_5D398B
                xor     ecx, ecx
                xor     eax, eax
                xor     edx, edx
                xor     esi, esi
                mov     ebx, 4
                jmp     short loc_5D39C3
; ---------------------------------------------------------------------------

loc_5D398B:                             ; CODE XREF: ___strgtold12+5AA↑j
                mov     edi, [esp+70h+var_38]
                test    edi, edi
                jz      short loc_5D39A8
                xor     esi, esi
                mov     eax, 7FFFh
                mov     edx, 80000000h
                xor     ecx, ecx
                mov     ebx, 2
                jmp     short loc_5D39C3
; ---------------------------------------------------------------------------

loc_5D39A8:                             ; CODE XREF: ___strgtold12+5C1↑j
                mov     edi, [esp+70h+var_34]
                test    edi, edi
                jz      short loc_5D39BF
                xor     ecx, ecx
                xor     eax, eax
                xor     edx, edx
                xor     esi, esi
                mov     ebx, 1
                jmp     short loc_5D39C3
; ---------------------------------------------------------------------------

loc_5D39BF:                             ; CODE XREF: ___strgtold12+5DE↑j
                mov     ebx, dword ptr [esp+70h+var_30]

loc_5D39C3:                             ; CODE XREF: ___strgtold12+5B9↑j
                mov     edi, [esp+70h+arg_0]
                mov     [edi], cx
                mov     ecx, dword ptr [esp+70h+var_3C]
                or      eax, ecx
                mov     [edi+2], esi
                mov     [edi+6], edx
                mov     [edi+0Ah], ax
                pop     edi
                pop     esi
                mov     eax, ebx
                pop     ebp
                pop     ebx
                add     esp, 60h
                retn
; ---------------------------------------------------------------------------

loc_5D39E4:                             ; CODE XREF: ___strgtold12+586↑j
                cmp     eax, 0FFFFEBB0h
                jge     short loc_5D39F8
                mov     [esp+70h+var_34], 1
                jmp     loc_5D3964
; ---------------------------------------------------------------------------

loc_5D39F8:                             ; CODE XREF: ___strgtold12+619↑j
                mov     ecx, dword ptr [esp+70h+arg_C]
                lea     edx, [esp+70h+var_2C]
                push    ecx
                push    eax
                push    edx
                call    ___multtenpow12
                mov     ecx, dword ptr [esp+7Ch+var_2C]
                mov     esi, [esp+7Ch+var_2C+2]
                mov     edx, dword ptr [esp+7Ch+var_26]
                mov     eax, dword ptr [esp+7Ch+var_22]
                add     esp, 0Ch
                jmp     loc_5D3974
; ---------------------------------------------------------------------------

loc_5D3A23:                             ; CODE XREF: ___strgtold12+520↑j
                xor     ecx, ecx
                xor     eax, eax
                xor     edx, edx
                xor     esi, esi
                jmp     loc_5D3974
___strgtold12   endp

; ---------------------------------------------------------------------------
jpt_5D3457      dd offset loc_5D345E    ; DATA XREF: ___strgtold12+87↑r
                dd offset loc_5D34C5    ; jump table for switch statement
                dd offset loc_5D350D
                dd offset loc_5D354B
                dd offset loc_5D35F1
                dd offset loc_5D36AE
                dd offset loc_5D370C
                dd offset loc_5D376F
                dd offset loc_5D3741
                dd offset loc_5D379E
                dd offset def_5D3457
                dd offset loc_5D385F
jpt_5D3506      dd offset loc_5D36A3    ; DATA XREF: ___strgtold12+136↑r
                dd offset loc_5D36A3    ; jump table for switch statement
                dd offset loc_5D3544
                dd offset loc_5D3699
                dd offset loc_5D3699
                dd offset def_5D3506
byte_5D3A78     db      0,     5,     1,     5
                db      5,     2,     5,     5 ; indirect table for switch statement
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     3,     3,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     5,     5,     5
                db      5,     4,     4
                align 4
jpt_5D35EA      dd offset loc_5D36A3    ; DATA XREF: ___strgtold12+21A↑r
                dd offset loc_5D36A3    ; jump table for switch statement
                dd offset loc_5D3699
                dd offset loc_5D3699
                dd offset def_5D3506
byte_5D3AC8     db      0,     4,     1,     4
                db      4,     4,     4,     4 ; indirect table for switch statement
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     2,     2,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     3,     3
                align 4
jpt_5D3692      dd offset loc_5D36A3    ; DATA XREF: ___strgtold12+2C2↑r
                dd offset loc_5D36A3    ; jump table for switch statement
                dd offset loc_5D3699
                dd offset loc_5D3699
                dd offset def_5D3506
byte_5D3B18     db      0,     4,     1,     4
                db      4,     4,     4,     4 ; indirect table for switch statement
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     2,     2,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     4,     4,     4
                db      4,     3,     3
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___STRINGTOLD   proc near

var_C           = byte ptr -0Ch
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                mov     eax, dword ptr [esp+arg_C]
                mov     ecx, dword ptr [esp+arg_8]
                mov     edx, dword ptr [esp+arg_4]
                sub     esp, 0Ch
                push    esi
                push    0
                push    0
                push    0
                push    eax
                push    ecx
                lea     eax, [esp+24h+var_C]
                push    edx
                push    eax
                call    ___strgtold12
                mov     ecx, dword ptr [esp+2Ch+arg_0]
                add     esp, 1Ch
                lea     edx, [esp+10h+var_C]
                mov     esi, eax
                push    ecx
                push    edx
                call    __ld12told
                add     esp, 8
                cmp     eax, 1
                jnz     short loc_5D3BA2
                or      esi, 2

loc_5D3BA2:                             ; CODE XREF: ___STRINGTOLD+3D↑j
                mov     eax, esi
                pop     esi
                add     esp, 0Ch
                retn
___STRINGTOLD   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; intptr_t __cdecl _spawnvpe(int Mode, const char *FileName, const char *const *Arguments, const char *const *Environment)
__spawnvpe      proc near               ; CODE XREF: __spawnvp+11↑p

var_4           = dword ptr -4
Mode            = dword ptr  4
varStr             = dword ptr  8
Arguments       = dword ptr  0Ch
Environment     = dword ptr  10h

                push    ecx
                mov     eax, dword ptr [esp+4+Environment]
                mov     ecx, dword ptr [esp+4+Arguments]
                mov     edx, dword ptr [esp+4+Mode]
                push    ebx
                push    ebp
                push    esi
                mov     esi, [esp+10h+varStr]
                push    edi
                push    eax             ; Environment
                push    ecx             ; Arguments
                push    esi             ; FileName
                push    edx             ; Mode
                xor     ebx, ebx
                call    __spawnve
                mov     ebp, eax
                add     esp, 10h
                cmp     ebp, 0FFFFFFFFh
                jnz     loc_5D3D7E
                call    __errno
                cmp     dword ptr [eax], 2
                jnz     loc_5D3D7E
                push    2Fh ; '/'       ; C
                push    esi             ; varStr
                call    __mbschr
                add     esp, 8
                test    eax, eax
                jnz     loc_5D3D7E
                push    offset g_VarName  ; "PATH"
                call    _getenv
                mov     esi, eax
                add     esp, 4
                test    esi, esi
                jz      loc_5D3D7E
                push    104h            ; varSize
                call    _malloc
                mov     ebx, eax
                add     esp, 4
                test    ebx, ebx
                jz      loc_5D3D8B
                push    103h
                push    ebx
                push    esi
                call    __getpath
                add     esp, 0Ch
                mov     [esp+14h+var_4], eax
                test    eax, eax
                jz      loc_5D3D7E

loc_5D3C48:                             ; CODE XREF: __spawnvpe+1C8↓j
                cmp     byte ptr [ebx], 0
                jz      loc_5D3D7E
                mov     edi, ebx
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                dec     ecx
                mov     al, [ecx+ebx-1]
                lea     esi, [ecx+ebx-1]
                cmp     al, 5Ch ; '\'
                jnz     short loc_5D3C7A
                push    5Ch ; '\'       ; C
                push    ebx             ; String
                call    __mbsrchr
                add     esp, 8
                cmp     esi, eax
                jz      short loc_5D3CA8
                jmp     short loc_5D3C7E
; ---------------------------------------------------------------------------

loc_5D3C7A:                             ; CODE XREF: __spawnvpe+B7↑j
                cmp     al, 2Fh ; '/'
                jz      short loc_5D3CA8

loc_5D3C7E:                             ; CODE XREF: __spawnvpe+C8↑j
                mov     edi, offset asc_6151BC ; "\\"
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     edx, ecx
                mov     edi, ebx
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     ecx, edx
                dec     edi
                shr     ecx, 2
                rep movsd
                mov     ecx, edx
                and     ecx, 3
                rep movsb

loc_5D3CA8:                             ; CODE XREF: __spawnvpe+C6↑j
                mov     edx, dword ptr [esp+14h+varStr]
                or      ecx, 0FFFFFFFFh
                mov     edi, edx
                xor     eax, eax
                repne scasb
                not     ecx
                dec     ecx
                mov     edi, ebx
                mov     esi, ecx
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                add     esi, ecx
                cmp     esi, 104h
                jnb     loc_5D3D7E
                mov     edi, edx
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     edx, ecx
                mov     edi, ebx
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     ecx, edx
                dec     edi
                shr     ecx, 2
                rep movsd
                mov     eax, dword ptr [esp+14h+Environment]
                mov     ecx, edx
                mov     edx, dword ptr [esp+14h+Mode]
                and     ecx, 3
                rep movsb
                mov     ecx, dword ptr [esp+14h+Arguments]
                push    eax             ; Environment
                push    ecx             ; Arguments
                push    ebx             ; FileName
                push    edx             ; Mode
                call    __spawnve
                mov     ebp, eax
                add     esp, 10h
                cmp     ebp, 0FFFFFFFFh
                jnz     short loc_5D3D7E
                call    __errno
                cmp     dword ptr [eax], 2
                jz      short loc_5D3D5F
                push    5Ch ; '\'       ; C
                push    ebx             ; varStr
                call    __mbschr
                add     esp, 8
                cmp     ebx, eax
                jz      short loc_5D3D3E
                push    2Fh ; '/'       ; C
                push    ebx             ; varStr
                call    __mbschr
                add     esp, 8
                cmp     ebx, eax
                jnz     short loc_5D3D7E

loc_5D3D3E:                             ; CODE XREF: __spawnvpe+17D↑j
                lea     esi, [ebx+1]
                push    5Ch ; '\'       ; C
                push    esi             ; varStr
                call    __mbschr
                add     esp, 8
                cmp     esi, eax
                jz      short loc_5D3D5F
                push    2Fh ; '/'       ; C
                push    esi             ; varStr
                call    __mbschr
                add     esp, 8
                cmp     esi, eax
                jnz     short loc_5D3D7E

loc_5D3D5F:                             ; CODE XREF: __spawnvpe+16E↑j
                mov     eax, dword ptr [esp+14h+var_4]
                push    103h
                push    ebx
                push    eax
                call    __getpath
                add     esp, 0Ch
                mov     [esp+14h+var_4], eax
                test    eax, eax
                jnz     loc_5D3C48

loc_5D3D7E:                             ; CODE XREF: __spawnvpe+28↑j
                test    ebx, ebx
                jz      short loc_5D3D8B
                push    ebx             ; Block
                call    _free
                add     esp, 4

loc_5D3D8B:                             ; CODE XREF: __spawnvpe+77↑j
                pop     edi
                mov     eax, ebp
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
__spawnvpe      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _fcloseall()
__fcloseall     proc near               ; CODE XREF: ___endstdio+E↑j
                push    ebp
                push    esi
                push    2
                xor     ebp, ebp
                call    __lock
                mov     eax, Count
                mov     esi, 3
                add     esp, 4
                cmp     eax, esi
                jle     short loc_5D3E24
                push    edi
                mov     edi, ds:DeleteCriticalSection
                push    ebx
                mov     bl, 83h

loc_5D3DC6:                             ; CODE XREF: __fcloseall+80↓j
                mov     eax, dword_70D838
                mov     eax, dword ptr [eax+esi*4]
                test    eax, eax
                jz      short loc_5D3E18
                test    [eax+0Ch], bl
                jz      short loc_5D3DE6
                push    eax             ; Stream
                call    _fclose
                add     esp, 4
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5D3DE6
                inc     ebp

loc_5D3DE6:                             ; CODE XREF: __fcloseall+35↑j
                cmp     esi, 14h
                jl      short loc_5D3E18
                mov     ecx, dword_70D838
                mov     edx, dword ptr [ecx+esi*4]
                add     edx, 20h ; ' '
                push    edx             ; lpCriticalSection
                call    edi ; DeleteCriticalSection
                mov     eax, dword_70D838
                mov     ecx, dword ptr [eax+esi*4]
                push    ecx             ; Block
                call    _free
                mov     edx, dword_70D838
                add     esp, 4
                mov     dword ptr [edx+esi*4], 0

loc_5D3E18:                             ; CODE XREF: __fcloseall+30↑j
                mov     eax, Count
                inc     esi
                cmp     esi, eax
                jl      short loc_5D3DC6
                pop     ebx
                pop     edi

loc_5D3E24:                             ; CODE XREF: __fcloseall+1A↑j
                push    2
                call    __unlock
                add     esp, 4
                mov     eax, ebp
                pop     esi
                pop     ebp
                retn
__fcloseall     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; size_t __cdecl wcstombs(char *Dest, const wchar_t *Source, size_t MaxCount)
_wcstombs       proc near               ; CODE XREF: __tzset_lk+E5↑p

Dest            = dword ptr  4
Source          = dword ptr  8
MaxCount        = dword ptr  0Ch

                push    ebx
                push    esi
                push    edi
                push    offset Addend   ; lpAddend
                call    InterlockedIncrement
                mov     eax, dword_70E964
                mov     edi, ds:InterlockedDecrement
                test    eax, eax
                jz      short loc_5D3E75
                push    offset Addend   ; lpAddend
                call    edi ; InterlockedDecrement
                push    13h
                call    __lock
                add     esp, 4
                mov     esi, 1
                jmp     short loc_5D3E77
; ---------------------------------------------------------------------------

loc_5D3E75:                             ; CODE XREF: _wcstombs+1B↑j
                xor     esi, esi

loc_5D3E77:                             ; CODE XREF: _wcstombs+33↑j
                mov     eax, dword ptr [esp+0Ch+MaxCount]
                mov     ecx, dword ptr [esp+0Ch+Source]
                mov     edx, dword ptr [esp+0Ch+Dest]
                push    eax             ; cchWideChar
                push    ecx             ; lpWideCharStr
                push    edx             ; lpMultiByteStr
                call    __wcstombs_lk
                add     esp, 0Ch
                mov     ebx, eax
                test    esi, esi
                jz      short loc_5D3EA4
                push    13h
                call    __unlock
                add     esp, 4
                mov     eax, ebx
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D3EA4:                             ; CODE XREF: _wcstombs+52↑j
                push    offset Addend   ; lpAddend
                call    edi ; InterlockedDecrement
                pop     edi
                mov     eax, ebx
                pop     esi
                pop     ebx
                retn
_wcstombs       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _wcstombs_lk(LPSTR lpMultiByteStr, LPCWCH lpWideCharStr, int cchWideChar)
__wcstombs_lk   proc near               ; CODE XREF: _wcstombs+46↑p

UsedDefaultChar = dword ptr -4
lpMultiByteStr  = dword ptr  4
lpWideCharStr   = dword ptr  8
cchWideChar     = dword ptr  0Ch

                push    ecx
                push    ebx
                push    ebp
                mov     ebp, [esp+0Ch+cchWideChar]
                push    esi
                push    edi
                mov     edi, [esp+14h+lpMultiByteStr]
                xor     eax, eax
                test    edi, edi
                mov     [esp+14h+UsedDefaultChar], eax
                jz      short loc_5D3EE1
                test    ebp, ebp
                jnz     short loc_5D3EE1
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D3EE1:                             ; CODE XREF: __wcstombs_lk+15↑j
                test    edi, edi
                jz      loc_5D4044
                mov     ecx, dword_70D558
                test    ecx, ecx
                jnz     short loc_5D3F2A
                test    ebp, ebp
                jbe     loc_5D40A4
                mov     ecx, dword ptr [esp+14h+lpWideCharStr]

loc_5D3EFF:                             ; CODE XREF: __wcstombs_lk+62↓j
                cmp     word ptr [ecx], 0FFh
                ja      loc_5D4096
                mov     dl, [ecx]
                add     ecx, 2
                mov     [eax+edi], dl
                mov     dx, [ecx-2]
                test    dx, dx
                jz      loc_5D40A4
                inc     eax
                cmp     eax, ebp
                jb      short loc_5D3EFF
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D3F2A:                             ; CODE XREF: __wcstombs_lk+31↑j
                cmp     [g_SrcSizeInBytes], 1
                jnz     short loc_5D3F8B
                mov     esi, [esp+14h+lpWideCharStr]
                test    ebp, ebp
                jbe     short loc_5D3F47
                push    ebp
                push    esi
                call    _wcsncnt_0
                add     esp, 8
                mov     ebp, eax

loc_5D3F47:                             ; CODE XREF: __wcstombs_lk+79↑j
                mov     ecx, CodePage
                lea     eax, [esp+14h+UsedDefaultChar]
                push    eax             ; lpUsedDefaultChar
                push    0               ; lpDefaultChar
                push    ebp             ; cbMultiByte
                push    edi             ; lpMultiByteStr
                push    ebp             ; cchWideChar
                push    esi             ; lpWideCharStr
                push    220h            ; dwFlags
                push    ecx             ; CodePage
                call    WideCharToMultiByte
                test    eax, eax
                jz      loc_5D4096
                mov     ecx, dword ptr [esp+14h+UsedDefaultChar]
                test    ecx, ecx
                jnz     loc_5D4096
                mov     cl, [eax+edi-1]
                test    cl, cl
                jnz     loc_5D40A4
                dec     eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D3F8B:                             ; CODE XREF: __wcstombs_lk+71↑j
                mov     ebx, dword ptr [esp+14h+lpWideCharStr]
                mov     eax, CodePage
                lea     edx, [esp+14h+UsedDefaultChar]
                push    edx             ; lpUsedDefaultChar
                push    0               ; lpDefaultChar
                push    ebp             ; cbMultiByte
                push    edi             ; lpMultiByteStr
                push    0FFFFFFFFh      ; cchWideChar
                push    ebx             ; lpWideCharStr
                push    220h            ; dwFlags
                push    eax             ; CodePage
                call    WideCharToMultiByte
                mov     esi, eax
                mov     eax, dword ptr [esp+14h+UsedDefaultChar]
                test    esi, esi
                jz      short loc_5D3FC7
                test    eax, eax
                jnz     loc_5D4096
                lea     eax, [esi-1]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D3FC7:                             ; CODE XREF: __wcstombs_lk+F4↑j
                test    eax, eax
                jnz     loc_5D4096
                call    GetLastError
                cmp     eax, 7Ah ; 'z'
                jnz     loc_5D4096
                cmp     esi, ebp
                jnb     short loc_5D403C

loc_5D3FE2:                             ; CODE XREF: __wcstombs_lk+17A↓j
                mov     edx, [g_SrcSizeInBytes]
                lea     ecx, [esp+14h+UsedDefaultChar]
                push    ecx             ; lpUsedDefaultChar
                mov     ecx, CodePage
                push    0               ; lpDefaultChar
                lea     eax, [esp+1Ch+lpWideCharStr]
                push    edx             ; cbMultiByte
                push    eax             ; lpMultiByteStr
                push    1               ; cchWideChar
                push    ebx             ; lpWideCharStr
                push    0               ; dwFlags
                push    ecx             ; CodePage
                call    WideCharToMultiByte
                test    eax, eax
                jz      loc_5D4096
                mov     ecx, dword ptr [esp+14h+UsedDefaultChar]
                test    ecx, ecx
                jnz     short loc_5D4096
                lea     edx, [eax+esi]
                cmp     edx, ebp
                ja      short loc_5D403C
                xor     edx, edx
                test    eax, eax
                jle     short loc_5D4035

loc_5D4024:                             ; CODE XREF: __wcstombs_lk+173↓j
                mov     cl, byte ptr [esp+edx+14h+lpWideCharStr]
                test    cl, cl
                mov     [esi+edi], cl
                jz      short loc_5D403C
                inc     edx
                inc     esi
                cmp     edx, eax
                jl      short loc_5D4024

loc_5D4035:                             ; CODE XREF: __wcstombs_lk+162↑j
                add     ebx, 2
                cmp     esi, ebp
                jb      short loc_5D3FE2

loc_5D403C:                             ; CODE XREF: __wcstombs_lk+120↑j
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D4044:                             ; CODE XREF: __wcstombs_lk+23↑j
                mov     eax, dword_70D558
                test    eax, eax
                jnz     short loc_5D4060
                mov     eax, dword ptr [esp+14h+lpWideCharStr]
                push    eax             ; String
                call    _wcslen
                add     esp, 4
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D4060:                             ; CODE XREF: __wcstombs_lk+18B↑j
                mov     edx, dword ptr [esp+14h+lpWideCharStr]
                mov     eax, CodePage
                lea     ecx, [esp+14h+UsedDefaultChar]
                push    ecx             ; lpUsedDefaultChar
                push    0               ; lpDefaultChar
                push    0               ; cbMultiByte
                push    0               ; lpMultiByteStr
                push    0FFFFFFFFh      ; cchWideChar
                push    edx             ; lpWideCharStr
                push    220h            ; dwFlags
                push    eax             ; CodePage
                call    WideCharToMultiByte
                test    eax, eax
                jz      short loc_5D4096
                mov     ecx, dword ptr [esp+14h+UsedDefaultChar]
                test    ecx, ecx
                jnz     short loc_5D4096
                dec     eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D4096:                             ; CODE XREF: __wcstombs_lk+44↑j
                call    __errno
                mov     dword ptr [eax], 2Ah ; '*'
                or      eax, 0FFFFFFFFh

loc_5D40A4:                             ; CODE XREF: __wcstombs_lk+35↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
__wcstombs_lk   endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_wcsncnt_0      proc near               ; CODE XREF: __wcstombs_lk+7D↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     edx, dword ptr [esp+arg_0]
                push    esi
                mov     esi, [esp+4+arg_4]
                mov     eax, edx
                mov     ecx, esi
                test    ecx, ecx
                jz      short loc_5D40DE

loc_5D40C1:                             ; CODE XREF: _wcsncnt_0+1B↓j
                cmp     word ptr [eax], 0
                jz      short loc_5D40CD
                add     eax, 2
                dec     ecx
                jnz     short loc_5D40C1

loc_5D40CD:                             ; CODE XREF: _wcsncnt_0+15↑j
                test    ecx, ecx
                jz      short loc_5D40DE
                cmp     word ptr [eax], 0
                jnz     short loc_5D40DE
                sub     eax, edx
                sar     eax, 1
                inc     eax
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D40DE:                             ; CODE XREF: _wcsncnt_0+F↑j
                mov     eax, esi
                pop     esi
                retn
_wcsncnt_0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; char *__cdecl getenv(const char *VarName)
_getenv         proc near               ; CODE XREF: __spawnvpe+54↑p

VarName         = dword ptr  4

                push    esi
                push    0Ch
                call    __lock
                mov     eax, dword ptr [esp+8+VarName]
                add     esp, 4
                push    eax             ; Str2
                call    __getenv_lk
                add     esp, 4
                mov     esi, eax
                push    0Ch
                call    __unlock
                add     esp, 4
                mov     eax, esi
                pop     esi
                retn
_getenv         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _getenv_lk(unsigned __int8 *Str2)
__getenv_lk     proc near               ; CODE XREF: __tzset_lk+33↑p

Str2            = dword ptr  4

                push    ebx
                mov     ebx, dword_70D348
                push    ebp
                push    esi
                test    ebx, ebx
                push    edi
                jnz     short loc_5D414A
                mov     eax, dword_70D350
                test    eax, eax
                jz      short loc_5D4146
                call    ___wtomb_environ
                test    eax, eax
                jnz     short loc_5D41A7
                mov     ebx, dword_70D348

loc_5D4146:                             ; CODE XREF: __getenv_lk+15↑j
                test    ebx, ebx
                jz      short loc_5D41A7

loc_5D414A:                             ; CODE XREF: __getenv_lk+C↑j
                mov     ebp, [esp+10h+Str2]
                test    ebp, ebp
                jz      short loc_5D41A7
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                mov     edx, dword ptr [ebx]
                repne scasb
                not     ecx
                dec     ecx
                test    edx, edx
                mov     esi, ecx
                jz      short loc_5D41A7

loc_5D4166:                             ; CODE XREF: __getenv_lk+73↓j
                mov     edi, edx
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                dec     ecx
                cmp     ecx, esi
                jbe     short loc_5D418B
                cmp     byte ptr [esi+edx], 3Dh ; '='
                jnz     short loc_5D418B
                push    esi             ; MaxCount
                push    ebp             ; Str2
                push    edx             ; Str1
                call    __mbsnbicoll
                add     esp, 0Ch
                test    eax, eax
                jz      short loc_5D419C

loc_5D418B:                             ; CODE XREF: __getenv_lk+54↑j
                mov     edx, dword ptr [ebx+4]
                add     ebx, 4
                test    edx, edx
                jnz     short loc_5D4166
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D419C:                             ; CODE XREF: __getenv_lk+69↑j
                mov     eax, dword ptr [ebx]
                lea     eax, [eax+esi+1]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D41A7:                             ; CODE XREF: __getenv_lk+1E↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                retn
__getenv_lk     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___addl         proc near               ; CODE XREF: __IncMan+3D↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                mov     edx, dword ptr [esp+arg_0]
                push    esi
                mov     esi, [esp+4+arg_4]
                xor     eax, eax
                lea     ecx, [esi+edx]
                cmp     ecx, edx
                jb      short loc_5D41C6
                cmp     ecx, esi
                jnb     short loc_5D41CB

loc_5D41C6:                             ; CODE XREF: ___addl+10↑j
                mov     eax, 1

loc_5D41CB:                             ; CODE XREF: ___addl+14↑j
                mov     edx, dword ptr [esp+4+arg_8]
                pop     esi
                mov     [edx], ecx
                retn
___addl         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___add_12       proc near               ; CODE XREF: ___mtold12+58↓p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                push    esi
                mov     esi, [esp+4+arg_0]
                push    edi
                mov     edi, [esp+8+arg_4]
                mov     ecx, dword ptr [esi]
                push    esi
                mov     eax, dword ptr [edi]
                push    eax
                push    ecx
                call    ___addl
                add     esp, 0Ch
                test    eax, eax
                jz      short loc_5D4216
                mov     edx, dword ptr [esi+4]
                lea     eax, [esi+4]
                push    eax
                push    1
                push    edx
                call    ___addl
                add     esp, 0Ch
                test    eax, eax
                jz      short loc_5D4216
                inc     dword ptr [esi+8]

loc_5D4216:                             ; CODE XREF: ___add_12+1B↑j
                mov     ecx, dword ptr [edi+4]
                mov     edx, dword ptr [esi+4]
                lea     eax, [esi+4]
                push    eax
                push    ecx
                push    edx
                call    ___addl
                add     esp, 0Ch
                test    eax, eax
                jz      short loc_5D4231
                inc     dword ptr [esi+8]

loc_5D4231:                             ; CODE XREF: ___add_12+4C↑j
                mov     ecx, dword ptr [edi+8]
                mov     edx, dword ptr [esi+8]
                lea     eax, [esi+8]
                push    eax
                push    ecx
                push    edx
                call    ___addl
                add     esp, 0Ch
                pop     edi
                pop     esi
                retn
___add_12       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___shl_12       proc near               ; CODE XREF: ___mtold12+41↓p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                push    esi
                push    edi
                mov     esi, [eax]
                mov     edi, [eax+4]
                mov     ecx, esi
                add     esi, esi
                mov     [eax], esi
                lea     esi, [edi+edi]
                shr     ecx, 1Fh
                or      esi, ecx
                mov     ecx, dword ptr [eax+8]
                mov     edx, edi
                mov     [eax+4], esi
                shr     edx, 1Fh
                shl     ecx, 1
                or      ecx, edx
                pop     edi
                mov     [eax+8], ecx
                pop     esi
                retn
___shl_12       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___shr_12       proc near               ; CODE XREF: _$I10_OUTPUT+277↓p

arg_0           = dword ptr  4

                mov     eax, dword ptr [esp+arg_0]
                push    esi
                push    edi
                mov     edx, dword ptr [eax+8]
                mov     ecx, dword ptr [eax+4]
                mov     esi, edx
                mov     edi, ecx
                shl     esi, 1Fh
                shr     ecx, 1
                or      ecx, esi
                mov     [eax+4], ecx
                mov     ecx, dword ptr [eax]
                shl     edi, 1Fh
                shr     ecx, 1
                shr     edx, 1
                or      ecx, edi
                pop     edi
                mov     [eax+8], edx
                mov     [eax], ecx
                pop     esi
                retn
___shr_12       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___mtold12      proc near               ; CODE XREF: ___strgtold12+547↑p

var_C           = dword ptr -0Ch
var_8           = dword ptr -8
var_4           = dword ptr -4
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                mov     eax, dword ptr [esp+arg_4]
                sub     esp, 0Ch
                push    ebx
                push    ebp
                push    esi
                mov     esi, [esp+18h+arg_8]
                xor     ebp, ebp
                push    edi
                cmp     eax, ebp
                mov     edi, 404Eh
                mov     [esi], ebp
                mov     [esi+4], ebp
                mov     [esi+8], ebp
                jbe     short loc_5D4342
                mov     ebx, dword ptr [esp+1Ch+arg_0]
                mov     [esp+1Ch+arg_8], eax

loc_5D42DA:                             ; CODE XREF: ___mtold12+90↓j
                mov     eax, esi
                push    esi
                mov     ecx, dword ptr [eax]
                mov     [esp+20h+var_C], ecx
                mov     edx, dword ptr [eax+4]
                mov     [esp+20h+var_8], edx
                mov     eax, dword ptr [eax+8]
                mov     [esp+20h+var_4], eax
                call    ___shl_12
                add     esp, 4
                push    esi
                call    ___shl_12
                add     esp, 4
                lea     ecx, [esp+1Ch+var_C]
                push    ecx
                push    esi
                call    ___add_12
                add     esp, 8
                push    esi
                call    ___shl_12
                movsx   edx, byte ptr [ebx]
                add     esp, 4
                lea     eax, [esp+1Ch+var_C]
                mov     [esp+1Ch+var_C], edx
                mov     [esp+1Ch+var_8], ebp
                push    eax
                push    esi
                mov     [esp+24h+var_4], ebp
                call    ___add_12
                mov     eax, dword ptr [esp+24h+arg_8]
                add     esp, 8
                inc     ebx
                dec     eax
                mov     [esp+1Ch+arg_8], eax
                jnz     short loc_5D42DA

loc_5D4342:                             ; CODE XREF: ___mtold12+20↑j
                cmp     [esi+8], ebp
                jnz     short loc_5D4373

loc_5D4347:                             ; CODE XREF: ___mtold12+C1↓j
                mov     eax, dword ptr [esi+4]
                add     edi, 0FFF0h
                mov     ecx, eax
                shr     ecx, 10h
                mov     [esi+8], ecx
                mov     ecx, dword ptr [esi]
                mov     edx, ecx
                shr     edx, 10h
                shl     eax, 10h
                or      edx, eax
                mov     eax, dword ptr [esi+8]
                shl     ecx, 10h
                cmp     eax, ebp
                mov     [esi+4], edx
                mov     [esi], ecx
                jz      short loc_5D4347

loc_5D4373:                             ; CODE XREF: ___mtold12+95↑j
                mov     eax, dword ptr [esi+8]
                mov     ebx, 8000h
                test    ebx, eax
                jnz     short loc_5D4395

loc_5D437F:                             ; CODE XREF: ___mtold12+E3↓j
                push    esi
                call    ___shl_12
                mov     eax, dword ptr [esi+8]
                add     esp, 4
                add     edi, 0FFFFh
                test    ebx, eax
                jz      short loc_5D437F

loc_5D4395:                             ; CODE XREF: ___mtold12+CD↑j
                mov     [esi+0Ah], di
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 0Ch
                retn
___mtold12      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

_$I10_OUTPUT    proc near               ; CODE XREF: __fltout2+3C↑p

var_20          = dword ptr -20h
var_1C          = byte ptr -1Ch
var_1B          = byte ptr -1Bh
var_1A          = byte ptr -1Ah
var_19          = byte ptr -19h
var_18          = byte ptr -18h
var_17          = byte ptr -17h
var_16          = byte ptr -16h
var_15          = byte ptr -15h
var_14          = byte ptr -14h
var_13          = byte ptr -13h
var_12          = byte ptr -12h
var_11          = byte ptr -11h
var_10          = dword ptr -10h
var_A           = dword ptr -0Ah
var_6           = dword ptr -6
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h
arg_10          = byte ptr  14h
arg_14          = dword ptr  18h

                sub     esp, 20h
                mov     ecx, dword ptr [esp+20h+arg_8]
                mov     al, 0CCh
                mov     [esp+20h+var_1C], al
                mov     [esp+20h+var_1B], al
                mov     [esp+20h+var_1A], al
                mov     [esp+20h+var_19], al
                mov     [esp+20h+var_18], al
                mov     [esp+20h+var_17], al
                mov     [esp+20h+var_16], al
                mov     [esp+20h+var_15], al
                mov     [esp+20h+var_14], al
                mov     [esp+20h+var_13], al
                mov     eax, ecx
                push    ebx
                and     eax, 8000h
                push    ebp
                and     ecx, 7FFFh
                push    esi
                test    ax, ax
                push    edi
                mov     [esp+30h+var_12], 0FBh
                mov     [esp+30h+var_11], 3Fh ; '?'
                mov     [esp+30h+var_20], 1
                jz      short loc_5D4413
                mov     edi, [esp+30h+arg_14]
                mov     byte ptr [edi+2], 2Dh ; '-'
                jmp     short loc_5D441D
; ---------------------------------------------------------------------------

loc_5D4413:                             ; CODE XREF: _$I10_OUTPUT+57↑j
                mov     edx, dword ptr [esp+30h+arg_14]
                mov     edi, edx
                mov     byte ptr [edx+2], 20h ; ' '

loc_5D441D:                             ; CODE XREF: _$I10_OUTPUT+61↑j
                mov     edx, dword ptr [esp+30h+arg_4]
                mov     ebx, dword ptr [esp+30h+arg_0]
                test    cx, cx
                jnz     short loc_5D443A
                test    edx, edx
                jnz     short loc_5D443A
                test    ebx, ebx
                jnz     short loc_5D443A
                mov     [edi], bx
                jmp     loc_5D45BF
; ---------------------------------------------------------------------------

loc_5D443A:                             ; CODE XREF: _$I10_OUTPUT+78↑j
                cmp     cx, 7FFFh
                jnz     loc_5D451D
                cmp     edx, 80000000h
                mov     word ptr [edi], 1
                jnz     short loc_5D4456
                test    ebx, ebx
                jz      short loc_5D448C

loc_5D4456:                             ; CODE XREF: _$I10_OUTPUT+A0↑j
                test    edx, 40000000h
                jnz     short loc_5D448C
                mov     ecx, ds:dword_6151E0
                lea     eax, [edi+4]
                mov     [edi+4], ecx
                mov     dx, ds:word_6151E4
                mov     [eax+4], dx
                mov     cl, ds:byte_6151E6
                mov     byte ptr [edi+3], 6
                mov     [eax+6], cl
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 20h
                retn
; ---------------------------------------------------------------------------

loc_5D448C:                             ; CODE XREF: _$I10_OUTPUT+A4↑j
                test    ax, ax
                jz      short loc_5D44C1
                cmp     edx, 0C0000000h
                jnz     short loc_5D44C1
                test    ebx, ebx
                jnz     short loc_5D44C1
                mov     eax, ds:dword_6151D8
                lea     edx, [edi+4]
                mov     [edi+4], eax
                mov     cx, ds:word_6151DC
                mov     byte ptr [edi+3], 5
                xor     eax, eax
                mov     [edx+4], cx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 20h
                retn
; ---------------------------------------------------------------------------

loc_5D44C1:                             ; CODE XREF: _$I10_OUTPUT+DF↑j
                cmp     edx, 80000000h
                jnz     short loc_5D44F1
                test    ebx, ebx
                jnz     short loc_5D44F1
                mov     eax, ds:dword_6151D0
                lea     edx, [edi+4]
                mov     [edi+4], eax
                mov     cx, ds:word_6151D4
                mov     byte ptr [edi+3], 5
                xor     eax, eax
                mov     [edx+4], cx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 20h
                retn
; ---------------------------------------------------------------------------

loc_5D44F1:                             ; CODE XREF: _$I10_OUTPUT+117↑j
                mov     eax, ds:dword_6151C8
                lea     edx, [edi+4]
                mov     [edi+4], eax
                mov     cx, ds:word_6151CC
                mov     [edx+4], cx
                mov     al, ds:byte_6151CE
                mov     byte ptr [edi+3], 6
                mov     [edx+6], al
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 20h
                retn
; ---------------------------------------------------------------------------

loc_5D451D:                             ; CODE XREF: _$I10_OUTPUT+8F↑j
                mov     eax, edx
                mov     esi, ecx
                shr     eax, 18h
                and     esi, 0FFFFh
                and     eax, 0FFFFh
                shr     esi, 8
                mov     word ptr [esp+30h+var_6], cx
                mov     [esp+30h+var_A], edx
                lea     eax, [esi+eax*2]
                mov     [esp+30h+var_10+2], ebx
                push    1
                lea     edx, [esp+34h+var_10]
                lea     esi, [eax+eax*8]
                xor     ebx, ebx
                mov     word ptr [esp+34h+var_10], bx
                lea     esi, [eax+esi*2]
                lea     esi, [eax+esi*4]
                mov     eax, ecx
                and     eax, 0FFFFh
                mov     ebp, eax
                shl     ebp, 4
                add     ebp, eax
                lea     eax, [eax+ebp*8]
                lea     eax, [eax+eax*8]
                shl     eax, 4
                lea     esi, [esi+eax-134312F4h]
                sar     esi, 10h
                movsx   ecx, si
                neg     ecx
                push    ecx
                push    edx
                call    ___multtenpow12
                add     esp, 0Ch
                cmp     word ptr [esp+30h+var_6], 3FFFh
                jb      short loc_5D45A4
                lea     eax, [esp+30h+var_1C]
                lea     ecx, [esp+30h+var_10]
                push    eax
                push    ecx
                inc     esi
                call    ___ld12mul
                add     esp, 8

loc_5D45A4:                             ; CODE XREF: _$I10_OUTPUT+1DF↑j
                mov     al, [esp+30h+arg_10]
                mov     [edi], si
                test    al, 1
                jz      short loc_5D45DC
                mov     ebp, [esp+30h+arg_C]
                movsx   edx, si
                add     ebp, edx
                cmp     ebp, ebx
                jg      short loc_5D45E0
                mov     [edi], bx

loc_5D45BF:                             ; CODE XREF: _$I10_OUTPUT+85↑j
                mov     byte ptr [edi+2], 20h ; ' '
                mov     byte ptr [edi+3], 1
                mov     byte ptr [edi+4], 30h ; '0'
                mov     byte ptr [edi+5], 0
                mov     eax, 1
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 20h
                retn
; ---------------------------------------------------------------------------

loc_5D45DC:                             ; CODE XREF: _$I10_OUTPUT+1FD↑j
                mov     ebp, [esp+30h+arg_C]

loc_5D45E0:                             ; CODE XREF: _$I10_OUTPUT+20A↑j
                cmp     ebp, 15h
                jle     short loc_5D45EA
                mov     ebp, 15h

loc_5D45EA:                             ; CODE XREF: _$I10_OUTPUT+233↑j
                mov     esi, [esp+30h+var_6]
                mov     word ptr [esp+30h+var_6], bx
                and     esi, 0FFFFh
                mov     ebx, 8
                sub     esi, 3FFEh

loc_5D4604:                             ; CODE XREF: _$I10_OUTPUT+262↓j
                lea     eax, [esp+30h+var_10]
                push    eax
                call    ___shl_12
                add     esp, 4
                dec     ebx
                jnz     short loc_5D4604
                test    esi, esi
                jge     short loc_5D4632
                neg     esi
                and     esi, 0FFh
                jle     short loc_5D4632

loc_5D4622:                             ; CODE XREF: _$I10_OUTPUT+280↓j
                lea     ecx, [esp+30h+var_10]
                push    ecx
                call    ___shr_12
                add     esp, 4
                dec     esi
                jnz     short loc_5D4622

loc_5D4632:                             ; CODE XREF: _$I10_OUTPUT+266↑j
                lea     esi, [edi+4]
                lea     edi, [ebp+1]
                test    edi, edi
                mov     ebx, esi
                jle     short loc_5D46A1

loc_5D463E:                             ; CODE XREF: _$I10_OUTPUT+2EF↓j
                mov     edx, dword ptr [esp+30h+var_10]
                mov     eax, dword ptr [esp+24h]
                mov     ecx, dword ptr [esp+30h+var_A+2]
                mov     [esp+30h+arg_0], edx
                lea     edx, [esp+30h+var_10]
                mov     [esp+30h+arg_4], eax
                push    edx
                mov     [esp+34h+arg_8], ecx
                call    ___shl_12
                add     esp, 4
                lea     eax, [esp+30h+var_10]
                push    eax
                call    ___shl_12
                add     esp, 4
                lea     ecx, [esp+30h+arg_0]
                lea     edx, [esp+30h+var_10]
                push    ecx
                push    edx
                call    ___add_12
                add     esp, 8
                lea     eax, [esp+30h+var_10]
                push    eax
                call    ___shl_12
                mov     cl, byte ptr [esp+34h+var_6+1]
                add     esp, 4
                add     cl, 30h ; '0'
                mov     byte ptr [esp+30h+var_6+1], 0
                mov     [ebx], cl
                inc     ebx
                dec     edi
                jnz     short loc_5D463E

loc_5D46A1:                             ; CODE XREF: _$I10_OUTPUT+28C↑j
                mov     al, [ebx-1]
                dec     ebx
                dec     ebx
                cmp     al, 35h ; '5'
                jl      short loc_5D46DB
                cmp     ebx, esi
                jb      short loc_5D46BF

loc_5D46AE:                             ; CODE XREF: _$I10_OUTPUT+309↓j
                cmp     byte ptr [ebx], 39h ; '9'
                jnz     short loc_5D46BB
                mov     byte ptr [ebx], 30h ; '0'
                dec     ebx
                cmp     ebx, esi
                jnb     short loc_5D46AE

loc_5D46BB:                             ; CODE XREF: _$I10_OUTPUT+301↑j
                cmp     ebx, esi
                jnb     short loc_5D46CF

loc_5D46BF:                             ; CODE XREF: _$I10_OUTPUT+2FC↑j
                mov     eax, dword ptr [esp+30h+arg_14]
                inc     ebx
                inc     word ptr [eax]
                mov     cl, [ebx]
                inc     cl
                mov     [ebx], cl
                jmp     short loc_5D4716
; ---------------------------------------------------------------------------

loc_5D46CF:                             ; CODE XREF: _$I10_OUTPUT+30D↑j
                mov     cl, [ebx]
                mov     eax, dword ptr [esp+30h+arg_14]
                inc     cl
                mov     [ebx], cl
                jmp     short loc_5D4716
; ---------------------------------------------------------------------------

loc_5D46DB:                             ; CODE XREF: _$I10_OUTPUT+2F8↑j
                cmp     ebx, esi
                jb      short loc_5D46ED

loc_5D46DF:                             ; CODE XREF: _$I10_OUTPUT+337↓j
                cmp     byte ptr [ebx], 30h ; '0'
                jnz     short loc_5D46E9
                dec     ebx
                cmp     ebx, esi
                jnb     short loc_5D46DF

loc_5D46E9:                             ; CODE XREF: _$I10_OUTPUT+332↑j
                cmp     ebx, esi
                jnb     short loc_5D4712

loc_5D46ED:                             ; CODE XREF: _$I10_OUTPUT+32D↑j
                mov     eax, dword ptr [esp+30h+arg_14]
                mov     byte ptr [esi], 30h ; '0'
                mov     word ptr [eax], 0
                mov     byte ptr [eax+2], 20h ; ' '
                mov     byte ptr [eax+3], 1
                mov     byte ptr [eax+5], 0
                mov     eax, 1
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 20h
                retn
; ---------------------------------------------------------------------------

loc_5D4712:                             ; CODE XREF: _$I10_OUTPUT+33B↑j
                mov     eax, dword ptr [esp+30h+arg_14]

loc_5D4716:                             ; CODE XREF: _$I10_OUTPUT+31D↑j
                sub     bl, al
                pop     edi
                sub     bl, 3
                pop     esi
                movsx   edx, bl
                mov     [eax+3], bl
                pop     ebp
                mov     byte ptr [eax+edx+4], 0
                mov     eax, dword ptr [esp+24h+var_20]
                pop     ebx
                add     esp, 20h
                retn
_$I10_OUTPUT    endp

; ---------------------------------------------------------------------------
                align 10h
                mov     eax, uNumber
                push    esi
                mov     esi, [esp+8]
                push    edi
                cmp     esi, eax
                jnb     short loc_5D4791
                mov     eax, esi
                mov     ecx, esi
                and     eax, 1Fh
                sar     ecx, 5
                lea     edx, [eax+eax*8]
                mov     eax, __pioinfo[ecx*4]
                test    byte ptr [eax+edx*4+4], 1
                jz      short loc_5D4791
                push    esi
                call    __lock_fhandle
                mov     ecx, dword ptr [esp+14h]
                add     esp, 4
                push    ecx
                push    esi
                call    __chsize_lk
                add     esp, 8
                mov     edi, eax
                push    esi
                call    __unlock_fhandle
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D4791:                             ; CODE XREF: .text:005D474D↑j
                call    __errno
                mov     dword ptr [eax], 9
                pop     edi
                or      eax, 0FFFFFFFFh
                pop     esi
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _chsize_lk(int FileHandle, LONG)
__chsize_lk     proc near               ; CODE XREF: __sopen+2C7↑p

lDistanceToMove = dword ptr -1004h
Buffer          = byte ptr -1000h
FileHandle      = dword ptr  4
arg_4           = dword ptr  8

                mov     eax, 1004h
                call    __alloca_probe
                push    ebx
                mov     ebx, dword ptr [esp+1008h+FileHandle]
                push    ebp
                push    esi
                push    edi
                xor     ebp, ebp
                push    1               ; dwMoveMethod
                push    ebp             ; lDistanceToMove
                push    ebx             ; FileHandle
                call    __lseek_lk
                mov     edi, eax
                add     esp, 0Ch
                cmp     edi, 0FFFFFFFFh
                mov     [esp+1014h+lDistanceToMove], edi
                jz      loc_5D48F0
                push    2               ; dwMoveMethod
                push    ebp             ; lDistanceToMove
                push    ebx             ; FileHandle
                call    __lseek_lk
                add     esp, 0Ch
                cmp     eax, 0FFFFFFFFh
                jz      loc_5D48F0
                mov     ecx, dword ptr [esp+1014h+arg_4]
                mov     esi, ecx
                sub     esi, eax
                test    esi, esi
                jle     loc_5D4891
                mov     ecx, 400h
                xor     eax, eax
                lea     edi, [esp+1014h+Buffer]
                push    8000h
                rep stosd
                push    ebx
                call    __setmode_lk
                add     esp, 8
                mov     edi, eax

loc_5D4827:                             ; CODE XREF: __chsize_lk+A0↓j
                cmp     esi, 1000h
                mov     eax, 1000h
                jge     short loc_5D4836
                mov     eax, esi

loc_5D4836:                             ; CODE XREF: __chsize_lk+82↑j
                push    eax             ; nNumberOfBytesToWrite
                lea     eax, [esp+1018h+Buffer]
                push    eax             ; lpBuffer
                push    ebx             ; FileHandle
                call    __write_lk
                add     esp, 0Ch
                cmp     eax, 0FFFFFFFFh
                jz      short loc_5D4852
                sub     esi, eax
                test    esi, esi
                jle     short loc_5D486A
                jmp     short loc_5D4827
; ---------------------------------------------------------------------------

loc_5D4852:                             ; CODE XREF: __chsize_lk+98↑j
                call    ___doserrno
                cmp     dword ptr [eax], 5
                jnz     short loc_5D4867
                call    __errno
                mov     dword ptr [eax], 0Dh

loc_5D4867:                             ; CODE XREF: __chsize_lk+AA↑j
                or      ebp, 0FFFFFFFFh

loc_5D486A:                             ; CODE XREF: __chsize_lk+9E↑j
                push    edi
                push    ebx
                call    __setmode_lk
                mov     edi, [esp+101Ch+lDistanceToMove]
                add     esp, 8
                push    0               ; dwMoveMethod
                push    edi             ; lDistanceToMove
                push    ebx             ; FileHandle
                call    __lseek_lk
                add     esp, 0Ch
                mov     eax, ebp
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 1004h
                retn
; ---------------------------------------------------------------------------

loc_5D4891:                             ; CODE XREF: __chsize_lk+54↑j
                jge     short loc_5D48D7
                push    0               ; dwMoveMethod
                push    ecx             ; lDistanceToMove
                push    ebx             ; FileHandle
                call    __lseek_lk
                add     esp, 0Ch
                push    ebx             ; FileHandle
                call    __get_osfhandle
                add     esp, 4
                push    eax             ; hFile
                call    SetEndOfFile
                mov     ebp, eax
                neg     ebp
                sbb     ebp, ebp
                neg     ebp
                dec     ebp
                cmp     ebp, 0FFFFFFFFh
                jnz     short loc_5D48D7
                call    __errno
                mov     dword ptr [eax], 0Dh
                call    GetLastError
                mov     esi, eax
                call    ___doserrno
                mov     [eax], esi

loc_5D48D7:                             ; CODE XREF: __chsize_lk:loc_5D4891↑j
                push    0               ; dwMoveMethod
                push    edi             ; lDistanceToMove
                push    ebx             ; FileHandle
                call    __lseek_lk
                add     esp, 0Ch
                mov     eax, ebp
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 1004h
                retn
; ---------------------------------------------------------------------------

loc_5D48F0:                             ; CODE XREF: __chsize_lk+2C↑j
                pop     edi
                pop     esi
                pop     ebp
                or      eax, 0FFFFFFFFh
                pop     ebx
                add     esp, 1004h
                retn
__chsize_lk     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __getlocaleinfo(UINT CodePage, LCID Locale, LCTYPE LCType, int)
___getlocaleinfo proc near              ; CODE XREF: __get_lc_time+2E↑p

var_84          = dword ptr -84h
Block           = byte ptr -80h
CodePage        = dword ptr  4
Locale          = dword ptr  8
LCType          = dword ptr  0Ch
arg_C           = dword ptr  10h

                mov     eax, dword ptr [esp+CodePage]
                sub     esp, 84h
                push    ebx
                push    ebp
                mov     ebp, 1
                push    esi
                cmp     eax, ebp
                push    edi
                jnz     loc_5D4A00
                mov     ebx, dword ptr [esp+94h+LCType]
                mov     ebp, [esp+94h+Locale]
                push    0               ; CodePage
                lea     eax, [esp+98h+Block]
                push    80h             ; cchData
                push    eax             ; lpLCData
                push    ebx             ; LCType
                push    ebp             ; Locale
                lea     edi, [esp+0A8h+Block]
                mov     [esp+0A8h+var_84], 0
                call    ___crtGetLocaleInfoA
                mov     esi, eax
                add     esp, 14h
                test    esi, esi
                jnz     short loc_5D499A
                call    GetLastError
                cmp     eax, 7Ah ; 'z'
                jnz     short loc_5D49B0
                push    esi             ; CodePage
                push    esi             ; cchData
                push    esi             ; lpLCData
                push    ebx             ; LCType
                push    ebp             ; Locale
                call    ___crtGetLocaleInfoA
                mov     esi, eax
                add     esp, 14h
                test    esi, esi
                jz      short loc_5D49B0
                push    esi             ; varSize
                call    _malloc
                mov     edi, eax
                add     esp, 4
                test    edi, edi
                jz      short loc_5D49B0
                push    0               ; CodePage
                push    esi             ; cchData
                push    edi             ; lpLCData
                push    ebx             ; LCType
                push    ebp             ; Locale
                mov     [esp+0A8h+var_84], 1
                call    ___crtGetLocaleInfoA
                mov     esi, eax
                add     esp, 14h
                test    esi, esi
                jz      short loc_5D49B0

loc_5D499A:                             ; CODE XREF: ___getlocaleinfo+4F↑j
                push    esi             ; varSize
                call    _malloc
                mov     ecx, dword ptr [esp+98h+arg_C]
                add     esp, 4
                test    eax, eax
                mov     [ecx], eax
                jnz     short loc_5D49D3

loc_5D49B0:                             ; CODE XREF: ___getlocaleinfo+5A↑j
                mov     eax, dword ptr [esp+94h+var_84]
                test    eax, eax
                jz      loc_5D4A9E
                push    edi             ; Block
                call    _free
                add     esp, 4
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 84h
                retn
; ---------------------------------------------------------------------------

loc_5D49D3:                             ; CODE XREF: ___getlocaleinfo+AE↑j
                push    esi             ; Count
                push    edi             ; Source
                push    eax             ; Destination
                call    _strncpy
                mov     eax, dword ptr [esp+0A0h+var_84]
                add     esp, 0Ch
                test    eax, eax
                jz      loc_5D4A91
                push    edi             ; Block
                call    _free
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 84h
                retn
; ---------------------------------------------------------------------------

loc_5D4A00:                             ; CODE XREF: ___getlocaleinfo+15↑j
                test    eax, eax
                jnz     loc_5D4A9E
                mov     edx, dword ptr [esp+94h+LCType]
                push    eax             ; CodePage
                mov     eax, dword ptr [esp+98h+Locale]
                push    4               ; cchData
                push    offset LCData   ; lpLCData
                push    edx             ; LCType
                push    eax             ; Locale
                call    ___crtGetLocaleInfoW
                add     esp, 14h
                test    eax, eax
                jz      short loc_5D4A9E
                mov     edi, [esp+94h+arg_C]
                mov     esi, offset LCData
                mov     byte ptr [edi], 0

loc_5D4A3B:                             ; CODE XREF: ___getlocaleinfo+18F↓j
                mov     eax, [g_SrcSizeInBytes]
                mov     bl, [esi]
                cmp     eax, ebp
                mov     byte ptr [esp+94h+var_84], bl
                jle     short loc_5D4A61
                mov     ecx, dword ptr [esp+94h+var_84]
                push    4               ; Type
                and     ecx, 0FFh
                push    ecx             ; C
                call    __isctype
                add     esp, 8
                jmp     short loc_5D4A76
; ---------------------------------------------------------------------------

loc_5D4A61:                             ; CODE XREF: ___getlocaleinfo+148↑j
                mov     edx, dword ptr [esp+94h+var_84]
                mov     eax, off_641268
                and     edx, 0FFh
                mov     al, [eax+edx*2]
                and     eax, 4

loc_5D4A76:                             ; CODE XREF: ___getlocaleinfo+15F↑j
                test    eax, eax
                jz      short loc_5D4A91
                mov     al, [edi]
                mov     cl, 0Ah
                imul    cl
                add     al, bl
                add     esi, 2
                sub     al, 30h ; '0'
                cmp     esi, offset unk_70D7E0
                mov     [edi], al
                jl      short loc_5D4A3B

loc_5D4A91:                             ; CODE XREF: ___getlocaleinfo+E4↑j
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 84h
                retn
; ---------------------------------------------------------------------------

loc_5D4A9E:                             ; CODE XREF: ___getlocaleinfo+B6↑j
                pop     edi
                pop     esi
                pop     ebp
                or      eax, 0FFFFFFFFh
                pop     ebx
                add     esp, 84h
                retn
___getlocaleinfo endp

; ---------------------------------------------------------------------------
                align 10h
                mov     eax, off_642670
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __crtGetLocaleInfoW(LCID Locale, LCTYPE LCType, LPWSTR lpLCData, int cchData, UINT CodePage)
___crtGetLocaleInfoW proc near          ; CODE XREF: ___get_qualified_locale+218↑p

Locale          = dword ptr  4
LCType          = dword ptr  8
lpLCData        = dword ptr  0Ch
cchData         = dword ptr  10h
CodePage        = dword ptr  14h

                mov     eax, dword_70D7E4
                push    ebx
                push    ebp
                push    esi
                mov     esi, ds:GetLocaleInfoW
                push    edi
                test    eax, eax
                jnz     short loc_5D4B08
                push    0               ; cchData
                push    0               ; lpLCData
                push    1               ; LCType
                push    0               ; Locale
                call    esi ; GetLocaleInfoW
                test    eax, eax
                jz      short loc_5D4AE8
                mov     eax, 1
                jmp     short loc_5D4B03
; ---------------------------------------------------------------------------

loc_5D4AE8:                             ; CODE XREF: ___crtGetLocaleInfoW+1F↑j
                push    0               ; cchData
                push    0               ; lpLCData
                push    1               ; LCType
                push    0               ; Locale
                call    GetLocaleInfoA
                test    eax, eax
                jz      loc_5D4BD9
                mov     eax, 2

loc_5D4B03:                             ; CODE XREF: ___crtGetLocaleInfoW+26↑j
                mov     dword_70D7E4, eax

loc_5D4B08:                             ; CODE XREF: ___crtGetLocaleInfoW+11↑j
                cmp     eax, 1
                jnz     short loc_5D4B28
                mov     eax, dword ptr [esp+10h+cchData]
                mov     ecx, dword ptr [esp+10h+lpLCData]
                mov     edx, dword ptr [esp+10h+LCType]
                push    eax             ; cchData
                mov     eax, dword ptr [esp+14h+Locale]
                push    ecx             ; lpLCData
                push    edx             ; LCType
                push    eax             ; Locale
                call    esi ; GetLocaleInfoW
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D4B28:                             ; CODE XREF: ___crtGetLocaleInfoW+4B↑j
                cmp     eax, 2
                jnz     loc_5D4BEB
                mov     eax, dword ptr [esp+10h+CodePage]
                test    eax, eax
                jnz     short loc_5D4B43
                mov     ecx, CodePage
                mov     [esp+10h+CodePage], ecx

loc_5D4B43:                             ; CODE XREF: ___crtGetLocaleInfoW+77↑j
                mov     ebx, dword ptr [esp+10h+LCType]
                mov     ebp, [esp+10h+Locale]
                push    0               ; cchData
                push    0               ; lpLCData
                push    ebx             ; LCType
                push    ebp             ; Locale
                call    GetLocaleInfoA
                mov     esi, eax
                test    esi, esi
                jnz     short loc_5D4B62
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D4B62:                             ; CODE XREF: ___crtGetLocaleInfoW+9B↑j
                push    esi             ; varSize
                call    _malloc
                mov     edi, eax
                add     esp, 4
                test    edi, edi
                jnz     short loc_5D4B76
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D4B76:                             ; CODE XREF: ___crtGetLocaleInfoW+AF↑j
                push    esi             ; cchData
                push    edi             ; lpLCData
                push    ebx             ; LCType
                push    ebp             ; Locale
                call    GetLocaleInfoA
                test    eax, eax
                jz      short loc_5D4BD0
                mov     eax, dword ptr [esp+10h+cchData]
                test    eax, eax
                jnz     short loc_5D4BB4
                mov     edx, dword ptr [esp+10h+CodePage]
                push    eax             ; cchWideChar
                push    eax             ; lpWideCharStr
                push    0FFFFFFFFh      ; cbMultiByte
                push    edi             ; lpMultiByteStr
                push    1               ; dwFlags
                push    edx             ; CodePage
                call    MultiByteToWideChar
                mov     esi, eax
                test    esi, esi
                jz      short loc_5D4BD0
                push    edi             ; Block
                call    _free
                add     esp, 4
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D4BB4:                             ; CODE XREF: ___crtGetLocaleInfoW+CA↑j
                mov     ecx, dword ptr [esp+10h+CodePage]
                push    eax             ; cchWideChar
                mov     eax, dword ptr [esp+14h+lpLCData]
                push    eax             ; lpWideCharStr
                push    0FFFFFFFFh      ; cbMultiByte
                push    edi             ; lpMultiByteStr
                push    1               ; dwFlags
                push    ecx             ; CodePage
                call    MultiByteToWideChar
                mov     esi, eax
                test    esi, esi
                jnz     short loc_5D4BE0

loc_5D4BD0:                             ; CODE XREF: ___crtGetLocaleInfoW+C2↑j
                push    edi             ; Block
                call    _free
                add     esp, 4

loc_5D4BD9:                             ; CODE XREF: ___crtGetLocaleInfoW+38↑j
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D4BE0:                             ; CODE XREF: ___crtGetLocaleInfoW+10E↑j
                push    edi             ; Block
                call    _free
                add     esp, 4
                mov     eax, esi

loc_5D4BEB:                             ; CODE XREF: ___crtGetLocaleInfoW+6B↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
___crtGetLocaleInfoW endp


; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __crtGetLocaleInfoA(LCID Locale, LCTYPE LCType, LPSTR lpLCData, int cchData, UINT CodePage)
___crtGetLocaleInfoA proc near          ; CODE XREF: ___get_qualified_locale+2BB↑p

Locale          = dword ptr  4
LCType          = dword ptr  8
lpLCData        = dword ptr  0Ch
cchData         = dword ptr  10h
CodePage        = dword ptr  14h

                mov     eax, dword_70D7E8
                push    ebx
                push    ebp
                push    esi
                mov     esi, ds:GetLocaleInfoA
                push    edi
                test    eax, eax
                jnz     short loc_5D4C38
                push    0               ; cchData
                push    0               ; lpLCData
                push    1               ; LCType
                push    0               ; Locale
                call    esi ; GetLocaleInfoA
                test    eax, eax
                jz      short loc_5D4C18
                mov     eax, 2
                jmp     short loc_5D4C33
; ---------------------------------------------------------------------------

loc_5D4C18:                             ; CODE XREF: ___crtGetLocaleInfoA+1F↑j
                push    0               ; cchData
                push    0               ; lpLCData
                push    1               ; LCType
                push    0               ; Locale
                call    GetLocaleInfoW
                test    eax, eax
                jz      loc_5D4D18
                mov     eax, 1

loc_5D4C33:                             ; CODE XREF: ___crtGetLocaleInfoA+26↑j
                mov     dword_70D7E8, eax

loc_5D4C38:                             ; CODE XREF: ___crtGetLocaleInfoA+11↑j
                cmp     eax, 2
                jnz     short loc_5D4C58
                mov     eax, dword ptr [esp+10h+cchData]
                mov     ecx, dword ptr [esp+10h+lpLCData]
                mov     edx, dword ptr [esp+10h+LCType]
                push    eax             ; cchData
                mov     eax, dword ptr [esp+14h+Locale]
                push    ecx             ; lpLCData
                push    edx             ; LCType
                push    eax             ; Locale
                call    esi ; GetLocaleInfoA
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D4C58:                             ; CODE XREF: ___crtGetLocaleInfoA+4B↑j
                cmp     eax, 1
                jnz     loc_5D4D2A
                mov     eax, dword ptr [esp+10h+CodePage]
                test    eax, eax
                jnz     short loc_5D4C73
                mov     ecx, CodePage
                mov     [esp+10h+CodePage], ecx

loc_5D4C73:                             ; CODE XREF: ___crtGetLocaleInfoA+77↑j
                mov     ebx, dword ptr [esp+10h+LCType]
                mov     ebp, [esp+10h+Locale]
                push    0               ; cchData
                push    0               ; lpLCData
                push    ebx             ; LCType
                push    ebp             ; Locale
                call    GetLocaleInfoW
                mov     edi, eax
                test    edi, edi
                jnz     short loc_5D4C92
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D4C92:                             ; CODE XREF: ___crtGetLocaleInfoA+9B↑j
                lea     edx, [edi+edi]
                push    edx             ; varSize
                call    _malloc
                mov     esi, eax
                add     esp, 4
                test    esi, esi
                jnz     short loc_5D4CA9
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D4CA9:                             ; CODE XREF: ___crtGetLocaleInfoA+B2↑j
                push    edi             ; cchData
                push    esi             ; lpLCData
                push    ebx             ; LCType
                push    ebp             ; Locale
                call    GetLocaleInfoW
                test    eax, eax
                jz      short loc_5D4D0F
                mov     eax, dword ptr [esp+10h+cchData]
                push    0               ; lpUsedDefaultChar
                test    eax, eax
                push    0               ; lpDefaultChar
                jnz     short loc_5D4CF0
                mov     eax, dword ptr [esp+18h+CodePage]
                push    0               ; cbMultiByte
                push    0               ; lpMultiByteStr
                push    0FFFFFFFFh      ; cchWideChar
                push    esi             ; lpWideCharStr
                push    220h            ; dwFlags
                push    eax             ; CodePage
                call    WideCharToMultiByte
                mov     edi, eax
                test    edi, edi
                jz      short loc_5D4D0F
                push    esi             ; Block
                call    _free
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D4CF0:                             ; CODE XREF: ___crtGetLocaleInfoA+D1↑j
                mov     ecx, dword ptr [esp+18h+lpLCData]
                mov     edx, dword ptr [esp+18h+CodePage]
                push    eax             ; cbMultiByte
                push    ecx             ; lpMultiByteStr
                push    0FFFFFFFFh      ; cchWideChar
                push    esi             ; lpWideCharStr
                push    220h            ; dwFlags
                push    edx             ; CodePage
                call    WideCharToMultiByte
                mov     edi, eax
                test    edi, edi
                jnz     short loc_5D4D1F

loc_5D4D0F:                             ; CODE XREF: ___crtGetLocaleInfoA+C5↑j
                push    esi             ; Block
                call    _free
                add     esp, 4

loc_5D4D18:                             ; CODE XREF: ___crtGetLocaleInfoA+38↑j
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D4D1F:                             ; CODE XREF: ___crtGetLocaleInfoA+11D↑j
                push    esi             ; Block
                call    _free
                add     esp, 4
                mov     eax, edi

loc_5D4D2A:                             ; CODE XREF: ___crtGetLocaleInfoA+6B↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
___crtGetLocaleInfoA endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl wcstol(const wchar_t *String, wchar_t **EndPtr, int Radix)
_wcstol         proc near               ; CODE XREF: ___get_qualified_locale+238↑p

String          = dword ptr  4
EndPtr          = dword ptr  8
Radix           = dword ptr  0Ch

                mov     eax, dword ptr [esp+Radix]
                mov     ecx, dword ptr [esp+EndPtr]
                mov     edx, dword ptr [esp+String]
                push    0
                push    eax
                push    ecx
                push    edx
                call    _wcstoxl
                add     esp, 10h
                retn
_wcstol         endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_wcstoxl        proc near               ; CODE XREF: _wcstol+11↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                push    ebx
                push    ebp
                push    esi
                push    edi
                mov     edi, [esp+10h+arg_0]
                push    8               ; Type
                xor     ebx, ebx
                mov     si, [edi]
                add     edi, 2
                push    esi             ; C
                call    _iswctype
                add     esp, 8
                test    eax, eax
                jz      short loc_5D4D84

loc_5D4D6F:                             ; CODE XREF: _wcstoxl+32↓j
                mov     si, [edi]
                push    8               ; Type
                push    esi             ; C
                add     edi, 2
                call    _iswctype
                add     esp, 8
                test    eax, eax
                jnz     short loc_5D4D6F

loc_5D4D84:                             ; CODE XREF: _wcstoxl+1D↑j
                cmp     si, 2Dh ; '-'
                jnz     short loc_5D4D91
                or      [esp+10h+arg_C], 2
                jmp     short loc_5D4D97
; ---------------------------------------------------------------------------

loc_5D4D91:                             ; CODE XREF: _wcstoxl+38↑j
                cmp     si, 2Bh ; '+'
                jnz     short loc_5D4D9D

loc_5D4D97:                             ; CODE XREF: _wcstoxl+3F↑j
                mov     si, [edi]
                add     edi, 2

loc_5D4D9D:                             ; CODE XREF: _wcstoxl+45↑j
                mov     ebp, [esp+10h+arg_8]
                test    ebp, ebp
                jl      loc_5D4F1B
                cmp     ebp, 1
                jz      loc_5D4F1B
                cmp     ebp, 24h ; '$'
                jg      loc_5D4F1B
                test    ebp, ebp
                jnz     short loc_5D4DE5
                cmp     si, 30h ; '0'
                jz      short loc_5D4DCC
                mov     ebp, 0Ah
                jmp     short loc_5D4DE5
; ---------------------------------------------------------------------------

loc_5D4DCC:                             ; CODE XREF: _wcstoxl+73↑j
                mov     ax, [edi]
                cmp     ax, 78h ; 'x'
                jz      short loc_5D4DE0
                cmp     ax, 58h ; 'X'
                mov     ebp, 8
                jnz     short loc_5D4DE5

loc_5D4DE0:                             ; CODE XREF: _wcstoxl+83↑j
                mov     ebp, 10h

loc_5D4DE5:                             ; CODE XREF: _wcstoxl+6D↑j
                cmp     ebp, 10h
                jnz     short loc_5D4E09
                cmp     si, 30h ; '0'
                jnz     short loc_5D4E09
                mov     ax, [edi]
                cmp     ax, 78h ; 'x'
                jz      short loc_5D4DFF
                cmp     ax, 58h ; 'X'
                jnz     short loc_5D4E09

loc_5D4DFF:                             ; CODE XREF: _wcstoxl+A7↑j
                mov     si, [edi+2]
                add     edi, 2
                add     edi, 2

loc_5D4E09:                             ; CODE XREF: _wcstoxl+98↑j
                or      eax, 0FFFFFFFFh
                xor     edx, edx
                div     ebp
                mov     [esp+10h+arg_8], eax

loc_5D4E14:                             ; CODE XREF: _wcstoxl+139↓j
                push    4               ; Type
                push    esi             ; C
                call    _iswctype
                add     esp, 8
                test    eax, eax
                jz      short loc_5D4E2E
                and     esi, 0FFFFh
                sub     esi, 30h ; '0'
                jmp     short loc_5D4E55
; ---------------------------------------------------------------------------

loc_5D4E2E:                             ; CODE XREF: _wcstoxl+D1↑j
                push    103h            ; Type
                push    esi             ; C
                call    _iswctype
                add     esp, 8
                test    eax, eax
                jz      short loc_5D4E9B
                push    esi             ; C
                call    _towupper
                mov     si, ax
                add     esp, 4
                and     esi, 0FFFFh
                sub     esi, 37h ; '7'

loc_5D4E55:                             ; CODE XREF: _wcstoxl+DC↑j
                cmp     esi, ebp
                jnb     short loc_5D4E9B
                mov     edx, dword ptr [esp+10h+arg_C]
                mov     eax, dword ptr [esp+10h+arg_8]
                or      edx, 8
                cmp     ebx, eax
                mov     [esp+10h+arg_C], edx
                jb      short loc_5D4E8B
                jnz     short loc_5D4E79
                or      eax, 0FFFFFFFFh
                xor     edx, edx
                div     ebp
                cmp     esi, edx
                jbe     short loc_5D4E8B

loc_5D4E79:                             ; CODE XREF: _wcstoxl+11C↑j
                mov     eax, dword ptr [esp+10h+arg_C]
                mov     si, [edi]
                or      al, 4
                add     edi, 2
                mov     [esp+10h+arg_C], eax
                jmp     short loc_5D4E14
; ---------------------------------------------------------------------------

loc_5D4E8B:                             ; CODE XREF: _wcstoxl+11A↑j
                imul    ebx, ebp
                add     ebx, esi
                mov     si, [edi]
                add     edi, 2
                jmp     loc_5D4E14
; ---------------------------------------------------------------------------

loc_5D4E9B:                             ; CODE XREF: _wcstoxl+EE↑j
                mov     ecx, dword ptr [esp+10h+arg_C]
                mov     esi, [esp+10h+arg_4]
                sub     edi, 2
                test    cl, 8
                jnz     short loc_5D4EB7
                test    esi, esi
                jz      short loc_5D4EB3
                mov     edi, [esp+10h+arg_0]

loc_5D4EB3:                             ; CODE XREF: _wcstoxl+15D↑j
                xor     ebx, ebx
                jmp     short loc_5D4F07
; ---------------------------------------------------------------------------

loc_5D4EB7:                             ; CODE XREF: _wcstoxl+159↑j
                test    cl, 4
                jnz     short loc_5D4EDC
                test    cl, 1
                jnz     short loc_5D4F07
                mov     eax, ecx
                and     eax, 2
                jz      short loc_5D4ED0
                cmp     ebx, 80000000h
                ja      short loc_5D4EDC

loc_5D4ED0:                             ; CODE XREF: _wcstoxl+176↑j
                test    eax, eax
                jnz     short loc_5D4F07
                cmp     ebx, 7FFFFFFFh
                jbe     short loc_5D4F07

loc_5D4EDC:                             ; CODE XREF: _wcstoxl+16A↑j
                call    __errno
                mov     dword ptr [eax], 22h ; '"'
                mov     eax, dword ptr [esp+10h+arg_C]
                test    al, 1
                jz      short loc_5D4EF4
                or      ebx, 0FFFFFFFFh
                jmp     short loc_5D4F03
; ---------------------------------------------------------------------------

loc_5D4EF4:                             ; CODE XREF: _wcstoxl+19D↑j
                and     al, 2
                neg     al
                sbb     eax, eax
                neg     eax
                add     eax, 7FFFFFFFh
                mov     ebx, eax

loc_5D4F03:                             ; CODE XREF: _wcstoxl+1A2↑j
                mov     ecx, dword ptr [esp+10h+arg_C]

loc_5D4F07:                             ; CODE XREF: _wcstoxl+165↑j
                test    esi, esi
                jz      short loc_5D4F0D
                mov     [esi], edi

loc_5D4F0D:                             ; CODE XREF: _wcstoxl+1B9↑j
                test    cl, 2
                jz      short loc_5D4F14
                neg     ebx

loc_5D4F14:                             ; CODE XREF: _wcstoxl+1C0↑j
                mov     eax, ebx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D4F1B:                             ; CODE XREF: _wcstoxl+53↑j
                mov     eax, dword ptr [esp+10h+arg_4]
                test    eax, eax
                jz      short loc_5D4F29
                mov     ecx, dword ptr [esp+10h+arg_0]
                mov     [eax], ecx

loc_5D4F29:                             ; CODE XREF: _wcstoxl+1D1↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                retn
_wcstoxl        endp

; ---------------------------------------------------------------------------
                mov     eax, dword ptr [esp+0Ch]
                mov     ecx, dword ptr [esp+8]
                mov     edx, dword ptr [esp+4]
                push    1
                push    eax
                push    ecx
                push    edx
                call    _wcstoxl
                add     esp, 10h
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; double __cdecl ldexp(double X, int Y)
_ldexp          proc near               ; CODE XREF: .text:005D2E0F↑p

var_1C          = qword ptr -1Ch
var_4           = dword ptr -4
X               = qword ptr  4
Y               = dword ptr  0Ch

                push    ecx
                push    ebx
                push    esi
                push    edi
                push    0FFFFh
                push    133Fh
                call    __ctrlfp
                mov     esi, eax
                mov     eax, dword ptr [esp+18h+X+6]
                and     eax, 7FF0h
                add     esp, 8
                cmp     eax, 7FF0h
                jnz     short loc_5D4FF2
                mov     edi, dword ptr [esp+10h+X+4]
                mov     ebx, dword ptr [esp+10h+X]
                push    edi
                push    ebx
                call    __sptype
                add     esp, 8
                test    eax, eax
                jle     short loc_5D4FBC
                cmp     eax, 2
                jle     short loc_5D5003
                cmp     eax, 3
                jnz     short loc_5D4FBC
                fild    [esp+10h+Y]
                push    esi
                fstp    [esp+14h+X]
                mov     ecx, dword ptr [esp+14h+X+4]
                mov     edx, dword ptr [esp+14h+X]
                push    ecx
                push    edx
                push    edi
                push    ebx
                push    19h
                call    __handle_qnan2
                add     esp, 18h
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D4FBC:                             ; CODE XREF: _ldexp+3C↑j
                fld     [esp+10h+X]
                fsub    qword ptr [dbl_6151E8]
                push    esi             ; int
                sub     esp, 8
                fstp    [esp+1Ch+var_1C] ; double
                fild    [esp+1Ch+Y]
                fstp    [esp+1Ch+X]
                mov     eax, dword ptr [esp+1Ch+X+4]
                mov     ecx, dword ptr [esp+1Ch+X]
                push    eax             ; int
                push    ecx             ; int
                push    edi             ; int
                push    ebx             ; int
                push    19h             ; int
                push    8               ; char
                call    __except2
                add     esp, 24h
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D4FF2:                             ; CODE XREF: _ldexp+26↑j
                fld     [esp+10h+X]
                fcomp   qword ptr [dbl_6151F0]
                fnstsw  ax
                test    ah, 40h
                jz      short loc_5D501A

loc_5D5003:                             ; CODE XREF: _ldexp+41↑j
                push    0FFFFh
                push    esi
                call    __ctrlfp
                fld     [esp+18h+X]
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D501A:                             ; CODE XREF: _ldexp+B1↑j
                mov     edi, dword ptr [esp+10h+X+4]
                mov     ebx, dword ptr [esp+10h+X]
                lea     edx, [esp+10h+var_4]
                push    edx             ; int
                push    edi
                push    ebx             ; double
                call    __decomp
                mov     eax, dword ptr [esp+1Ch+Y]
                add     esp, 0Ch
                fstp    [esp+10h+X]
                test    eax, eax
                mov     ecx, eax
                jge     short loc_5D5041
                neg     ecx

loc_5D5041:                             ; CODE XREF: _ldexp+ED↑j
                cmp     ecx, 7FFFFFFFh
                jg      short loc_5D504F
                mov     ecx, dword ptr [esp+10h+var_4]
                add     eax, ecx

loc_5D504F:                             ; CODE XREF: _ldexp+F7↑j
                cmp     eax, 0A00h
                jle     short loc_5D50A0
                mov     edx, dword ptr [esp+10h+X+4]
                mov     eax, dword ptr [esp+10h+X]
                mov     ecx, dword ptr g_Number+4
                push    esi             ; int
                push    edx
                mov     edx, dword ptr g_Number
                push    eax             ; Sign
                push    ecx
                push    edx             ; Number
                call    __copysign
                fstp    [esp+24h+var_1C] ; double
                fild    [esp+24h+Y]
                add     esp, 8
                fstp    [esp+1Ch+X]
                mov     eax, dword ptr [esp+1Ch+X+4]
                mov     ecx, dword ptr [esp+1Ch+X]
                push    eax             ; int
                push    ecx             ; int
                push    edi             ; int
                push    ebx             ; int
                push    19h             ; int
                push    11h             ; char
                call    __except2
                add     esp, 24h
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D50A0:                             ; CODE XREF: _ldexp+104↑j
                cmp     eax, 400h
                jle     short loc_5D50F3
                mov     edx, dword ptr [esp+10h+X+4]
                add     eax, 0FFFFFA00h
                push    eax
                mov     eax, dword ptr [esp+14h+X]
                push    edx
                push    eax
                call    __set_exp
                fstp    [esp+1Ch+X]
                fild    [esp+1Ch+Y]
                mov     ecx, dword ptr [esp+1Ch+X+4]
                mov     edx, dword ptr [esp+1Ch+X]
                add     esp, 0Ch
                fstp    [esp+10h+X]
                mov     eax, dword ptr [esp+10h+X+4]
                push    esi             ; int
                push    ecx
                mov     ecx, dword ptr [esp+18h+X]
                push    edx             ; double
                push    eax             ; int
                push    ecx             ; int
                push    edi             ; int
                push    ebx             ; int
                push    19h             ; int
                push    11h             ; char
                call    __except2
                add     esp, 24h
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D50F3:                             ; CODE XREF: _ldexp+155↑j
                cmp     eax, 0FFFFF603h
                jge     short loc_5D5124
                fild    [esp+10h+Y]
                push    esi             ; int
                push    0
                push    0               ; double
                fstp    [esp+1Ch+X]
                mov     edx, dword ptr [esp+1Ch+X+4]
                mov     eax, dword ptr [esp+1Ch+X]
                push    edx             ; int
                push    eax             ; int
                push    edi             ; int
                push    ebx             ; int
                push    19h             ; int
                push    12h             ; char
                call    __except2
                add     esp, 24h
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D5124:                             ; CODE XREF: _ldexp+1A8↑j
                cmp     eax, 0FFFFFC03h
                jge     short loc_5D5177
                mov     ecx, dword ptr [esp+10h+X+4]
                mov     edx, dword ptr [esp+10h+X]
                add     eax, 600h
                push    eax
                push    ecx
                push    edx
                call    __set_exp
                fstp    [esp+1Ch+X]
                fild    [esp+1Ch+Y]
                mov     eax, dword ptr [esp+1Ch+X+4]
                mov     ecx, dword ptr [esp+1Ch+X]
                add     esp, 0Ch
                fstp    [esp+10h+X]
                mov     edx, dword ptr [esp+10h+X+4]
                push    esi             ; int
                push    eax
                mov     eax, dword ptr [esp+18h+X]
                push    ecx             ; double
                push    edx             ; int
                push    eax             ; int
                push    edi             ; int
                push    ebx             ; int
                push    19h             ; int
                push    12h             ; char
                call    __except2
                add     esp, 24h
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D5177:                             ; CODE XREF: _ldexp+1D9↑j
                mov     ecx, dword ptr [esp+10h+X+4]
                mov     edx, dword ptr [esp+10h+X]
                push    eax
                push    ecx
                push    edx
                call    __set_exp
                fstp    [esp+1Ch+X]
                add     esp, 0Ch
                push    0FFFFh
                push    esi
                call    __ctrlfp
                fld     [esp+18h+X]
                add     esp, 8
                pop     edi
                pop     esi
                pop     ebx
                pop     ecx
                retn
_ldexp          endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___ld12mul      proc near               ; CODE XREF: _$I10_OUTPUT+1EC↑p

var_24          = dword ptr -24h
var_20          = dword ptr -20h
var_1C          = dword ptr -1Ch
var_18          = dword ptr -18h
var_14          = dword ptr -14h
var_10          = dword ptr -10h
var_C           = dword ptr -0Ch
var_8           = dword ptr -8
var_4           = dword ptr -4
arg_0           = dword ptr  4
arg_4           = dword ptr  8

                sub     esp, 24h
                mov     edx, dword ptr [esp+24h+arg_0]
                push    ebx
                push    ebp
                push    esi
                mov     ax, [edx+0Ah]
                push    edi
                mov     edi, [esp+34h+arg_4]
                xor     ebp, ebp
                mov     [esp+34h+var_14], ebp
                mov     [esp+34h+var_C], ebp
                mov     cx, [edi+0Ah]
                mov     [esp+34h+var_8], ebp
                mov     esi, ecx
                and     ecx, 7FFFh
                xor     esi, eax
                and     eax, 7FFFh
                and     esi, 8000h
                cmp     ax, 7FFFh
                lea     ebx, [ecx+eax]
                mov     [esp+34h+var_4], ebp
                mov     [esp+34h+var_1C], esi
                mov     [esp+34h+var_24], ebx
                jnb     loc_5D5447
                cmp     cx, 7FFFh
                jnb     loc_5D5447
                cmp     bx, 0BFFDh
                ja      loc_5D5447
                cmp     bx, 3FBFh
                ja      short loc_5D5230
                mov     [edx+8], ebp
                mov     [edx+4], ebp
                mov     [edx], ebp
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 24h
                retn
; ---------------------------------------------------------------------------

loc_5D5230:                             ; CODE XREF: ___ld12mul+6E↑j
                cmp     ax, bp
                jnz     short loc_5D5259
                mov     eax, dword ptr [edx+8]
                inc     ebx
                test    eax, 7FFFFFFFh
                mov     [esp+34h+var_24], ebx
                jnz     short loc_5D5259
                cmp     [edx+4], ebp
                jnz     short loc_5D5259
                cmp     [edx], ebp
                jnz     short loc_5D5259
                mov     [edx+0Ah], bp
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 24h
                retn
; ---------------------------------------------------------------------------

loc_5D5259:                             ; CODE XREF: ___ld12mul+83↑j
                cmp     cx, bp
                jnz     short loc_5D5286
                mov     eax, dword ptr [edi+8]
                inc     ebx
                test    eax, 7FFFFFFFh
                mov     [esp+34h+var_24], ebx
                jnz     short loc_5D5286
                cmp     [edi+4], ebp
                jnz     short loc_5D5286
                cmp     [edi], ebp
                jnz     short loc_5D5286
                mov     [edx+8], ebp
                mov     [edx+4], ebp
                mov     [edx], ebp
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 24h
                retn
; ---------------------------------------------------------------------------

loc_5D5286:                             ; CODE XREF: ___ld12mul+AC↑j
                lea     eax, [esp+34h+var_8]
                mov     [esp+34h+var_18], ebp
                mov     [esp+34h+var_20], eax
                mov     ebp, 5

loc_5D5297:                             ; CODE XREF: ___ld12mul+160↓j
                mov     ecx, dword ptr [esp+34h+var_18]
                test    ebp, ebp
                lea     eax, [ecx+ecx]
                jle     short loc_5D52F9
                mov     ecx, dword ptr [esp+34h+var_20]
                add     edi, 8
                lea     esi, [eax+edx]
                mov     [esp+34h+var_10], ebp
                lea     ebx, [ecx-4]

loc_5D52B3:                             ; CODE XREF: ___ld12mul+137↓j
                xor     edx, edx
                xor     eax, eax
                mov     dx, [edi]
                mov     ax, [esi]
                imul    edx, eax
                mov     ecx, dword ptr [ebx]
                push    ebx
                push    edx
                push    ecx
                call    ___addl
                add     esp, 0Ch
                test    eax, eax
                jz      short loc_5D52D8
                mov     eax, dword ptr [esp+34h+var_20]
                inc     word ptr [eax]

loc_5D52D8:                             ; CODE XREF: ___ld12mul+11F↑j
                mov     eax, dword ptr [esp+34h+var_10]
                add     esi, 2
                sub     edi, 2
                dec     eax
                mov     [esp+34h+var_10], eax
                jnz     short loc_5D52B3
                mov     edi, [esp+34h+arg_4]
                mov     edx, dword ptr [esp+34h+arg_0]
                mov     ebx, dword ptr [esp+34h+var_24]
                mov     esi, [esp+34h+var_1C]

loc_5D52F9:                             ; CODE XREF: ___ld12mul+F0↑j
                mov     ecx, dword ptr [esp+34h+var_20]
                mov     eax, dword ptr [esp+34h+var_18]
                add     ecx, 2
                inc     eax
                dec     ebp
                mov     [esp+34h+var_20], ecx
                test    ebp, ebp
                mov     [esp+34h+var_18], eax
                jg      short loc_5D5297
                add     ebx, 0C002h
                mov     ebp, 80000000h
                test    bx, bx
                mov     [esp+34h+var_24], ebx
                jle     short loc_5D5355

loc_5D5326:                             ; CODE XREF: ___ld12mul+1A3↓j
                test    [esp+34h+var_4], ebp
                jnz     short loc_5D5355
                lea     edx, [esp+34h+var_C]
                push    edx
                call    ___shl_12
                mov     eax, dword ptr [esp+38h+var_24]
                mov     edx, dword ptr [esp+38h+arg_0]
                mov     esi, [esp+38h+var_1C]
                add     eax, 0FFFFh
                add     esp, 4
                mov     [esp+34h+var_24], eax
                test    ax, ax
                mov     ebx, eax
                jg      short loc_5D5326

loc_5D5355:                             ; CODE XREF: ___ld12mul+174↑j
                xor     ecx, ecx
                cmp     bx, cx
                jg      short loc_5D53AA
                add     ebx, 0FFFFh
                cmp     bx, cx
                jge     short loc_5D539B
                movsx   eax, bx
                neg     eax
                add     ebx, eax
                mov     esi, eax
                mov     [esp+34h+var_24], ebx

loc_5D5374:                             ; CODE XREF: ___ld12mul+1DD↓j
                test    byte ptr [esp+34h+var_C], 1
                jz      short loc_5D537F
                inc     [esp+34h+var_14]

loc_5D537F:                             ; CODE XREF: ___ld12mul+1C9↑j
                lea     eax, [esp+34h+var_C]
                push    eax
                call    ___shr_12
                add     esp, 4
                dec     esi
                jnz     short loc_5D5374
                mov     edx, dword ptr [esp+34h+arg_0]
                mov     ebx, dword ptr [esp+34h+var_24]
                mov     esi, [esp+34h+var_1C]

loc_5D539B:                             ; CODE XREF: ___ld12mul+1B5↑j
                mov     eax, dword ptr [esp+34h+var_14]
                xor     ecx, ecx
                cmp     eax, ecx
                jz      short loc_5D53AA
                or      byte ptr [esp+34h+var_C], 1

loc_5D53AA:                             ; CODE XREF: ___ld12mul+1AA↑j
                mov     edi, 8000h
                cmp     word ptr [esp+34h+var_C], di
                ja      short loc_5D53C6
                mov     eax, dword ptr [esp+34h+var_C]
                and     eax, 1FFFFh
                cmp     eax, 18000h
                jnz     short loc_5D53FF

loc_5D53C6:                             ; CODE XREF: ___ld12mul+204↑j
                or      eax, 0FFFFFFFFh
                cmp     [esp+34h+var_C+2], eax
                jnz     short loc_5D53FB
                cmp     [esp+34h+var_8+2], eax
                mov     [esp+34h+var_C+2], ecx
                jnz     short loc_5D53F5
                cmp     word ptr [esp+34h+var_4+2], 0FFFFh
                mov     [esp+34h+var_8+2], ecx
                jnz     short loc_5D53EE
                mov     word ptr [esp+34h+var_4+2], di
                inc     ebx
                jmp     short loc_5D53FF
; ---------------------------------------------------------------------------

loc_5D53EE:                             ; CODE XREF: ___ld12mul+234↑j
                inc     word ptr [esp+34h+var_4+2]
                jmp     short loc_5D53FF
; ---------------------------------------------------------------------------

loc_5D53F5:                             ; CODE XREF: ___ld12mul+227↑j
                inc     [esp+34h+var_8+2]
                jmp     short loc_5D53FF
; ---------------------------------------------------------------------------

loc_5D53FB:                             ; CODE XREF: ___ld12mul+21D↑j
                inc     [esp+34h+var_C+2]

loc_5D53FF:                             ; CODE XREF: ___ld12mul+214↑j
                cmp     bx, 7FFFh
                jb      short loc_5D5423
                neg     si
                sbb     esi, esi
                mov     [edx+4], ecx
                and     esi, ebp
                mov     [edx], ecx
                add     esi, 7FFF8000h
                mov     [edx+8], esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 24h
                retn
; ---------------------------------------------------------------------------

loc_5D5423:                             ; CODE XREF: ___ld12mul+254↑j
                mov     cx, word ptr [esp+34h+var_C+2]
                mov     eax, dword ptr [esp+34h+var_8]
                mov     [edx], cx
                mov     ecx, dword ptr [esp+34h+var_4]
                or      ebx, esi
                mov     [edx+2], eax
                mov     [edx+6], ecx
                mov     [edx+0Ah], bx
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 24h
                retn
; ---------------------------------------------------------------------------

loc_5D5447:                             ; CODE XREF: ___ld12mul+4D↑j
                neg     si
                sbb     esi, esi
                pop     edi
                and     esi, 80000000h
                mov     [edx+4], ebp
                add     esi, 7FFF8000h
                mov     [edx], ebp
                mov     [edx+8], esi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 24h
                retn
___ld12mul      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___multtenpow12 proc near               ; CODE XREF: ___strgtold12+636↑p

var_C           = dword ptr -0Ch
var_8           = dword ptr -8
var_4           = dword ptr -4
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                sub     esp, 0Ch
                push    ebx
                push    esi
                mov     esi, [esp+14h+arg_4]
                push    edi
                mov     edi, offset unk_642688
                sub     edi, 60h ; '`'
                test    esi, esi
                jz      short loc_5D54F3
                jge     short loc_5D5492
                mov     edi, offset unk_6427E8
                neg     esi
                sub     edi, 60h ; '`'

loc_5D5492:                             ; CODE XREF: ___multtenpow12+16↑j
                mov     eax, dword ptr [esp+18h+arg_8]
                mov     ebx, dword ptr [esp+18h+arg_0]
                test    eax, eax
                jnz     short loc_5D54A3
                mov     word ptr [ebx], 0

loc_5D54A3:                             ; CODE XREF: ___multtenpow12+2C↑j
                test    esi, esi
                jz      short loc_5D54F3

loc_5D54A7:                             ; CODE XREF: ___multtenpow12+81↓j
                mov     eax, esi
                add     edi, 54h ; 'T'
                and     eax, 7
                sar     esi, 3
                test    eax, eax
                jz      short loc_5D54EF
                lea     eax, [eax+eax*2]
                cmp     word ptr [edi+eax*4], 8000h
                lea     eax, [edi+eax*4]
                jb      short loc_5D54E5
                mov     ecx, dword ptr [eax]
                mov     [esp+18h+var_C], ecx
                mov     edx, dword ptr [eax+4]
                mov     [esp+18h+var_8], edx
                mov     eax, dword ptr [eax+8]
                mov     [esp+18h+var_4], eax
                mov     eax, dword ptr [esp+18h+var_C+2]
                dec     eax
                mov     [esp+18h+var_C+2], eax
                lea     eax, [esp+18h+var_C]

loc_5D54E5:                             ; CODE XREF: ___multtenpow12+52↑j
                push    eax
                push    ebx
                call    ___ld12mul
                add     esp, 8

loc_5D54EF:                             ; CODE XREF: ___multtenpow12+44↑j
                test    esi, esi
                jnz     short loc_5D54A7

loc_5D54F3:                             ; CODE XREF: ___multtenpow12+14↑j
                pop     edi
                pop     esi
                pop     ebx
                add     esp, 0Ch
                retn
___multtenpow12 endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__getpath       proc near               ; CODE XREF: __spawnvpe+84↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch

                mov     ecx, dword ptr [esp+arg_0]
                push    esi
                push    edi
                cmp     byte ptr [ecx], 3Bh ; ';'
                jnz     short loc_5D5513

loc_5D550B:                             ; CODE XREF: __getpath+11↓j
                mov     al, [ecx+1]
                inc     ecx
                cmp     al, 3Bh ; ';'
                jz      short loc_5D550B

loc_5D5513:                             ; CODE XREF: __getpath+9↑j
                mov     edi, [esp+8+arg_8]
                mov     eax, ecx
                dec     edi
                jz      short loc_5D558D
                mov     dl, [ecx]
                mov     esi, [esp+8+arg_4]
                test    dl, dl
                jz      short loc_5D5571

loc_5D5526:                             ; CODE XREF: __getpath+5D↓j
                cmp     dl, 3Bh ; ';'
                jz      short loc_5D5571
                cmp     dl, 22h ; '"'
                jz      short loc_5D5539
                mov     [esi], dl
                inc     esi
                inc     ecx
                dec     edi
                jz      short loc_5D5561
                jmp     short loc_5D5559
; ---------------------------------------------------------------------------

loc_5D5539:                             ; CODE XREF: __getpath+2E↑j
                mov     dl, [ecx+1]
                inc     ecx
                test    dl, dl
                jz      short loc_5D5553

loc_5D5541:                             ; CODE XREF: __getpath+51↓j
                cmp     dl, 22h ; '"'
                jz      short loc_5D5553
                mov     [esi], dl
                inc     esi
                inc     ecx
                dec     edi
                jz      short loc_5D5561
                mov     dl, [ecx]
                test    dl, dl
                jnz     short loc_5D5541

loc_5D5553:                             ; CODE XREF: __getpath+3F↑j
                cmp     byte ptr [ecx], 0
                jz      short loc_5D5559
                inc     ecx

loc_5D5559:                             ; CODE XREF: __getpath+37↑j
                mov     dl, [ecx]
                test    dl, dl
                jnz     short loc_5D5526
                jmp     short loc_5D5571
; ---------------------------------------------------------------------------

loc_5D5561:                             ; CODE XREF: __getpath+35↑j
                mov     eax, ecx
                mov     byte ptr [esi], 0
                sub     eax, ecx
                neg     eax
                sbb     eax, eax
                and     eax, ecx
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D5571:                             ; CODE XREF: __getpath+24↑j
                cmp     byte ptr [ecx], 3Bh ; ';'
                jnz     short loc_5D5591

loc_5D5576:                             ; CODE XREF: __getpath+7D↓j
                mov     dl, [ecx+1]
                inc     ecx
                cmp     dl, 3Bh ; ';'
                jz      short loc_5D5576
                sub     eax, ecx
                mov     byte ptr [esi], 0
                neg     eax
                sbb     eax, eax
                and     eax, ecx
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D558D:                             ; CODE XREF: __getpath+1A↑j
                mov     esi, [esp+8+arg_4]

loc_5D5591:                             ; CODE XREF: __getpath+74↑j
                sub     eax, ecx
                mov     byte ptr [esi], 0
                neg     eax
                sbb     eax, eax
                pop     edi
                and     eax, ecx
                pop     esi
                retn
__getpath       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; intptr_t __cdecl _spawnve(int Mode, const char *FileName, const char *const *Arguments, const char *const *Environment)
__spawnve       proc near               ; CODE XREF: __spawnvpe+1B↑p

var_C           = dword ptr -0Ch
var_8           = dword ptr -8
var_4           = dword ptr -4
Mode            = dword ptr  4
Block           = dword ptr  8
Arguments       = dword ptr  0Ch
Environment     = dword ptr  10h

                sub     esp, 0Ch
                push    ebx
                push    ebp
                mov     ebp, [esp+14h+Block]
                push    esi
                push    edi
                mov     ebx, ebp
                push    5Ch ; '\'       ; C
                push    ebp             ; String
                mov     [esp+24h+var_C], ebx
                call    __mbsrchr
                add     esp, 8
                mov     esi, eax
                push    2Fh ; '/'       ; C
                push    ebp             ; String
                call    __mbsrchr
                add     esp, 8
                test    eax, eax
                jnz     loc_5D5659
                test    esi, esi
                jnz     loc_5D5663
                push    3Ah ; ':'       ; C
                push    ebp             ; varStr
                call    __mbschr
                mov     esi, eax
                add     esp, 8
                test    esi, esi
                jnz     short loc_5D5663
                mov     edi, ebp
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                add     ecx, 2
                push    ecx             ; varSize
                call    _malloc
                mov     edx, eax
                add     esp, 4
                test    edx, edx
                mov     [esp+1Ch+var_C], edx
                jnz     short loc_5D5614
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 0Ch
                retn
; ---------------------------------------------------------------------------

loc_5D5614:                             ; CODE XREF: __spawnve+67↑j
                mov     cx, ds:word_615218
                mov     eax, edx
                mov     edi, ebp
                mov     [eax], cx
                mov     cl, ds:byte_61521A
                mov     [eax+2], cl
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     esi, edi
                mov     ebx, ecx
                mov     edi, edx
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     ecx, ebx
                dec     edi
                shr     ecx, 2
                rep movsd
                mov     ecx, ebx
                mov     ebx, dword ptr [esp+1Ch+var_C]
                and     ecx, 3
                rep movsb
                lea     esi, [edx+2]
                jmp     short loc_5D5663
; ---------------------------------------------------------------------------

loc_5D5659:                             ; CODE XREF: __spawnve+2B↑j
                test    esi, esi
                jz      short loc_5D5661
                cmp     eax, esi
                jbe     short loc_5D5663

loc_5D5661:                             ; CODE XREF: __spawnve+BB↑j
                mov     esi, eax

loc_5D5663:                             ; CODE XREF: __spawnve+33↑j
                push    2Eh ; '.'       ; C
                push    esi             ; String
                mov     [esp+24h+var_8], 0FFFFFFFFh
                call    __mbsrchr
                add     esp, 8
                test    eax, eax
                jz      short loc_5D56AF
                push    0               ; AccessMode
                push    ebx             ; FileName
                call    __access
                add     esp, 8
                cmp     eax, 0FFFFFFFFh
                jz      loc_5D577C
                mov     edx, dword ptr [esp+1Ch+Environment]
                mov     eax, dword ptr [esp+1Ch+Arguments]
                mov     ecx, dword ptr [esp+1Ch+Mode]
                push    edx             ; lpEnvironment
                push    eax             ; int
                push    ebx             ; Block
                push    ecx             ; int
                call    _comexecmd
                add     esp, 10h
                mov     [esp+1Ch+var_8], eax
                jmp     loc_5D577C
; ---------------------------------------------------------------------------

loc_5D56AF:                             ; CODE XREF: __spawnve+D8↑j
                mov     edi, ebx
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                add     ecx, 4
                push    ecx             ; varSize
                call    _malloc
                mov     ebp, eax
                add     esp, 4
                test    ebp, ebp
                jnz     short loc_5D56D7
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 0Ch
                retn
; ---------------------------------------------------------------------------

loc_5D56D7:                             ; CODE XREF: __spawnve+12A↑j
                mov     edi, ebx
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     edx, ecx
                mov     esi, edi
                mov     edi, ebp
                shr     ecx, 2
                rep movsd
                mov     ecx, edx
                and     ecx, 3
                rep movsb
                mov     edi, ebx
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                mov     ebx, offset off_642684 ; ".com"
                mov     edx, ecx
                add     edx, ebp
                mov     [esp+1Ch+var_4], edx
                jmp     short loc_5D5713
; ---------------------------------------------------------------------------

loc_5D570F:                             ; CODE XREF: __spawnve+1AB↓j
                mov     edx, dword ptr [esp+1Ch+var_4]

loc_5D5713:                             ; CODE XREF: __spawnve+16D↑j
                mov     edi, [ebx]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                push    0               ; AccessMode
                repne scasb
                not     ecx
                sub     edi, ecx
                push    ebp             ; FileName
                mov     eax, ecx
                mov     esi, edi
                mov     edi, edx
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                and     ecx, 3
                rep movsb
                call    __access
                add     esp, 8
                cmp     eax, 0FFFFFFFFh
                jnz     short loc_5D574F
                sub     ebx, 4
                cmp     ebx, offset off_642678 ; ".cmd"
                jge     short loc_5D570F
                jmp     short loc_5D576B
; ---------------------------------------------------------------------------

loc_5D574F:                             ; CODE XREF: __spawnve+1A0↑j
                mov     ecx, dword ptr [esp+1Ch+Environment]
                mov     edx, dword ptr [esp+1Ch+Arguments]
                mov     eax, dword ptr [esp+1Ch+Mode]
                push    ecx             ; lpEnvironment
                push    edx             ; int
                push    ebp             ; Block
                push    eax             ; int
                call    _comexecmd
                add     esp, 10h
                mov     [esp+1Ch+var_8], eax

loc_5D576B:                             ; CODE XREF: __spawnve+1AD↑j
                push    ebp             ; Block
                call    _free
                mov     ebx, dword ptr [esp+20h+var_C]
                mov     ebp, [esp+20h+Block]
                add     esp, 4

loc_5D577C:                             ; CODE XREF: __spawnve+E8↑j
                cmp     ebx, ebp
                jz      short loc_5D5789
                push    ebx             ; Block
                call    _free
                add     esp, 4

loc_5D5789:                             ; CODE XREF: __spawnve+1DE↑j
                mov     eax, dword ptr [esp+1Ch+var_8]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 0Ch
                retn
__spawnve       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl comexecmd(int, void *Block, int, void *lpEnvironment)
_comexecmd      proc near               ; CODE XREF: __spawnve+FE↑p

arg_0           = dword ptr  4
Block           = dword ptr  8
arg_8           = dword ptr  0Ch
lpEnvironment   = dword ptr  10h

                mov     edx, dword ptr [esp+lpEnvironment]
                push    esi
                mov     esi, [esp+4+Block]
                lea     eax, [esp+4+lpEnvironment]
                push    esi
                lea     ecx, [esp+8+Block]
                push    eax
                mov     eax, dword ptr [esp+0Ch+arg_8]
                push    ecx
                push    edx
                push    eax
                call    __cenvarg
                add     esp, 14h
                cmp     eax, 0FFFFFFFFh
                jnz     short loc_5D57CB
                or      eax, eax
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D57CB:                             ; CODE XREF: _comexecmd+25↑j
                mov     ecx, dword ptr [esp+4+lpEnvironment]
                mov     edx, dword ptr [esp+4+Block]
                mov     eax, dword ptr [esp+4+arg_0]
                push    ecx             ; lpEnvironment
                push    edx             ; ExitCode
                push    esi             ; lpApplicationName
                push    eax             ; int
                call    __dospawn
                mov     ecx, dword ptr [esp+14h+Block]
                add     esp, 10h
                mov     esi, eax
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esp+8+lpEnvironment]
                add     esp, 4
                push    edx             ; Block
                call    _free
                add     esp, 4
                mov     eax, esi
                pop     esi
                retn
_comexecmd      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _mbsnbicoll(const unsigned __int8 *Str1, const unsigned __int8 *Str2, size_t MaxCount)
__mbsnbicoll    proc near               ; CODE XREF: __getenv_lk+5F↑p

Str1            = dword ptr  4
Str2            = dword ptr  8
MaxCount        = dword ptr  0Ch

                mov     eax, dword ptr [esp+MaxCount]
                test    eax, eax
                jnz     short loc_5D5819
                retn
; ---------------------------------------------------------------------------

loc_5D5819:                             ; CODE XREF: __mbsnbicoll+6↑j
                mov     ecx, dword_70D4BC
                mov     edx, dword ptr [esp+Str2]
                push    ecx             ; CodePage
                mov     ecx, Locale
                push    eax             ; cchCount2
                push    edx             ; lpString2
                push    eax             ; PCNZWCH
                mov     eax, dword ptr [esp+10h+Str1]
                push    eax             ; lpString1
                push    1               ; dwCmpFlags
                push    ecx             ; Locale
                call    ___crtCompareStringA
                add     esp, 1Ch
                test    eax, eax
                jnz     short loc_5D5847
                mov     eax, 7FFFFFFFh
                retn
; ---------------------------------------------------------------------------

loc_5D5847:                             ; CODE XREF: __mbsnbicoll+2F↑j
                add     eax, 0FFFFFFFEh
                retn
__mbsnbicoll    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

___wtomb_environ proc near              ; CODE XREF: __getenv_lk+17↑p
                push    ebx
                mov     ebx, dword_70D350
                push    ebp
                push    esi
                mov     eax, dword ptr [ebx]
                push    edi
                test    eax, eax
                jz      short loc_5D58C3
                mov     ebp, ds:WideCharToMultiByte

loc_5D5866:                             ; CODE XREF: ___wtomb_environ+64↓j
                push    0               ; lpUsedDefaultChar
                push    0               ; lpDefaultChar
                push    0               ; cbMultiByte
                push    0               ; lpMultiByteStr
                push    0FFFFFFFFh      ; cchWideChar
                push    eax             ; lpWideCharStr
                push    0               ; dwFlags
                push    1               ; CodePage
                call    ebp ; WideCharToMultiByte
                mov     esi, eax
                test    esi, esi
                jz      short loc_5D58BB
                push    esi             ; varSize
                call    _malloc
                mov     edi, eax
                add     esp, 4
                test    edi, edi
                jz      short loc_5D58BB
                mov     eax, dword ptr [ebx]
                push    0               ; lpUsedDefaultChar
                push    0               ; lpDefaultChar
                push    esi             ; cbMultiByte
                push    edi             ; lpMultiByteStr
                push    0FFFFFFFFh      ; cchWideChar
                push    eax             ; lpWideCharStr
                push    0               ; dwFlags
                push    1               ; CodePage
                call    ebp ; WideCharToMultiByte
                test    eax, eax
                jz      short loc_5D58BB
                push    0               ; int
                push    edi             ; varStr
                call    ___crtsetenv
                mov     eax, dword ptr [ebx+4]
                add     ebx, 4
                add     esp, 8
                test    eax, eax
                jnz     short loc_5D5866
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D58BB:                             ; CODE XREF: ___wtomb_environ+2B↑j
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D58C3:                             ; CODE XREF: ___wtomb_environ+E↑j
                pop     edi
                pop     esi
                pop     ebp
                xor     eax, eax
                pop     ebx
                retn
___wtomb_environ endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _setmode(int FileHandle, int Mode)
__setmode       proc near               ; CODE XREF: filebuf::setmode(int)+4B↓p

FileHandle      = dword ptr  4
Mode            = dword ptr  8

                mov     eax, uNumber
                push    esi
                mov     esi, [esp+4+FileHandle]
                push    edi
                cmp     esi, eax
                jnb     short loc_5D5921
                mov     eax, esi
                mov     ecx, esi
                and     eax, 1Fh
                sar     ecx, 5
                lea     edx, [eax+eax*8]
                mov     eax, __pioinfo[ecx*4]
                test    byte ptr [eax+edx*4+4], 1
                jz      short loc_5D5921
                push    esi
                call    __lock_fhandle
                mov     ecx, dword ptr [esp+0Ch+Mode]
                add     esp, 4
                push    ecx
                push    esi
                call    __setmode_lk
                add     esp, 8
                mov     edi, eax
                push    esi
                call    __unlock_fhandle
                add     esp, 4
                mov     eax, edi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D5921:                             ; CODE XREF: __setmode+D↑j
                call    __errno
                mov     dword ptr [eax], 9
                pop     edi
                or      eax, 0FFFFFFFFh
                pop     esi
                retn
__setmode       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__setmode_lk    proc near               ; CODE XREF: __chsize_lk+6D↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     eax, dword ptr [esp+arg_0]
                push    esi
                mov     ecx, eax
                and     eax, 1Fh
                sar     ecx, 5
                lea     edx, [eax+eax*8]
                mov     esi, [esp+4+arg_4]
                mov     eax, __pioinfo[ecx*4]
                mov     cl, [eax+edx*4+4]
                lea     edx, [eax+edx*4+4]
                mov     al, cl
                and     eax, 80h
                cmp     esi, 8000h
                jnz     short loc_5D5977
                and     cl, 7Fh
                jmp     short loc_5D5982
; ---------------------------------------------------------------------------

loc_5D5977:                             ; CODE XREF: __setmode_lk+30↑j
                cmp     esi, 4000h
                jnz     short loc_5D5994
                or      cl, 80h

loc_5D5982:                             ; CODE XREF: __setmode_lk+35↑j
                neg     eax
                sbb     eax, eax
                mov     [edx], cl
                and     eax, 0FFFFC000h
                add     eax, 8000h
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D5994:                             ; CODE XREF: __setmode_lk+3D↑j
                call    __errno
                mov     dword ptr [eax], 16h
                or      eax, 0FFFFFFFFh
                pop     esi
                retn
__setmode_lk    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; wint_t __cdecl towupper(wint_t C)
_towupper       proc near               ; CODE XREF: _wcstoxl+F1↑p

varC               = word ptr  4

                mov     eax, dword_70D558
                test    eax, eax
                jnz     short loc_5D59CF
                mov     eax, dword ptr [esp+varC]
                cmp     ax, 61h ; 'a'
                jb      short locret_5D5A37
                cmp     ax, 7Ah ; 'z'
                ja      short locret_5D5A37
                add     eax, 0FFE0h
                retn
; ---------------------------------------------------------------------------

loc_5D59CF:                             ; CODE XREF: _towupper+7↑j
                push    edi
                push    esi
                push    ebx
                push    offset Addend   ; lpAddend
                call    InterlockedIncrement
                mov     eax, dword_70E964
                mov     edi, ds:InterlockedDecrement
                test    eax, eax
                jz      short loc_5D5A04
                push    offset Addend   ; lpAddend
                call    edi ; InterlockedDecrement
                push    13h
                call    __lock
                add     esp, 4
                mov     esi, 1
                jmp     short loc_5D5A06
; ---------------------------------------------------------------------------

loc_5D5A04:                             ; CODE XREF: _towupper+3A↑j
                xor     esi, esi

loc_5D5A06:                             ; CODE XREF: _towupper+52↑j
                mov     eax, dword ptr [esp+0Ch+varC]
                push    eax             ; C
                call    _towupper_0
                add     esp, 4
                mov     ebx, eax
                test    esi, esi
                jz      short loc_5D5A2A
                push    13h
                call    __unlock
                add     esp, 4
                mov     ax, bx
                pop     ebx
                pop     esi
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_5D5A2A:                             ; CODE XREF: _towupper+67↑j
                push    offset Addend   ; lpAddend
                call    edi ; InterlockedDecrement
                mov     ax, bx
                pop     ebx
                pop     esi
                pop     edi

locret_5D5A37:                          ; CODE XREF: _towupper+11↑j
                retn
_towupper       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; wint_t __cdecl towupper_0(wint_t C)
_towupper_0     proc near               ; CODE XREF: _towupper+5B↑p

DestStr         = word ptr -2
varC               = word ptr  4

                push    ecx
                mov     eax, dword ptr [esp+4+varC]
                cmp     ax, 0FFFFh
                jnz     short loc_5D5A50
                or      ax, ax
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D5A50:                             ; CODE XREF: _towupper_0+9↑j
                mov     ecx, dword_70D558
                test    ecx, ecx
                jnz     short loc_5D5A6D
                cmp     ax, 61h ; 'a'
                jb      short loc_5D5ABB
                cmp     ax, 7Ah ; 'z'
                ja      short loc_5D5ABB
                add     eax, 0FFE0h
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D5A6D:                             ; CODE XREF: _towupper_0+18↑j
                cmp     ax, 100h
                jnb     short loc_5D5A89
                push    2               ; Type
                push    eax             ; C
                call    _iswctype
                add     esp, 8
                test    eax, eax
                jnz     short loc_5D5A89
                mov     ax, [esp+4+varC]
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D5A89:                             ; CODE XREF: _towupper_0+31↑j
                mov     edx, dword_70D558
                push    0               ; CodePage
                lea     eax, [esp+8+DestStr]
                push    1               ; cchDest
                push    eax             ; lpDestStr
                lea     ecx, [esp+10h+varC]
                push    1               ; Source
                push    ecx             ; lpSrcStr
                push    200h            ; dwMapFlags
                push    edx             ; Locale
                call    ___crtLCMapStringW
                add     esp, 1Ch
                test    eax, eax
                mov     ax, [esp+4+varC]
                jz      short loc_5D5ABB
                mov     ax, [esp+4+DestStr]

loc_5D5ABB:                             ; CODE XREF: _towupper_0+1E↑j
                pop     ecx
                retn
_towupper_0     endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl iswctype(wint_t C, wctype_t Type)
_iswctype       proc near               ; CODE XREF: _wcstoxl+13↑p

CharType        = word ptr -4
varC               = word ptr  4
varType            = word ptr  8

                push    ecx
                mov     eax, dword ptr [esp+4+varC]
                cmp     ax, 0FFFFh
                jz      short loc_5D5B20
                cmp     ax, 100h
                jnb     short loc_5D5AE2
                mov     ecx, off_64126C
                and     eax, 0FFFFh
                mov     cx, [ecx+eax*2]
                jmp     short loc_5D5B0D
; ---------------------------------------------------------------------------

loc_5D5AE2:                             ; CODE XREF: _iswctype+F↑j
                mov     eax, dword_70D558
                test    eax, eax
                jz      short loc_5D5B20
                push    0               ; Locale
                lea     edx, [esp+8+CharType]
                push    0               ; CodePage
                push    edx             ; lpCharType
                lea     eax, [esp+10h+varC]
                push    1               ; cchSrc
                push    eax             ; lpSrcStr
                push    1               ; dwInfoType
                call    ___crtGetStringTypeW
                add     esp, 18h
                test    eax, eax
                jz      short loc_5D5B20
                mov     ecx, dword ptr [esp+4+CharType]

loc_5D5B0D:                             ; CODE XREF: _iswctype+20↑j
                mov     eax, dword ptr [esp+4+varType]
                and     ecx, 0FFFFh
                and     eax, 0FFFFh
                and     eax, ecx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D5B20:                             ; CODE XREF: _iswctype+9↑j
                xor     eax, eax
                pop     ecx
                retn
_iswctype       endp

; ---------------------------------------------------------------------------
                align 10h
                mov     eax, dword ptr [esp+8]
                mov     ecx, dword ptr [esp+4]
                push    eax
                push    ecx
                call    _iswctype
                add     esp, 8
                retn
; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _access(const char *FileName, int AccessMode)
__access        proc near               ; CODE XREF: __spawnve+DD↑p

lpFileName      = dword ptr  4
AccessMode      = dword ptr  8

                mov     eax, dword ptr [esp+lpFileName]
                push    eax             ; lpFileName
                call    GetFileAttributesA
                cmp     eax, 0FFFFFFFFh
                jnz     short loc_5D5B73
                call    GetLastError
                push    eax
                call    __dosmaperr
                add     esp, 4
                or      eax, 0FFFFFFFFh
                retn
; ---------------------------------------------------------------------------

loc_5D5B73:                             ; CODE XREF: __access+E↑j
                test    al, 1
                jz      short loc_5D5B98
                test    byte ptr [esp+AccessMode], 2
                jz      short loc_5D5B98
                call    __errno
                mov     dword ptr [eax], 0Dh
                call    ___doserrno
                mov     dword ptr [eax], 5
                or      eax, 0FFFFFFFFh
                retn
; ---------------------------------------------------------------------------

loc_5D5B98:                             ; CODE XREF: __access+25↑j
                xor     eax, eax
                retn
__access        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl _dospawn(int, LPCSTR lpApplicationName, DWORD ExitCode, LPVOID lpEnvironment)
__dospawn       proc near               ; CODE XREF: _comexecmd+3B↑p

var_59          = byte ptr -59h
lpCommandLine   = dword ptr -58h
ProcessInformation= _PROCESS_INFORMATION ptr -54h
StartupInfo     = _STARTUPINFOA ptr -44h
arg_0           = dword ptr  4
lpApplicationName= dword ptr  8
ExitCode        = dword ptr  0Ch
lpEnvironment   = dword ptr  10h

                sub     esp, 5Ch
                mov     eax, dword ptr [esp+5Ch+arg_0]
                push    ebx
                push    ebp
                xor     ebx, ebx
                push    esi
                cmp     eax, 4          ; switch 5 cases
                push    edi
                mov     [esp+6Ch+var_59], bl
                ja      def_5D5BBA      ; jumptable 005D5BBA default case
                jmp     ds:jpt_5D5BBA[eax*4] ; switch jump
; ---------------------------------------------------------------------------

loc_5D5BC1:                             ; CODE XREF: __dospawn+1A↑j
                mov     [esp+6Ch+var_59], 1 ; jumptable 005D5BBA case 4

loc_5D5BC6:                             ; CODE XREF: __dospawn+1A↑j
                mov     eax, dword ptr [esp+6Ch+ExitCode] ; jumptable 005D5BBA cases 0-3
                mov     [esp+6Ch+lpCommandLine], eax
                mov     cl, [eax]
                test    cl, cl
                jz      short loc_5D5BED

loc_5D5BD4:                             ; CODE XREF: __dospawn+3A↓j
                mov     cl, [eax+1]
                inc     eax
                test    cl, cl
                jnz     short loc_5D5BD4
                mov     cl, [eax+1]
                test    cl, cl
                jz      short loc_5D5BE7
                mov     byte ptr [eax], 20h ; ' '
                inc     eax

loc_5D5BE7:                             ; CODE XREF: __dospawn+41↑j
                mov     cl, [eax]
                test    cl, cl
                jnz     short loc_5D5BD4

loc_5D5BED:                             ; CODE XREF: __dospawn+32↑j
                mov     esi, uNumber
                mov     ecx, 11h
                xor     eax, eax
                lea     edi, [esp+6Ch+StartupInfo]
                rep stosd
                test    esi, esi
                mov     [esp+6Ch+StartupInfo.cb], 44h ; 'D'
                jz      short loc_5D5C30

loc_5D5C0C:                             ; CODE XREF: __dospawn+8E↓j
                lea     ecx, [esi-1]
                mov     edx, ecx
                mov     eax, ecx
                sar     edx, 5
                and     eax, 1Fh
                mov     edx, __pioinfo[edx*4]
                lea     eax, [eax+eax*8]
                cmp     byte ptr [edx+eax*4+4], 0
                jnz     short loc_5D5C30
                mov     esi, ecx
                test    esi, esi
                jnz     short loc_5D5C0C

loc_5D5C30:                             ; CODE XREF: __dospawn+6A↑j
                lea     eax, [esi+esi*4+4]
                push    1               ; varSize
                mov     [esp+70h+StartupInfo.cbReserved2], ax
                mov     ecx, dword ptr [esp+70h+StartupInfo.cbReserved2]
                and     ecx, 0FFFFh
                push    ecx             ; Count
                call    _calloc
                mov     [esp+74h+StartupInfo.lpReserved2], eax
                mov     [eax], esi
                mov     edx, dword ptr [esp+74h+StartupInfo.lpReserved2]
                add     esp, 8
                xor     ecx, ecx
                test    esi, esi
                lea     edi, [edx+4]
                lea     ebp, [esi+edx+4]
                jle     short loc_5D5CA4

loc_5D5C65:                             ; CODE XREF: __dospawn+FE↓j
                mov     edx, ecx
                mov     eax, ecx
                sar     edx, 5
                and     eax, 1Fh
                mov     edx, __pioinfo[edx*4]
                lea     eax, [eax+eax*8]
                lea     eax, [edx+eax*4]
                mov     dl, [eax+4]
                test    dl, 10h
                jnz     short loc_5D5C8D
                mov     [edi], dl
                mov     eax, dword ptr [eax]
                mov     [ebp+0], eax
                jmp     short loc_5D5C97
; ---------------------------------------------------------------------------

loc_5D5C8D:                             ; CODE XREF: __dospawn+E2↑j
                mov     byte ptr [edi], 0
                mov     dword ptr [ebp+0], 0FFFFFFFFh

loc_5D5C97:                             ; CODE XREF: __dospawn+EB↑j
                inc     ecx
                inc     edi
                add     ebp, 4
                cmp     ecx, esi
                jl      short loc_5D5C65
                mov     edx, dword ptr [esp+6Ch+StartupInfo.lpReserved2]

loc_5D5CA4:                             ; CODE XREF: __dospawn+C3↑j
                mov     al, [esp+6Ch+var_59]
                test    al, al
                jz      short loc_5D5CDA
                xor     edi, edi
                lea     eax, [edx+4]
                lea     ecx, [esi+edx+4]

loc_5D5CB5:                             ; CODE XREF: __dospawn+133↓j
                cmp     esi, 3
                mov     edx, esi
                jl      short loc_5D5CC1
                mov     edx, 3

loc_5D5CC1:                             ; CODE XREF: __dospawn+11A↑j
                cmp     edi, edx
                jge     short loc_5D5CD5
                mov     byte ptr [eax], 0
                inc     edi
                mov     dword ptr [ecx], 0FFFFFFFFh
                inc     eax
                add     ecx, 4
                jmp     short loc_5D5CB5
; ---------------------------------------------------------------------------

loc_5D5CD5:                             ; CODE XREF: __dospawn+123↑j
                mov     ebx, 8

loc_5D5CDA:                             ; CODE XREF: __dospawn+10A↑j
                call    __errno
                mov     dword ptr [eax], 0
                call    ___doserrno
                lea     ecx, [esp+6Ch+ProcessInformation]
                lea     edx, [esp+6Ch+StartupInfo]
                mov     dword ptr [eax], 0
                mov     eax, dword ptr [esp+6Ch+lpEnvironment]
                push    ecx             ; lpProcessInformation
                mov     ecx, dword ptr [esp+70h+lpCommandLine]
                push    edx             ; lpStartupInfo
                mov     edx, dword ptr [esp+74h+lpApplicationName]
                push    0               ; lpCurrentDirectory
                push    eax             ; lpEnvironment
                push    ebx             ; dwCreationFlags
                push    1               ; bInheritHandles
                push    0               ; lpThreadAttributes
                push    0               ; lpProcessAttributes
                push    ecx             ; lpCommandLine
                push    edx             ; lpApplicationName
                call    CreateProcessA
                mov     esi, eax
                call    GetLastError
                mov     edi, eax
                mov     eax, dword ptr [esp+6Ch+StartupInfo.lpReserved2]
                push    eax             ; Block
                call    _free
                add     esp, 4
                test    esi, esi
                jnz     short loc_5D5D47
                push    edi
                call    __dosmaperr
                add     esp, 4
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 5Ch
                retn
; ---------------------------------------------------------------------------

loc_5D5D47:                             ; CODE XREF: __dospawn+191↑j
                mov     eax, dword ptr [esp+6Ch+arg_0]
                mov     esi, ds:CloseHandle
                cmp     eax, 2
                jnz     short loc_5D5D73
                push    0               ; Code
                call    __exit
; ---------------------------------------------------------------------------
                mov     ecx, dword ptr [esp+70h+ProcessInformation.hThread]
                add     esp, 4
                push    ecx             ; hObject
                call    esi ; CloseHandle
                mov     eax, dword ptr [esp+6Ch+ExitCode]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 5Ch
                retn
; ---------------------------------------------------------------------------

loc_5D5D73:                             ; CODE XREF: __dospawn+1B4↑j
                test    eax, eax
                jnz     short loc_5D5DAE
                mov     ecx, dword ptr [esp+6Ch+ProcessInformation.hProcess]
                push    0FFFFFFFFh      ; dwMilliseconds
                push    ecx             ; hHandle
                call    WaitForSingleObject
                mov     eax, dword ptr [esp+6Ch+ProcessInformation.hProcess]
                lea     edx, [esp+6Ch+ExitCode]
                push    edx             ; lpExitCode
                push    eax             ; hProcess
                call    GetExitCodeProcess
                mov     ecx, dword ptr [esp+6Ch+ProcessInformation.hProcess]
                push    ecx             ; hObject
                call    esi ; CloseHandle
                mov     ecx, dword ptr [esp+6Ch+ProcessInformation.hThread]
                push    ecx             ; hObject
                call    esi ; CloseHandle
                mov     eax, dword ptr [esp+6Ch+ExitCode]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 5Ch
                retn
; ---------------------------------------------------------------------------

loc_5D5DAE:                             ; CODE XREF: __dospawn+1D5↑j
                cmp     eax, 4
                jnz     short loc_5D5DD5
                mov     edx, dword ptr [esp+6Ch+ProcessInformation.hProcess]
                push    edx             ; hObject
                call    esi ; CloseHandle
                mov     ecx, dword ptr [esp+6Ch+ProcessInformation.hThread]
                mov     [esp+6Ch+ExitCode], 0
                push    ecx             ; hObject
                call    esi ; CloseHandle
                mov     eax, dword ptr [esp+6Ch+ExitCode]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 5Ch
                retn
; ---------------------------------------------------------------------------

loc_5D5DD5:                             ; CODE XREF: __dospawn+211↑j
                mov     ecx, dword ptr [esp+6Ch+ProcessInformation.hThread]
                mov     eax, dword ptr [esp+6Ch+ProcessInformation.hProcess]
                push    ecx             ; hObject
                mov     [esp+70h+ExitCode], eax
                call    esi ; CloseHandle
                mov     eax, dword ptr [esp+6Ch+ExitCode]
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 5Ch
                retn
; ---------------------------------------------------------------------------

def_5D5BBA:                             ; CODE XREF: __dospawn+14↑j
                call    __errno         ; jumptable 005D5BBA default case
                mov     dword ptr [eax], 16h
                call    ___doserrno
                pop     edi
                pop     esi
                mov     dword ptr [eax], 0
                pop     ebp
                or      eax, 0FFFFFFFFh
                pop     ebx
                add     esp, 5Ch
                retn
__dospawn       endp

; ---------------------------------------------------------------------------
                align 4
jpt_5D5BBA      dd offset loc_5D5BC6    ; DATA XREF: __dospawn+1A↑r
                dd offset loc_5D5BC6    ; jump table for switch statement
                dd offset loc_5D5BC6
                dd offset loc_5D5BC6
                dd offset loc_5D5BC1
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

__cenvarg       proc near               ; CODE XREF: _comexecmd+1A↑p

var_4           = dword ptr -4
arg_0           = dword ptr  4
arg_4           = dword ptr  8
arg_8           = dword ptr  0Ch
arg_C           = dword ptr  10h

                push    ecx
                push    ebx
                push    ebp
                mov     ebp, [esp+0Ch+arg_0]
                push    esi
                push    edi
                mov     edx, ebp
                mov     edi, [ebp+0]
                mov     esi, 2
                test    edi, edi
                jz      short loc_5D5E5E

loc_5D5E47:                             ; CODE XREF: __cenvarg+2C↓j
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                add     edx, 4
                repne scasb
                mov     edi, [edx]
                not     ecx
                dec     ecx
                test    edi, edi
                lea     esi, [esi+ecx+1]
                jnz     short loc_5D5E47

loc_5D5E5E:                             ; CODE XREF: __cenvarg+15↑j
                push    esi             ; varSize
                call    _malloc
                mov     ecx, dword ptr [esp+18h+arg_8]
                add     esp, 4
                test    eax, eax
                mov     [ecx], eax
                jnz     short loc_5D5E7C
                mov     edx, dword ptr [esp+14h+arg_C]
                mov     [edx], eax
                jmp     loc_5D5F7C
; ---------------------------------------------------------------------------

loc_5D5E7C:                             ; CODE XREF: __cenvarg+3F↑j
                mov     edx, dword ptr [esp+14h+arg_4]
                test    edx, edx
                jz      short loc_5D5EA6
                mov     edi, [edx]
                mov     esi, 2
                test    edi, edi
                jz      short loc_5D5EA6

loc_5D5E8F:                             ; CODE XREF: __cenvarg+74↓j
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                add     edx, 4
                repne scasb
                mov     edi, [edx]
                not     ecx
                dec     ecx
                test    edi, edi
                lea     esi, [esi+ecx+1]
                jnz     short loc_5D5E8F

loc_5D5EA6:                             ; CODE XREF: __cenvarg+52↑j
                mov     eax, dword ptr [esp+14h+arg_4]
                test    eax, eax
                jnz     short loc_5D5EC1
                mov     eax, dword ptr [esp+14h+arg_C]
                mov     ebx, dword ptr [esp+14h+arg_C]
                mov     dword ptr [eax], 0
                jmp     loc_5D5F9F
; ---------------------------------------------------------------------------

loc_5D5EC1:                             ; CODE XREF: __cenvarg+7C↑j
                mov     ebp, dword_70D36C
                test    ebp, ebp
                jnz     short loc_5D5EE5
                call    ___crtGetEnvironmentStringsA
                mov     ebp, eax
                test    ebp, ebp
                mov     dword_70D36C, ebp
                jnz     short loc_5D5EE5
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D5EE5:                             ; CODE XREF: __cenvarg+99↑j
                mov     al, [ebp+0]
                xor     edx, edx
                test    al, al
                mov     [esp+14h+var_4], edx
                jz      short loc_5D5F18
                mov     edi, ebp
                mov     al, [edi]

loc_5D5EF6:                             ; CODE XREF: __cenvarg+E6↓j
                cmp     al, 3Dh ; '='
                jz      short loc_5D5F18
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                dec     ecx
                lea     edi, [edx+ecx+1]
                mov     [esp+14h+var_4], edi
                add     edi, ebp
                mov     edx, dword ptr [esp+14h+var_4]
                mov     al, [edi]
                test    al, al
                jnz     short loc_5D5EF6

loc_5D5F18:                             ; CODE XREF: __cenvarg+C0↑j
                mov     al, [edx+ebp]
                mov     ebx, edx
                cmp     al, 3Dh ; '='
                jnz     short loc_5D5F4F

loc_5D5F21:                             ; CODE XREF: __cenvarg+11D↓j
                mov     al, [ebx+ebp+1]
                test    al, al
                jz      short loc_5D5F4F
                cmp     byte ptr [ebx+ebp+2], 3Ah ; ':'
                jnz     short loc_5D5F4F
                cmp     byte ptr [ebx+ebp+3], 3Dh ; '='
                jnz     short loc_5D5F4F
                lea     edi, [ebx+ebp+4]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                dec     ecx
                lea     ebx, [ebx+ecx+5]
                cmp     byte ptr [ebx+ebp], 3Dh ; '='
                jz      short loc_5D5F21

loc_5D5F4F:                             ; CODE XREF: __cenvarg+EF↑j
                lea     ecx, [ebx+esi]
                sub     ecx, edx
                push    ecx             ; varSize
                call    _malloc
                mov     edx, dword ptr [esp+18h+arg_C]
                add     esp, 4
                test    eax, eax
                mov     [edx], eax
                jnz     short loc_5D5F9B
                mov     esi, [esp+14h+arg_8]
                mov     eax, dword ptr [esi]
                push    eax             ; Block
                call    _free
                add     esp, 4
                mov     dword ptr [esi], 0

loc_5D5F7C:                             ; CODE XREF: __cenvarg+47↑j
                call    __errno
                mov     dword ptr [eax], 0Ch
                call    ___doserrno
                mov     dword ptr [eax], 8
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D5F9B:                             ; CODE XREF: __cenvarg+135↑j
                mov     ebp, [esp+14h+arg_0]

loc_5D5F9F:                             ; CODE XREF: __cenvarg+8C↑j
                mov     eax, dword ptr [esp+14h+arg_0]
                mov     ecx, dword ptr [esp+14h+arg_8]
                mov     edi, [eax]
                mov     edx, dword ptr [ecx]
                test    edi, edi
                jnz     short loc_5D5FB2
                inc     edx
                jmp     short loc_5D5FE6
; ---------------------------------------------------------------------------

loc_5D5FB2:                             ; CODE XREF: __cenvarg+17D↑j
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     eax, ecx
                mov     esi, edi
                mov     edi, edx
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                mov     eax, dword ptr [esp+14h+arg_0]
                and     ecx, 3
                rep movsb
                mov     edi, [eax]
                lea     ebp, [eax+4]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                dec     ecx
                lea     edx, [edx+ecx+1]

loc_5D5FE6:                             ; CODE XREF: __cenvarg+180↑j
                mov     edi, [ebp+0]
                test    edi, edi
                jz      short loc_5D6027

loc_5D5FED:                             ; CODE XREF: __cenvarg+1F5↓j
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                add     ebp, 4
                mov     eax, ecx
                mov     esi, edi
                mov     edi, edx
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                mov     edi, [ebp-4]
                or      ecx, 0FFFFFFFFh
                repne scasb
                not     ecx
                dec     ecx
                add     edx, ecx
                mov     byte ptr [edx], 20h ; ' '
                mov     edi, [ebp+0]
                inc     edx
                test    edi, edi
                jnz     short loc_5D5FED

loc_5D6027:                             ; CODE XREF: __cenvarg+1BB↑j
                mov     ecx, dword ptr [esp+14h+arg_C]
                mov     eax, dword ptr [esp+14h+arg_4]
                mov     byte ptr [edx-1], 0
                mov     byte ptr [edx], 0
                mov     edx, dword ptr [ecx]
                test    eax, eax
                jz      short loc_5D60A3
                mov     eax, dword ptr [esp+14h+var_4]
                mov     esi, dword_70D36C
                mov     ecx, ebx
                add     esi, eax
                sub     ecx, eax
                mov     edi, edx
                mov     eax, ecx
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                and     ecx, 3
                rep movsb
                sub     ebx, [esp+14h+var_4]
                add     edx, ebx
                mov     ebx, dword ptr [esp+14h+arg_4]
                mov     edi, [ebx]
                test    edi, edi
                jz      short loc_5D60A3

loc_5D606C:                             ; CODE XREF: __cenvarg+271↓j
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                add     ebx, 4
                mov     eax, ecx
                mov     esi, edi
                mov     edi, edx
                shr     ecx, 2
                rep movsd
                mov     ecx, eax
                xor     eax, eax
                and     ecx, 3
                rep movsb
                mov     edi, [ebx-4]
                or      ecx, 0FFFFFFFFh
                repne scasb
                mov     edi, [ebx]
                not     ecx
                dec     ecx
                test    edi, edi
                lea     edx, [edx+ecx+1]
                jnz     short loc_5D606C

loc_5D60A3:                             ; CODE XREF: __cenvarg+20A↑j
                test    edx, edx
                jz      short loc_5D60B6
                mov     ecx, dword ptr [esp+14h+arg_C]
                cmp     edx, [ecx]
                jnz     short loc_5D60B3
                mov     byte ptr [edx], 0
                inc     edx

loc_5D60B3:                             ; CODE XREF: __cenvarg+27D↑j
                mov     byte ptr [edx], 0

loc_5D60B6:                             ; CODE XREF: __cenvarg+275↑j
                mov     edx, dword_70D36C
                push    edx             ; Block
                call    _free
                add     esp, 4
                mov     dword_70D36C, 0
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
__cenvarg       endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __crtCompareStringW(LCID Locale, DWORD dwCmpFlags, PCNZWCH lpString1, void *Block, PCNZWCH lpString2, int cchCount2, UINT CodePage)
___crtCompareStringW proc near

Locale          = dword ptr  4
dwCmpFlags      = dword ptr  8
lpString1       = dword ptr  0Ch
Block           = dword ptr  10h
lpString2       = dword ptr  14h
cchCount2       = dword ptr  18h
CodePage        = dword ptr  1Ch

                mov     eax, dword_70D7EC
                push    ebx
                push    ebp
                push    esi
                push    edi
                mov     edi, ds:CompareStringW
                test    eax, eax
                jnz     short loc_5D6141
                push    1               ; cchCount2
                push    offset aString1  ; lpString2
                push    1               ; cchCount1
                push    offset aString1  ; lpString1
                push    0               ; dwCmpFlags
                push    0               ; Locale
                call    edi ; CompareStringW
                test    eax, eax
                jz      short loc_5D6117
                mov     dword_70D7EC, 1
                jmp     short loc_5D6141
; ---------------------------------------------------------------------------

loc_5D6117:                             ; CODE XREF: ___crtCompareStringW+29↑j
                push    1               ; cchCount2
                push    offset aString2  ; lpString2
                push    1               ; cchCount1
                push    offset aString2  ; lpString1
                push    0               ; dwCmpFlags
                push    0               ; Locale
                call    CompareStringA
                test    eax, eax
                jz      loc_5D6284
                mov     dword_70D7EC, 2

loc_5D6141:                             ; CODE XREF: ___crtCompareStringW+11↑j
                mov     esi, [esp+10h+Block]
                test    esi, esi
                jle     short loc_5D615B
                mov     ebx, dword ptr [esp+10h+lpString1]
                push    esi
                push    ebx
                call    _wcsncnt_1
                add     esp, 8
                mov     esi, eax
                jmp     short loc_5D615F
; ---------------------------------------------------------------------------

loc_5D615B:                             ; CODE XREF: ___crtCompareStringW+67↑j
                mov     ebx, dword ptr [esp+10h+lpString1]

loc_5D615F:                             ; CODE XREF: ___crtCompareStringW+79↑j
                mov     eax, dword ptr [esp+10h+cchCount2]
                test    eax, eax
                jle     short loc_5D6179
                push    eax
                mov     eax, dword ptr [esp+14h+lpString2]
                push    eax
                call    _wcsncnt_1
                add     esp, 8
                mov     [esp+10h+cchCount2], eax

loc_5D6179:                             ; CODE XREF: ___crtCompareStringW+85↑j
                test    esi, esi
                jz      loc_5D62C2
                test    eax, eax
                jz      loc_5D62C2
                mov     ecx, dword_70D7EC
                cmp     ecx, 1
                jnz     short loc_5D61AD
                mov     ecx, dword ptr [esp+10h+lpString2]
                mov     edx, dword ptr [esp+10h+dwCmpFlags]
                push    eax             ; cchCount2
                mov     eax, dword ptr [esp+14h+Locale]
                push    ecx             ; lpString2
                push    esi             ; cchCount1
                push    ebx             ; lpString1
                push    edx             ; dwCmpFlags
                push    eax             ; Locale
                call    edi ; CompareStringW
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D61AD:                             ; CODE XREF: ___crtCompareStringW+B2↑j
                cmp     ecx, 2
                jnz     loc_5D62DD
                mov     edi, [esp+10h+CodePage]
                mov     [esp+10h+Block], 0
                test    edi, edi
                jnz     short loc_5D61CC
                mov     edi, CodePage

loc_5D61CC:                             ; CODE XREF: ___crtCompareStringW+E4↑j
                push    0               ; lpUsedDefaultChar
                push    0               ; lpDefaultChar
                push    0               ; cbMultiByte
                push    0               ; lpMultiByteStr
                push    esi             ; cchWideChar
                push    ebx             ; lpWideCharStr
                mov     ebx, ds:WideCharToMultiByte
                push    220h            ; dwFlags
                push    edi             ; CodePage
                call    ebx ; WideCharToMultiByte
                mov     ebp, eax
                test    ebp, ebp
                jnz     short loc_5D61EF
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D61EF:                             ; CODE XREF: ___crtCompareStringW+108↑j
                push    ebp             ; varSize
                call    _malloc
                add     esp, 4
                mov     [esp+10h+CodePage], eax
                test    eax, eax
                jnz     short loc_5D6205
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D6205:                             ; CODE XREF: ___crtCompareStringW+11E↑j
                mov     ecx, dword ptr [esp+10h+lpString1]
                push    0               ; lpUsedDefaultChar
                push    0               ; lpDefaultChar
                push    ebp             ; cbMultiByte
                push    eax             ; lpMultiByteStr
                push    esi             ; cchWideChar
                push    ecx             ; lpWideCharStr
                push    220h            ; dwFlags
                push    edi             ; CodePage
                call    ebx ; WideCharToMultiByte
                test    eax, eax
                jz      short loc_5D626A
                mov     edx, dword ptr [esp+10h+cchCount2]
                mov     eax, dword ptr [esp+10h+lpString2]
                push    0               ; lpUsedDefaultChar
                push    0               ; lpDefaultChar
                push    0               ; cbMultiByte
                push    0               ; lpMultiByteStr
                push    edx             ; cchWideChar
                push    eax             ; lpWideCharStr
                push    220h            ; dwFlags
                push    edi             ; CodePage
                call    ebx ; WideCharToMultiByte
                mov     esi, eax
                test    esi, esi
                jz      short loc_5D626A
                push    esi             ; varSize
                call    _malloc
                add     esp, 4
                mov     [esp+10h+Block], eax
                test    eax, eax
                jz      short loc_5D626A
                mov     ecx, dword ptr [esp+10h+cchCount2]
                mov     edx, dword ptr [esp+10h+lpString2]
                push    0               ; lpUsedDefaultChar
                push    0               ; lpDefaultChar
                push    esi             ; cbMultiByte
                push    eax             ; lpMultiByteStr
                push    ecx             ; cchWideChar
                push    edx             ; lpWideCharStr
                push    220h            ; dwFlags
                push    edi             ; CodePage
                call    ebx ; WideCharToMultiByte
                test    eax, eax
                jnz     short loc_5D628B

loc_5D626A:                             ; CODE XREF: ___crtCompareStringW+13B↑j
                mov     eax, dword ptr [esp+10h+CodePage]
                push    eax             ; Block
                call    _free
                mov     ecx, dword ptr [esp+14h+Block]
                add     esp, 4
                push    ecx             ; Block
                call    _free
                add     esp, 4

loc_5D6284:                             ; CODE XREF: ___crtCompareStringW+51↑j
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D628B:                             ; CODE XREF: ___crtCompareStringW+188↑j
                mov     edi, [esp+10h+Block]
                mov     ebx, dword ptr [esp+10h+CodePage]
                mov     edx, dword ptr [esp+10h+dwCmpFlags]
                mov     eax, dword ptr [esp+10h+Locale]
                push    esi             ; cchCount2
                push    edi             ; lpString2
                push    ebp             ; cchCount1
                push    ebx             ; lpString1
                push    edx             ; dwCmpFlags
                push    eax             ; Locale
                call    CompareStringA
                push    ebx             ; Block
                mov     esi, eax
                call    _free
                add     esp, 4
                push    edi             ; Block
                call    _free
                add     esp, 4
                mov     eax, esi
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D62C2:                             ; CODE XREF: ___crtCompareStringW+9B↑j
                sub     esi, eax
                jnz     short loc_5D62D0
                mov     eax, 2
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D62D0:                             ; CODE XREF: ___crtCompareStringW+1E4↑j
                xor     eax, eax
                test    esi, esi
                setnl   al
                dec     eax
                and     al, 0FEh
                add     eax, 3

loc_5D62DD:                             ; CODE XREF: ___crtCompareStringW+D0↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                retn
___crtCompareStringW endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_wcsncnt_1      proc near               ; CODE XREF: ___crtCompareStringW+6F↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     edx, dword ptr [esp+arg_4]
                push    esi
                mov     esi, [esp+4+arg_0]
                push    edi
                test    edx, edx
                mov     eax, esi
                lea     ecx, [edx-1]
                jz      short loc_5D6313

loc_5D6303:                             ; CODE XREF: _wcsncnt_1+21↓j
                cmp     word ptr [eax], 0
                jz      short loc_5D6319
                add     eax, 2
                mov     edi, ecx
                dec     ecx
                test    edi, edi
                jnz     short loc_5D6303

loc_5D6313:                             ; CODE XREF: _wcsncnt_1+11↑j
                cmp     word ptr [eax], 0
                jnz     short loc_5D6320

loc_5D6319:                             ; CODE XREF: _wcsncnt_1+17↑j
                sub     eax, esi
                sar     eax, 1
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D6320:                             ; CODE XREF: _wcsncnt_1+27↑j
                pop     edi
                mov     eax, edx
                pop     esi
                retn
_wcsncnt_1      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __crtCompareStringA(LCID Locale, DWORD dwCmpFlags, PCNZCH lpString1, PCNZWCH, PCNZCH lpString2, int cchCount2, UINT CodePage)
___crtCompareStringA proc near          ; CODE XREF: __mbsnbicoll+25↑p

var_18          = dword ptr -18h
CPInfo          = _cpinfo ptr -14h
Locale          = dword ptr  4
dwCmpFlags      = dword ptr  8
lpString1       = dword ptr  0Ch
arg_C           = dword ptr  10h
lpString2       = dword ptr  14h
cchCount2       = dword ptr  18h
CodePage        = dword ptr  1Ch

                mov     eax, dword_70D7F0
                sub     esp, 18h
                test    eax, eax
                push    ebx
                mov     ebx, ds:CompareStringA
                push    ebp
                push    esi
                push    edi
                jnz     short loc_5D6394
                push    1               ; cchCount2
                push    offset aString2  ; lpString2
                push    1               ; cchCount1
                push    offset aString2  ; lpString1
                push    0               ; dwCmpFlags
                push    0               ; Locale
                call    ebx ; CompareStringA
                test    eax, eax
                jz      short loc_5D636A
                mov     dword_70D7F0, 2
                jmp     short loc_5D6394
; ---------------------------------------------------------------------------

loc_5D636A:                             ; CODE XREF: ___crtCompareStringA+2C↑j
                push    1               ; cchCount2
                push    offset aString1  ; lpString2
                push    1               ; cchCount1
                push    offset aString1  ; lpString1
                push    0               ; dwCmpFlags
                push    0               ; Locale
                call    CompareStringW
                test    eax, eax
                jz      loc_5D6550
                mov     dword_70D7F0, 1

loc_5D6394:                             ; CODE XREF: ___crtCompareStringA+14↑j
                mov     esi, [esp+28h+arg_C]
                test    esi, esi
                jle     short loc_5D63AE
                mov     ebp, [esp+28h+lpString1]
                push    esi
                push    ebp
                call    _strncnt_0
                add     esp, 8
                mov     esi, eax
                jmp     short loc_5D63B2
; ---------------------------------------------------------------------------

loc_5D63AE:                             ; CODE XREF: ___crtCompareStringA+6A↑j
                mov     ebp, [esp+28h+lpString1]

loc_5D63B2:                             ; CODE XREF: ___crtCompareStringA+7C↑j
                mov     edi, [esp+28h+cchCount2]
                test    edi, edi
                jle     short loc_5D63CE
                mov     eax, dword ptr [esp+28h+lpString2]
                push    edi
                push    eax
                call    _strncnt_0
                add     esp, 8
                mov     [esp+28h+cchCount2], eax
                mov     edi, eax

loc_5D63CE:                             ; CODE XREF: ___crtCompareStringA+88↑j
                mov     eax, dword_70D7F0
                cmp     eax, 2
                jnz     short loc_5D63F4
                mov     ecx, dword ptr [esp+28h+lpString2]
                mov     edx, dword ptr [esp+28h+dwCmpFlags]
                mov     eax, dword ptr [esp+28h+Locale]
                push    edi             ; cchCount2
                push    ecx             ; lpString2
                push    esi             ; cchCount1
                push    ebp             ; lpString1
                push    edx             ; dwCmpFlags
                push    eax             ; Locale
                call    ebx ; CompareStringA
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
; ---------------------------------------------------------------------------

loc_5D63F4:                             ; CODE XREF: ___crtCompareStringA+A6↑j
                cmp     eax, 1
                jnz     loc_5D65ED
                mov     ebx, dword ptr [esp+28h+CodePage]
                xor     eax, eax
                test    ebx, ebx
                mov     [esp+28h+var_18], eax
                mov     [esp+28h+arg_C], eax
                jnz     short loc_5D6415
                mov     ebx, CodePage

loc_5D6415:                             ; CODE XREF: ___crtCompareStringA+DD↑j
                test    esi, esi
                jz      short loc_5D6421
                test    edi, edi
                jnz     loc_5D651C

loc_5D6421:                             ; CODE XREF: ___crtCompareStringA+E7↑j
                cmp     esi, edi
                jnz     short loc_5D6432
                mov     eax, 2
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
; ---------------------------------------------------------------------------

loc_5D6432:                             ; CODE XREF: ___crtCompareStringA+F3↑j
                cmp     edi, 1
                jle     short loc_5D6444
                mov     eax, 1
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
; ---------------------------------------------------------------------------

loc_5D6444:                             ; CODE XREF: ___crtCompareStringA+105↑j
                cmp     esi, 1
                jle     short loc_5D6456
                mov     eax, 3
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
; ---------------------------------------------------------------------------

loc_5D6456:                             ; CODE XREF: ___crtCompareStringA+117↑j
                lea     ecx, [esp+28h+CPInfo]
                push    ecx             ; lpCPInfo
                push    ebx             ; CodePage
                call    GetCPInfo
                test    eax, eax
                jnz     short loc_5D646E
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
; ---------------------------------------------------------------------------

loc_5D646E:                             ; CODE XREF: ___crtCompareStringA+134↑j
                test    esi, esi
                jle     short loc_5D64BD
                cmp     [esp+28h+CPInfo.MaxCharSize], 2
                jnb     short loc_5D6486
                mov     eax, 3
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
; ---------------------------------------------------------------------------

loc_5D6486:                             ; CODE XREF: ___crtCompareStringA+147↑j
                mov     cl, [esp+28h+CPInfo.LeadByte]
                lea     eax, [esp+28h+CPInfo.LeadByte]
                test    cl, cl
                jz      short loc_5D64B0

loc_5D6492:                             ; CODE XREF: ___crtCompareStringA+17E↓j
                mov     dl, [eax+1]
                test    dl, dl
                jz      short loc_5D64B0
                mov     cl, [ebp+0]
                mov     bl, [eax]
                cmp     cl, bl
                jb      short loc_5D64A6
                cmp     cl, dl
                jbe     short loc_5D650F

loc_5D64A6:                             ; CODE XREF: ___crtCompareStringA+170↑j
                mov     cl, [eax+2]
                add     eax, 2
                test    cl, cl
                jnz     short loc_5D6492

loc_5D64B0:                             ; CODE XREF: ___crtCompareStringA+160↑j
                mov     eax, 3
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
; ---------------------------------------------------------------------------

loc_5D64BD:                             ; CODE XREF: ___crtCompareStringA+140↑j
                test    edi, edi
                jle     short loc_5D651C
                cmp     [esp+28h+CPInfo.MaxCharSize], 2
                jnb     short loc_5D64D5
                mov     eax, 1
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
; ---------------------------------------------------------------------------

loc_5D64D5:                             ; CODE XREF: ___crtCompareStringA+196↑j
                mov     cl, [esp+28h+CPInfo.LeadByte]
                lea     eax, [esp+28h+CPInfo.LeadByte]
                test    cl, cl
                jz      short loc_5D6502

loc_5D64E1:                             ; CODE XREF: ___crtCompareStringA+1D0↓j
                mov     dl, [eax+1]
                test    dl, dl
                jz      short loc_5D6502
                mov     ecx, dword ptr [esp+28h+lpString2]
                mov     bl, [eax]
                mov     cl, [ecx]
                cmp     cl, bl
                jb      short loc_5D64F8
                cmp     cl, dl
                jbe     short loc_5D650F

loc_5D64F8:                             ; CODE XREF: ___crtCompareStringA+1C2↑j
                mov     cl, [eax+2]
                add     eax, 2
                test    cl, cl
                jnz     short loc_5D64E1

loc_5D6502:                             ; CODE XREF: ___crtCompareStringA+1AF↑j
                mov     eax, 1
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
; ---------------------------------------------------------------------------

loc_5D650F:                             ; CODE XREF: ___crtCompareStringA+174↑j
                mov     eax, 2
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
; ---------------------------------------------------------------------------

loc_5D651C:                             ; CODE XREF: ___crtCompareStringA+EB↑j
                mov     edi, ds:MultiByteToWideChar
                push    0               ; cchWideChar
                push    0               ; lpWideCharStr
                push    esi             ; cbMultiByte
                push    ebp             ; lpMultiByteStr
                push    9               ; dwFlags
                push    ebx             ; CodePage
                call    edi ; MultiByteToWideChar
                mov     ebp, eax
                test    ebp, ebp
                jnz     short loc_5D653B
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
; ---------------------------------------------------------------------------

loc_5D653B:                             ; CODE XREF: ___crtCompareStringA+201↑j
                lea     edx, [ebp+ebp+0]
                push    edx             ; varSize
                call    _malloc
                add     esp, 4
                mov     [esp+28h+CodePage], eax
                test    eax, eax
                jnz     short loc_5D655A

loc_5D6550:                             ; CODE XREF: ___crtCompareStringA+54↑j
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
; ---------------------------------------------------------------------------

loc_5D655A:                             ; CODE XREF: ___crtCompareStringA+21E↑j
                push    ebp             ; cchWideChar
                push    eax             ; lpWideCharStr
                mov     eax, dword ptr [esp+30h+lpString1]
                push    esi             ; cbMultiByte
                push    eax             ; lpMultiByteStr
                push    1               ; dwFlags
                push    ebx             ; CodePage
                call    edi ; MultiByteToWideChar
                test    eax, eax
                jz      short loc_5D65CD
                mov     ecx, dword ptr [esp+28h+cchCount2]
                mov     edx, dword ptr [esp+28h+lpString2]
                push    0               ; cchWideChar
                push    0               ; lpWideCharStr
                push    ecx             ; cbMultiByte
                push    edx             ; lpMultiByteStr
                push    9               ; dwFlags
                push    ebx             ; CodePage
                call    edi ; MultiByteToWideChar
                mov     esi, eax
                test    esi, esi
                jz      short loc_5D65CD
                lea     eax, [esi+esi]
                push    eax             ; varSize
                call    _malloc
                add     esp, 4
                mov     [esp+28h+arg_C], eax
                test    eax, eax
                jz      short loc_5D65CD
                mov     ecx, dword ptr [esp+28h+cchCount2]
                mov     edx, dword ptr [esp+28h+lpString2]
                push    esi             ; cchWideChar
                push    eax             ; lpWideCharStr
                push    ecx             ; cbMultiByte
                push    edx             ; lpMultiByteStr
                push    1               ; dwFlags
                push    ebx             ; CodePage
                call    edi ; MultiByteToWideChar
                test    eax, eax
                jz      short loc_5D65CD
                mov     eax, dword ptr [esp+28h+arg_C]
                mov     ecx, dword ptr [esp+28h+CodePage]
                mov     edx, dword ptr [esp+28h+dwCmpFlags]
                push    esi             ; cchCount2
                push    eax             ; lpString2
                mov     eax, dword ptr [esp+30h+Locale]
                push    ebp             ; cchCount1
                push    ecx             ; lpString1
                push    edx             ; dwCmpFlags
                push    eax             ; Locale
                call    CompareStringW
                mov     esi, eax
                jmp     short loc_5D65D1
; ---------------------------------------------------------------------------

loc_5D65CD:                             ; CODE XREF: ___crtCompareStringA+239↑j
                mov     esi, [esp+28h+var_18]

loc_5D65D1:                             ; CODE XREF: ___crtCompareStringA+29B↑j
                mov     ecx, dword ptr [esp+28h+CodePage]
                push    ecx             ; Block
                call    _free
                mov     edx, dword ptr [esp+2Ch+arg_C]
                add     esp, 4
                push    edx             ; Block
                call    _free
                add     esp, 4
                mov     eax, esi

loc_5D65ED:                             ; CODE XREF: ___crtCompareStringA+C7↑j
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                add     esp, 18h
                retn
___crtCompareStringA endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_strncnt_0      proc near               ; CODE XREF: ___crtCompareStringA+72↑p

arg_0           = dword ptr  4
arg_4           = dword ptr  8

                mov     edx, dword ptr [esp+arg_4]
                push    esi
                mov     esi, [esp+4+arg_0]
                test    edx, edx
                push    edi
                mov     eax, esi
                lea     ecx, [edx-1]
                jz      short loc_5D6620

loc_5D6613:                             ; CODE XREF: _strncnt_0+1E↓j
                cmp     byte ptr [eax], 0
                jz      short loc_5D6620
                inc     eax
                mov     edi, ecx
                dec     ecx
                test    edi, edi
                jnz     short loc_5D6613

loc_5D6620:                             ; CODE XREF: _strncnt_0+11↑j
                cmp     byte ptr [eax], 0
                jnz     short loc_5D662A
                sub     eax, esi
                pop     edi
                pop     esi
                retn
; ---------------------------------------------------------------------------

loc_5D662A:                             ; CODE XREF: _strncnt_0+23↑j
                pop     edi
                pop     esi
                mov     eax, edx
                retn
_strncnt_0      endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function

; int __cdecl __crtsetenv(unsigned __int8 *varStr, int)
___crtsetenv    proc near               ; CODE XREF: ___wtomb_environ+54↑p

var_4           = dword ptr -4
varStr             = dword ptr  4
arg_4           = dword ptr  8

                push    ecx
                push    ebx
                push    ebp
                push    esi
                push    edi
                mov     edi, [esp+14h+varStr]
                test    edi, edi
                jz      loc_5D67EE
                push    3Dh ; '='       ; C
                push    edi             ; varStr
                call    __mbschr
                mov     esi, eax
                add     esp, 8
                test    esi, esi
                jz      loc_5D67EE
                cmp     edi, esi
                jz      loc_5D67EE
                mov     dl, [esi+1]
                mov     ecx, dword_70D34C
                xor     eax, eax
                test    dl, dl
                setz    al
                mov     ebp, eax
                mov     eax, dword_70D348
                cmp     eax, ecx
                jnz     short loc_5D6687
                push    eax
                call    _copy_environ
                add     esp, 4
                mov     dword_70D348, eax

loc_5D6687:                             ; CODE XREF: ___crtsetenv+47↑j
                test    eax, eax
                jnz     short loc_5D6702
                mov     eax, dword ptr [esp+14h+arg_4]
                test    eax, eax
                jz      short loc_5D66AE
                mov     eax, dword_70D350
                test    eax, eax
                jz      short loc_5D66AE
                call    ___wtomb_environ
                test    eax, eax
                jz      short loc_5D66FD
                or      eax, 0FFFFFFFFh
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D66AE:                             ; CODE XREF: ___crtsetenv+61↑j
                test    ebp, ebp
                jz      short loc_5D66BA
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D66BA:                             ; CODE XREF: ___crtsetenv+80↑j
                push    4               ; varSize
                call    _malloc
                add     esp, 4
                mov     dword_70D348, eax
                test    eax, eax
                jz      loc_5D67EE
                mov     dword ptr [eax], 0
                mov     eax, dword_70D350
                test    eax, eax
                jnz     short loc_5D66FD
                push    4               ; varSize
                call    _malloc
                add     esp, 4
                mov     dword_70D350, eax
                test    eax, eax
                jz      loc_5D67EE
                mov     dword ptr [eax], 0

loc_5D66FD:                             ; CODE XREF: ___crtsetenv+73↑j
                mov     eax, dword_70D348

loc_5D6702:                             ; CODE XREF: ___crtsetenv+59↑j
                mov     ebx, eax
                mov     eax, esi
                sub     eax, edi
                push    eax             ; MaxCount
                push    edi             ; Str1
                mov     [esp+1Ch+var_4], eax
                call    _findenv
                mov     esi, eax
                add     esp, 8
                test    esi, esi
                jl      loc_5D67FF
                cmp     dword ptr [ebx], 0
                jz      loc_5D67FF
                test    ebp, ebp
                jz      loc_5D67F7
                mov     ecx, dword ptr [ebx+esi*4]
                lea     edi, [ebx+esi*4]
                push    ecx             ; Block
                call    _free
                mov     eax, dword ptr [edi]
                add     esp, 4
                test    eax, eax
                jz      short loc_5D6759
                mov     eax, edi

loc_5D6748:                             ; CODE XREF: ___crtsetenv+127↓j
                mov     edx, dword ptr [eax+4]
                add     eax, 4
                mov     [edi], edx
                inc     esi
                mov     ecx, dword ptr [eax]
                mov     edi, eax
                test    ecx, ecx
                jnz     short loc_5D6748

loc_5D6759:                             ; CODE XREF: ___crtsetenv+114↑j
                lea     eax, ds:0[esi*4]
                push    eax             ; varSize
                push    ebx             ; Block
                call    _realloc
                add     esp, 8
                test    eax, eax
                jz      short loc_5D6773
                mov     dword_70D348, eax

loc_5D6773:                             ; CODE XREF: ___crtsetenv+13C↑j
                mov     edi, [esp+14h+varStr]

loc_5D6777:                             ; CODE XREF: ___crtsetenv+1CA↓j
                mov     eax, dword ptr [esp+14h+arg_4]
                test    eax, eax
                jz      short loc_5D67E6
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                inc     ecx
                push    ecx             ; varSize
                call    _malloc
                mov     ebx, eax
                add     esp, 4
                test    ebx, ebx
                jz      short loc_5D67E6
                mov     edi, [esp+14h+varStr]
                or      ecx, 0FFFFFFFFh
                xor     eax, eax
                repne scasb
                not     ecx
                sub     edi, ecx
                mov     eax, dword ptr [esp+14h+var_4]
                mov     edx, ecx
                mov     esi, edi
                mov     edi, ebx
                shr     ecx, 2
                rep movsd
                mov     ecx, edx
                and     ecx, 3
                neg     ebp
                rep movsb
                sbb     ebp, ebp
                mov     byte ptr [ebx+eax], 0
                lea     eax, [ebx+eax+1]
                not     ebp
                and     ebp, eax
                push    ebp             ; lpValue
                push    ebx             ; lpName
                call    SetEnvironmentVariableA
                push    ebx             ; Block
                call    _free
                add     esp, 4
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D67E6:                             ; CODE XREF: ___crtsetenv+14D↑j
                xor     eax, eax
                pop     edi
                pop     esi
                pop     ebp
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D67EE:                             ; CODE XREF: ___crtsetenv+B↑j
                pop     edi
                pop     esi
                pop     ebp
                or      eax, 0FFFFFFFFh
                pop     ebx
                pop     ecx
                retn
; ---------------------------------------------------------------------------

loc_5D67F7:                             ; CODE XREF: ___crtsetenv+FB↑j
                mov     [ebx+esi*4], edi
                jmp     loc_5D6777
; ---------------------------------------------------------------------------

loc_5D67FF:                             ; CODE XREF: ___crtsetenv+EA↑j
                test    ebp, ebp
                jnz     short loc_5D67E6
                test    esi, esi
                jge     short loc_5D6809
                neg     esi

loc_5D6809:                             ; CODE XREF: ___crtsetenv+1D5↑j
                lea     ecx, ds:8[esi*4]
                push    ecx             ; varSize
                push    ebx             ; Block
                call    _realloc
                add     esp, 8
                test    eax, eax
                jz      short loc_5D67EE
                mov     [eax+esi*4], edi
                mov     dword ptr [eax+esi*4+4], 0
                mov     dword_70D348, eax
                jmp     loc_5D6777
___crtsetenv    endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

; int __cdecl findenv(unsigned __int8 *Str1, size_t MaxCount)
_findenv        proc near               ; CODE XREF: ___crtsetenv+DE↑p

Str1            = dword ptr  4
MaxCount        = dword ptr  8

                push    ebx
                push    esi
                mov     esi, dword_70D348
                push    edi
                mov     eax, dword ptr [esi]
                test    eax, eax
                jz      short loc_5D68A1
                mov     edi, [esp+0Ch+MaxCount]
                mov     ebx, dword ptr [esp+0Ch+Str1]

loc_5D6857:                             ; CODE XREF: _findenv+3B↓j
                push    edi             ; MaxCount
                push    eax             ; Str2
                push    ebx             ; Str1
                call    __mbsnbicoll
                add     esp, 0Ch
                test    eax, eax
                jnz     short loc_5D6873
                mov     eax, dword ptr [esi]
                mov     al, [eax+edi]
                cmp     al, 3Dh ; '='
                jz      short loc_5D6890
                test    al, al
                jz      short loc_5D6890

loc_5D6873:                             ; CODE XREF: _findenv+24↑j
                mov     eax, dword ptr [esi+4]
                add     esi, 4
                test    eax, eax
                jnz     short loc_5D6857
                mov     eax, esi
                mov     esi, dword_70D348
                sub     eax, esi
                sar     eax, 2
                neg     eax
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D6890:                             ; CODE XREF: _findenv+2D↑j
                mov     edx, dword_70D348
                mov     eax, esi
                sub     eax, edx
                sar     eax, 2
                pop     edi
                pop     esi
                pop     ebx
                retn
; ---------------------------------------------------------------------------

loc_5D68A1:                             ; CODE XREF: _findenv+D↑j
                mov     eax, esi
                mov     esi, dword_70D348
                sub     eax, esi
                pop     edi
                sar     eax, 2
                pop     esi
                pop     ebx
                neg     eax
                retn
_findenv        endp

; ---------------------------------------------------------------------------
                align 10h

; =============== S U B R O U T I N E =======================================

; Attributes: library function static

_copy_environ   proc near               ; CODE XREF: ___crtsetenv+4A↑p

arg_0           = dword ptr  4

                push    edi
                mov     edi, [esp+4+arg_0]
                xor     ecx, ecx
                test    edi, edi
                jnz     short loc_5D68CF
                xor     eax, eax
                pop     edi
                retn
; ---------------------------------------------------------------------------

loc_5D68CF:                             ; CODE XREF: _copy_environ+9↑j
                mov     edx, dword ptr [edi]
                push    esi
                test    edx, edx
                push    ebx
                lea     eax, [edi+4]
                jz      short loc_5D68E4

loc_5D68DA:                             ; CODE XREF: _copy_environ+22↓j
                mov     edx, dword ptr [eax]
                inc     ecx
                add     eax, 4
                test    edx, edx
                jnz     short loc_5D68DA

loc_5D68E4:                             ; CODE XREF: _copy_environ+18↑j
                lea     eax, ds:4[ecx*4]
                push    eax             ; varSize
                call    _malloc
                mov     esi, eax
                add     esp, 4
                test    esi, esi
                mov     ebx, esi
                jnz     short loc_5D6906
                push    9
                call    __amsg_exit
; ---------------------------------------------------------------------------
                add     esp, 4

loc_5D6906:                             ; CODE XREF: _copy_environ+3A↑j
                mov     eax, dword ptr [edi]
                test    eax, eax
                jz      short loc_5D6923

loc_5D690C:                             ; CODE XREF: _copy_environ+61↓j
                push    eax             ; Source
                add     edi, 4
                call    __strdup
                mov     [esi], eax
                mov     eax, dword ptr [edi]
                add     esp, 4
                add     esi, 4
                test    eax, eax
                jnz     short loc_5D690C

loc_5D6923:                             ; CODE XREF: _copy_environ+4A↑j
                mov     eax, ebx
                mov     dword ptr [esi], 0
                pop     ebx
                pop     esi
                pop     edi
                retn
_copy_environ   endp


























;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

.data
unk_63ED10      db  20h                 ; DATA XREF: __NLG_Notify1+2↑o
                db    5
                db  93h
                db  19h
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  75h ; u
                db  98h
                db    0
                db    0
                db  73h ; s
                db  98h
                db    0
                db    0
off_63ED28      dd offset __fpmath      ; DATA XREF: __cinit↑r
off_63ED2C      dd offset nullsub_1     ; DATA XREF: _threadstart(x):loc_5C2444↑r
off_63ED30      dd offset nullsub_1     ; DATA XREF: __endthread↑r
                align 10h
aSqrt           db 'sqrt',0             ; DATA XREF: _sqrt+3C↑o
                align 10h
aTan_0          db 'tan',0
                align 10h
; public class type_info /* mdisp:0 */
; class type_info `RTTI Type Descriptor'
??_R0?AVtype_info@@@8 dd offset ??_7type_info@@6B@
                dd 0                    ; internal runtime reference
aAvtypeInfo     db '.?AVtype_info@@',0  ; type descriptor name
                align 10h
dbl_63ED80      dq 0.5                  ; DATA XREF: sub_5C0D75+E↑r
aPow_0          db 'pow',0              ; DATA XREF: _pow+71↑o
                                        ; _pow+8E↑o
                db    0
                db    0
                db    0
                db    0
                dd offset ?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z ; __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
aSin_0          db 'sin',0
                align 10h
aCos_0          db 'cos',0              ; DATA XREF: _cos+38↑o
                                        ; _cos+8D↑o
                db 0Ch dup(0)
aAtan           db 'atan',0             ; DATA XREF: _atan+34↑o
                align 10h
aLog10          db 'log10',0            ; DATA XREF: _log10+43↑o
                align 10h
aAcos           db 'acos',0             ; DATA XREF: _acos+46↑o
                align 4


aLog_0          db 'log',0
                align 10h
unk_63EE00      db    1                 ; DATA XREF: __dosmaperr+E↑o
                db    0
                db    0
                db    0
dword_63EE04    dd 16h                  ; DATA XREF: __dosmaperr+68↑r
                db    2
                db    0
                db    0
                db    0
                db    2
                db    0
                db    0
                db    0
                db    3
                db    0
                db    0
                db    0
                db    2
                db    0
                db    0
                db    0
                db    4
                db    0
                db    0
                db    0
                db  18h
                db    0
                db    0
                db    0
                db    5
                db    0
                db    0
                db    0
                db  0Dh
                db    0
                db    0
                db    0
                db    6
                db    0
                db    0
                db    0
                db    9
                db    0
                db    0
                db    0
                db    7
                db    0
                db    0
                db    0
                db  0Ch
                db    0
                db    0
                db    0
                db    8
                db    0
                db    0
                db    0
                db  0Ch
                db    0
                db    0
                db    0
                db    9
                db    0
                db    0
                db    0
                db  0Ch
                db    0
                db    0
                db    0
                db  0Ah
                db    0
                db    0
                db    0
                db    7
                db    0
                db    0
                db    0
                db  0Bh
                db    0
                db    0
                db    0
                db    8
                db    0
                db    0
                db    0
                db  0Ch
                db    0
                db    0
                db    0
                db  16h
                db    0
                db    0
                db    0
                db  0Dh
                db    0
                db    0
                db    0
                db  16h
                db    0
                db    0
                db    0
                db  0Fh
                db    0
                db    0
                db    0
                db    2
                db    0
                db    0
                db    0
                db  10h
                db    0
                db    0
                db    0
                db  0Dh
                db    0
                db    0
                db    0
                db  11h
                db    0
                db    0
                db    0
                db  12h
                db    0
                db    0
                db    0
                db  12h
                db    0
                db    0
                db    0
                db    2
                db    0
                db    0
                db    0
                db  21h ; !
                db    0
                db    0
                db    0
                db  0Dh
                db    0
                db    0
                db    0
                db  35h ; 5
                db    0
                db    0
                db    0
                db    2
                db    0
                db    0
                db    0
                db  41h ; A
                db    0
                db    0
                db    0
                db  0Dh
                db    0
                db    0
                db    0
                db  43h ; C
                db    0
                db    0
                db    0
                db    2
                db    0
                db    0
                db    0
                db  50h ; P
                db    0
                db    0
                db    0
                db  11h
                db    0
                db    0
                db    0
                db  52h ; R
                db    0
                db    0
                db    0
                db  0Dh
                db    0
                db    0
                db    0
                db  53h ; S
                db    0
                db    0
                db    0
                db  0Dh
                db    0
                db    0
                db    0
                db  57h ; W
                db    0
                db    0
                db    0
                db  16h
                db    0
                db    0
                db    0
                db  59h ; Y
                db    0
                db    0
                db    0
                db  0Bh
                db    0
                db    0
                db    0
                db  6Ch ; l
                db    0
                db    0
                db    0
                db  0Dh
                db    0
                db    0
                db    0
                db  6Dh ; m
                db    0
                db    0
                db    0
                db  20h
                db    0
                db    0
                db    0
                db  70h ; p
                db    0
                db    0
                db    0
                db  1Ch
                db    0
                db    0
                db    0
                db  72h ; r
                db    0
                db    0
                db    0
                db    9
                db    0
                db    0
                db    0
                db    6
                db    0
                db    0
                db    0
                db  16h
                db    0
                db    0
                db    0
                db  80h
                db    0
                db    0
                db    0
                db  0Ah
                db    0
                db    0
                db    0
                db  81h
                db    0
                db    0
                db    0
                db  0Ah
                db    0
                db    0
                db    0
                db  82h
                db    0
                db    0
                db    0
                db    9
                db    0
                db    0
                db    0
                db  83h
                db    0
                db    0
                db    0
                db  16h
                db    0
                db    0
                db    0
                db  84h
                db    0
                db    0
                db    0
                db  0Dh
                db    0
                db    0
                db    0
                db  91h
                db    0
                db    0
                db    0
                db  29h ; )
                db    0
                db    0
                db    0
                db  9Eh
                db    0
                db    0
                db    0
                db  0Dh
                db    0
                db    0
                db    0
                db 0A1h
                db    0
                db    0
                db    0
                db    2
                db    0
                db    0
                db    0
                db 0A4h
                db    0
                db    0
                db    0
                db  0Bh
                db    0
                db    0
                db    0
                db 0A7h
                db    0
                db    0
                db    0
                db  0Dh
                db    0
                db    0
                db    0
                db 0B7h
                db    0
                db    0
                db    0
                db  11h
                db    0
                db    0
                db    0
                db 0CEh
                db    0
                db    0
                db    0
                db    2
                db    0
                db    0
                db    0
                db 0D7h
                db    0
                db    0
                db    0
                db  0Bh
                db    0
                db    0
                db    0
                db  18h
                db    7
                db    0
                db    0
                db  0Ch
                db    0
                db    0
                db    0
byte_63EF68     db 1                    ; DATA XREF: __dosmaperr+1B↑o
                db    2
                db    4
                db    8
                db    0
                db    0
                db    0
                db    0
unk_63EF70      db 0A4h                 ; DATA XREF: __setmbcp+4D↑o
                db    3
                db    0
                db    0
dword_63EF74    dd 82798260h            ; DATA XREF: __setmbcp+1D9↑r
dword_63EF78    dd 21h                  ; DATA XREF: __setmbcp+1DF↑r
                align 10h
unk_63EF80      db 0A6h                 ; DATA XREF: __setmbcp+182↑o
                db 0DFh
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db 0A1h
                db 0A5h
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  81h
                db  9Fh
                db 0E0h
                db 0FCh
                db    0
                db    0
                db    0
                db    0
                db  40h ; @
                db  7Eh ; ~
                db  80h
                db 0FCh
                db    0
                db    0
                db    0
                db    0
                db 0A8h
                db    3
                db    0
                db    0
                db 0C1h
                db 0A3h
                db 0DAh
                db 0A3h
                db  20h
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  81h
                db 0FEh
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  40h ; @
                db 0FEh
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db 0B5h
                db    3
                db    0
                db    0
                db 0C1h
                db 0A3h
                db 0DAh
                db 0A3h
                db  20h
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  81h
                db 0FEh
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  41h ; A
                db 0FEh
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db 0B6h
                db    3
                db    0
                db    0
                db 0CFh
                db 0A2h
                db 0E4h
                db 0A2h
                db  1Ah
                db    0
                db 0E5h
                db 0A2h
                db 0E8h
                db 0A2h
                db  5Bh ; [
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  81h
                db 0FEh
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  40h ; @
                db  7Eh ; ~
                db 0A1h
                db 0FEh
                db    0
                db    0
                db    0
                db    0
                db  51h ; Q
                db    5
                db    0
                db    0
                db  51h ; Q
                db 0DAh
                db  5Eh ; ^
                db 0DAh
                db  20h
                db    0
                db  5Fh ; _
                db 0DAh
                db  6Ah ; j
                db 0DAh
                db  32h ; 2
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  81h
                db 0D3h
                db 0D8h
                db 0DEh
                db 0E0h
                db 0F9h
                db    0
                db    0
                db  31h ; 1
                db  7Eh ; ~
                db  81h
                db 0FEh
                db    0
                db    0
                db    0
                db    0
off_63F060      dd offset aSun    ; DATA XREF: __setmbcp+5E↑o
                dd offset aMon
                dd offset aTue
                dd offset aWed
                dd offset aThu
                dd offset aFri
                dd offset aSat
                dd offset aSunday       ; "Sunday"
                dd offset aMonday       ; "Monday"
                dd offset aTuesday      ; "Tuesday"
                dd offset aWednesday    ; "Wednesday"
                dd offset aThursday     ; "Thursday"
                dd offset aFriday       ; "Friday"
                dd offset aSaturday     ; "Saturday"
                dd offset aJan
                dd offset aFeb
                dd offset aMar
                dd offset aApr
                dd offset aMay
                dd offset aJun
                dd offset aJul
                dd offset aAug
                dd offset aSep
                dd offset aOct
                dd offset aNov
                dd offset aDec
                dd offset aJanuary      ; "January"
                dd offset aFebruary     ; "February"
                dd offset aMarch        ; "March"
                dd offset aApril        ; "April"
                dd offset aMay
                dd offset aJune         ; "June"
                dd offset aJuly         ; "July"
                dd offset aAugust       ; "August"
                dd offset aSeptember    ; "September"
                dd offset aOctober      ; "October"
                dd offset aNovember     ; "November"
                dd offset aDecember     ; "December"
                dd offset g_aAm           ; "AM"
                dd offset aPm           ; "PM"
                dd offset aMDYy         ; "M/d/yy"
                dd offset aDdddMmmmDdYyyy ; "dddd, MMMM dd, yyyy"
                dd offset aHMmSs        ; "H:mm:ss"
off_63F10C      dd offset off_63F060    ; DATA XREF: __Getdays+3↑r
                dd offset ?__CxxUnhandledExceptionFilter@@YGJPAU_EXCEPTION_POINTERS@@@Z ; __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *)
                align 10h
; DWORD __tlsindex

off_63F124      dd offset ?terminate@@YAXXZ ; DATA XREF: sub_5C6F90+2D↑r
off_63F128      dd offset __fptrap      ; DATA XREF: __cfltcvt_init_0+F↑w
off_63F12C      dd offset __fptrap      ; DATA XREF: __cfltcvt_init_0+5↑w
off_63F130      dd offset __fptrap      ; DATA XREF: __cfltcvt_init_0+14↑w
off_63F134      dd offset __fptrap      ; DATA XREF: __cfltcvt_init_0+1E↑w
off_63F138      dd offset __fptrap      ; DATA XREF: __cfltcvt_init_0+28↑w
off_63F13C      dd offset __fptrap      ; DATA XREF: __cfltcvt_init_0+32↑w
                db    0
                db  10h
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0



tbyte_641230    db 0, 0, 0, 0, 0, 0, 0, 0C0h, 0FFh, 0FFh                  ; DATA XREF: _sqrt+7C↑r
tbyte_64123A    dt 1.5707963267948966193 ; DATA XREF: _atan+56↑r
dbl_641244      dq 1.0                  ; DATA XREF: .text:005C8476↑r
unk_64124C      db    8                 ; DATA XREF: __trandisp1+28↑o
                db    4
                db    8
                db    8
                db    8
                db    4
                db    8
                db    8
                db    0
                db    4
                db  0Ch
                db    8
                db    0
                db    4
                db  0Ch
                db    8
                db    0
                db    0
                db    0
                db    0
off_641260      dd offset aNull_0       ; DATA XREF: __output:loc_5C8B91↑r
off_641264      dd offset word_614714    ; DATA XREF: __output+3C3↑r
off_641268      dd offset __ctype+2     ; DATA XREF: _isalpha+20↑r
off_64126C      dd offset __ctype+2     ; DATA XREF: sub_5D2570+1E7↑w
                public __ctype
; unsigned __int16 _ctype[]
__ctype         dd    200000h           ; DATA XREF: _x_ismbbtype+1F↑r
                                dw    20h,   20h,   20h,   20h,   20h,   20h,   20h,   20h; 0
                dw    28h,   28h,   28h,   28h,   28h,   20h,   20h,   20h; 8
                dw    20h,   20h,   20h,   20h,   20h,   20h,   20h,   20h; 16
                dw    20h,   20h,   20h,   20h,   20h,   20h,   20h,   48h; 24
                dw    10h,   10h,   10h,   10h,   10h,   10h,   10h,   10h; 32
                dw    10h,   10h,   10h,   10h,   10h,   10h,   10h,   84h; 40
                dw    84h,   84h,   84h,   84h,   84h,   84h,   84h,   84h; 48
                dw    84h,   10h,   10h,   10h,   10h,   10h,   10h,   10h; 56
                dw    81h,   81h,   81h,   81h,   81h,   81h,     1,     1; 64
                dw      1,     1,     1,     1,     1,     1,     1,     1; 72
                dw      1,     1,     1,     1,     1,     1,     1,     1; 80
                dw      1,     1,   10h,   10h,   10h,   10h,   10h,   10h; 88
                dw    82h,   82h,   82h,   82h,   82h,   82h,     2,     2; 96
                dw      2,     2,     2,     2,     2,     2,     2,     2; 104
                dw      2,     2,     2,     2,     2,     2,     2,     2; 112
                dw      2,     2,   10h,   10h,   10h,   10h,   20h,     0; 120
                dw      0,     0,     0,     0,     0,     0,     0,     0; 128
                dw      0,     0,     0,     0,     0,     0,     0,     0; 136
                dw      0,     0,     0,     0,     0,     0,     0,     0; 144
                dw      0,     0,     0,     0,     0,     0,     0,     0; 152
                dw      0,     0,     0,     0,     0,     0,     0,     0; 160
                dw      0,     0,     0,     0,     0,     0,     0,     0; 168
                dw      0,     0,     0,     0,     0,     0,     0,     0; 176
                dw      0,     0,     0,     0,     0,     0,     0,     0; 184
                dw      0,     0,     0,     0,     0,     0,     0,     0; 192
                dw      0,     0,     0,     0,     0,     0,     0,     0; 200
                dw      0,     0,     0,     0,     0,     0,     0,     0; 208
                dw      0,     0,     0,     0,     0,     0,     0,     0; 216
                dw      0,     0,     0,     0,     0,     0,     0,     0; 224
                dw      0,     0,     0,     0,     0,     0,     0,     0; 232
                dw      0,     0,     0,     0,     0,     0,     0,     0; 240
                dw      0,     0,     0,     0,     0,     0,     0,     0; 248
; size_t SrcSizeInBytes
g_SrcSizeInBytes  dd 1                    ; DATA XREF: _isalpha↑r
byte_641478     db 2Eh                  ; DATA XREF: __forcdecpt:loc_5C7103↑r
                align 4
dword_64147C    dd 1                    ; DATA XREF: ___init_numeric+1E5↑w
tbyte_641480    db 0
                db 0
                db 0
                db 0
                db 0
                db 0
                db 0
                db 80h
                db 0FFh
                db 7Fh
tbyte_64148A    db    0,   0,   0,   0,   0,   0,   0, 80h,0FFh,0FFh                ; DATA XREF: _log10+8E↑r
                db 0DCh
                db 0A7h
                db 0D7h
                db 0B9h
                db  85h
                db  66h ; f
                db  71h ; q
                db 0B1h
                db  0Dh
                db  40h ; @
tbyte_64149E    dt 32767.5              ; DATA XREF: __ffexpm1+4↑r
                db 0F7h
                db  36h ; 6
                db  43h ; C
                db  0Ch
                db  98h
                db  19h
                db 0F6h
                db  95h
                db 0FDh
                db  3Fh ; ?
dbl_6414B2      dq 0.5                  ; DATA XREF: _isintTOS+E↑r
unk_6414BA      db    3                 ; DATA XREF: sub_5BFC80↑o
                db 'exp',0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    1
                db  14h
                db    0
                dd offset __fFEXP
                dd offset __rtonenpop
                dd offset __tosnan1
                dd offset _rtforexpinf
                db 6 dup(0)
asc_6414E0      db ' ',9,'-',0Dh,']',0  ; DATA XREF: __input:loc_5CA465↑o
                align 4
asc_6414E8      db ']',0                ; DATA XREF: __input:loc_5CA451↑o
                align 10h
aC              db 'C',0                ; DATA XREF: __setlocale_set_cat+134↑o
                align 8
                dd offset aLcAll        ; "LC_ALL"
; void *dword_6414FC
dword_6414FC    dd 0                    ; DATA XREF: _setlocale+77↑r
off_641500      dd offset sub_5CB700    ; DATA XREF: __setlocale_set_cat:loc_5CB36D↑r
off_641504      dd offset aLcCollate    ; DATA XREF: _setlocale+F3↑o
off_641508      dd offset aC            ; DATA XREF: __setlocale_get_all+2B↑r
                dd offset sub_5D2830
                dd offset aLcCtype      ; "LC_CTYPE"
off_641514      dd offset aC            ; DATA XREF: __setlocale_get_all+103↑r
                dd offset sub_5D2570
                dd offset aLcMonetary   ; "LC_MONETARY"
                dd offset aC            ; "C"
                dd offset ___init_monetary
                dd offset aLcNumeric    ; "LC_NUMERIC"
                dd offset aC            ; "C"
                dd offset ___init_numeric
off_641534      dd offset aLcTime       ; DATA XREF: _setlocale+125↑o
off_641538      dd offset aC            ; DATA XREF: _setlocale+254↑o
                dd offset ___init_time
unk_641540      db  43h ; C             ; DATA XREF: __expandlocale+AC↑o
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
unk_6415C8      db  43h ; C             ; DATA XREF: __expandlocale+74↑o
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0

unk_6416E0      db    5                 ; DATA XREF: _atan2\u2191o
                                        ; .text:005C13BA\u2191o ...
aAtan2          db 'atan2',0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    2
                dw 10h
                dd offset __fFATN2
                dd offset loc_5CC8E2
                dd offset __tosnan2
                dd offset _rtforatn20
                dd offset _rtforatn20
                dd offset _rtforatn20
                dd offset __tosnan2
                dd offset _rtforatn20
                dd offset __nosnan2
                dd offset __nosnan2
                dd offset __nan2
                dd offset __nosnan2
                dd offset loc_5CC8E2
                dd offset loc_5CC8E2
                dd offset __tosnan2
                dd offset __rtindfpop
dword_641730    dd 14h                  ; DATA XREF: __get_fname+6\u2191o
off_641734      dd offset aExp          ; DATA XREF: __get_fname:loc_5CD2ED\u2191r
                                        ; "exp"
                dd 1Dh
                dd offset aPow          ; "pow"
                dd 1Ah
                dd offset aLog          ; "log"
                dd 1Bh
                dd offset aLog10_0      ; "log10"
                dd 1Fh
                dd offset aSinh         ; "sinh"
                dd 13h
                dd offset aCosh         ; "cosh"
                dd 21h
                dd offset aTanh         ; "tanh"
                dd 0Eh
                dd offset aAsin         ; "asin"
                dd 0Dh
                dd offset aAcos_0       ; "acos"
                dd 0Fh
                dd offset aAtan_0       ; "atan"
                dd 10h
                dd offset aAtan2_0      ; "atan2"
                dd 5
                dd offset aSqrt_0       ; "sqrt"
                dd 1Eh
                dd offset aSin          ; "sin"
                dd 12h
                dd offset aCos          ; "cos"
                dd 20h
                dd offset aTan          ; "tan"
                dd 0Ch
                dd offset aCeil         ; "ceil"
                dd 0Bh
                dd offset aFloor        ; "floor"
                dd 15h
                dd offset aFabs         ; "fabs"
                dd 1Ch
                dd offset aModf         ; "modf"
                dd 19h
                dd offset aLdexp        ; "ldexp"
                dd 11h
                dd offset aCabs         ; "_cabs"
                dd 18h
                dd offset aHypot        ; "_hypot"
                dd 16h
                dd offset aFmod         ; "fmod"
                dd 17h
                dd offset aFrexp        ; "frexp"
                dd 22h
                dd offset aY0           ; "_y0"
                dd 23h
                dd offset aY1           ; "_y1"
                dd 24h
                dd offset aYn           ; "_yn"

; double Number
g_Number        db 0, 0, 0, 0, 0, 0, 0F0h, 7Fh                 ; DATA XREF: __hypothlp+2EB↑r
dword_641810    dd 0                    ; DATA XREF: __powhlp+E7↑r
dword_641814    dd 0FFF80000h           ; DATA XREF: __powhlp+F4↑r
dbl_641818      db 0FFh, 0FFh, 0FFh, 0FFh, 0FFh, 0FFh, 0EFh, 7Fh ; DATA XREF: __handle_exc+F6↑r
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  10h
                db    0
dword_641828    dd 0                    ; DATA XREF: __powhlp+1E8↑r
dword_64182C    dd 80000000h            ; DATA XREF: __powhlp+1ED↑r
tbyte_641830    dt 2.3562723457267347066e313
                align 10h
tbyte_641840    dt 1.9149954921904370718e-1233
                align 10h

dword_6418C8    dd 3                    ; DATA XREF: _raise+138↑r
dword_6418CC    dd 7                    ; DATA XREF: _raise+13D↑r

unk_6418D8      db 0FFh                 ; DATA XREF: _clearerr:loc_5C3AB3↑o
                db 0FFh
                db 0FFh
                db 0FFh
                db    0
                db  0Ah
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
off_641900      dd offset unk_70D840    ; DATA XREF: __lock_file+6↑o
                align 8
                dd offset unk_70D840
                db    1
                db    1
                db    0
                db    0
unk_641910      db    0                 ; DATA XREF: ___initstdio+83↑o
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  10h
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
; FILE File
_stdout            FILE <0, 0, 0, 2, 1, 0, 0, 0> ; DATA XREF: _printf+2↑o
; FILE _stderr
_stderr     FILE <0, 0, 0, 2, 2, 0, 0, 0> ; DATA XREF: __flsbuf+55↑o
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
unk_641970      db    0                 ; DATA XREF: ___initstdio+B2↑o
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
unk_641B60      db    0                 ; DATA XREF: __lock_file+D↑o
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
dword_641B80    dd 7080h                ; DATA XREF: __make_time_t+1B5↑r
dword_641B84    dd 1                    ; DATA XREF: _localtime+39↑r
dword_641B88    dd 0FFFFF1F0h           ; DATA XREF: __make_time_t:loc_5C4265↑r
                align 10h
unk_641B90      db  50h ; P             ; DATA XREF: .data:Dest↓o
                db  53h ; S
                db  54h ; T
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
off_641BD0      dd offset sub_544450    ; DATA XREF: .data:off_641C14↓o
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
; char *Dest
g_Dest            dd offset unk_641B90    ; DATA XREF: __expandtime+4B8↑r
; char *off_641C14
off_641C14      dd offset off_641BD0    ; DATA XREF: __tzset_lk+EA↑r
dword_641C18    dd 0FFFFFFFFh           ; DATA XREF: __tzset_lk+24↑w
dword_641C1C    dd 0                    ; DATA XREF: sub_5CF160:loc_5CF334↑r
dword_641C20    dd 0                    ; DATA XREF: sub_5CF160+23D↑r
                align 8
dword_641C28    dd 0FFFFFFFFh           ; DATA XREF: __tzset_lk+1A↑w
dword_641C2C    dd 0                    ; DATA XREF: sub_5CF160+1DA↑r
dword_641C30    dd 0                    ; DATA XREF: sub_5CF160:loc_5CF3AF↑r
dword_641C34    dd 0                    ; DATA XREF: _cvtdate+2B↑r
dword_641C38    dd 0FFFFFFFFh           ; DATA XREF: _gmtime+C4↑o
                db  1Eh
                db    0
                db    0
                db    0
                db  3Bh ; ;
                db    0
                db    0
                db    0
                db  5Ah ; Z
                db    0
                db    0
                db    0
                db  78h ; x
                db    0
                db    0
                db    0
                db  97h
                db    0
                db    0
                db    0
                db 0B5h
                db    0
                db    0
                db    0
                db 0D4h
                db    0
                db    0
                db    0
                db 0F3h
                db    0
                db    0
                db    0
                db  11h
                db    1
                db    0
                db    0
                db  30h ; 0
                db    1
                db    0
                db    0
                db  4Eh ; N
                db    1
                db    0
                db    0
                db  6Dh ; m
                db    1
                db    0
                db    0
dword_641C6C    dd 0                    ; DATA XREF: ___loctotime_t+2E↑r
dword_641C70    dd 0FFFFFFFFh           ; DATA XREF: __make_time_t+6F↑r
                db  1Eh
                db    0
                db    0
                db    0
                db  3Ah ; :
                db    0
                db    0
                db    0
                db  59h ; Y
                db    0
                db    0
                db    0
                db  77h ; w
                db    0
                db    0
                db    0
                db  96h
                db    0
                db    0
                db    0
                db 0B4h
                db    0
                db    0
                db    0
                db 0D3h
                db    0
                db    0
                db    0
                db 0F2h
                db    0
                db    0
                db    0
                db  10h
                db    1
                db    0
                db    0
                db  2Fh ; /
                db    1
                db    0
                db    0
                db  4Dh ; M
                db    1
                db    0
                db    0
                db  6Ch ; l
                db    1
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
unk_641CA8      db    0                 ; DATA XREF: sub_5CFF00+8↑o
                db    4
                db    0
                db    0
                db    1
                db 0FCh
                db 0FFh
                db 0FFh
                db  35h ; 5
                db    0
                db    0
                db    0
                db  0Bh
                db    0
                db    0
                db    0
                db  40h ; @
                db    0
                db    0
                db    0
                db 0FFh
                db    3
                db    0
                db    0
unk_641CC0      db  80h                 ; DATA XREF: sub_5CFF20+8↑o
                db    0
                db    0
                db    0
                db  81h
                db 0FFh
                db 0FFh
                db 0FFh
                db  18h
                db    0
                db    0
                db    0
                db    8
                db    0
                db    0
                db    0
                db  20h
                db    0
                db    0
                db    0
                db  7Fh ; 
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
byte_641CE0     db 0                    ; DATA XREF: unknown_libname_319+26↑r
                db    1
                db    0
                db    0
                db    4
                db    0
                db    0
                db    7
                db    0
                db    0
                db  0Ah
                db    0
                db    0
                db  0Dh
                db    0
                db    0
flt_641CF0      dd 0.9375               ; DATA XREF: unknown_libname_319+6C↑r
flt_641CF4      dd 1.0625               ; DATA XREF: unknown_libname_319:loc_5D05A3↑r
flt_641CF8      dd 9.223372e18          ; DATA XREF: unknown_libname_319+F6↑r
byte_641CFC     db 0                    ; DATA XREF: unknown_libname_333+1D↑r
                db    1
                db    0
                db    0
                db    4
                db    0
                db    0
                db    7
                db    0
                db    0
                db  0Ah
                db    0
                db    0
                db  0Dh
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db 0EEh
                db  3Fh ; ?
dbl_641D14      dq 1.844674407370955e19 ; DATA XREF: unknown_libname_334+68↑r
dbl_641D1C      dq 5.421010862427522e-20
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db 0F0h
                db  3Fh ; ?
dbl_641D2C      dq 0.5                  ; DATA XREF: unknown_libname_333+161↑r
tbyte_641D34    dt 1.1897133414953030964e4932
jpt_5D063D      dd offset loc_5D0644, offset loc_5D064A, offset loc_5D064F
                dd offset loc_5D0655, offset loc_5D065A, offset loc_5D0660 ; jump table for switch statement
                dd offset loc_5D0666, offset loc_5D066C, offset loc_5D0672
                dd offset loc_5D068E, offset loc_5D0693, offset loc_5D06A9
                dd offset loc_5D06AE, offset loc_5D06CA, offset loc_5D06DA
                dd offset loc_5D06EE, offset loc_5D06FE, offset loc_5D071E
                dd offset loc_5D0723, offset loc_5D073D, offset loc_5D0742
                dd offset loc_5D0762, offset loc_5D0776, offset loc_5D078E
                dd offset loc_5D07A2, offset loc_5D07C2, offset loc_5D07C7
                dd offset loc_5D07E1, offset loc_5D07E6, offset loc_5D0806
                dd offset loc_5D081A, offset loc_5D0832, offset loc_5D0846
                dd offset loc_5D0866, offset loc_5D086B, offset loc_5D0885
                dd offset loc_5D088A, offset loc_5D08AA, offset loc_5D08BE
                dd offset loc_5D08D6, offset loc_5D08EA, offset loc_5D090A
                dd offset loc_5D090F, offset loc_5D0929, offset loc_5D092E
                dd offset loc_5D094E, offset loc_5D0962, offset loc_5D097A
                dd offset loc_5D098E, offset loc_5D09AE, offset loc_5D09B3
                dd offset loc_5D09CD, offset loc_5D09D2, offset loc_5D09F2
                dd offset loc_5D0A06, offset loc_5D0A1E, offset loc_5D0A32
                dd offset loc_5D0A52, offset loc_5D0A57, offset loc_5D0A71
                dd offset loc_5D0A76, offset loc_5D0A96, offset loc_5D0AAA
                dd offset loc_5D0AC2
                align 10h
; char *off_641E40
; CHAR byte_659A5C_2[4]
byte_659A5C_2     db 4 dup(?)             ; DATA XREF: sub_4502C0+2D↑o

off_641E40      dd offset byte_659A5C_2   ; DATA XREF: _trans_lang_lang+19↑r
dword_641E44    dd 400h
                dd offset aAmerican     ; "american"
                dd 409h
                dd offset aAmericanEnglis_0 ; "american english"
                dd 409h
                dd offset aAmericanEnglis ; "american-english"
                dd 409h
                dd offset aAustralian   ; "australian"
                dd 0C09h
                dd offset aBelgian      ; "belgian"
                dd 813h
                dd offset aCanadian     ; "canadian"
                dd 1009h
                dd offset aChh          ; "chh"
                dd 0C04h
                dd offset aChi          ; "chi"
                dd 1004h
                dd offset aChinese      ; "chinese"
                dd 404h
                dd offset aChineseHongkon ; "chinese-hongkong"
                dd 0C04h
                dd offset aChineseSimplif ; "chinese-simplified"
                dd 804h
                dd offset aChineseSingapo ; "chinese-singapore"
                dd 1004h
                dd offset aChineseTraditi ; "chinese-traditional"
                dd 404h
                dd offset aChs          ; "chs"
                dd 804h
                dd offset aCht          ; "cht"
                dd 404h
                dd offset aCsy          ; "csy"
                dd 405h
                dd offset aCzech        ; "czech"
                dd 405h
                dd offset aDan          ; "dan"
                dd 406h
                dd offset aDanish       ; "danish"
                dd 406h
                dd offset aDea          ; "dea"
                dd 0C07h
                dd offset aDes          ; "des"
                dd 807h
                dd offset aDeu          ; "deu"
                dd 407h
                dd offset aDutch        ; "dutch"
                dd 413h
                dd offset aDutchBelgian ; "dutch-belgian"
                dd 813h
                dd offset aEll          ; "ell"
                dd 408h
                dd offset aEna          ; "ena"
                dd 0C09h
                dd offset aEnc          ; "enc"
                dd 1009h
                dd offset aEng          ; "eng"
                dd 809h
                dd offset aEnglish      ; "english"
                dd 409h
                dd offset aEnglishAmerica ; "english-american"
                dd 409h
                dd offset aEnglishAus   ; "english-aus"
                dd 0C09h
                dd offset aEnglishCan   ; "english-can"
                dd 1009h
                dd offset aEnglishIre   ; "english-ire"
                dd 1809h
                dd offset aEnglishNz    ; "english-nz"
                dd 1409h
                dd offset aEnglishUk    ; "english-uk"
                dd 809h
                dd offset aEnglishUs    ; "english-us"
                dd 409h
                dd offset aEnglishUsa   ; "english-usa"
                dd 409h
                dd offset aEni          ; "eni"
                dd 1809h
                dd offset aEnu          ; "enu"
                dd 409h
                dd offset aEnz          ; "enz"
                dd 1409h
                dd offset aEsm          ; "esm"
                dd 80Ah
                dd offset aEsn          ; "esn"
                dd 0C0Ah
                dd offset aEsp          ; "esp"
                dd 40Ah
                dd offset aFin          ; "fin"
                dd 40Bh
                dd offset aFinnish      ; "finnish"
                dd 40Bh
                dd offset aFra          ; "fra"
                dd 40Ch
                dd offset aFrb          ; "frb"
                dd 80Ch
                dd offset aFrc          ; "frc"
                dd 0C0Ch
                dd offset aFrench       ; "french"
                dd 40Ch
                dd offset aFrenchBelgian ; "french-belgian"
                dd 80Ch
                dd offset aFrenchCanadian ; "french-canadian"
                dd 0C0Ch
                dd offset aFrenchSwiss  ; "french-swiss"
                dd 100Ch
                dd offset aFrs          ; "frs"
                dd 100Ch
                dd offset aGerman       ; "german"
                dd 407h
                dd offset aGermanAustrian ; "german-austrian"
                dd 0C07h
                dd offset aGermanSwiss  ; "german-swiss"
                dd 807h
                dd offset aGreek        ; "greek"
                dd 408h
                dd offset aHun          ; "hun"
                dd 40Eh
                dd offset aHungarian    ; "hungarian"
                dd 40Eh
                dd offset aIcelandic    ; "icelandic"
                dd 40Fh
                dd offset aIrishEnglish ; "irish-english"
                dd 1809h
                dd offset aIsl          ; "isl"
                dd 40Fh
                dd offset aIta          ; "ita"
                dd 410h
                dd offset aItalian      ; "italian"
                dd 410h
                dd offset aItalianSwiss ; "italian-swiss"
                dd 810h
                dd offset aIts          ; "its"
                dd 810h
                dd offset aJapanese     ; "japanese"
                dd 411h
                dd offset aJpn          ; "jpn"
                dd 411h
                dd offset aKor          ; "kor"
                dd 412h
                dd offset aKorean       ; "korean"
                dd 412h
                dd offset aNlb          ; "nlb"
                dd 813h
                dd offset aNld          ; "nld"
                dd 413h
                dd offset aNon          ; "non"
                dd 814h
                dd offset aNor          ; "nor"
                dd 414h
                dd offset aNorwegian    ; "norwegian"
                dd 414h
                dd offset aNorwegianBokma ; "norwegian-bokmal"
                dd 414h
                dd offset aNorwegianNynor ; "norwegian-nynorsk"
                dd 814h
                dd offset aPlk          ; "plk"
                dd 415h
                dd offset aPolish       ; "polish"
                dd 415h
                dd offset aPortuguese   ; "portuguese"
                dd 816h
                dd offset aPortugueseBraz ; "portuguese-brazilian"
                dd 416h
                dd offset aPtb          ; "ptb"
                dd 416h
                dd offset aPtg          ; "ptg"
                dd 816h
                dd offset aRus          ; "rus"
                dd 419h
                dd offset aRussian      ; "russian"
                dd 419h
                dd offset aSky          ; "sky"
                dd 41Bh
                dd offset aSlovak       ; "slovak"
                dd 41Bh
                dd offset aSpanish      ; "spanish"
                dd 40Ah
                dd offset aSpanishMexican ; "spanish-mexican"
                dd 80Ah
                dd offset aSpanishModern ; "spanish-modern"
                dd 0C0Ah
                dd offset aSve          ; "sve"
                dd 41Dh
                dd offset aSwedish      ; "swedish"
                dd 41Dh
                dd offset aSwiss        ; "swiss"
                dd 807h
                dd offset aTrk          ; "trk"
                dd 41Fh
                dd offset aTurkish      ; "turkish"
                dd 41Fh
                dd offset aUk           ; "uk"
                dd 809h
                dd offset aUs           ; "us"
                dd 409h
                dd offset aUsa          ; "usa"
                dd 409h
; char *off_642158
off_642158      dd offset byte_659A5C_2   ; DATA XREF: _trans_ctry_ctry+19↑r
dword_64215C    dd 0                    ; DATA XREF: _trans_ctry_ctry:loc_5D2C4F↑r
                dd offset aAmerica      ; "america"
                dd 1
                dd offset aAus          ; "aus"
                dd 3Dh
                dd offset aAustralia    ; "australia"
                dd 3Dh
                dd offset aAustria      ; "austria"
                dd 2Bh
                dd offset aAut          ; "aut"
                dd 2Bh
                dd offset aBel          ; "bel"
                dd 20h
                dd offset aBelgium      ; "belgium"
                dd 20h
                dd offset aBra          ; "bra"
                dd 37h
                dd offset aBrazil       ; "brazil"
                dd 37h
                dd offset aBritain      ; "britain"
                dd 2Ch
                dd offset aCan          ; "can"
                dd 2
                dd offset aCanada       ; "canada"
                dd 2
                dd offset aChe          ; "che"
                dd 29h
                dd offset aChina        ; "china"
                dd 56h
                dd offset aChn          ; "chn"
                dd 56h
                dd offset aCze          ; "cze"
                dd 2Ah
                dd offset aCzech        ; "czech"
                dd 2Ah
                dd offset aDenmark      ; "denmark"
                dd 2Dh
                dd offset aDeu          ; "deu"
                dd 31h
                dd offset aDnk          ; "dnk"
                dd 2Dh
                dd offset aEngland      ; "england"
                dd 2Ch
                dd offset aEsp          ; "esp"
                dd 22h
                dd offset aFin          ; "fin"
                dd 166h
                dd offset aFinland      ; "finland"
                dd 166h
                dd offset aFra          ; "fra"
                dd 21h
                dd offset aFrance       ; "france"
                dd 21h
                dd offset aGbr          ; "gbr"
                dd 2Ch
                dd offset aGermany      ; "germany"
                dd 31h
                dd offset aGrc          ; "grc"
                dd 1Eh
                dd offset aGreatBritain ; "great britain"
                dd 2Ch
                dd offset aGreece       ; "greece"
                dd 1Eh
                dd offset aHkg          ; "hkg"
                dd 354h
                dd offset aHolland      ; "holland"
                dd 1Fh
                dd offset aHongKong_0   ; "hong kong"
                dd 354h
                dd offset aHongKong     ; "hong-kong"
                dd 354h
                dd offset aHun          ; "hun"
                dd 24h
                dd offset aHungary      ; "hungary"
                dd 24h
                dd offset aIceland      ; "iceland"
                dd 162h
                dd offset aIreland      ; "ireland"
                dd 161h
                dd offset aIrl          ; "irl"
                dd 161h
                dd offset aIsl          ; "isl"
                dd 162h
                dd offset aIta          ; "ita"
                dd 27h
                dd offset aItaly        ; "italy"
                dd 27h
                dd offset aJapan        ; "japan"
                dd 51h
                dd offset aJpn          ; "jpn"
                dd 51h
                dd offset aKor          ; "kor"
                dd 52h
                dd offset aKorea        ; "korea"
                dd 52h
                dd offset aMex          ; "mex"
                dd 34h
                dd offset aMexico       ; "mexico"
                dd 34h
                dd offset aNetherlands  ; "netherlands"
                dd 1Fh
                dd offset aNewZealand_0 ; "new zealand"
                dd 40h
                dd offset aNewZealand   ; "new-zealand"
                dd 40h
                dd offset aNld          ; "nld"
                dd 1Fh
                dd offset aNor          ; "nor"
                dd 2Fh
                dd offset aNorway       ; "norway"
                dd 2Fh
                dd offset aNz           ; "nz"
                dd 40h
                dd offset aNzl          ; "nzl"
                dd 40h
                dd offset aPol          ; "pol"
                dd 30h
                dd offset aPoland       ; "poland"
                dd 30h
                dd offset aPortugal     ; "portugal"
                dd 15Fh
                dd offset aPrChina_0    ; "pr china"
                dd 56h
                dd offset aPrChina      ; "pr-china"
                dd 56h
                dd offset aPrt          ; "prt"
                dd 15Fh
                dd offset aRus          ; "rus"
                dd 7
                dd offset aRussia       ; "russia"
                dd 7
                dd offset aSingapore    ; "singapore"
                dd 41h
                dd offset aSgp          ; "sgp"
                dd 41h
                dd offset aSlovak       ; "slovak"
                dd 2Ah
                dd offset aSouthKorea_0 ; "south korea"
                dd 52h
                dd offset aSouthKorea   ; "south-korea"
                dd 52h
                dd offset aSpain        ; "spain"
                dd 22h
                dd offset aSvk          ; "svk"
                dd 2Ah
                dd offset aSwe          ; "swe"
                dd 2Eh
                dd offset aSweden       ; "sweden"
                dd 2Eh
                dd offset aSwitzerland  ; "switzerland"
                dd 29h
                dd offset aTaiwan       ; "taiwan"
                dd 376h
                dd offset aTur          ; "tur"
                dd 5Ah
                dd offset aTurkey       ; "turkey"
                dd 5Ah
                dd offset aTwn          ; "twn"
                dd 376h
                dd offset aUk           ; "uk"
                dd 2Ch
                dd offset aUnitedKingdom_0 ; "united kingdom"
                dd 2Ch
                dd offset aUnitedStates_0 ; "united states"
                dd 1
                dd offset aUnitedKingdom ; "united-kingdom"
                dd 2Ch
                dd offset aUnitedStates ; "united-states"
                dd 1
                dd offset aUs           ; "us"
                dd 1
                dd offset aUsa          ; "usa"
                dd 1

                ; DATA XREF: _trans_ctry_lang+3C↑r
                ; _match_ctry_lang+37↑o
word_642410     dw 0, 0, 0, 409h, 0, 0, 1009h, 0C0Ch, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 419h, 0 ; 0
                dw 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ; 23
                dw 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ; 51
                dw 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 408h, 0, 0, 413h, 0, 0, 813h, 80Ch, 0, 40Ch, 0, 0 ; 79
                dw 40Ah, 0, 0, 0, 0, 0, 40Eh, 0, 0, 0, 0, 0, 0, 0, 0, 410h, 0, 0, 0, 0, 0, 807h, 100Ch ; 102
                dw 810h, 405h, 41Bh, 0, 0C07h, 0, 0, 809h, 0, 0, 406h, 0, 0, 41Dh, 0, 0, 414h, 0, 0 ; 125
                dw 415h, 0, 0, 407h, 0, 0, 0, 0, 0, 816h, 0, 0, 80Ah, 0, 0, 1809h, 0, 0, 40Fh, 0, 0 ; 144
                dw 416h, 0, 0, 0, 0, 0, 0, 0, 0, 40Bh, 0, 0, 0, 0, 0, 0, 0, 0, 0C09h, 0, 0, 0, 0, 0 ; 165
                dw 0, 0, 0, 1409h, 0, 0, 1004h, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ; 189
                dw 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ; 214
                dw 0, 411h, 0, 0, 412h, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 404h, 0, 0, 0, 0, 0, 0, 0, 0 ; 242
                dw 0, 0, 0, 41Fh, 0, 0, 0 ; 267

dword_642634    dd 2694h                ; DATA XREF: __cintrindisp2+12↑r
unk_642638      db  2Eh ; .             ; DATA XREF: ___init_numeric+B6↑o
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
off_642640      dd offset unk_642638    ; DATA XREF: ___init_monetary+A2↑w
off_642644      dd offset unk_70D7E0    ; DATA XREF: ___init_monetary+AB↑w
off_642648      dd offset unk_70D7E0    ; DATA XREF: ___init_monetary+B9↑w
                dd offset unk_70D7E0
                dd offset unk_70D7E0
                dd offset unk_70D7E0
                dd offset unk_70D7E0
                dd offset unk_70D7E0
                dd offset unk_70D7E0
                dd offset unk_70D7E0
                db  7Fh ; 
                db  7Fh ; 
                db  7Fh ; 
                db  7Fh ; 
                db  7Fh ; 
                db  7Fh ; 
                db  7Fh ; 
                db  7Fh ; 
off_642670      dd offset off_642640    ; DATA XREF: ___init_numeric:loc_5D20EE↑r
                align 8
off_642678      dd offset aCmd          ; DATA XREF: __spawnve+1A5↑o
                dd offset aBat          ; ".bat"
                dd offset aExe          ; ".exe"
off_642684      dd offset aCom          ; DATA XREF: __spawnve+160↑o
unk_642688      db    0                 ; DATA XREF: ___multtenpow12+A↑o
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db 0A0h
                db    2
                db  40h ; @
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db 0C8h
                db    5
                db  40h ; @
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db 0FAh
                db    8
                db  40h ; @
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  40h ; @
                db  9Ch
                db  0Ch
                db  40h ; @
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  50h ; P
                db 0C3h
                db  0Fh
                db  40h ; @
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  24h ; $
                db 0F4h
                db  12h
                db  40h ; @
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  80h
                db  96h
                db  98h
                db  16h
                db  40h ; @
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db  20h
                db 0BCh
                db 0BEh
                db  19h
                db  40h ; @
                db    0
                db    0
                db    0
                db    0
                db    0
                db    4
                db 0BFh
                db 0C9h
                db  1Bh
                db  8Eh
                db  34h ; 4
                db  40h ; @
                db    0
                db    0
                db    0
                db 0A1h
                db 0EDh
                db 0CCh
                db 0CEh
                db  1Bh
                db 0C2h
                db 0D3h
                db  4Eh ; N
                db  40h ; @
                db  20h
                db 0F0h
                db  9Eh
                db 0B5h
                db  70h ; p
                db  2Bh ; +
                db 0A8h
                db 0ADh
                db 0C5h
                db  9Dh
                db  69h ; i
                db  40h ; @
                db 0D0h
                db  5Dh ; ]
                db 0FDh
                db  25h ; %
                db 0E5h
                db  1Ah
                db  8Eh
                db  4Fh ; O
                db  19h
                db 0EBh
                db  83h
                db  40h ; @
                db  71h ; q
                db  96h
                db 0D7h
                db  95h
                db  43h ; C
                db  0Eh
                db    5
                db  8Dh
                db  29h ; )
                db 0AFh
                db  9Eh
                db  40h ; @
                db 0F9h
                db 0BFh
                db 0A0h
                db  44h ; D
                db 0EDh
                db  81h
                db  12h
                db  8Fh
                db  81h
                db  82h
                db 0B9h
                db  40h ; @
                db 0BFh
                db  3Ch ; <
                db 0D5h
                db 0A6h
                db 0CFh
                db 0FFh
                db  49h ; I
                db  1Fh
                db  78h ; x
                db 0C2h
                db 0D3h
                db  40h ; @
                db  6Fh ; o
                db 0C6h
                db 0E0h
                db  8Ch
                db 0E9h
                db  80h
                db 0C9h
                db  47h ; G
                db 0BAh
                db  93h
                db 0A8h
                db  41h ; A
                db 0BCh
                db  85h
                db  6Bh ; k
                db  55h ; U
                db  27h ; '
                db  39h ; 9
                db  8Dh
                db 0F7h
                db  70h ; p
                db 0E0h
                db  7Ch ; |
                db  42h ; B
                db 0BCh
                db 0DDh
                db  8Eh
                db 0DEh
                db 0F9h
                db  9Dh
                db 0FBh
                db 0EBh
                db  7Eh ; ~
                db 0AAh
                db  51h ; Q
                db  43h ; C
                db 0A1h
                db 0E6h
                db  76h ; v
                db 0E3h
                db 0CCh
                db 0F2h
                db  29h ; )
                db  2Fh ; /
                db  84h
                db  81h
                db  26h ; &
                db  44h ; D
                db  28h ; (
                db  10h
                db  17h
                db 0AAh
                db 0F8h
                db 0AEh
                db  10h
                db 0E3h
                db 0C5h
                db 0C4h
                db 0FAh
                db  44h ; D
                db 0EBh
                db 0A7h
                db 0D4h
                db 0F3h
                db 0F7h
                db 0EBh
                db 0E1h
                db  4Ah ; J
                db  7Ah ; z
                db  95h
                db 0CFh
                db  45h ; E
                db  65h ; e
                db 0CCh
                db 0C7h
                db  91h
                db  0Eh
                db 0A6h
                db 0AEh
                db 0A0h
                db  19h
                db 0E3h
                db 0A3h
                db  46h ; F
                db  0Dh
                db  65h ; e
                db  17h
                db  0Ch
                db  75h ; u
                db  81h
                db  86h
                db  75h ; u
                db  76h ; v
                db 0C9h
                db  48h ; H
                db  4Dh ; M
                db  58h ; X
                db  42h ; B
                db 0E4h
                db 0A7h
                db  93h
                db  39h ; 9
                db  3Bh ; ;
                db  35h ; 5
                db 0B8h
                db 0B2h
                db 0EDh
                db  53h ; S
                db  4Dh ; M
                db 0A7h
                db 0E5h
                db  5Dh ; ]
                db  3Dh ; =
                db 0C5h
                db  5Dh ; ]
                db  3Bh ; ;
                db  8Bh
                db  9Eh
                db  92h
                db  5Ah ; Z
                db 0FFh
                db  5Dh ; ]
                db 0A6h
                db 0F0h
                db 0A1h
                db  20h
                db 0C0h
                db  54h ; T
                db 0A5h
                db  8Ch
                db  37h ; 7
                db  61h ; a
                db 0D1h
                db 0FDh
                db  8Bh
                db  5Ah ; Z
                db  8Bh
                db 0D8h
                db  25h ; %
                db  5Dh ; ]
                db  89h
                db 0F9h
                db 0DBh
                db  67h ; g
                db 0AAh
                db  95h
                db 0F8h
                db 0F3h
                db  27h ; '
                db 0BFh
                db 0A2h
                db 0C8h
                db  5Dh ; ]
                db 0DDh
                db  80h
                db  6Eh ; n
                db  4Ch ; L
                db 0C9h
                db  9Bh
                db  97h
                db  20h
                db  8Ah
                db    2
                db  52h ; R
                db  60h ; `
                db 0C4h
                db  25h ; %
                db  75h ; u
                db    0
                db    0
                db    0
                db    0
unk_6427E8      db 0CDh                 ; DATA XREF: ___multtenpow12+18↑o
                db 0CCh
                db 0CDh
                db 0CCh
                db 0CCh
                db 0CCh
                db 0CCh
                db 0CCh
                db 0CCh
                db 0CCh
                db 0FBh
                db  3Fh ; ?
                db  71h ; q
                db  3Dh ; =
                db  0Ah
                db 0D7h
                db 0A3h
                db  70h ; p
                db  3Dh ; =
                db  0Ah
                db 0D7h
                db 0A3h
                db 0F8h
                db  3Fh ; ?
                db  5Ah ; Z
                db  64h ; d
                db  3Bh ; ;
                db 0DFh
                db  4Fh ; O
                db  8Dh
                db  97h
                db  6Eh ; n
                db  12h
                db  83h
                db 0F5h
                db  3Fh ; ?
                db 0C3h
                db 0D3h
                db  2Ch ; ,
                db  65h ; e
                db  19h
                db 0E2h
                db  58h ; X
                db  17h
                db 0B7h
                db 0D1h
                db 0F1h
                db  3Fh ; ?
                db 0D0h
                db  0Fh
                db  23h ; #
                db  84h
                db  47h ; G
                db  1Bh
                db  47h ; G
                db 0ACh
                db 0C5h
                db 0A7h
                db 0EEh
                db  3Fh ; ?
                db  40h ; @
                db 0A6h
                db 0B6h
                db  69h ; i
                db  6Ch ; l
                db 0AFh
                db    5
                db 0BDh
                db  37h ; 7
                db  86h
                db 0EBh
                db  3Fh ; ?
                db  33h ; 3
                db  3Dh ; =
                db 0BCh
                db  42h ; B
                db  7Ah ; z
                db 0E5h
                db 0D5h
                db  94h
                db 0BFh
                db 0D6h
                db 0E7h
                db  3Fh ; ?
                db 0C2h
                db 0FDh
                db 0FDh
                db 0CEh
                db  61h ; a
                db  84h
                db  11h
                db  77h ; w
                db 0CCh
                db 0ABh
                db 0E4h
                db  3Fh ; ?
                db  2Fh ; /
                db  4Ch ; L
                db  5Bh ; [
                db 0E1h
                db  4Dh ; M
                db 0C4h
                db 0BEh
                db  94h
                db  95h
                db 0E6h
                db 0C9h
                db  3Fh ; ?
                db  92h
                db 0C4h
                db  53h ; S
                db  3Bh ; ;
                db  75h ; u
                db  44h ; D
                db 0CDh
                db  14h
                db 0BEh
                db  9Ah
                db 0AFh
                db  3Fh ; ?
                db 0DEh
                db  67h ; g
                db 0BAh
                db  94h
                db  39h ; 9
                db  45h ; E
                db 0ADh
                db  1Eh
                db 0B1h
                db 0CFh
                db  94h
                db  3Fh ; ?
                db  24h ; $
                db  23h ; #
                db 0C6h
                db 0E2h
                db 0BCh
                db 0BAh
                db  3Bh ; ;
                db  31h ; 1
                db  61h ; a
                db  8Bh
                db  7Ah ; z
                db  3Fh ; ?
                db  61h ; a
                db  55h ; U
                db  59h ; Y
                db 0C1h
                db  7Eh ; ~
                db 0B1h
                db  53h ; S
                db  7Ch ; |
                db  12h
                db 0BBh
                db  5Fh ; _
                db  3Fh ; ?
                db 0D7h
                db 0EEh
                db  2Fh ; /
                db  8Dh
                db    6
                db 0BEh
                db  92h
                db  85h
                db  15h
                db 0FBh
                db  44h ; D
                db  3Fh ; ?
                db  24h ; $
                db  3Fh ; ?
                db 0A5h
                db 0E9h
                db  39h ; 9
                db 0A5h
                db  27h ; '
                db 0EAh
                db  7Fh ; 
                db 0A8h
                db  2Ah ; *
                db  3Fh ; ?
                db  7Dh ; }
                db 0ACh
                db 0A1h
                db 0E4h
                db 0BCh
                db  64h ; d
                db  7Ch ; |
                db  46h ; F
                db 0D0h
                db 0DDh
                db  55h ; U
                db  3Eh ; >
                db  63h ; c
                db  7Bh ; {
                db    6
                db 0CCh
                db  23h ; #
                db  54h ; T
                db  77h ; w
                db  83h
                db 0FFh
                db  91h
                db  81h
                db  3Dh ; =
                db  91h
                db 0FAh
                db  3Ah ; :
                db  19h
                db  7Ah ; z
                db  63h ; c
                db  25h ; %
                db  43h ; C
                db  31h ; 1
                db 0C0h
                db 0ACh
                db  3Ch ; <
                db  21h ; !
                db  89h
                db 0D1h
                db  38h ; 8
                db  82h
                db  47h ; G
                db  97h
                db 0B8h
                db    0
                db 0FDh
                db 0D7h
                db  3Bh ; ;
                db 0DCh
                db  88h
                db  58h ; X
                db    8
                db  1Bh
                db 0B1h
                db 0E8h
                db 0E3h
                db  86h
                db 0A6h
                db    3
                db  3Bh ; ;
                db 0C6h
                db  84h
                db  45h ; E
                db  42h ; B
                db    7
                db 0B6h
                db  99h
                db  75h ; u
                db  37h ; 7
                db 0DBh
                db  2Eh ; .
                db  3Ah ; :
                db  33h ; 3
                db  71h ; q
                db  1Ch
                db 0D2h
                db  23h ; #
                db 0DBh
                db  32h ; 2
                db 0EEh
                db  49h ; I
                db  90h
                db  5Ah ; Z
                db  39h ; 9
                db 0A6h
                db  87h
                db 0BEh
                db 0C0h
                db  57h ; W
                db 0DAh
                db 0A5h
                db  82h
                db 0A6h
                db 0A2h
                db 0B5h
                db  32h ; 2
                db 0E2h
                db  68h ; h
                db 0B2h
                db  11h
                db 0A7h
                db  52h ; R
                db  9Fh
                db  44h ; D
                db  59h ; Y
                db 0B7h
                db  10h
                db  2Ch ; ,
                db  25h ; %
                db  49h ; I
                db 0E4h
                db  2Dh ; -
                db  36h ; 6
                db  34h ; 4
                db  4Fh ; O
                db  53h ; S
                db 0AEh
                db 0CEh
                db  6Bh ; k
                db  25h ; %
                db  8Fh
                db  59h ; Y
                db    4
                db 0A4h
                db 0C0h
                db 0DEh
                db 0C2h
                db  7Dh ; }
                db 0FBh
                db 0E8h
                db 0C6h
                db  1Eh
                db  9Eh
                db 0E7h
                db  88h
                db  5Ah ; Z
                db  57h ; W
                db  91h
                db  3Ch ; <
                db 0BFh
                db  50h ; P
                db  83h
                db  22h ; "
                db  18h
                db  4Eh ; N
                db  4Bh ; K
                db  65h ; e
                db  62h ; b
                db 0FDh
                db  83h
                db  8Fh
                db 0AFh
                db    6
                db  94h
                db  7Dh ; }
                db  11h
                db 0E4h
                db  2Dh ; -
                db 0DEh
                db  9Fh
                db 0CEh
                db 0D2h
                db 0C8h
                db    4
                db 0DDh
                db 0A6h
                db 0D8h
                db  0Ah
                db    2
                db    0
                db    0
                db    0








dword_70D320    dd ?                    ; DATA XREF: .text:005BEFA4↑r
dword_70D324    dd ?                    ; DATA XREF: __fpmath+A↑w
dword_70D328    dd ?                    ; DATA XREF: __sopen+135↑r
dword_70D32C    dd ?                    ; DATA XREF: start+52↑w
dword_70D330    dd ?                    ; DATA XREF: start+49↑w
dword_70D334    dd ?                    ; DATA XREF: start+3E↑w
dword_70D338    dd ?                    ; DATA XREF: start+30↑w
__argc    dd ?                    ; DATA XREF: __setargv+94↑w
__targv    dd ?                    ; DATA XREF: __setargv+8D↑w
                db 4 dup(?)
; void *dword_70D348
dword_70D348    dd ?                    ; DATA XREF: __setenvp+48↑w
dword_70D34C    dd ?                    ; DATA XREF: ___crtsetenv+31↑r
dword_70D350    dd ?                    ; DATA XREF: __getenv_lk+E↑r
                db 4 dup(?)
dword_70D358    dd ?                    ; DATA XREF: __setargv+1D↑w
                db 4 dup(?)
; void *dword_70D36C
dword_70D36C    dd ?                    ; DATA XREF: start+9E↑w
                db 4h dup(?)

dword_70D378    dd ?                    ; DATA XREF: _time+62↑r
                db 4 dup(?)
dword_70D380    dd ?                    ; DATA XREF: _time+59↑r
unk_70D384      db 2h dup(?)
word_70D386     dw ?                    ; DATA XREF: _time+3D↑r
dword_70D388    dd ?                    ; DATA XREF: _time+2F↑r
dword_70D38C    dd ?                    ; DATA XREF: _time+C9↑w
unk_70D390      db 28h dup(?)
__mbctype      db 104h dup(?)
; UINT dword_70D4BC
dword_70D4BC    dd ?                    ; DATA XREF: __mbschr↑r
; LCID Locale
g_Locale          dd ?                    ; DATA XREF: __mbsupr+34↑r
                align 8
dword_70D4C8    dd ?                    ; DATA XREF: __setmbcp+111↑w
dword_70D4CC    dd ?                    ; DATA XREF: __setmbcp+117↑w
dword_70D4D0    dd ?                    ; DATA XREF: __setmbcp+11D↑w
dword_70D4D4    dd ?                    ; DATA XREF: __setmbcp:loc_5C4755↑r
dword_70D4D8    dd ?                    ; DATA XREF: __Strftime+C8↑w
dword_70D4DC    dd ?                    ; DATA XREF: __expandtime+150↑w


dword_70D550    dd 2 dup (?)                    ; DATA XREF: __strcmpi+C↑o

; LCID dword_70D558
dword_70D558    dd ?                    ; DATA XREF: _tolower↑r
dword_70D55C    dd ?                    ; DATA XREF: ___init_monetary↑r
dword_70D560    dd ?                    ; DATA XREF: ___init_numeric↑r
dword_70D564    dd ?                    ; DATA XREF: ___init_time↑r
; UINT CodePage
g_CodePage        dd ?                    ; DATA XREF: _getSystemCP+3D↑r
dword_70D56C    dd ?                    ; DATA XREF: __expandlocale+108↑o
dword_70D570    dd ?                    ; DATA XREF: __expandlocale:loc_5CB623↑r
dword_70D574    dd ?                    ; DATA XREF: __expandlocale+137↑w
dword_70D578    dd ?                    ; DATA XREF: ___crtLCMapStringW↑r
dword_70D57C    dd ?                    ; DATA XREF: ___crtLCMapStringA↑r
; LPTOP_LEVEL_EXCEPTION_FILTER lpfn
g_lpfn            dd ?                    ; DATA XREF: __CxxUnhandledExceptionFilter(_EXCEPTION_POINTERS *):loc_5CC06C↑r



                align 10h
; CHAR Filename[264]
g_Filename        db 108h dup(?)          ; DATA XREF: __setargv+A↑o
dword_70D6A8    dd ?                    ; DATA XREF: ___crtGetEnvironmentStringsA↑r
                align 10h
dword_70D6B0    dd ?                    ; DATA XREF: __stbuf+4A↑r
                align 8
dword_70D6B8    dd ?                    ; DATA XREF: __fdopen:loc_5C39DD↑r
dword_70D6BC    dd ?                    ; DATA XREF: ___crtGetStringTypeW+1↑r
dword_70D6C0    dd ?                    ; DATA XREF: ___crtGetStringTypeA+1↑r
dword_70D6C4    dd ?                    ; DATA XREF: __fdopen:loc_5C3957↑r
dword_70D6C8    dd ?                    ; DATA XREF: __tzset_lk+14↑w
                align 10h
; struct _TIME_ZONE_INFORMATION TimeZoneInformation
g_TimeZoneInformation _TIME_ZONE_INFORMATION  <>

; void *dword_70D77C
dword_70D77C    dd ?                    ; DATA XREF: __tzset_lk+125↑r
dword_70D780    dd ?                    ; DATA XREF: ___tzset↑r
; void *dword_70D784
dword_70D784    dd ?                    ; DATA XREF: ___init_time:loc_5D191C↑r
; void *dword_70D788
dword_70D788    dd ?                    ; DATA XREF: ___init_numeric+1B↑o
; void *dword_70D78C
dword_70D78C    dd ?                    ; DATA XREF: ___init_numeric+2F↑o
; void *dword_70D790
dword_70D790    dd ?                    ; DATA XREF: ___init_numeric+43↑o
; void *dword_70D794
dword_70D794    dd ?                    ; DATA XREF: ___init_monetary+6E↑r
; void *dword_70D798
dword_70D798    dd ?                    ; DATA XREF: sub_5D2570:loc_5D274A↑r
; void *dword_70D79C
dword_70D79C    dd ?                    ; DATA XREF: sub_5D2570:loc_5D2768↑r
unk_70D7A0      db 0Ch dup(?)
; LCID word_70D7AC
word_70D7AC     dw ?                    ; DATA XREF: sub_5D2570+29↑r
                db 6h dup(?)
; LCID word_70D7B4
word_70D7B4     dw ?                    ; DATA XREF: __get_lc_lconv+8↑r
                db 4h dup(?)
; LCID word_70D7BA
word_70D7BA     dw ?                    ; DATA XREF: ___init_numeric+D↑r
                db 2h dup(?)
; LCID word_70D7BE
word_70D7BE     dw ?                    ; DATA XREF: __get_lc_time+B↑r
; LCID word_70D7C0
word_70D7C0     dw ?                    ; DATA XREF: __get_lc_time+12↑r
                align 4

dword_70D7D0    dd ?                    ; DATA XREF: __sopen+41↑r
                align 8
; WCHAR LCData
LCData          dw ?                    ; DATA XREF: ___getlocaleinfo+119↑o
                db 6h dup(?)
unk_70D7E0      db 4h dup(?)
dword_70D7E4    dd ?                    ; DATA XREF: ___crtGetLocaleInfoW↑r
dword_70D7E8    dd ?                    ; DATA XREF: ___crtGetLocaleInfoA↑r
dword_70D7EC    dd ?                    ; DATA XREF: ___crtCompareStringW↑r
dword_70D7F0    dd ?                    ; DATA XREF: ___crtCompareStringA↑r
                align 8


aHMmSs          db 'H:mm:ss',0          ; DATA XREF: .data:0063F108↓o
aDdddMmmmDdYyyy db 'dddd, MMMM dd, yyyy',0 ; DATA XREF: .data:0063F104↓o
aMDYy           db 'M/d/yy',0           ; DATA XREF: .data:0063F100↓o
                align 4
aPm             db 'PM',0               ; DATA XREF: .data:0063F0FC↓o

                align 4
g_aAm             db 'AM',0               ; DATA XREF: .data:0063F0F8↓o
                align 10h

aDecember       db 'December',0         ; DATA XREF: .data:0063F0F4↓o
                align 4
aNovember       db 'November',0         ; DATA XREF: .data:0063F0F0↓o
                align 4
aOctober        db 'October',0          ; DATA XREF: .data:0063F0EC↓o
aSeptember      db 'September',0        ; DATA XREF: .data:0063F0E8↓o
                align 4
aAugust         db 'August',0           ; DATA XREF: .data:0063F0E4↓o
                align 4
aJuly           db 'July',0             ; DATA XREF: .data:0063F0E0↓o
                align 4
aJune           db 'June',0             ; DATA XREF: .data:0063F0DC↓o
                align 4
aApril          db 'April',0            ; DATA XREF: .data:0063F0D4↓o
                align 4
aMarch          db 'March',0            ; DATA XREF: .data:0063F0D0↓o
                align 4
aFebruary       db 'February',0         ; DATA XREF: .data:0063F0CC↓o
                align 10h
aJanuary        db 'January',0          ; DATA XREF: .data:0063F0C8↓o

aDec            db 'Dec',0
aNov            db 'Nov',0
aOct            db 'Oct',0
aSep            db 'Sep',0
aAug            db 'Aug',0
aJul            db 'Jul',0
aJun            db 'Jun',0
aMay            db 'May',0
aApr            db 'Apr',0
aMar            db 'Mar',0
aFeb            db 'Feb',0
aJan            db 'Jan',0

aSaturday       db 'Saturday',0         ; DATA XREF: .data:0063F094↓o
                db    0
                db    0
                db    0
aFriday         db 'Friday',0           ; DATA XREF: .data:0063F090↓o
                db    0
aThursday       db 'Thursday',0         ; DATA XREF: .data:0063F08C↓o
                db    0
                db    0
                db    0
aWednesday      db 'Wednesday',0        ; DATA XREF: .data:0063F088↓o
                db    0
                db    0
aTuesday        db 'Tuesday',0          ; DATA XREF: .data:0063F084↓o
aMonday         db 'Monday',0           ; DATA XREF: .data:0063F080↓o
                db    0
aSunday         db 'Sunday',0           ; DATA XREF: .data:0063F07C↓o
                db    0
aSat            db 'Sat',0
aFri            db 'Fri',0
aThu            db 'Thu',0
aWed            db 'Wed',0
aTue            db 'Tue',0
aMon            db 'Mon',0
aSun            db 'Sun',0
; const char aAP[]
aAP             db 'a/p',0
; const char aAmPm[]
aAmPm           db 'am/pm',0            ; DATA XREF: __store_winword:loc_5C58D1↑o
                align 8




??_7type_info@@6B@ dd offset ??_Gtype_info@@UAEPAXI@Z
stru_6143F8     _SCOPETABLE_ENTRY <0FFFFFFFFh, 0, offset loc_5C0113>
                align 8
stru_614408     _SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_5C0190, offset loc_5C019D>
                align 8
stru_614418     _SCOPETABLE_ENTRY <0FFFFFFFFh, 0, offset loc_5C024F>
                align 8
unk_614428      db  63h ; c             ; DATA XREF: _CxxThrowException(x,x)+E↑o
                db  73h ; s
                db  6Dh ; m
                db 0E0h
                db    1
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    3
                db    0
                db    0
                db    0
                db  20h
                db    5
                db  93h
                db  19h
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
                db    0
dbl_614448      dq -1.0                 ; DATA XREF: _fabs+4E↑r
dbl_614450      dq 0.0                  ; DATA XREF: __hypothlp+4F↑r
stru_614458     _SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_5C1CFD, offset loc_5C1D12>
                align 8
stru_614468     _SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_5C2467, offset loc_5C247C>
                align 8
stru_614478     _SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_5C2EDD, offset loc_5C2EF2>




stru_6145B8     _SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_5C6756, offset loc_5C6763>
                align 8
stru_6145C8     _SCOPETABLE_ENTRY <0FFFFFFFFh, 0, offset loc_5C693F>
                _SCOPETABLE_ENTRY <0, offset loc_5C6907, offset loc_5C6914>
stru_6145E0     _SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_5C6BBB, offset loc_5C6BC1>
                align 10h
stru_6145F0     _SCOPETABLE_ENTRY <0FFFFFFFFh, offset loc_5C6C3A, offset loc_5C6C45>
                align 10h
stru_614600     _SCOPETABLE_ENTRY <0FFFFFFFFh, 0, offset loc_5C6F57>
                _SCOPETABLE_ENTRY <0, offset loc_5C6F2A, offset loc_5C6F30>
stru_614618     _SCOPETABLE_ENTRY <0FFFFFFFFh, 0, offset loc_5C6FFE>
                _SCOPETABLE_ENTRY <0, offset loc_5C6FD1, offset loc_5C6FD7>
dbl_614630      dq 1.0                  ; DATA XREF: __ms_p5_test_fdiv+34↑r
; const CHAR ProcName[]
ProcName        db 'IsProcessorFeaturePresent',0
                align 4
; const CHAR ModuleName[]
ModuleName      db 'KERNEL32',0         ; DATA XREF: __ms_p5_mp_test_fdiv↑o
                align 10h
dbl_614660      dq 0.0                  ; DATA XREF: __positive+6↑r
dword_614668    dd 30302B65h            ; DATA XREF: __cftoe2+59↑r
word_61466C     dw 30h                  ; DATA XREF: __cftoe2+6C↑r
                align 10h
dbl_614670      dq 1.0                  ; DATA XREF: __convertTOStoQNaN:tosIsSNaN↑r
word_614678     dw 27Fh                 ; DATA XREF: _tan+18↑r
tbyte_61467A    dt 1.4488038916154245685e19
dbl_614684      db 0FFh, 0FFh, 0FFh, 0FFh, 0FFh, 0FFh, 0EFh, 7Fh
dbl_61468C      dq 2.225073858507201e-308
dbl_614694      dq -1536.0              ; DATA XREF: __check_range_exit:haveoverflow↑r
dbl_61469C      dq 1536.0               ; DATA XREF: __check_range_exit:haveunderflow↑r
dbl_6146A4      db 0, 0, 0, 0, 0, 0, 0F0h, 7Fh                ; DATA XREF: __check_range_exit+9B↑r
dbl_6146AC      dq 0.0                  ; DATA XREF: __check_range_exit+72↑r
                align 8
byte_6146B8     db 6                    ; DATA XREF: __output:loc_5C8895↑r
                db    0
                db    0
                db    6
                db    0
                db    1
                db    0
                db    0
                db  10h
                db    0
                db    3
                db    6
                db    0
                db    6
                db    2
                db  10h
                db    4
                db  45h ; E
                db  45h ; E
                db  45h ; E
                db    5
                db    5
                db    5
                db    5
                db    5
                db  35h ; 5
                db  30h ; 0
                db    0
                db  50h ; P
                db    0
                db    0
                db    0
                db    0
                db  20h
                db  28h ; (
                db  38h ; 8
                db  50h ; P
                db  58h ; X
                db    7
                db    8
                db    0
                db  37h ; 7
                db  30h ; 0
                db  30h ; 0
                db  57h ; W
                db  50h ; P
                db    7
                db    0
                db    0
                db  20h
                db  20h
                db    8
                db    0
                db    0
                db    0
                db    0
                db    8
                db  60h ; `
                db  68h ; h
                db  60h ; `
                db  60h ; `
                db  60h ; `
                db  60h ; `
                db    0
                db    0
                db  70h ; p
                db  70h ; p
                db  78h ; x
                db  78h ; x
                db  78h ; x
                db  78h ; x
                db    8
                db    7
                db    8
                db    0
                db    0
                db    7
                db    0
                db    8
                db    8
                db    8
                db    0
                db    0
                db    8
                db    0
                db    8
                db    0
                db    7
                db    8
                db    0
                db    0
                db    0
word_614714     dw 28h                  ; DATA XREF: .data:off_641264↓o
                dw 6Eh
                dw 75h
                dw 6Ch
                dw 6Ch
                dw 29h
                dw 0
                align 4
aNull_0         db '(null)',0           ; DATA XREF: .data:off_641260↓o
                align 10h
dbl_614730      db 0FFh, 0FFh, 0FFh, 0FFh, 0FFh, 0FFh, 0EFh, 7Fh ; DATA XREF: cintrinexit+BD↑r
dbl_614738      dq 2.225073858507201e-308 ; DATA XREF: cintrinexit+8F↑r
dbl_614740      dq -1536.0              ; DATA XREF: cintrinexit+AD↑r
dbl_614748      dq 1536.0               ; DATA XREF: cintrinexit+7F↑r
dbl_614750      db 0, 0, 0, 0, 0, 0, 0F0h, 7Fh                ; DATA XREF: cintrinexit+C9↑r
dbl_614758      dq 0.0                  ; DATA XREF: cintrinexit+9B↑r
aLcTime         db 'LC_TIME',0          ; DATA XREF: .data:off_641534↓o
aLcNumeric      db 'LC_NUMERIC',0       ; DATA XREF: .data:00641528↓o
                align 4
aLcMonetary     db 'LC_MONETARY',0      ; DATA XREF: .data:0064151C↓o
aLcCtype        db 'LC_CTYPE',0         ; DATA XREF: .data:00641510↓o
                align 4
aLcCollate      db 'LC_COLLATE',0       ; DATA XREF: .data:off_641504↓o
                align 4
aLcAll          db 'LC_ALL',0           ; DATA XREF: .data:006414F8↓o
                align 10h
; const char asc_6147A0[2]
asc_6147A0      db ';',0                ; DATA XREF: _setlocale+132↑o
                align 4
; const char Control[3]
aControl         db '=;',0               ; DATA XREF: _setlocale+BB↑o
                align 4
asc_6147A8      db '=',0                ; DATA XREF: __setlocale_get_all+3D↑o
                align 4
; const char asc_6147AC[4]
asc_6147AC      db '_.,',0              ; DATA XREF: ___lc_strtolc:loc_5CB7BE↑o
word_6147B0     dw 2Eh                  ; DATA XREF: ___lc_lctostr+55↑o
                align 4
unk_6147B4      db  5Fh ; _             ; DATA XREF: ___lc_lctostr+34↑o
                db    0
                db    0
                db    0
dbl_6147B8      dq 0.0                  ; DATA XREF: __powhlp+4↑r
dbl_6147C0      dq 1.0                  ; DATA XREF: __powhlp+48↑r
dbl_6147C8      dq 2.0                  ; DATA XREF: __d_inttype+3C↑r
; const CHAR String2[4]
aString2         db 4 dup(0)             ; DATA XREF: ___crtLCMapStringW+38↑o
; const WCHAR String1
aString1         dw 0                    ; DATA XREF: ___crtLCMapStringW+19↑o
                align 4


                align 4
aYn             db '_yn',0              ; DATA XREF: .data:00641804\u2193o
aY1             db '_y1',0              ; DATA XREF: .data:006417FC\u2193o
aY0             db '_y0',0              ; DATA XREF: .data:006417F4\u2193o
aFrexp          db 'frexp',0            ; DATA XREF: .data:006417EC\u2193o
                db    0
                db    0
aFmod           db 'fmod',0             ; DATA XREF: .data:006417E4\u2193o
                db    0
                db    0
                db    0
aHypot          db '_hypot',0           ; DATA XREF: .data:006417DC\u2193o
                db    0
aCabs           db '_cabs',0            ; DATA XREF: .data:006417D4\u2193o
                db    0
                db    0
aLdexp          db 'ldexp',0            ; DATA XREF: .data:006417CC\u2193o
                db    0
                db    0
aModf           db 'modf',0             ; DATA XREF: .data:006417C4\u2193o
                db    0
                db    0
                db    0
aFabs           db 'fabs',0             ; DATA XREF: .data:006417BC\u2193o
                db    0
                db    0
                db    0
aFloor          db 'floor',0            ; DATA XREF: .data:006417B4\u2193o
                db    0
                db    0
aCeil           db 'ceil',0             ; DATA XREF: .data:006417AC\u2193o
                db    0
                db    0
                db    0
aTan            db 'tan',0              ; DATA XREF: .data:006417A4\u2193o
aCos            db 'cos',0              ; DATA XREF: .data:0064179C\u2193o
aSin            db 'sin',0              ; DATA XREF: .data:00641794\u2193o
aSqrt_0         db 'sqrt',0             ; DATA XREF: .data:0064178C\u2193o
                db    0
                db    0
                db    0
aAtan2_0        db 'atan2',0            ; DATA XREF: .data:00641784\u2193o
                db    0
                db    0
aAtan_0         db 'atan',0             ; DATA XREF: .data:0064177C\u2193o
                db    0
                db    0
                db    0
aAcos_0         db 'acos',0             ; DATA XREF: .data:00641774\u2193o
                db    0
                db    0
                db    0
aAsin           db 'asin',0             ; DATA XREF: .data:0064176C\u2193o
                db    0
                db    0
                db    0
aTanh           db 'tanh',0             ; DATA XREF: .data:00641764\u2193o
                db    0
                db    0
                db    0
aCosh           db 'cosh',0             ; DATA XREF: .data:0064175C\u2193o
                db    0
                db    0
                db    0
aSinh           db 'sinh',0             ; DATA XREF: .data:00641754\u2193o
                db    0
                db    0
                db    0
aLog10_0        db 'log10',0            ; DATA XREF: .data:0064174C\u2193o
                db    0
                db    0
aLog            db 'log',0              ; DATA XREF: .data:00641744\u2193o
aPow            db 'pow',0              ; DATA XREF: .data:0064173C\u2193o
aExp            db 'exp',0              ; DATA XREF: .data:off_641734\u2193o
                align 10h
dbl_614B80      dq 0.0                  ; DATA XREF: __handle_exc+98↑r
dbl_614B88      dq 0.0                  ; DATA XREF: __decomp+4↑r
aSunmontuewedth db 'SunMonTueWedThuFriSat',0
                align 4
aJanfebmaraprma db 'JanFebMarAprMayJunJulAugSepOctNovDec',0
                align 10h
; const unsigned __int8 aTz
aTz             db 'TZ',0               ; DATA XREF: __tzset_lk+2E↑o
                align 4
aUnitedStates   db 'united-states',0
                align 4
aUnitedKingdom  db 'united-kingdom',0
                align 4
aUnitedStates_0 db 'united states',0
                align 4
aUnitedKingdom_0 db 'united kingdom',0
                align 4
aTwn            db 'twn',0
aTurkey         db 'turkey',0
                align 10h
aTur            db 'tur',0
aTaiwan         db 'taiwan',0
                align 4
aSwitzerland    db 'switzerland',0
aSweden         db 'sweden',0
                align 10h
aSwe            db 'swe',0
aSvk            db 'svk',0
aSpain          db 'spain',0
                align 10h
aSouthKorea     db 'south-korea',0
aSouthKorea_0   db 'south korea',0
aSgp            db 'sgp',0
aSingapore      db 'singapore',0
                align 4
aRussia         db 'russia',0
                align 10h
aPrt            db 'prt',0
aPrChina        db 'pr-china',0
                align 10h
aPrChina_0      db 'pr china',0
                align 4
aPortugal       db 'portugal',0
                align 4
aPoland         db 'poland',0
                align 10h
aPol            db 'pol',0
aNzl            db 'nzl',0
aNz             db 'nz',0
                db    0
aNorway         db 'norway',0
                db    0
aNewZealand     db 'new-zealand',0
aNewZealand_0   db 'new zealand',0
aNetherlands    db 'netherlands',0
aMexico         db 'mexico',0
                db    0
aMex            db 'mex',0
aKorea          db 'korea',0
                db    0
                db    0
aJapan          db 'japan',0
                db    0
                db    0
aItaly          db 'italy',0
                db    0
                db    0
aIrl            db 'irl',0
aIreland        db 'ireland',0
aIceland        db 'iceland',0
aHungary        db 'hungary',0
aHongKong       db 'hong-kong',0
                db    0
                db    0
aHongKong_0     db 'hong kong',0
                db    0
                db    0
aHolland        db 'holland',0
aHkg            db 'hkg',0
aGreece         db 'greece',0
                db    0
aGreatBritain   db 'great britain',0
                db    0
                db    0
aGrc            db 'grc',0
aGermany        db 'germany',0
aGbr            db 'gbr',0
aFrance         db 'france',0
                db    0
aFinland        db 'finland',0
aEngland        db 'england',0
aDnk            db 'dnk',0
aDenmark        db 'denmark',0
aCze            db 'cze',0
aChn            db 'chn',0
aChina          db 'china',0
                db    0
                db    0
aChe            db 'che',0
aCanada         db 'canada',0
                db    0
aCan            db 'can',0
aBritain        db 'britain',0
aBrazil         db 'brazil',0
                db    0
aBra            db 'bra',0
aBelgium        db 'belgium',0
aBel            db 'bel',0
aAut            db 'aut',0
aAustria        db 'austria',0
aAustralia      db 'australia',0
                db    0
                db    0
aAus            db 'aus',0
aAmerica        db 'america',0          ; DATA XREF: .data:00642160↓o
aUsa            db 'usa',0              ; DATA XREF: .data:00642408↓o
aUs             db 'us',0
                db    0
aUk             db 'uk',0
                db    0
aTurkish        db 'turkish',0
aTrk            db 'trk',0
aSwiss          db 'swiss',0
                db    0
                db    0
aSwedish        db 'swedish',0
aSve            db 'sve',0
aSpanishModern  db 'spanish-modern',0
                db    0
aSpanishMexican db 'spanish-mexican',0
aSpanish        db 'spanish',0
aSlovak         db 'slovak',0
                db    0
aSky            db 'sky',0
aRussian        db 'russian',0
aRus            db 'rus',0
aPtg            db 'ptg',0
aPtb            db 'ptb',0
aPortugueseBraz db 'portuguese-brazilian',0
                db    0
                db    0
                db    0
aPortuguese     db 'portuguese',0
                db    0
aPolish         db 'polish',0
                db    0
aPlk            db 'plk',0
aNorwegianNynor db 'norwegian-nynorsk',0
                db    0
                db    0
aNorwegianBokma db 'norwegian-bokmal',0
                db    0
                db    0
                db    0
aNorwegian      db 'norwegian',0
                db    0
                db    0
aNor            db 'nor',0
aNon            db 'non',0
aNld            db 'nld',0
aNlb            db 'nlb',0
aKorean         db 'korean',0
                db    0
aKor            db 'kor',0
aJpn            db 'jpn',0
aJapanese       db 'japanese',0
                db    0
                db    0
                db    0
aIts            db 'its',0
aItalianSwiss   db 'italian-swiss',0
                db    0
                db    0
aItalian        db 'italian',0
aIta            db 'ita',0
aIsl            db 'isl',0
aIrishEnglish   db 'irish-english',0
                db    0
                db    0
aIcelandic      db 'icelandic',0
                db    0
                db    0
aHungarian      db 'hungarian',0
                db    0
                db    0
aHun            db 'hun',0
aGreek          db 'greek',0
                db    0
                db    0
aGermanSwiss    db 'german-swiss',0
                db    0
                db    0
                db    0
aGermanAustrian db 'german-austrian',0
aGerman         db 'german',0
                db    0
aFrs            db 'frs',0
aFrenchSwiss    db 'french-swiss',0
                db    0
                db    0
                db    0
aFrenchCanadian db 'french-canadian',0
aFrenchBelgian  db 'french-belgian',0
                db    0
aFrench         db 'french',0
                db    0
aFrc            db 'frc',0
aFrb            db 'frb',0
aFra            db 'fra',0
aFinnish        db 'finnish',0
aFin            db 'fin',0
aEsp            db 'esp',0
aEsn            db 'esn',0
aEsm            db 'esm',0
aEnz            db 'enz',0
aEnu            db 'enu',0
aEni            db 'eni',0
aEnglishUsa     db 'english-usa',0
aEnglishUs      db 'english-us',0
                db    0
aEnglishUk      db 'english-uk',0
                db    0
aEnglishNz      db 'english-nz',0
                db    0
aEnglishIre     db 'english-ire',0
aEnglishCan     db 'english-can',0
aEnglishAus     db 'english-aus',0
aEnglishAmerica db 'english-american',0
                db    0
                db    0
                db    0
aEnglish        db 'english',0
aEng            db 'eng',0
aEnc            db 'enc',0
aEna            db 'ena',0
aEll            db 'ell',0
aDutchBelgian   db 'dutch-belgian',0
                db    0
                db    0
aDutch          db 'dutch',0
                db    0
                db    0
aDeu            db 'deu',0
aDes            db 'des',0
aDea            db 'dea',0
aDanish         db 'danish',0
                db    0
aDan            db 'dan',0
aCzech          db 'czech',0
                db    0
                db    0
aCsy            db 'csy',0
aCht            db 'cht',0
aChs            db 'chs',0
aChineseTraditi db 'chinese-traditional',0
aChineseSingapo db 'chinese-singapore',0
                db    0
                db    0
aChineseSimplif db 'chinese-simplified',0
                db    0
aChineseHongkon db 'chinese-hongkong',0
                db    0
                db    0
                db    0
aChinese        db 'chinese',0
aChi            db 'chi',0
aChh            db 'chh',0
aCanadian       db 'canadian',0
                db    0
                db    0
                db    0
aBelgian        db 'belgian',0
aAustralian     db 'australian',0
                db    0
aAmericanEnglis db 'american-english',0
                db    0
                db    0
                db    0
aAmericanEnglis_0 db 'american english',0
                db    0
                db    0
                db    0
aAmerican       db 'american',0
                db    0
                db    0
                db    0
unk_615164      db  4Fh ; O             ; DATA XREF: ___get_qualified_locale+F7↑o
                db  43h ; C
                db  50h ; P
                db    0
unk_615168      db  41h ; A             ; DATA XREF: ___get_qualified_locale+C3↑o
                db  43h ; C
                db  50h ; P
                db    0
                db    0
                db    0
                db    0
                db    0
dbl_615170      dq -1.0                 ; DATA XREF: __logb+75↑r
dbl_615178      dq 0.0                  ; DATA XREF: __logb+99↑r

asc_6151BC      db '\',0                ; DATA XREF: __spawnvpe:loc_5D3C7E↑o
                align 10h
; const char VarName[]
g_VarName         db 'PATH',0             ; DATA XREF: __spawnvpe+4F↑o
                align 4
dword_6151C8    dd 4E512331h            ; DATA XREF: _$I10_OUTPUT:loc_5D44F1↑r
word_6151CC     dw 4E41h                ; DATA XREF: _$I10_OUTPUT+14C↑r
byte_6151CE     db 0                    ; DATA XREF: _$I10_OUTPUT+157↑r
                align 10h
dword_6151D0    dd 4E492331h            ; DATA XREF: _$I10_OUTPUT+11D↑r
word_6151D4     dw 46h                  ; DATA XREF: _$I10_OUTPUT+128↑r
                align 4
dword_6151D8    dd 4E492331h            ; DATA XREF: _$I10_OUTPUT+ED↑r
word_6151DC     dw 44h                  ; DATA XREF: _$I10_OUTPUT+F8↑r
                align 10h
dword_6151E0    dd 4E532331h            ; DATA XREF: _$I10_OUTPUT+AE↑r
word_6151E4     dw 4E41h                ; DATA XREF: _$I10_OUTPUT+BA↑r
byte_6151E6     db 0                    ; DATA XREF: _$I10_OUTPUT+C5↑r
                align 4
dbl_6151E8      dq -1.0                 ; DATA XREF: _ldexp+70↑r
dbl_6151F0      dq 0.0                  ; DATA XREF: _ldexp+A6↑r
aCom            db '.com',0             ; DATA XREF: .data:off_642684↓o
                align 10h
aExe            db '.exe',0             ; DATA XREF: .data:00642680↓o
                align 4
aBat            db '.bat',0             ; DATA XREF: .data:0064267C↓o
                align 10h
aCmd            db '.cmd',0             ; DATA XREF: .data:off_642678↓o
                align 4
word_615218     dw 5C2Eh                ; DATA XREF: __spawnve:loc_5D5614↑r
byte_61521A     db 0                    ; DATA XREF: __spawnve+82↑r
                align 10h



dword_70D838    dd ?                    ; DATA XREF: _flsall:loc_5C3FC6↑r
                dd ?
unk_70D840      db 1000h dup(?)
; size_t Count
g_Count           dd ?                    ; DATA XREF: _flsall+14↑r
;                align 20h


__pioinfo       dd 40h dup(?)

; UINT uNumber
uNumber         dd ?                    ; DATA XREF: __alloc_osfhnd+D5↑o
dword_70E964    dd ?                    ; DATA XREF: __strcmpi+5A↑r
; LONG Addend
Addend          dd ?                    ; DATA XREF: __strcmpi:loc_5C0B03↑w

dword_70E970    dd ?                    ; DATA XREF: start+94↑w


end
